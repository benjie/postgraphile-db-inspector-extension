(function(e){function t(t){for(var a,r,l=t[0],c=t[1],s=t[2],u=0,m=[];u<l.length;u++)r=l[u],i[r]&&m.push(i[r][0]),i[r]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);d&&d(t);while(m.length)m.shift()();return o.push.apply(o,s||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],a=!0,r=1;r<n.length;r++){var c=n[r];0!==i[c]&&(a=!1)}a&&(o.splice(t--,1),e=l(l.s=n[0]))}return e}var a={},i={app:0},o=[];function r(e){return l.p+"js/"+({about:"about",pdfjsWorker:"pdfjsWorker"}[e]||e)+"."+{about:"e0eaae9a",pdfjsWorker:"597cb4ac"}[e]+".js"}function l(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,l),n.l=!0,n.exports}l.e=function(e){var t=[],n=i[e];if(0!==n)if(n)t.push(n[2]);else{var a=new Promise(function(t,a){n=i[e]=[t,a]});t.push(n[2]=a);var o,c=document.createElement("script");c.charset="utf-8",c.timeout=120,l.nc&&c.setAttribute("nonce",l.nc),c.src=r(e),o=function(t){c.onerror=c.onload=null,clearTimeout(s);var n=i[e];if(0!==n){if(n){var a=t&&("load"===t.type?"missing":t.type),o=t&&t.target&&t.target.src,r=new Error("Loading chunk "+e+" failed.\n("+a+": "+o+")");r.type=a,r.request=o,n[1](r)}i[e]=void 0}};var s=setTimeout(function(){o({type:"timeout",target:c})},12e4);c.onerror=c.onload=o,document.head.appendChild(c)}return Promise.all(t)},l.m=e,l.c=a,l.d=function(e,t,n){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(l.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)l.d(n,a,function(t){return e[t]}.bind(null,a));return n},l.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="/pgdbi/",l.oe=function(e){throw console.error(e),e};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],s=c.push.bind(c);c.push=t,c=c.slice();for(var u=0;u<c.length;u++)t(c[u]);var d=s;o.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"0134":function(e,t,n){"use strict";var a=n("da37"),i=n.n(a);i.a},"015f":function(e,t,n){},"065f":function(e,t,n){"use strict";var a=n("9e46"),i=n.n(a);i.a},1:function(e,t){},2:function(e,t){},"243e":function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("h1",[e._v(e._s(e.id))]),n("hr"),n("script-viewer",{attrs:{scriptText:e.definition,showDeclarationVisibility:!1,showReadability:!1,skipFormat:""},on:{"declaration-visibility-changed":e.declarationVisibilityChanged}})],1)},i=[],o=(n("7514"),n("28a5"),n("89d6")),r={name:"Function",components:{ScriptViewer:o["a"]},props:{id:{type:String,required:!0},context:{type:String,default:"default"}},computed:{definition:function(){var e={default:this.rawFunction,trigger:this.triggerFunction};return e[this.context]},rawFunction:function(){return this.fn.definition},modifiedFunction:function(){var e=this.fn.definition.split("$function$")[0],t=this.fn.definition.split("$function$")[1],n=e.split("\n").map(function(e){return"-- ".concat(e)}).join("\n");return"".concat(n," $function$").concat(t," -- $function$\n")},triggerFunction:function(){var e=this.fn.definition.split("$function$")[1];return e},functionName:function(){return this.fn.functionName},functionSchema:function(){return this.fn.functionSchema}},data:function(){return{fn:{definition:""},declarationVisibility:"show"}},methods:{declarationVisibilityChanged:function(e){this.declarationVisibility=e},onCopy:function(e){alert("Copied!")},onError:function(e){alert("Failed to copy texts")},setFn:function(){var e=this.id.split(".")[0],t=this.id.split(".")[1],n=this.$store.state.managedSchemata.find(function(t){return t.schemaName===e});this.fn=n.schemaFunctions.find(function(e){return e.functionName===t})}},mounted:function(){this.setFn()},beforeRouteUpdate:function(e,t,n){this.setFn(),n()}},l=r,c=n("2877"),s=n("6544"),u=n.n(s),d=n("a523"),m=Object(c["a"])(l,a,i,!1,null,null,null);t["a"]=m.exports;u()(m,{VContainer:d["a"]})},"2a83":function(e,t){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"allEnabledRoles"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"nodes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"roleName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"applicableRoles"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"grantee"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"roleName"},arguments:[],directives:[]}]}}]}}]}}]}}],loc:{start:0,end:131}};n.loc.source={body:"query {\n  allEnabledRoles {\n    nodes {\n      roleName\n      applicableRoles {\n        grantee\n        roleName\n      }\n    }\n  }\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};function a(e,t){if("FragmentSpread"===e.kind)t.add(e.name.value);else if("VariableDefinition"===e.kind){var n=e.type;"NamedType"===n.kind&&t.add(n.name.value)}e.selectionSet&&e.selectionSet.selections.forEach(function(e){a(e,t)}),e.variableDefinitions&&e.variableDefinitions.forEach(function(e){a(e,t)}),e.definitions&&e.definitions.forEach(function(e){a(e,t)})}var i={};(function(){n.definitions.forEach(function(e){if(e.name){var t=new Set;a(e,t),i[e.name.value]=t}})})(),e.exports=n},3:function(e,t){},"35d9":function(e,t,n){"use strict";var a=n("b450"),i=n.n(a);i.a},3754:function(e,t,n){},"3b45":function(e,t,n){},4:function(e,t){},5:function(e,t){},"567d":function(e,t,n){"use strict";(function(e){n("55dd"),n("6b54");var a=n("82cd");t["a"]={name:"FunctionPolicyManager",components:{PolicyDefinition:a["a"]},methods:{saveNewPolicy:function(){try{this.$store.commit("newFunctionPolicy",{name:this.newPolicyName})}catch(e){alert(e.toString()),console.error(e)}this.dialog=!1}},computed:{policies:function(){return this.$store.state.functionPolicies.sort(function(e,t){return e.id<t.id?-1:1})}},data:function(){return{dialog:!1,newPolicyName:"New Function Policy",headers:[{text:"",sortable:!1},{text:"ID",sortable:!1,value:"id"},{text:"Name",sortable:!1,value:"name"}]}},mounted:function(){e.client&&window&&(window.history.scrollRestoration="auto")}}}).call(this,n("4362"))},"56d7":function(e,t,n){"use strict";n.r(t);n("cadf"),n("551c"),n("f751"),n("097d");var a=n("2b0e"),i=n("f309");a["a"].use(i["a"]);var o=new i["a"]({icons:{iconfont:"md"}}),r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-app",{attrs:{id:"inspire"}},[n("v-hover",{scopedSlots:e._u([{key:"default",fn:function(t){var a=t.hover;return[n("v-navigation-drawer",{attrs:{clipped:!0,app:"",width:a?500:200,"disable-route-watcher":""},model:{value:e.drawer,callback:function(t){e.drawer=t},expression:"drawer"}},[n("project-navigator")],1)]}}])}),n("v-app-bar",{attrs:{app:"","clipped-left":""}},[n("v-app-bar-nav-icon",{on:{click:function(t){t.stopPropagation(),e.drawer=!e.drawer}}}),n("v-toolbar-title",{attrs:{selectable:""},domProps:{textContent:e._s(e.title)},on:{click:e.home}}),n("v-spacer"),n("v-btn",{attrs:{color:e.btnColor("home")},on:{click:function(t){return e.navigate("home")}}},[e._v("Home")]),n("v-btn",{attrs:{color:e.btnColor("role-manager")},on:{click:function(t){return e.navigate("role-manager")}}},[e._v("Roles")]),n("v-btn",{attrs:{color:e.btnColor("table-security-manager")},on:{click:function(t){return e.navigate("table-security-manager")}}},[e._v("Table Security")]),n("v-btn",{attrs:{color:e.btnColor("function-security-manager")},on:{click:function(t){return e.navigate("function-security-manager")}}},[e._v("Function Security")]),n("v-btn",{attrs:{color:e.btnColor("fk-index-manager")},on:{click:function(t){return e.navigate("fk-index-manager")}}},[e._v("Constraints And Indices")]),n("v-btn",{attrs:{color:e.btnColor("search-view")},on:{click:function(t){return e.navigate("search-view")}}},[e._v("Function Search")]),n("v-btn",{attrs:{color:e.btnColor("worker"),hidden:e.disableGraphileWorker},on:{click:function(t){return e.navigate("worker")}}},[e._v("Worker")]),n("v-btn",{attrs:{color:e.btnColor("sqitch"),hidden:e.disableSqitch},on:{click:function(t){return e.navigate("sqitch")}}},[e._v("Sqitch")]),n("v-spacer"),n("v-spacer"),n("v-spacer"),n("v-spacer"),n("v-spacer"),n("v-spacer"),n("v-spacer"),n("v-spacer"),n("v-spacer"),n("v-btn",{attrs:{icon:""},on:{click:function(t){return t.stopPropagation(),e.settings(t)}}},[n("v-icon",[e._v("settings")])],1)],1),n("v-content",[n("v-container",{attrs:{"justify-start":"","ma-0":"","pa-0":""}},[n("router-view")],1)],1),n("v-footer",{attrs:{app:""}},[n("span",[e._v("Â© 2019")])])],1)},l=[],c=(n("7f7f"),new a["a"],function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("schema-navigator")],1)}),s=[],u=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",{attrs:{"ma-0":"","pa-0":""}},[n("v-toolbar",[n("v-btn",{attrs:{block:""},on:{click:e.refreshSchemata}},[e._v("Refresh"),n("br"),e._v("Schemata")])],1),n("schema-tree")],1)},d=[],m=(n("6b54"),n("58bb")),f=n.n(m),p=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",{attrs:{"ma-0":"","pa-0":"",dense:""}},[n("v-treeview",{directives:[{name:"scroll",rawName:"v-scroll"}],attrs:{items:e.items,activatable:"",transition:"",active:e.active,hoverable:"",dense:""},on:{"update:active":function(t){e.active=t}},model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}})],1)},b=[],v=(n("28a5"),n("55dd"),{name:"SchemaTree",data:function(){return{active:[],schemata:[],selected:[]}},computed:{items:function(){var e=this;return this.$store.state.managedSchemata.map(function(t){return{id:"schema:".concat(t.id),name:t.schemaName,children:e.filterMode?[]:[{id:"tables:".concat(t.schemaName),name:"tables",children:t.schemaTables.sort(function(e,t){return e.tableName<t.tableName?-1:1}).map(function(e){return{id:"table:".concat(e.id),name:e.tableName}})},{id:"functions:".concat(t.schemaName),name:"functions",children:(t.schemaFunctions||[]).sort(function(e,t){return e.functionName<t.functionName?-1:1}).map(function(e){return{id:"function:".concat(e.id),name:e.functionName}})},{id:"enums:".concat(t.schemaName),name:"enums",children:(t.schemaEnums||[]).sort(function(e,t){return e.enumName<t.enumName?-1:1}).map(function(e){return{id:"enum:".concat(e.id),name:e.enumName}})},{id:"udts:".concat(t.schemaName),name:"udts",children:(t.schemaUdts||[]).sort(function(e,t){return e.udtName<t.udtName?-1:1}).map(function(e){return{id:"udt:".concat(e.id),name:e.udtName}})}]}}).sort(function(e,t){return e.name<t.name?-1:1})}},watch:{active:function(){var e=this.active[0]||"",t=e.split(":")[0],n=e.split(":")[1];switch(console.log("enum",t,n,this.active),t){case"table":this.$router.push({name:"table",params:{id:n}});break;case"tables":break;case"function":this.$router.push({name:"function",params:{id:n}});break;case"enum":this.$router.push({name:"enum",params:{id:n}});break;case"udt":this.$router.push({name:"udt",params:{id:n}});break;default:break}}}}),h=v,y=n("2877"),g=n("6544"),x=n.n(g),k=n("a523"),_=n("eb2a"),C=n("269a"),N=n.n(C),T=n("f977"),S=Object(y["a"])(h,p,b,!1,null,null,null),I=S.exports;x()(S,{VContainer:k["a"],VTreeview:_["a"]}),N()(S,{Scroll:T["a"]});var D={name:"SchemaNavigator",components:{SchemaTree:I},props:{},data:function(){return{}},computed:{},watch:{},methods:{refreshSchemata:function(){var e=this;this.$loading(!0),this.$apollo.query({query:f.a,fetchPolicy:"network-only"}).then(function(t){e.$store.commit("setManagedSchemata",t.data.dbIntrospection.schemaTree),e.$store.commit("setEnabledRoles",{enabledRoles:t.data.dbIntrospection.enabledRoles}),e.$store.commit("setPgdbiOptions",{pgdbiOptions:t.data.pgdbiOptions}),e.$loading(!1)}).catch(function(t){e.$loading(!1),console.error(t),alert(t.toString())})}}},E=D,P=n("8336"),O=n("71d9"),j=Object(y["a"])(E,u,d,!1,null,null,null),w=j.exports;x()(j,{VBtn:P["a"],VContainer:k["a"],VToolbar:O["a"]});var R={name:"ProjectNavigator",props:{},components:{SchemaNavigator:w}},V=R,F=Object(y["a"])(V,c,s,!1,null,null,null),A=F.exports;x()(F,{VContainer:k["a"]});var $={name:"App",props:{source:String},components:{ProjectNavigator:A},computed:{currentRoute:function(){return this.$router.currentRoute},disableGraphileWorker:function(){return!0!==(this.$store.state.pgdbiOptions||{enableGraphileWorker:!1}).enableGraphileWorker},disableSqitch:function(){return!0!==(this.$store.state.pgdbiOptions||{enableSqitch:!1}).enableSqitch}},methods:{btnColor:function(e){return this.$router.currentRoute.name===e?"blue":"blue-grey"},home:function(){this.$router.push({name:"home"})},settings:function(){this.$router.push({name:"settings"})},navigate:function(e){this.$router.push({name:e})}},data:function(){return{expandNav:!1,clipped:!0,drawer:!0,fixed:!1,items:[],miniVariant:!1,right:!0,rightDrawer:!1,title:"pg-db-inspector"}},created:function(){this.$vuetify.theme.dark=!0}},q=$,G=n("7496"),U=n("40dc"),L=n("5bc1"),B=n("a75b"),M=n("553a"),z=n("ce87"),Q=n("132d"),K=n("f774"),W=n("2fa4"),H=n("2a7f"),X=Object(y["a"])(q,r,l,!1,null,null,null),Y=X.exports;x()(X,{VApp:G["a"],VAppBar:U["a"],VAppBarNavIcon:L["a"],VBtn:P["a"],VContainer:k["a"],VContent:B["a"],VFooter:M["a"],VHover:z["a"],VIcon:Q["a"],VNavigationDrawer:K["a"],VSpacer:W["a"],VToolbarTitle:H["a"]});var J=n("8c4f"),Z=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",{attrs:{"ma-0":"","pa-0":""}},[n("h1",[e._v("PGDBI")]),n("h2",[e._v("postgraphile-db-inspector")]),n("hr"),n("h2",[e._v("A collection of tools to ensure your postgres database is properly configured to support "),n("a",{attrs:{href:"https://www.graphile.org/postgraphile/",target:"_blank"}},[e._v("postgraphile")])]),n("hr"),n("h2",[e._v("click here if you want to reset the tool")]),n("v-btn",{on:{click:e.resetStore}},[e._v("Reset PGDBI")]),n("h2",[e._v("import/export")]),n("v-btn",{on:{click:function(t){return e.$router.push("project-export")}}},[e._v("Export Project")]),n("v-btn",{on:{click:function(t){return e.$router.push("project-import")}}},[e._v("Import Project")]),n("hr"),n("h3",[e._v("links")]),n("ul",[n("li",[n("a",{attrs:{href:"https://www.graphile.org/postgraphile/"}},[e._v("postgraphile")])]),n("li",[n("a",{attrs:{href:"https://www.postgresql.org/docs/"}},[e._v("postgres")])]),n("li",[n("a",{attrs:{href:"https://graphql.org/"}},[e._v("graphql")])])])],1)},ee=[],te={name:"Home",components:{},props:{},computed:{},data:function(){return{activeTab:null}},methods:{resetStore:function(){this.$store.commit("resetDefaultState"),this.$router.push("initialize")}}},ne=te,ae=Object(y["a"])(ne,Z,ee,!1,null,null,null),ie=ae.exports;x()(ae,{VBtn:P["a"],VContainer:k["a"]});var oe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",{attrs:{"ma-0":"","pa-0":""}},[n("h1",[e._v("Select schema to work with in the filter to the left to get started")]),n("h2",[e._v("or...")]),n("project-import")],1)},re=[],le=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"container"},[n("div",{staticClass:"large-12 medium-12 small-12 cell"},[n("label",[e._v("File\n        "),n("input",{ref:"file",attrs:{type:"file",id:"file"},on:{change:function(t){return e.handleFileUpload()}}})])])]),n("h1",[e._v("Import Project: "+e._s(e.projectName))]),n("v-toolbar",[n("v-btn",{on:{click:e.importProject}},[e._v("Import")])],1),n("v-textarea",{attrs:{value:e.projectJson,"auto-grow":"",readonly:""}})],1)},ce=[],se=n("f499"),ue=n.n(se),de={name:"ImportProject",components:{},props:{},computed:{projectName:function(){return this.project?this.project.name:"N/A"},projectJson:function(){return this.project?ue()(this.project,null,2):"N/A"}},methods:{importProject:function(){this.$store.commit("importProject",{project:this.project})},useResults:function(e){this.project=JSON.parse(e.currentTarget.result)},handleFileUpload:function(){this.file=this.$refs.file.files[0];var e=new FileReader;e.onload=this.useResults,e.readAsText(this.file)},submitFile:function(){}},data:function(){return this.$store.commit("clearFocus"),{file:"",project:{releases:{nodes:[]}}}}},me=de,fe=n("a844"),pe=Object(y["a"])(me,le,ce,!1,null,null,null),be=pe.exports;x()(pe,{VBtn:P["a"],VTextarea:fe["a"],VToolbar:O["a"]});var ve={name:"Initialize",components:{ProjectImport:be},props:{},computed:{initializing:function(){return this.$store.state.initializing}},data:function(){return{activeTab:null}},watch:{initializing:function(){!0!==this.initializing&&this.$router.push({name:"role-manager"})}},beforeRouteLeave:function(e,t,n){this.initializing?n(!1):n()}},he=ve,ye=Object(y["a"])(he,oe,re,!1,null,null,null),ge=ye.exports;x()(ye,{VContainer:k["a"]});var xe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("h1",[e._v(e._s(e.id))]),n("hr"),n("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[n("v-tab",{key:"cols",attrs:{ripple:""}},[e._v("\n      Columns\n    ")]),n("v-tab-item",{key:"cols"},[n("v-card",{attrs:{flat:""}},[n("table-columns",{attrs:{tableInfo:e.tableInfo}})],1)],1),n("v-tab",{key:"constraints-and-indices",attrs:{ripple:""}},[e._v("\n      Constraints and Indices\n    ")]),n("v-tab-item",{key:"constraints-and-indices"},[n("v-card",{attrs:{flat:""}},[n("constraints-and-indices",{attrs:{tableSchema:e.tableSchema,tableName:e.tableName}})],1)],1),n("v-tab",{key:"tabletriggers",attrs:{ripple:""}},[e._v("\n      Triggers\n    ")]),n("v-tab-item",{key:"tabletriggers"},[n("v-card",{attrs:{flat:""}},[n("table-triggers",{attrs:{triggers:e.tableTriggers}})],1)],1),n("v-tab",{key:"tablePolicy",attrs:{ripple:""}},[e._v("\n      Assigned Policy\n    ")]),n("v-tab-item",{key:"tablePolicy"},[n("v-card",{attrs:{flat:""}},[n("table-policy-definition",{attrs:{policyId:e.tableInfo.policyDefinitionId,table:e.tableInfo}})],1)],1),n("v-tab",{key:"tableScripts",attrs:{ripple:""}},[e._v("\n      Generated Scripts\n    ")]),n("v-tab-item",{key:"tableScripts"},[n("v-card",{attrs:{flat:""}},[n("table-scripts",{attrs:{tableInfo:e.tableInfo}})],1)],1)],1)],1)},ke=[],_e=n("cebc"),Ce=(n("7514"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.tableDetail,"hide-default-footer":"","show-expand":""},scopedSlots:e._u([{key:"item.fkInfo",fn:function(t){var n=t.item;return[e._v("\n    "+e._s(n.fkInfo)+"\n  ")]}},{key:"item.fkIndex",fn:function(t){var a=t.item;return[n("div",{class:e.fkIndexClass(a.fkIndex)},[a.fkIndexLinkId?n("router-link",{attrs:{to:{name:"table",params:{id:a.fkIndexLinkId}},target:"_blank"}},[e._v(e._s(a.fkIndex))]):e._e(),a.fkIndexLinkId?e._e():n("span",[e._v(e._s(a.fkIndex))])],1)]}},{key:"expanded-item",fn:function(t){return[n("td",{attrs:{colspan:e.headers.length+1}},[n("column-detail",{attrs:{columnInfo:t.item}})],1)]}}])})],1)}),Ne=[],Te=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",{attrs:{fluid:""}},[n("v-row",[n("v-col",{attrs:{cols:"12"}},[n("v-row",{staticClass:"blue darken-4"},[n("v-col",{attrs:{cols:"4"}},[n("v-card",{staticClass:"ma-1 pa-1",attrs:{outlined:"",tile:""}},[n("h4",[e._v("Indices")]),n("hr"),e._l(e.columnInfo.columnIndices,function(t){return n("v-card",{key:t.id,staticClass:"ma-1 pa-1 grey darken-4 text-no-wrap"},[e._v("\n              "+e._s(t.indexName)+"\n            ")])})],2)],1),n("v-col",{attrs:{cols:"4"}},[n("v-card",{staticClass:"ma-1 pa-1",attrs:{dense:""}},[n("h4",[e._v("Foreign Keys")]),n("hr"),e._l(e.columnInfo.fkConstraintUsage,function(t){return n("v-card",{key:t.id,staticClass:"ma-1 pa-1 grey darken-4 text-no-wrap"},[e._v("\n              "+e._s(t.constraintName)+"\n              "),n("hr"),e._v("\n              REF: "),t.fkTableLinkId?n("router-link",{attrs:{to:{name:"table",params:{id:t.fkTableLinkId}},target:"_blank"}},[e._v(e._s(t.fkPath))]):e._e(),n("hr"),e._v("\n              IDX: "),n("span",{class:e.fkIndexClass(t.fkIndexEvaluation)},[e._v(e._s(t.fkIndexEvaluation))])],1)})],2)],1),n("v-col",{attrs:{cols:"4"}},[n("v-card",{staticClass:"ma-1 pa-1",attrs:{dense:""}},[n("h4",[e._v("Unique Constraints")]),n("hr"),e._l(e.columnInfo.uqConstraintUsage,function(t){return n("v-card",{key:t.id,staticClass:"ma-1 pa-1 grey darken-4 text-no-wrap"},[e._v("\n              "+e._s(t.constraintName)+"\n              "),n("hr"),e._v("\n              IDX: "),n("span",{class:e.uqIndexClass(t.uqIndexEvaluation)},[e._v(e._s(t.uqIndexEvaluation))])])})],2)],1)],1)],1)],1)],1)},Se=[],Ie="NO INDEX",De="MULTIPLE_INDICES",Ee={name:"ColumnDetail",props:{columnInfo:{type:Object,required:!0}},methods:{fkIndexClass:function(e){return e===Ie?"red--text":e===De?"yellow--text":"green--text"},uqIndexClass:function(e){return e===Ie?"red--text":e===De?"yellow--text":"green--text"}}},Pe=Ee,Oe=n("b0af"),je=n("62ad"),we=n("0fd9"),Re=Object(y["a"])(Pe,Te,Se,!1,null,null,null),Ve=Re.exports;x()(Re,{VCard:Oe["a"],VCol:je["a"],VContainer:k["a"],VRow:we["a"]});var Fe="NO INDEX",Ae={name:"TableDetail",props:{tableInfo:{type:Object,required:!0}},components:{ColumnDetail:Ve},methods:{changeSort:function(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)},fkIndexClass:function(e){return e===Fe?"red--text":""}},computed:{tableDetail:function(){var e=this;console.log("table",this.tableInfo);var t=(this.tableInfo.tableColumns||[]).map(function(t){var n=((e.tableInfo.referentialConstraints||[]).find(function(e){return void 0!==e.referencingColumnUsage.find(function(e){return e.tableSchema===t.tableSchema&&e.tableName===t.tableName&&e.columnName===t.columnName})})||{referencedColumnUsage:[]}).referencedColumnUsage[0],a=n?"".concat(n.tableSchema,".").concat(n.tableName,".").concat(n.columnName):"",i=e.tableInfo.indices.find(function(e){return e.tableSchema===t.tableSchema&&e.tableName===t.tableName&&e.columnName===t.columnName}),o=n?i?"".concat(i.indexName):Fe:"",r=n&&o!==Fe?"table:".concat(n.tableSchema,".").concat(n.tableName):"";return Object(_e["a"])({},t,{fkInfo:a,fkIndex:o,fkIndexLinkId:r})});return t}},data:function(){return{headers:[{text:"Ordinal",sortable:!0,value:"ordinalPosition"},{text:"Column Name",sortable:!0,value:"columnName"},{text:"Data Type",sortable:!0,value:"dataType"},{text:"Identity",sortable:!0,value:"isIdentity"},{text:"Nullable",sortable:!0,value:"isNullable"},{text:"Default Value",sortable:!0,value:"columnDefault"},{text:"FK Reference",sortable:!0,value:"fkInfo"},{text:"FK Index",sortable:!0,value:"fkIndex"}],pagination:{sortBy:"ordinalPosition",rowsPerPage:-1}}}},$e=Ae,qe=n("8fea"),Ge=Object(y["a"])($e,Ce,Ne,!1,null,null,null),Ue=Ge.exports;x()(Ge,{VContainer:k["a"],VDataTable:qe["a"]});var Le=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",{attrs:{fluid:""}},[n("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{headers:e.headers,items:e.tableDetail,"hide-default-footer":"","calculate-widths":"",dense:"","items-per-page":100},scopedSlots:e._u([{key:"item.isPKColumn",fn:function(t){var a=t.item;return[a.isPKColumn?n("v-icon",[e._v("check")]):e._e()]}},{key:"item.isNullable",fn:function(t){var a=t.item;return["YES"===a.isNullable?n("v-icon",[e._v("check")]):e._e()]}}])})],1)},Be=[],Me=n("75fc"),ze="NO INDEX",Qe="MULTIPLE_INDICES",Ke={name:"TableColumns",props:{tableInfo:{type:Object,required:!0}},components:{ColumnDetail:Ve},methods:{changeSort:function(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)},fkIndexClass:function(e){var t=e.fkConstraintUsage.filter(function(e){return e.fkIndexEvaluation===ze}).length,n=e.fkConstraintUsage.filter(function(e){return e.fkIndexEvaluation===Qe}).length;return t>0?"red":n>0?"yellow":"green"},uqIndexClass:function(e){var t=e.uqConstraintUsage.filter(function(e){return e.uqIndexEvaluation===ze}).length,n=e.uqConstraintUsage.filter(function(e){return e.uqIndexEvaluation===Qe}).length;return t>0?"red":n>0?"yellow":"green"}},computed:{tableDetail:function(){var e=this;console.log("table",this.tableInfo);var t=this.tableInfo.primaryKeyConstraints.reduce(function(e,t){var n=t.keyColumnUsage.reduce(function(e,t){return[].concat(Object(Me["a"])(e),[t.columnName])},[]);return[].concat(Object(Me["a"])(e),Object(Me["a"])(n))},[]),n=(this.tableInfo.tableColumns||[]).map(function(n){var a=e.tableInfo.indices.filter(function(e){return e.tableSchema===n.tableSchema&&e.tableName===n.tableName&&e.columnName===n.columnName}),i=t.indexOf(n.columnName)>-1,o=e.$store.state.fkIndexEvaluations.singleColumn["".concat(n.tableSchema,".").concat(n.tableName,".").concat(n.columnName)],r=e.$store.state.uqIndexEvaluations["".concat(n.tableSchema,".").concat(n.tableName,".").concat(n.columnName)];return Object(_e["a"])({},n,{fkConstraintUsage:o||[],uqConstraintUsage:r||[],isPKColumn:i,columnIndices:a})});return n}},data:function(){return{headers:[{text:"Ordinal",sortable:!0,value:"ordinalPosition"},{text:"Column Name",sortable:!0,value:"columnName"},{text:"PK",sortable:!0,value:"isPKColumn"},{text:"Nullable",sortable:!0,value:"isNullable"},{text:"Data Type",sortable:!0,value:"dataType"},{text:"Default Value",sortable:!0,value:"columnDefault"}],pagination:{sortBy:"ordinalPosition",rowsPerPage:-1}}}},We=Ke,He=Object(y["a"])(We,Le,Be,!1,null,null,null),Xe=He.exports;x()(He,{VContainer:k["a"],VDataTable:qe["a"],VIcon:Q["a"]});var Ye=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[n("v-tab",{key:"allIndices",attrs:{ripple:""}},[e._v("\n    All Indices\n  ")]),n("v-tab-item",{key:"allIndices"},[n("v-card",{attrs:{flat:""}},[n("table-generic-indices",{attrs:{tableInfo:e.tableInfo}})],1)],1),n("v-tab",{key:"fkIndices",attrs:{ripple:""}},[e._v("\n    Foreign Key Constraints\n  ")]),n("v-tab-item",{key:"fkIndices"},[n("v-card",{attrs:{flat:""}},[n("table-fk-indices",{attrs:{tableInfo:e.tableInfo}})],1)],1),n("v-tab",{key:"uqIndices",attrs:{ripple:""}},[e._v("\n    Unique Constraints\n  ")]),n("v-tab-item",{key:"uqIndices"},[n("v-card",{attrs:{flat:""}},[n("table-uq-indices",{attrs:{tableInfo:e.tableInfo}})],1)],1),n("v-tab",{key:"chk",attrs:{ripple:""}},[e._v("\n    Check Constraints\n  ")]),n("v-tab-item",{key:"chk"},[n("v-card",{attrs:{flat:""}},[n("table-check-constraints",{attrs:{checkConstraints:e.checkConstraints}})],1)],1)],1)},Je=[],Ze=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",{attrs:{fluid:""}},[n("v-card",{staticClass:"ma-3 pa-3 green darken-3",attrs:{dense:""}},[n("h2",[e._v("Indexed")]),n("hr"),n("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{items:e.goodIndices,headers:e.headers,"hide-default-footer":"","show-expand":"","calculate-widths":"",dense:""},scopedSlots:e._u([{key:"item.evaluation",fn:function(t){var a=t.item;return[n("span",{class:a.indexDisplayClass},[e._v(e._s(a.evaluation))])]}},{key:"expanded-item",fn:function(t){return[n("td",{attrs:{colspan:e.headers.length+1}},[n("table-generic-index-detail",{attrs:{evaluation:t.item}})],1)]}}])})],1),n("v-card",{staticClass:"ma-3 pa-3 red darken-3",attrs:{dense:""}},[n("h2",[e._v("Over-Indexed")]),n("hr"),n("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{items:e.badIndices,headers:e.headers,"hide-default-footer":"","show-expand":"","calculate-widths":"",dense:""},scopedSlots:e._u([{key:"item.columnDisplay",fn:function(t){var a=t.item;return e._l(a.columnDisplay,function(t){return n("div",{key:t},[e._v(e._s(t))])})}},{key:"item.evaluation",fn:function(t){var a=t.item;return[n("span",{class:a.indexDisplayClass},[e._v(e._s(a.evaluation))])]}},{key:"expanded-item",fn:function(t){return[n("td",{attrs:{colspan:e.headers.length+1}},[n("table-generic-index-detail",{attrs:{evaluation:t.item}})],1)]}}])})],1)],1)},et=[],tt=n("a4bb"),nt=n.n(tt),at=n("89d6"),it=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.evaluation.indices,"hide-default-footer":!0,"show-expand":""},scopedSlots:e._u([{key:"expanded-item",fn:function(t){return[n("td",{attrs:{colspan:e.headers.length+1}},[n("v-tabs",{attrs:{dark:"","slider-color":"yellow"}},[n("v-tab",{key:"create",attrs:{ripple:""}},[e._v("\n          Create\n          ")]),n("v-tab-item",{key:"create",attrs:{lazy:""}},[n("script-viewer",{attrs:{scriptText:t.item.indexDefinition,showReadability:!1}})],1),n("v-tab",{key:"drop",attrs:{ripple:""}},[e._v("\n          Drop\n          ")]),n("v-tab-item",{key:"drop",attrs:{lazy:""}},[n("script-viewer",{attrs:{scriptText:t.item.indexDrop,showReadability:!1}})],1)],1)],1)]}}])})],1)},ot=[],rt={name:"TableGenericIndexDetail",props:{evaluation:{type:Object,required:!0}},components:{ScriptViewer:at["a"]},methods:{},computed:{},data:function(){return{headers:[{text:"Index Name",value:"indexName"}]}}},lt=rt,ct=n("71a3"),st=n("c671"),ut=n("fe57"),dt=Object(y["a"])(lt,it,ot,!1,null,null,null),mt=dt.exports;x()(dt,{VContainer:k["a"],VDataTable:qe["a"],VTab:ct["a"],VTabItem:st["a"],VTabs:ut["a"]});var ft="MULTIPLE_INDICES",pt={name:"TableGenericIndices",props:{tableInfo:{type:Object,required:!0}},components:{TableGenericIndexDetail:mt},methods:{changeSort:function(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},computed:{items:function(){var e=this,t=this.$store.state.genericIndexEvaluations;return nt()(t).filter(function(n){return t[n].tableKey==="".concat(e.tableInfo.tableSchema,".").concat(e.tableInfo.tableName)}).map(function(e){return t[e]})},goodIndices:function(){return this.items.filter(function(e){return e.evaluation!==ft})},badIndices:function(){return this.items.filter(function(e){return e.evaluation===ft}).map(function(e){return Object(_e["a"])({},e,{columnDisplay:e.idxColumns.split("+")})})},duplicateIndexSets:function(){return this.tableInfo.indices.reduce(function(e,t){},[])}},data:function(){return{selected:[],headers:[{text:"Index Columns",value:"columnDisplay"},{text:"Evaluation",value:"evaluation"}],pagination:{sortBy:"constraintName",rowsPerPage:-1}}}},bt=pt,vt=Object(y["a"])(bt,Ze,et,!1,null,null,null),ht=vt.exports;x()(vt,{VCard:Oe["a"],VContainer:k["a"],VDataTable:qe["a"]});var yt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("v-card",{staticClass:"ma-3 pa-3 blue-grey",attrs:{dense:""}},[n("h2",[e._v("Single-Column Foreign Keys")]),n("hr"),n("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{headers:e.singleColumnHeaders,items:e.singleColumnItems,"hide-default-footer":"","show-expand":"","calculate-widths":"",dense:""},scopedSlots:e._u([{key:"item.fkIndexEvaluation",fn:function(t){var a=t.item;return[n("span",{class:a.indexDisplayClass},[e._v(e._s(a.fkIndexEvaluation))])]}},{key:"item.fkTable",fn:function(t){var a=t.item;return[a.fkTableLinkId?n("router-link",{attrs:{to:{name:"table",params:{id:a.fkTableLinkId}},target:"_blank"}},[e._v(e._s(a.fkTable))]):e._e()]}},{key:"item.fkSource",fn:function(t){var a=t.item;return e._l(a.fkSource,function(t){return n("div",{key:t},[e._v(e._s(t))])})}},{key:"item.fkTarget",fn:function(t){var a=t.item;return e._l(a.fkTarget,function(t){return n("div",{key:t},[e._v(e._s(t))])})}},{key:"expanded-item",fn:function(t){return[n("td",{attrs:{colspan:e.singleColumnHeaders.length+1}},[n("table-generic-index-detail",{attrs:{evaluation:t.item}})],1)]}}])})],1),n("v-card",{staticClass:"ma-3 pa-3 blue-grey darken-4",attrs:{dense:""}},[n("h2",[e._v("Multi-Column Foreign Keys")]),n("hr"),n("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{headers:e.multiColumnHeaders,items:e.multiColumnItems,"hide-default-footer":"","show-expand":"","calculate-widths":"",dense:""},scopedSlots:e._u([{key:"item.fkIndexEvaluation",fn:function(t){var a=t.item;return[n("span",{class:a.indexDisplayClass},[e._v(e._s(a.fkIndexEvaluation))])]}},{key:"item.fkTable",fn:function(t){var a=t.item;return[a.fkTableLinkId?n("router-link",{attrs:{to:{name:"table",params:{id:a.fkTableLinkId}},target:"_blank"}},[e._v(e._s(a.fkTable))]):e._e()]}},{key:"item.fkSource",fn:function(t){var a=t.item;return e._l(a.fkSource,function(t){return n("div",{key:t},[e._v(e._s(t))])})}},{key:"item.fkTarget",fn:function(t){var a=t.item;return e._l(a.fkTarget,function(t){return n("div",{key:t},[e._v(e._s(t))])})}},{key:"expanded-item",fn:function(t){return[n("td",{attrs:{colspan:e.multiColumnHeaders.length+1}},[n("table-generic-index-detail",{attrs:{evaluation:t.item}})],1)]}}])})],1)],1)},gt=[],xt={name:"TableFKIndices",components:{TableGenericIndexDetail:mt},props:{tableInfo:{type:Object,required:!0}},methods:{changeSort:function(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},computed:{singleColumnItems:function(){var e=this;return this.tableInfo.tableColumns.reduce(function(t,n){var a=e.$store.state.fkIndexEvaluations.singleColumn[n.id];return a?[].concat(Object(Me["a"])(t),Object(Me["a"])(a)):t},[])},multiColumnItems:function(){return this.$store.state.fkIndexEvaluations.multiColumn[this.tableInfo.id]}},data:function(){return{singleColumnHeaders:[{text:"Constraint Name",value:"constraintName"},{text:"Index",value:"fkIndexEvaluation"},{text:"FK Table",value:"fkTable"},{text:"FK Source",value:"fkSource"},{text:"FK Target",value:"fkTarget"}],multiColumnHeaders:[{text:"Constraint Name",value:"constraintName"},{text:"Index",value:"fkIndexEvaluation"},{text:"FK Table",value:"fkTable"},{text:"FK Source",value:"fkSource"},{text:"FK Target",value:"fkTarget"}]}}},kt=xt,_t=Object(y["a"])(kt,yt,gt,!1,null,null,null),Ct=_t.exports;x()(_t,{VCard:Oe["a"],VContainer:k["a"],VDataTable:qe["a"]});var Nt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("v-card",{staticClass:"ma-3 pa-3 purple",attrs:{dense:""}},[n("h2",[e._v("Single-Column Unique Indices")]),n("hr"),n("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{headers:e.singleColumnHeaders,items:e.singleColumnItems,"hide-default-footer":"","show-expand":"","calculate-widths":"",dense:""},scopedSlots:e._u([{key:"item.uqIndexEvaluation",fn:function(t){var a=t.item;return[n("span",{class:a.indexDisplayClass},[e._v(e._s(a.uqIndexEvaluation))])]}},{key:"item.uqSource",fn:function(t){var a=t.item;return e._l(a.idxColumns,function(t){return n("div",{key:t},[e._v(e._s(t))])})}},{key:"expanded-item",fn:function(t){return[n("td",{attrs:{colspan:e.singleColumnHeaders.length+1}},[n("table-generic-index-detail",{attrs:{evaluation:t.item}})],1)]}}])})],1),n("v-card",{staticClass:"ma-3 pa-3 purple darken-4",attrs:{dense:""}},[n("h2",[e._v("Multi-Column Unique Indices")]),n("hr"),n("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{headers:e.multiColumnHeaders,items:e.multiColumnItems,"hide-default-footer":"","show-expand":"","calculate-widths":"",dense:""},scopedSlots:e._u([{key:"item.uqIndexEvaluation",fn:function(t){var a=t.item;return[n("span",{class:a.indexDisplayClass},[e._v(e._s(a.uqIndexEvaluation))])]}},{key:"item.uqSource",fn:function(t){var a=t.item;return e._l(a.idxColumns,function(t){return n("div",{key:t},[e._v(e._s(t))])})}},{key:"expanded-item",fn:function(t){return[n("td",{attrs:{colspan:e.singleColumnHeaders.length+1}},[n("table-generic-index-detail",{attrs:{evaluation:t.item}})],1)]}}])})],1)],1)},Tt=[],St={name:"TableUqIndices",components:{TableGenericIndexDetail:mt},props:{tableInfo:{type:Object,required:!0}},methods:{changeSort:function(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},computed:{singleColumnItems:function(){var e=this;return this.tableInfo.tableColumns.reduce(function(t,n){var a=e.$store.state.uqIndexEvaluations.singleColumn[n.id];return a?[].concat(Object(Me["a"])(t),Object(Me["a"])(a)):t},[])},multiColumnItems:function(){return this.$store.state.uqIndexEvaluations.multiColumn[this.tableInfo.id]}},data:function(){return{singleColumnHeaders:[{text:"Constraint Name",value:"constraintName"},{text:"Index",value:"uqIndexEvaluation"},{text:"Uq Column",value:"uqSource"}],multiColumnHeaders:[{text:"Constraint Name",value:"constraintName"},{text:"Index",value:"uqIndexEvaluation"},{text:"Uq Column(s)",value:"uqSource"}]}}},It=St,Dt=Object(y["a"])(It,Nt,Tt,!1,null,null,null),Et=Dt.exports;x()(Dt,{VCard:Oe["a"],VContainer:k["a"],VDataTable:qe["a"]});var Pt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("v-card",{staticClass:"ma-3 pa-3 blue darken-4",attrs:{dense:""}},[n("h2",[e._v("Check Constraints")]),n("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.mappedConstraints,"hide-default-footer":!0}})],1)],1)},Ot=[],jt={name:"TableCheckConstraints",props:{checkConstraints:{type:Array,required:!0}},computed:{mappedConstraints:function(){return this.checkConstraints.map(function(e){return Object(_e["a"])({},e,{expanded:!1,tableName:e.tableConstraints[0].tableName})})}},methods:{changeSort:function(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},data:function(){return{headers:[{text:"Name",sortable:!0,value:"constraintName"},{text:"Check Clause",sortable:!0,value:"checkClause"}],pagination:{sortBy:"constraintName",rowsPerPage:-1}}}},wt=jt,Rt=Object(y["a"])(wt,Pt,Ot,!1,null,null,null),Vt=Rt.exports;x()(Rt,{VCard:Oe["a"],VContainer:k["a"],VDataTable:qe["a"]});var Ft={name:"TableIndexAnalysis",components:{TableGenericIndices:ht,TableFkIndices:Ct,TableUqIndices:Et,TableCheckConstraints:Vt},props:{tableInfo:{type:Object,required:!0}},methods:{changeSort:function(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},computed:{allIndices:function(){return this.tableInfo.indices},uqIndices:function(){return this.tableInfo.indices},checkConstraints:function(){return this.tableInfo.checkConstraints||[]}},data:function(){return{activeTab:0,headers:[{text:"Column",value:"columnName"},{text:"Index Name",value:"indexName"}],pagination:{sortBy:"constraintName",rowsPerPage:-1}}}},At=Ft,$t=Object(y["a"])(At,Ye,Je,!1,null,null,null),qt=$t.exports;x()($t,{VCard:Oe["a"],VTab:ct["a"],VTabItem:st["a"],VTabs:ut["a"]});var Gt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[n("v-tab",{key:"refcons",attrs:{ripple:""}},[e._v("\n        Referential Constraints\n      ")]),n("v-tab-item",{key:"refcons"},[n("v-card",{attrs:{flat:""}},[n("table-referential-constraints",{attrs:{referentialConstraints:e.referentialConstraints}})],1)],1),n("v-tab",{key:"chk",attrs:{ripple:""}},[e._v("\n        Check Constraints\n      ")]),n("v-tab-item",{key:"chk"},[n("v-card",{attrs:{flat:""}},[n("table-check-constraints",{attrs:{checkConstraints:e.checkConstraints}})],1)],1),n("v-tab",{key:"uq",attrs:{ripple:""}},[e._v("\n        Unique Constraints\n      ")]),n("v-tab-item",{key:"uq"},[n("v-card",{attrs:{flat:""}},[n("table-unique-constraints",{attrs:{uniqueConstraints:e.uniqueConstraints}})],1)],1)],1)],1)},Ut=[],Lt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.mappedConstraints,"hide-default-footer":!0,"item-key":"constraintName"},scopedSlots:e._u([{key:"items",fn:function(t){return[n("tr",{on:{click:function(e){t.expanded=!t.expanded}}},[n("td",[e._v(e._s(t.item.constraintName)),n("hr"),e._v(e._s(t.item.source))]),n("td",[e._v(e._s(t.item.uniqueConstraintName)),n("hr"),e._v(e._s(t.item.target))]),n("td",[e._v(e._s(t.item.matchOption))]),n("td",[e._v(e._s(t.item.updateRule))]),n("td",[e._v(e._s(t.item.deleteRule))])])]}},{key:"expand",fn:function(t){return[n("v-card",{attrs:{flat:""}},[n("h2",[e._v("Source")]),n("table-key-column-usage",{attrs:{keyColumnUsage:t.item.referencingColumnUsage}})],1),n("v-card",{attrs:{flat:""}},[n("h2",[e._v("Target")]),n("table-key-column-usage",{attrs:{keyColumnUsage:t.item.referencedColumnUsage}})],1)]}}])})],1)},Bt=[],Mt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.keyColumnUsage,"hide-default-footer":!0},scopedSlots:e._u([{key:"items",fn:function(t){return[n("td",[e._v(e._s(t.item.tableSchema))]),n("td",[e._v(e._s(t.item.tableName))]),n("td",[e._v(e._s(t.item.columnName))])]}}])})],1)},zt=[],Qt={name:"TableKeyColumnUsage",props:{keyColumnUsage:{type:Array,required:!0}},methods:{},data:function(){return{headers:[{text:"Schema",sortable:!1,value:"tableSchema"},{text:"Table",sortable:!1,value:"tableName"},{text:"Column",sortable:!1,value:"columnName"}]}}},Kt=Qt,Wt=Object(y["a"])(Kt,Mt,zt,!1,null,null,null),Ht=Wt.exports;x()(Wt,{VContainer:k["a"],VDataTable:qe["a"]});var Xt={name:"TableReferentialConstraints",components:{TableKeyColumnUsage:Ht},props:{referentialConstraints:{type:Array,required:!0}},computed:{mappedConstraints:function(){return this.referentialConstraints.map(function(e){return Object(_e["a"])({},e,{expanded:!1,source:"".concat(e.referencingColumnUsage[0].tableSchema,".").concat(e.referencingColumnUsage[0].tableName,".").concat(e.referencingColumnUsage[0].columnName),target:"".concat(e.referencedColumnUsage[0].tableSchema,".").concat(e.referencedColumnUsage[0].tableName,".").concat(e.referencedColumnUsage[0].columnName)})})}},methods:{changeSort:function(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},data:function(){return{headers:[{text:"Source Constraint",sortable:!0,value:"constraintName"},{text:"Target Constraint",sortable:!0,value:"uniqueConstraintName"},{text:"On Match",sortable:!0,value:"matchOption"},{text:"On Update",sortable:!0,value:"updateRule"},{text:"On Delete",sortable:!0,value:"deleteRule"}],pagination:{sortBy:"constraintName",rowsPerPage:-1}}}},Yt=Xt,Jt=Object(y["a"])(Yt,Lt,Bt,!1,null,null,null),Zt=Jt.exports;x()(Jt,{VCard:Oe["a"],VContainer:k["a"],VDataTable:qe["a"]});var en=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.uniqueConstraints,"hide-default-footer":!0},scopedSlots:e._u([{key:"items",fn:function(t){return[n("td",[e._v(e._s(t.item.constraintSchema))]),n("td",[e._v(e._s(t.item.constraintName))])]}}])})],1)},tn=[],nn={name:"TableUniqueConstraints",props:{uniqueConstraints:{type:Array,required:!0}},methods:{changeSort:function(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},data:function(){return{headers:[{text:"Schema",sortable:!0,value:"constraintSchema"},{text:"Name",sortable:!0,value:"constraintName"}],pagination:{sortBy:"constraintName",rowsPerPage:-1}}}},an=nn,on=Object(y["a"])(an,en,tn,!1,null,null,null),rn=on.exports;x()(on,{VContainer:k["a"],VDataTable:qe["a"]});var ln={name:"TableConstraints",components:{TableReferentialConstraints:Zt,TableCheckConstraints:Vt,TableUniqueConstraints:rn},props:{tableInfo:{type:Object,required:!0}},computed:{referentialConstraints:function(){return this.tableInfo.referentialConstraints||[]},checkConstraints:function(){return this.tableInfo.checkConstraints||[]},uniqueConstraints:function(){return this.tableInfo.uniqueConstraints||[]}},methods:{},data:function(){return{activeTab:null}}},cn=ln,sn=Object(y["a"])(cn,Gt,Ut,!1,null,null,null),un=sn.exports;x()(sn,{VCard:Oe["a"],VContainer:k["a"],VTab:ct["a"],VTabItem:st["a"],VTabs:ut["a"]});var dn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.grants,"hide-default-footer":!0},scopedSlots:e._u([{key:"items",fn:function(t){return[n("td",[e._v(e._s(t.item.grantee))]),n("td",[e._v(e._s(t.item.privilegeType))])]}}])})],1)},mn=[],fn={name:"TableGrants",props:{grants:{type:Array,required:!0}},methods:{changeSort:function(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},data:function(){return{headers:[{text:"Grantor",sortable:!0,value:"grantor"},{text:"Privilege Type",sortable:!0,value:"privilegeType"}],pagination:{sortBy:"constraintName",rowsPerPage:-1}}}},pn=fn,bn=Object(y["a"])(pn,dn,mn,!1,null,null,null),vn=bn.exports;x()(bn,{VContainer:k["a"],VDataTable:qe["a"]});var hn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.grants,"hide-default-footer":!0},scopedSlots:e._u([{key:"items",fn:function(t){return[n("td",[e._v(e._s(t.item.tableSchema))]),n("td",[e._v(e._s(t.item.tableName))]),n("td",[e._v(e._s(t.item.columnName))]),n("td",[e._v(e._s(t.item.grantee))]),n("td",[e._v(e._s(t.item.grantor))]),n("td",[e._v(e._s(t.item.privilegeType))]),n("td",[e._v(e._s(t.item.isGrantable))])]}}])})],1)},yn=[],gn={name:"TableGrants",props:{grants:{type:Array,required:!0}},methods:{changeSort:function(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},data:function(){return{headers:[{text:"Schema",sortable:!0,value:"tableSchema"},{text:"Table",sortable:!0,value:"tableName"},{text:"Column",sortable:!0,value:"columnName"},{text:"Grantee",sortable:!0,value:"grantee"},{text:"Grantor",sortable:!0,value:"grantor"},{text:"Privilege Type",sortable:!0,value:"privilegeType"},{text:"Is Grantable",sortable:!0,value:"isGrantable"}],pagination:{sortBy:"constraintName",rowsPerPage:-1}}}},xn=gn,kn=Object(y["a"])(xn,hn,yn,!1,null,null,null),_n=kn.exports;x()(kn,{VContainer:k["a"],VDataTable:qe["a"]});var Cn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.policies,"hide-default-footer":!0},scopedSlots:e._u([{key:"items",fn:function(t){return[n("td",[e._v(e._s(t.item.policyName))]),n("td",[e._v(e._s(t.item.roles))]),n("td",[e._v(e._s(t.item.cmd))]),n("td",[e._v(e._s(t.item.qual))]),n("td",[e._v(e._s(t.item.withCheck))])]}}])})],1)},Nn=[],Tn={name:"TablePolicies",props:{policies:{type:Array,required:!0}},methods:{changeSort:function(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},data:function(){return{headers:[{text:"Policy Name",sortable:!0,value:"policyName"},{text:"Roles",sortable:!0,value:"roles"},{text:"Cmd",sortable:!0,value:"cmd"},{text:"Qual",sortable:!0,value:"qual"},{text:"With Check",sortable:!0,value:"withCheck"}],pagination:{sortBy:"constraintName",rowsPerPage:-1}}}},Sn=Tn,In=Object(y["a"])(Sn,Cn,Nn,!1,null,null,null),Dn=In.exports;x()(In,{VContainer:k["a"],VDataTable:qe["a"]});var En=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("table-trigger-set",{staticClass:"pa-1 ma-1 green",attrs:{actionTiming:"BEFORE",eventManipulation:"INSERT",triggers:e.beforeInsert}}),n("table-trigger-set",{staticClass:"pa-1 ma-1 green darken-2",attrs:{actionTiming:"BEFORE",eventManipulation:"UPDATE",triggers:e.beforeUpdate}}),n("table-trigger-set",{staticClass:"pa-1 ma-1 green darken-4",attrs:{actionTiming:"BEFORE",eventManipulation:"DELETE",triggers:e.beforeDelete}}),n("table-trigger-set",{staticClass:"pa-1 ma-1 blue",attrs:{actionTiming:"AFTER",eventManipulation:"INSERT",triggers:e.afterInsert}}),n("table-trigger-set",{staticClass:"pa-1 ma-1 blue darken-2",attrs:{actionTiming:"AFTER",eventManipulation:"UPDATE",triggers:e.afterUpdate}}),n("table-trigger-set",{staticClass:"pa-1 ma-1 blue darken-4",attrs:{actionTiming:"AFTER",eventManipulation:"DELETE",triggers:e.afterDelete}})],1)},Pn=[],On=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("h4",[e._v(e._s(e.actionTiming)+" - "+e._s(e.eventManipulation))]),n("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.mappedTriggers,"hide-default-footer":!0,"item-key":"id","show-expand":""},scopedSlots:e._u([{key:"expanded-item",fn:function(t){return[n("td",{attrs:{colspan:e.headers.length+1}},[n("function",{attrs:{id:t.item.functionId,context:"trigger"}})],1)]}}])})],1)},jn=[],wn=n("243e"),Rn={name:"TableTriggers",props:{actionTiming:{type:String,required:!0},eventManipulation:{type:String,required:!0},triggers:{type:Array,required:!0}},components:{Function:wn["a"]},computed:{mappedTriggers:function(){return this.triggers.map(function(e){var t="".concat(e.actionStatement.split(" ")[2].split("(")[0]);return Object(_e["a"])({},e,{functionId:t})}).sort(function(e,t){return e.actionTiming<t.actionTiming})}},methods:{changeSort:function(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},data:function(){return{headers:[{text:"Name",sortable:!0,value:"triggerName",width:"20%"},{text:"Timing",sortable:!0,value:"actionTiming",width:"10%"},{text:"Trigger On",sortable:!0,value:"eventManipulation",width:"10%"},{text:"Statement",sortable:!0,value:"actionStatement",width:"60%"}],pagination:{sortBy:"triggerName",rowsPerPage:-1}}}},Vn=Rn,Fn=Object(y["a"])(Vn,On,jn,!1,null,null,null),An=Fn.exports;x()(Fn,{VContainer:k["a"],VDataTable:qe["a"]});var $n={name:"TableTriggers",props:{triggers:{type:Array,required:!0}},components:{TableTriggerSet:An},computed:{beforeInsert:function(){return this.triggers.filter(function(e){return"BEFORE"===e.actionTiming&&"INSERT"===e.eventManipulation})},beforeUpdate:function(){return this.triggers.filter(function(e){return"BEFORE"===e.actionTiming&&"UPDATE"===e.eventManipulation})},beforeDelete:function(){return this.triggers.filter(function(e){return"BEFORE"===e.actionTiming&&"DELETE"===e.eventManipulation})},afterInsert:function(){return this.triggers.filter(function(e){return"AFTER"===e.actionTiming&&"INSERT"===e.eventManipulation})},afterUpdate:function(){return this.triggers.filter(function(e){return"AFTER"===e.actionTiming&&"UPDATE"===e.eventManipulation})},afterDelete:function(){return this.triggers.filter(function(e){return"AFTER"===e.actionTiming&&"DELETE"===e.eventManipulation})}}},qn=$n,Gn=Object(y["a"])(qn,En,Pn,!1,null,null,null),Un=Gn.exports;x()(Gn,{VContainer:k["a"]});var Ln=n("861c"),Bn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[n("v-tab",{key:"allIndices",attrs:{ripple:""}},[e._v("\n    All Indices\n  ")]),n("v-tab-item",{key:"allIndices"},[n("v-card",{attrs:{flat:""}},[n("generic-index-set",{attrs:{indexEvaluations:e.allIndexEvaluations}})],1)],1),n("v-tab",{key:"fkIndices",attrs:{ripple:""}},[e._v("\n    Foreign Key Constraints\n  ")]),n("v-tab-item",{key:"fkIndices"},[n("v-card",{attrs:{flat:""}},[n("fk-index-constraints",{attrs:{fkIndexEvaluations:e.fkIndexEvaluations}})],1)],1),n("v-tab",{key:"uqIndices",attrs:{ripple:""}},[e._v("\n    Unique Constraints\n  ")]),n("v-tab-item",{key:"uqIndices"},[n("v-card",{attrs:{flat:""}},[n("uq-index-set",{attrs:{uqIndexEvaluations:e.uqIndexEvaluations}})],1)],1),n("v-tab",{key:"chk",attrs:{ripple:"",hidden:e.hideCheckConstraints}},[e._v("\n    Check Constraints\n  ")]),n("v-tab-item",{key:"chk"},[n("v-card",{attrs:{flat:""}},[n("check-constraints",{attrs:{checkConstraints:e.checkConstraints}})],1)],1),n("v-tab",{key:"drop",attrs:{ripple:""}},[e._v("\n    Create Indices Script\n  ")]),n("v-tab-item",{key:"drop"},[n("v-card",{attrs:{flat:""}},[n("script-viewer",{attrs:{scriptText:e.createIndicesScript}})],1)],1),n("v-tab",{key:"create",attrs:{ripple:""}},[e._v("\n    Drop Indices Script\n  ")]),n("v-tab-item",{key:"create"},[n("v-card",{attrs:{flat:""}},[n("script-viewer",{attrs:{scriptText:e.dropIndicesScript}})],1)],1)],1)},Mn=[],zn=n("db0c"),Qn=n.n(zn),Kn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",{attrs:{fluid:""}},[n("v-card",{staticClass:"ma-3 pa-3 green darken-3",attrs:{dense:""}},[n("h2",[e._v("Indexed")]),n("hr"),n("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{items:e.goodIndices,headers:e.headers,"hide-default-footer":"","show-expand":"","calculate-widths":"",dense:"","items-per-page":e.goodIndices.length},scopedSlots:e._u([{key:"item.tableSchema",fn:function(t){var n=t.item;return[e._v("\n        "+e._s(n.tableKey.split(".")[0])+"\n      ")]}},{key:"item.tableName",fn:function(t){var a=t.item;return[a.tableKey?n("router-link",{attrs:{to:{name:"table",params:{id:a.tableKey}},target:"_blank"}},[e._v(e._s(a.tableKey.split(".")[1]))]):e._e()]}},{key:"item.columnDisplay",fn:function(t){var a=t.item;return e._l(a.columnDisplay,function(t){return n("div",{key:t},[e._v(e._s(t))])})}},{key:"item.evaluation",fn:function(t){var a=t.item;return e._l(a.evaluation,function(t){return n("div",{key:t,class:a.indexDisplayClass},[e._v(e._s(t))])})}},{key:"expanded-item",fn:function(t){return[n("td",{attrs:{colspan:e.headers.length+1}},[n("generic-index-detail",{attrs:{evaluation:t.item}})],1)]}}])})],1),n("v-card",{staticClass:"ma-3 pa-3 red darken-3",attrs:{dense:""}},[n("h2",[e._v("Over-Indexed")]),n("hr"),n("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{items:e.badIndices,headers:e.headers,"hide-default-footer":"","show-expand":"","calculate-widths":"",dense:"","items-per-page":e.badIndices.length},scopedSlots:e._u([{key:"item.tableSchema",fn:function(t){var n=t.item;return[e._v("\n        "+e._s(n.tableKey.split(".")[0])+"\n      ")]}},{key:"item.tableName",fn:function(t){var a=t.item;return[a.tableKey?n("router-link",{attrs:{to:{name:"table",params:{id:a.tableKey}},target:"_blank"}},[e._v(e._s(a.tableKey.split(".")[1]))]):e._e()]}},{key:"item.columnDisplay",fn:function(t){var a=t.item;return e._l(a.columnDisplay,function(t){return n("div",{key:t},[e._v(e._s(t))])})}},{key:"item.evaluation",fn:function(t){var a=t.item;return e._l(a.evaluation,function(t){return n("div",{key:t,class:a.indexDisplayClass},[e._v(e._s(t))])})}},{key:"expanded-item",fn:function(t){return[n("td",{attrs:{colspan:e.headers.length+1}},[n("generic-index-detail",{attrs:{evaluation:t.item}})],1)]}}])})],1)],1)},Wn=[],Hn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("h2",[e._v("Existing Indices")]),n("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.evaluation.indices,"hide-default-footer":!0,"show-expand":"","show-select":""},on:{"item-selected":e.itemSelected},scopedSlots:e._u([{key:"expanded-item",fn:function(t){return[n("td",{attrs:{colspan:e.headers.length+2}},[n("h2",[e._v("Current Realization in Database Under Development")]),n("script-viewer",{attrs:{scriptText:t.item.indexDefinition,showReadability:!1,showToolbar:!1}})],1)]}}]),model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}},[n("template",{slot:"header.data-table-select"},[e._v("\n      Drop\n    ")])],2),n("h2",[e._v("Current Realization To Be Generated")]),n("script-viewer",{attrs:{scriptText:e.desiredRealization,showReadability:!1}})],1)},Xn=[],Yn={name:"GenericIndexDetail",props:{evaluation:{type:Object,required:!0}},components:{ScriptViewer:at["a"]},methods:{itemSelected:function(e){this.$store.commit("toggleIndexForDrop",e)}},computed:{existingIndices:function(){return this.evaluation.indices||[]},desiredRealization:function(){var e=this.evaluation.desiredRealization.drop?"-- INDICES TO DROP\n\n ".concat(this.evaluation.desiredRealization.drop):"",t=this.evaluation.desiredRealization.create?"-- INDICES TO CREATE\n\n ".concat(this.evaluation.desiredRealization.create):"",n=e.concat("\n\n").concat(t);return n}},data:function(){return{selected:[],headers:[{text:"",value:"drop",width:"5%"},{text:"Index Name",value:"indexName"}]}},mounted:function(){var e=this;this.evaluation.indices.map(function(e){return e.indexName});this.selected=this.evaluation.indices.filter(function(t){return void 0!==e.$store.state.indicesToDrop[t.indexName]})}},Jn=Yn,Zn=Object(y["a"])(Jn,Hn,Xn,!1,null,null,null),ea=Zn.exports;x()(Zn,{VContainer:k["a"],VDataTable:qe["a"]});var ta="MULTIPLE_INDICES",na={name:"GenericIndexSet",props:{indexEvaluations:{type:Array,required:!0}},components:{GenericIndexDetail:ea},methods:{changeSort:function(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},computed:{goodIndices:function(){return this.indexEvaluations.filter(function(e){return e.evaluation!==ta}).map(function(e){return Object(_e["a"])({},e,{columnDisplay:e.idxColumns.split(", "),evaluation:e.evaluation.split(", ")})})},badIndices:function(){return this.indexEvaluations.filter(function(e){return e.evaluation===ta}).map(function(e){return Object(_e["a"])({},e,{columnDisplay:e.idxColumns.split(", "),evaluation:e.evaluation.split(", ")})})}},data:function(){return{selected:[],headers:[{text:"Schema",value:"tableSchema",width:"10%"},{text:"Table",value:"tableName",width:"10%"},{text:"Index Columns",value:"columnDisplay",width:"40%"},{text:"Evaluation",value:"evaluation",width:"40%"}],pagination:{sortBy:"constraintName",rowsPerPage:-1}}}},aa=na,ia=Object(y["a"])(aa,Kn,Wn,!1,null,null,null),oa=ia.exports;x()(ia,{VCard:Oe["a"],VContainer:k["a"],VDataTable:qe["a"]});var ra=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("v-card",{staticClass:"ma-3 pa-3 blue-grey",attrs:{dense:""}},[n("h2",[e._v("Single-Column Foreign Keys")]),n("hr"),n("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{headers:e.headers,items:e.singleColumnItems,"hide-default-footer":"","show-expand":"","calculate-widths":"",dense:"","items-per-page":e.singleColumnItems.length},scopedSlots:e._u([{key:"item.fkIndexEvaluation",fn:function(t){var a=t.item;return[n("span",{class:a.indexDisplayClass},[e._v(e._s(a.fkIndexEvaluation))])]}},{key:"item.fkTable",fn:function(t){var a=t.item;return[a.fkTableLinkId?n("router-link",{attrs:{to:{name:"table",params:{id:a.fkTableLinkId}},target:"_blank"}},[e._v(e._s(a.fkTable))]):e._e()]}},{key:"item.fkSource",fn:function(t){var a=t.item;return e._l(a.fkSource,function(t){return n("div",{key:t},[e._v(e._s(t))])})}},{key:"item.fkTarget",fn:function(t){var a=t.item;return e._l(a.fkTarget,function(t){return n("div",{key:t},[e._v(e._s(t))])})}},{key:"expanded-item",fn:function(t){return[n("td",{attrs:{colspan:e.headers.length+1}},[n("generic-index-detail",{attrs:{evaluation:t.item}})],1)]}}])})],1),n("v-card",{staticClass:"ma-3 pa-3 blue-grey darken-4",attrs:{dense:""}},[n("h2",[e._v("Multi-Column Foreign Keys")]),n("hr"),n("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{headers:e.headers,items:e.multiColumnItems,"hide-default-footer":"","show-expand":"","calculate-widths":"",dense:"","items-per-page":e.multiColumnItems.length},scopedSlots:e._u([{key:"item.fkIndexEvaluation",fn:function(t){var a=t.item;return[n("span",{class:a.indexDisplayClass},[e._v(e._s(a.fkIndexEvaluation))])]}},{key:"item.fkTable",fn:function(t){var a=t.item;return[a.fkTableLinkId?n("router-link",{attrs:{to:{name:"table",params:{id:a.fkTableLinkId}},target:"_blank"}},[e._v(e._s(a.fkTable))]):e._e()]}},{key:"item.fkSource",fn:function(t){var a=t.item;return e._l(a.fkSource,function(t){return n("div",{key:t},[e._v(e._s(t))])})}},{key:"item.fkTarget",fn:function(t){var a=t.item;return e._l(a.fkTarget,function(t){return n("div",{key:t},[e._v(e._s(t))])})}},{key:"expanded-item",fn:function(t){return[n("td",{attrs:{colspan:e.headers.length+1}},[n("generic-index-detail",{attrs:{evaluation:t.item}})],1)]}}])})],1)],1)},la=[],ca={name:"FkIndexConstraints",components:{GenericIndexDetail:ea},props:{fkIndexEvaluations:{type:Object,required:!0}},methods:{changeSort:function(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},computed:{singleColumnItems:function(){return Qn()(this.fkIndexEvaluations.singleColumn).flat()},multiColumnItems:function(){return Qn()(this.fkIndexEvaluations.multiColumn).filter(function(e){return e.length>0}).flat()}},data:function(){return{headers:[{text:"Constraint Name",value:"constraintName",width:"15%"},{text:"FK Table",value:"fkTable",width:"15%"},{text:"FK Source",value:"fkSource",width:"25%"},{text:"FK Target",value:"fkTarget",width:"25%"},{text:"Index",value:"fkIndexEvaluation",width:"20%"}]}}},sa=ca,ua=Object(y["a"])(sa,ra,la,!1,null,null,null),da=ua.exports;x()(ua,{VCard:Oe["a"],VContainer:k["a"],VDataTable:qe["a"]});var ma=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("v-card",{staticClass:"ma-3 pa-3 purple",attrs:{dense:""}},[n("h2",[e._v("Single-Column Unique Indices")]),n("hr"),n("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{headers:e.headers,items:e.singleColumnItems,"hide-default-footer":"","show-expand":"","calculate-widths":"",dense:"","items-per-page":e.singleColumnItems.length},scopedSlots:e._u([{key:"item.uqTableId",fn:function(t){var a=t.item;return[a.uqTableId?n("router-link",{attrs:{to:{name:"table",params:{id:a.uqTableId}},target:"_blank"}},[e._v(e._s(a.uqTableId))]):e._e()]}},{key:"item.uqIndexEvaluation",fn:function(t){var a=t.item;return[n("span",{class:a.indexDisplayClass},[e._v(e._s(a.uqIndexEvaluation))])]}},{key:"item.uqSource",fn:function(t){var a=t.item;return e._l(a.idxColumns,function(t){return n("div",{key:t},[e._v(e._s(t))])})}},{key:"expanded-item",fn:function(t){return[n("td",{attrs:{colspan:e.headers.length+1}},[n("generic-index-detail",{attrs:{evaluation:t.item}})],1)]}}])})],1),n("v-card",{staticClass:"ma-3 pa-3 purple darken-4",attrs:{dense:""}},[n("h2",[e._v("Multi-Column Unique Indices")]),n("hr"),n("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{headers:e.headers,items:e.multiColumnItems,"hide-default-footer":"","show-expand":"","calculate-widths":"",dense:"","items-per-page":e.multiColumnItems.length},scopedSlots:e._u([{key:"item.uqTableId",fn:function(t){var a=t.item;return[a.uqTableId?n("router-link",{attrs:{to:{name:"table",params:{id:a.uqTableId}},target:"_blank"}},[e._v(e._s(a.uqTableId))]):e._e()]}},{key:"item.uqIndexEvaluation",fn:function(t){var a=t.item;return[n("span",{class:a.indexDisplayClass},[e._v(e._s(a.uqIndexEvaluation))])]}},{key:"item.uqSource",fn:function(t){var a=t.item;return e._l(a.idxColumns,function(t){return n("div",{key:t},[e._v(e._s(t))])})}},{key:"expanded-item",fn:function(t){return[n("td",{attrs:{colspan:e.headers.length+1}},[n("generic-index-detail",{attrs:{evaluation:t.item}})],1)]}}])})],1)],1)},fa=[],pa={name:"TableUqIndices",components:{GenericIndexDetail:ea},props:{uqIndexEvaluations:{type:Object,required:!0}},methods:{changeSort:function(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},computed:{singleColumnItems:function(){return Qn()(this.uqIndexEvaluations.singleColumn).flat()},multiColumnItems:function(){return Qn()(this.uqIndexEvaluations.multiColumn).flat()}},data:function(){return{headers:[{text:"Constraint Name",value:"constraintName",width:"25%"},{text:"Table",value:"uqTableId",width:"20%"},{text:"Uq Column",value:"uqSource",width:"25%"},{text:"Index",value:"uqIndexEvaluation",width:"30%"}]}}},ba=pa,va=Object(y["a"])(ba,ma,fa,!1,null,null,null),ha=va.exports;x()(va,{VCard:Oe["a"],VContainer:k["a"],VDataTable:qe["a"]});var ya=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("v-card",{staticClass:"ma-3 pa-3 blue darken-4",attrs:{dense:""}},[n("h2",[e._v("Check Constraints")]),n("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.mappedConstraints,"hide-default-footer":!0}})],1)],1)},ga=[],xa={name:"CheckConstraints",props:{checkConstraints:{type:Array,required:!0}},computed:{mappedConstraints:function(){return this.checkConstraints.map(function(e){return Object(_e["a"])({},e,{expanded:!1,tableName:e.tableConstraints[0].tableName})})}},methods:{changeSort:function(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},data:function(){return{headers:[{text:"Name",sortable:!0,value:"constraintName"},{text:"Check Clause",sortable:!0,value:"checkClause"}],pagination:{sortBy:"constraintName",rowsPerPage:-1}}}},ka=xa,_a=Object(y["a"])(ka,ya,ga,!1,null,null,null),Ca=_a.exports;x()(_a,{VCard:Oe["a"],VContainer:k["a"],VDataTable:qe["a"]});var Na={name:"ConstraintsAndIndices",components:{GenericIndexSet:oa,FkIndexConstraints:da,UqIndexSet:ha,CheckConstraints:Ca,ScriptViewer:at["a"]},props:{tableSchema:{type:String,required:!1},tableName:{type:String,required:!1}},methods:{},computed:{allIndexEvaluations:function(){var e=this,t=Qn()(this.$store.state.genericIndexEvaluations),n=this.tableSchema?t.filter(function(t){return t.tableKey.split(".")[0]===e.tableSchema}):t,a=this.tableName?t.filter(function(t){return t.tableKey.split(".")[0]===e.tableSchema&&t.tableKey.split(".")[1]===e.tableName}):n;return a},fkIndexEvaluations:function(){var e=this,t=this.$store.state.fkIndexEvaluations,n=this.tableSchema?{singleColumn:Qn()(t.singleColumn).filter(function(t){var n=t[0]||{};return!e.tableSchema||n.tableSchema===e.tableSchema}),multiColumn:Qn()(t.multiColumn).filter(function(t){var n=t[0]||{};return!e.tableSchema||n.tableSchema===e.tableSchema})}:t,a=this.tableName?{singleColumn:Qn()(n.singleColumn).filter(function(t){var n=t[0]||{};return!e.tableName||n.tableName===e.tableName}),multiColumn:Qn()(n.multiColumn).filter(function(t){var n=t[0]||{};return!e.tableName||n.tableName===e.tableName})}:n;return a},uqIndexEvaluations:function(){var e=this,t=this.$store.state.uqIndexEvaluations,n=this.tableSchema?{singleColumn:Qn()(t.singleColumn).filter(function(t){var n=t[0]||{};return!e.tableSchema||n.tableSchema===e.tableSchema}),multiColumn:Qn()(t.multiColumn).filter(function(t){var n=t[0]||{};return!e.tableSchema||n.tableSchema===e.tableSchema})}:t,a=this.tableName?{singleColumn:Qn()(n.singleColumn).filter(function(t){var n=t[0]||{};return!e.tableName||n.tableName===e.tableName}),multiColumn:Qn()(n.multiColumn).filter(function(t){var n=t[0]||{};return!e.tableName||n.tableName===e.tableName})}:n;return a},hideCheckConstraints:function(){return null===this.tableName||void 0===this.tableName},checkConstraints:function(){var e=this;return this.tableSchema&&this.tableName?this.$store.state.managedSchemata.find(function(t){return t.schemaName===e.tableSchema}).schemaTables.find(function(t){return t.tableName===e.tableName}).checkConstraints:[]},createIndicesScript:function(){var e=this;return Qn()(this.$store.state.genericIndexEvaluations).reduce(function(t,n){return e.tableName&&e.tableName!==n.tableName?t:e.schemaName&&e.tableSchema!==n.tableSchema?t:n.desiredRealization.create?t.concat(n.desiredRealization.create):t},"")},dropIndicesScript:function(){var e=this;return Qn()(this.$store.state.genericIndexEvaluations).reduce(function(t,n){return e.tableName&&e.tableName!==n.tableName?t:e.schemaName&&e.tableSchema!==n.tableSchema?t:n.desiredRealization.drop?t.concat(n.desiredRealization.drop):t},"")}},data:function(){return{activeTab:0}}},Ta=Na,Sa=Object(y["a"])(Ta,Bn,Mn,!1,null,null,null),Ia=Sa.exports;x()(Sa,{VCard:Oe["a"],VTab:ct["a"],VTabItem:st["a"],VTabs:ut["a"]});var Da=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[n("v-tab",{key:"tableDefinition",attrs:{ripple:""}},[e._v("\n      Definition\n    ")]),n("v-tab-item",{key:"tableDefinition"},[n("v-card",{attrs:{flat:""}},[n("script-viewer",{attrs:{scriptText:e.tableDefinition,showReadability:!1}})],1)],1),n("v-tab",{key:"tableIndices",attrs:{ripple:""}},[e._v("\n      Indices\n    ")]),n("v-tab-item",{key:"tableIndices"},[n("v-card",{attrs:{flat:""}},[n("script-viewer",{attrs:{scriptText:e.tableIndicesRealization,showReadability:!1}})],1)],1),n("v-tab",{key:"tableSecurityPolicy",attrs:{ripple:""}},[e._v("\n      Security Policy Script\n    ")]),n("v-tab-item",{key:"tableSecurityPolicy"},[n("v-card",{attrs:{flat:""}},[n("table-policy-realization",{attrs:{policyDefinition:e.policyDefinition,table:e.tableInfo}})],1)],1)],1)],1)},Ea=[],Pa=n("96b5"),Oa={name:"TableScripts",components:{ScriptViewer:at["a"],TablePolicyRealization:Pa["a"]},props:{tableInfo:{type:Object,required:!0}},computed:{tableDefinition:function(){return"TABLE DEFINITION NOT IMPLMENTED YET"},tableIndicesRealization:function(){var e=this,t=Qn()(this.$store.state.genericIndexEvaluations).filter(function(t){return t.tableKey==="".concat(e.tableInfo.tableSchema,".").concat(e.tableInfo.tableName)}),n=t.reduce(function(e,t){return""!==t.desiredRealization.drop?[].concat(Object(Me["a"])(e),[t.desiredRealization.drop]):e},[]),a=t.reduce(function(e,t){return""!==t.desiredRealization.create?[].concat(Object(Me["a"])(e),[t.desiredRealization.create]):e},[]),i=n.length>0?"-- INDICES TO DROP\n\n".concat(n.join("")):"",o=a.length>0?"-- INDICES TO CREATE\n\n".concat(a.join("")):"",r=i.concat("\n\n").concat(o);return r},policyDefinition:function(){var e=this.$store.state.tablePolicyAssignments["".concat(this.tableInfo.tableSchema,".").concat(this.tableInfo.tableName)].policyDefinitionId;return this.$store.state.policies.find(function(t){return t.id===e})}},methods:{},data:function(){return{activeTab:null}}},ja=Oa,wa=Object(y["a"])(ja,Da,Ea,!1,null,null,null),Ra=wa.exports;x()(wa,{VCard:Oe["a"],VContainer:k["a"],VTab:ct["a"],VTabItem:st["a"],VTabs:ut["a"]});var Va={name:"Table",components:{TableDetail:Ue,TableColumns:Xe,TableConstraints:un,TableIndices:qt,TableGrants:vn,TableColumnGrants:_n,TablePolicies:Dn,TableTriggers:Un,TablePolicyDefinition:Ln["a"],ConstraintsAndIndices:Ia,TableScripts:Ra},props:{id:{type:String,required:!0}},computed:{tableInfo:function(){var e=this,t=this.$store.state.managedSchemata.find(function(t){return t.schemaName===e.tableSchema}),n=t.schemaTables.find(function(t){return t.tableName===e.tableName}),a=this.$store.state.tablePolicyAssignments[this.id].policyDefinitionId;return Object(_e["a"])({},n,{policyDefinitionId:a})},tableName:function(){return this.id.split(".")[1]},tableSchema:function(){return this.id.split(".")[0]},tableColumns:function(){return this.tableInfo.tableColumns||[]},indices:function(){return this.tableInfo.indices||[]},tableGrants:function(){return this.tableInfo.roleTableGrants||[]},tableColumnGrants:function(){return this.tableInfo.roleColumnGrants||[]},tablePolicies:function(){return this.tableInfo.policies||[]},tableTriggers:function(){return this.tableInfo.triggers||[]}},methods:{},data:function(){return{activeTab:null}},beforeRouteUpdate:function(e,t,n){n()}},Fa=Va,Aa=Object(y["a"])(Fa,xe,ke,!1,null,null,null),$a=Aa.exports;x()(Aa,{VCard:Oe["a"],VContainer:k["a"],VTab:ct["a"],VTabItem:st["a"],VTabs:ut["a"]});var qa=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",{attrs:{"ma-0":"","pa-0":""}},[n("h1",[e._v("Role Manager")]),n("h2",[e._v("Select roles to use with other tools")]),n("hr"),n("role-filter")],1)},Ga=[],Ua=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",e._l(e.roleFamilies,function(t){return n("div",{key:t.name},[n("applicable-family",{attrs:{applicableFamily:t,maxFamilySize:e.maxFamilySize}})],1)}),0)},La=[],Ba=n("bd86"),Ma=n("5176"),za=n.n(Ma),Qa=n("b6d0"),Ka=n.n(Qa),Wa=(n("2a83"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("h1",[e._v(e._s(e.applicableFamily.name))]),n("v-data-table",{staticClass:"text-sm-left",attrs:{headers:e.familyHeaders,items:e.applicableFamily.dataRows,"item-key":"roleName","show-select":"",dense:"","disable-pagination":"","disable-sort":"","hide-default-footer":"",value:e.selected},on:{input:e.itemSelected},scopedSlots:e._u([{key:"item.ignore",fn:function(e){var t=e.item;return[n("ignore-role",{attrs:{role:t}})]}}])})],1)}),Ha=[],Xa=(n("6c7b"),n("c5f6"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-checkbox",{attrs:{"input-value":e.isIgnored,disabled:e.disabled},on:{click:function(t){return e.toggleIgnoreRole()}}})}),Ya=[],Ja={name:"IgnoreRole",mixins:[],props:{role:{type:Object,required:!0}},computed:{disabled:function(){var e=this.$store.state.projectRoles.map(function(e){return e.roleName}),t=-1!==e.indexOf(this.role.roleName);return t},isIgnored:function(){var e=this.$store.state.ignoredRoles.map(function(e){return e.roleName}),t=-1!==e.indexOf(this.role.roleName);return t}},watch:{},data:function(){return{debounce:!1}},methods:{toggleIgnoreRole:function(){this.debounce?this.debounce=!1:(this.$store.commit("toggleIgnoreRole",{role:this.role}),this.debounce=!0)}},mounted:function(){}},Za=Ja,ei=n("ac7c"),ti=Object(y["a"])(Za,Xa,Ya,!1,null,null,null),ni=ti.exports;x()(ti,{VCheckbox:ei["a"]});var ai={name:"ApplicableFamily",mixins:[],components:{IgnoreRole:ni},props:{applicableFamily:{type:Object,required:!0},maxFamilySize:{type:Number,required:!0}},computed:{familyHeaders:function(){var e="".concat(100/(this.maxFamilySize+2),"%"),t=this.applicableFamily.allMemberNames.map(function(t){return{text:t,value:t,sortable:!1,width:e}}),n=new Array(this.maxFamilySize-this.applicableFamily.members.length).fill({text:"",width:e}),a=[{text:"select family",name:"roleName",value:"roleName",sortable:!1,width:e},{text:"ignore",value:"ignore",width:e},,].concat(Object(Me["a"])(t),Object(Me["a"])(n));return a},projectRoles:function(){return this.$store.state.projectRoles},selected:function(){var e=this;return this.projectRoles.filter(function(t){return-1!==e.applicableFamily.allMemberNames.indexOf(t.roleName)})}},watch:{},data:function(){return{debounce:!1}},methods:{itemSelected:function(e){var t=this,n=[].concat(Object(Me["a"])(this.projectRoles.filter(function(e){return-1===t.applicableFamily.allMemberNames.indexOf(e.roleName)})),Object(Me["a"])(e.map(function(e){return t.applicableFamily.members.find(function(t){return t.roleName===e.roleName})})));this.$store.commit("projectRoles",{projectRoles:n})}},mounted:function(){}},ii=ai,oi=Object(y["a"])(ii,Wa,Ha,!1,null,null,null),ri=oi.exports;x()(oi,{VContainer:k["a"],VDataTable:qe["a"]});var li="---",ci="+++",si={name:"RoleFilter",mixins:[],components:{ApplicableFamily:ri},computed:{maxFamilySize:function(){return this.roleFamilies.reduce(function(e,t){return t.members.length>e?t.members.length:e},0)},initializing:function(){return this.$store.state.initializing},enabledRoles:function(){return this.$store.state.enabledRoles},projectRoles:function(){return this.$store.state.projectRoles},applyDisabled:function(){var e=this;if(this.roles.length>0){var t=this.projectRoles.reduce(function(t,n){var a=e.roles.find(function(e){return e.roleName===n.roleName});return t?a.selected:t},!0),n=this.roles.filter(function(e){return e.selected});return t&&n.length===this.projectRoles.length}return!0},selectedRoleFamilies:function(){return this.$store.state.selectedRoleFamilies}},watch:{initializing:function(){this.computeItems()}},data:function(){return{roleFamilies:[],roles:[],checkedFamilies:[],checkedRoles:{}}},methods:{computeItems:function(){var e=this;this.roles.map(function(t){t.selected=void 0!==e.projectRoles.find(function(e){return e.name===t.name})});var t=this.roles.sort(function(e,t){return e.applicableRoles.length>=t.applicableRoles.length?-1:1}).reduce(function(t,n){var a=t.find(function(e){return new Ka.a(e.allMemberNames).has(n.roleName)});if(a)return t;var i=n.applicableRoles.map(function(e){return e.roleName}).concat([n.roleName]).sort(function(t,n){var a=e.roles.find(function(e){return e.roleName===t}).applicableRoles.length,i=e.roles.find(function(e){return e.roleName===n}).applicableRoles.length;return a>=i?-1:1});return t.concat([{name:n.roleName,selected:e.selectedRoleFamilies.find(function(e){return e.name===n.roleName}),allMemberNames:i}])},[]);this.roleFamilies=t.reduce(function(t,n){var a=n.allMemberNames.reduce(function(t,a){var i=e.roles.find(function(e){return e.roleName===a}),o=n.allMemberNames.reduce(function(e,t){var n=i.applicableRoles.find(function(e){return e.roleName===t});return void 0!==n?za()(e,Object(Ba["a"])({},t,ci)):i.roleName===t?za()(e,Object(Ba["a"])({},t,t)):za()(e,Object(Ba["a"])({},t,li))},{});return t.concat([za()({roleName:a},o)])},[]),i=e.roles.filter(function(e){return n.allMemberNames.indexOf(e.roleName)>-1});return t.concat([za()(n,{dataRows:a,members:i})])},[])},familyItems:function(e){return e.items}},mounted:function(){var e=this;this.roles=this.enabledRoles.map(function(t){e.projectRoles.find(function(e){return e.roleName===t.roleName});return Object(_e["a"])({},t,{selected:void 0!==e.projectRoles.find(function(e){return e.roleName===t.roleName})})}),this.computeItems()}},ui=si,di=Object(y["a"])(ui,Ua,La,!1,null,null,null),mi=di.exports;x()(di,{VContainer:k["a"]});var fi={name:"RoleManagerView",components:{RoleFilter:mi},props:{},computed:{},data:function(){return{}}},pi=fi,bi=Object(y["a"])(pi,qa,Ga,!1,null,null,null),vi=bi.exports;x()(bi,{VContainer:k["a"]});var hi=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",{attrs:{"ma-0":"","pa-0":""}},[n("h1",[e._v("Table Security Manager")]),n("h2",[e._v("A tool to ensure that all "),n("a",{attrs:{href:"https://learn.graphile.org/docs/PostgreSQL_Row_Level_Security_Infosheet.pdf",target:"_blank"}},[e._v("table grants and rls policies")]),e._v(" are properly configured to support postgraphile")]),n("hr"),n("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[n("v-tab",{key:"policy-manager",attrs:{ripple:""}},[e._v("\n      Policy Templates\n    ")]),n("v-tab-item",{key:"policy-manager",attrs:{lazy:""}},[n("v-card",[n("policy-manager")],1)],1),n("v-tab",{key:"policyAssignment",attrs:{ripple:""}},[e._v("\n      Policy Assignment\n    ")]),n("v-tab-item",{key:"policyAssignment",attrs:{lazy:""}},[n("v-card",[n("v-layout",{attrs:{row:"",wrap:""}},[n("v-flex",{attrs:{xs12:""}},[n("v-card",{key:"olicyAssignment"},[n("policy-assignment")],1)],1)],1)],1)],1),n("v-tab",{key:"policies",attrs:{ripple:""}},[e._v("\n      Schema Security Scripts\n    ")]),n("v-tab-item",{key:"policies",attrs:{lazy:""}},[n("v-card",[n("schema-security-scripts")],1)],1),n("v-tab",{key:"cheatsheet",attrs:{lazy:""}},[e._v("\n      Cheatsheet\n    ")]),n("v-tab-item",{key:"cheatsheet",attrs:{lazy:""}},[n("v-container",{attrs:{fluid:""}},[n("v-row",{attrs:{"no-gutters":""}},[n("pdf",{attrs:{src:"https://learn.graphile.org/docs/PostgreSQL_Row_Level_Security_Infosheet.pdf"}})],1)],1)],1)],1)],1)},yi=[],gi=(n("52b3"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-tabs",{attrs:{dark:"","slider-color":"yellow"}},[e._l(e.managedSchemata,function(t){return n("v-tab",{key:t.schemaName,attrs:{ripple:""}},[e._v("\n      "+e._s(t.schemaName)+"\n    ")])}),e._l(e.managedSchemata,function(e){return n("v-tab-item",{key:e.schemaName,attrs:{lazy:""}},[n("policy-assignment-schema",{attrs:{schema:e}})],1)})],2)],1)}),xi=[],ki=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-toolbar",[n("policy-assignment-dialog",{attrs:{currentPolicyDefinition:e.defaultPolicy,tables:e.selected,bulkAssign:!0,disabled:e.selected.length<1}})],1),n("v-data-table",{attrs:{headers:e.headers,items:e.tablesToShow,"item-key":"id",dense:"","disable-pagination":"","disable-sort":"","hide-default-footer":"","show-select":"","show-expand":""},scopedSlots:e._u([{key:"item.name",fn:function(t){var n=t.item;return[e._v("\n        "+e._s(n.tableName)+"\n      ")]}},{key:"item.assignedPolicy",fn:function(t){var a=t.item;return[n("policy-assignment-dialog",{attrs:{currentPolicyDefinition:a.policyDefinition,tables:[a]}}),e.showCustomizeButton(a)?n("table-policy-customize-dialog",{attrs:{currentPolicyDefinition:a.policyDefinition,tables:[a]}}):e._e()]}},{key:"expanded-item",fn:function(t){return[n("td",{attrs:{colspan:e.headers.length+2}},[n("policy-definition",{key:t.item.id,attrs:{policyId:t.item.policyDefinition.id,table:t.item}})],1)]}}]),model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}})],1)},_i=[],Ci=n("996c"),Ni=n.n(Ci),Ti=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-dialog",{attrs:{persistent:"",width:"800"},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[n("v-btn",e._g({staticClass:"text-none",attrs:{small:"",dark:"",disabled:e.disabled}},a),[e._v("\n        "+e._s(e.displayValue)+"\n      ")])]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[n("v-card",[n("v-card-title",{staticClass:"headline"},[e._v("Assign Policy")]),n("v-combobox",{attrs:{items:e.allPolicyDefinitions,"item-text":"name","item-value":"id"},model:{value:e.currentSelection,callback:function(t){e.currentSelection=t},expression:"currentSelection"}}),n("v-card-actions",[n("v-spacer"),n("v-btn",{on:{click:function(t){e.dialog=!1}}},[e._v("Cancel")]),n("v-btn",{attrs:{disabled:e.updateDisabled},on:{click:e.updateTablePolicyDefinition}},[e._v("Update")]),n("v-spacer")],1)],1)],1)],1)},Si=[],Ii={name:"PolicyAssignmentDialog",props:{currentPolicyDefinition:{type:Object,required:!0},tables:{type:Array,required:!0},bulkAssign:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},mounted:function(){this.currentSelection=this.currentPolicyDefinition},data:function(){return{dialog:!1,currentSelection:null}},computed:{displayValue:function(){return this.bulkAssign?"Bulk Assign":this.currentPolicyDefinition?this.currentPolicyDefinition.name:"n/a"},allPolicyDefinitions:function(){return this.$store.state.policies.filter(function(e){return!e.customIdentifier})},updateDisabled:function(){return!this.bulkAssign&&(!this.currentPolicyDefinition||!this.currentSelection||this.currentPolicyDefinition.id===this.currentSelection.id)}},watch:{},methods:{updateTablePolicyDefinition:function(){this.dialog=!1;var e=this.tables.reduce(function(e,t){return e.concat([t.id])},[]);this.$store.commit("assignTablePolicy",{tableIds:e,policyDefinitionId:this.currentSelection.id})}}},Di=Ii,Ei=(n("35d9"),n("99d9")),Pi=n("2b5d"),Oi=n("169a"),ji=Object(y["a"])(Di,Ti,Si,!1,null,null,null),wi=ji.exports;x()(ji,{VBtn:P["a"],VCard:Oe["a"],VCardActions:Ei["a"],VCardTitle:Ei["b"],VCombobox:Pi["a"],VDialog:Oi["a"],VSpacer:W["a"]});var Ri=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-data-table",{attrs:{items:e.items,"hide-default-footer":!0,"hide-headers":!1,headers:e.headers},scopedSlots:e._u([{key:"items",fn:function(t){return[n("td",{attrs:{align:"right"}},[n("v-icon",{attrs:{color:t.item.expectedColor}},[e._v("fiber_manual_record")])],1),n("td",{attrs:{align:"left"}},[e._v(e._s(t.item.expectedCount))]),n("td",{attrs:{align:"right"}},[n("v-icon",{attrs:{color:t.item.extraColor}},[e._v("fiber_manual_record")])],1),n("td",{attrs:{align:"left"}},[e._v(e._s(t.item.extraCount))]),n("td",{attrs:{align:"right"}},[n("v-icon",{attrs:{color:t.item.missingColor}},[e._v("fiber_manual_record")])],1),n("td",{attrs:{align:"left"}},[e._v(e._s(t.item.missingCount))]),n("td",{attrs:{align:"right"}},[n("v-icon",{attrs:{color:t.item.unexpectedColor}},[e._v("fiber_manual_record")])],1),n("td",{attrs:{align:"left"}},[e._v(e._s(t.item.unexpectedCount))])]}}])})},Vi=[],Fi=n("e002"),Ai={name:"TablePolicyEvaluatorSummary",mixins:[Fi["a"]],props:{},mounted:function(){},data:function(){return{headers:[{text:"",sortable:!1},{text:"expected",sortable:!1},{text:"",sortable:!1},{text:"extra",sortable:!1},{text:"",sortable:!1},{text:"missing",sortable:!1},{text:"",sortable:!1},{text:"unexpected",sortable:!1}]}},computed:{items:function(){var e=this.tablePolicyEvaluation||{expected:[],missing:[],unexpected:[],extra:[]};return[{expectedCount:e.expected.length,expectedColor:e.expected.length>0?this.grantStatusColors.expected:"grey",missingCount:e.missing.length,missingColor:e.missing.length>0?this.grantStatusColors.missing:"grey",unexpectedCount:e.unexpected.length,unexpectedColor:e.unexpected.length>0?this.grantStatusColors.unexpected:"grey",extraCount:e.extra.length,extraColor:e.extra.length>0?this.grantStatusColors.extra:"grey"}]}},watch:{},methods:{}},$i=Ai,qi=(n("9849"),Object(y["a"])($i,Ri,Vi,!1,null,null,null)),Gi=qi.exports;x()(qi,{VDataTable:qe["a"],VIcon:Q["a"]});var Ui=n("bd5a"),Li={name:"PolicyAssignment",components:{PolicyDefinition:Ln["a"],PolicyAssignmentDialog:wi,TablePolicyEvaluatorSummary:Gi,TablePolicyCustomizeDialog:Ui["a"],MugenScroll:Ni.a},props:{schema:{type:Object,required:!0}},methods:{showCustomizeButton:function(e){return!!e&&(!e.policyDefinition||!e.policyDefinition.customIdentifier)}},watch:{},computed:{tablesToShow:function(){var e=this;return this.schema.schemaTables.map(function(t){var n=e.$store.state.tablePolicyAssignments[t.id].policyDefinitionId,a=e.policies.find(function(e){return e.id===n});return Object(_e["a"])({},t,{policyDefinition:a,policyDefinitionId:n})})},defaultPolicy:function(){return this.$store.state.defaultPolicy},policies:function(){return this.$store.state.policies}},data:function(){return{loading:!1,selected:[],headers:[{text:"",sortable:!1},{text:"Table Name",sortable:!1,value:"name"},{text:"Assigned Policy",sortable:!1,value:"assignedPolicy"}]}}},Bi=Li,Mi=(n("cb8a"),Object(y["a"])(Bi,ki,_i,!1,null,null,null)),zi=Mi.exports;x()(Mi,{VDataTable:qe["a"],VToolbar:O["a"]});var Qi={name:"PolicyAssignment",components:{PolicyAssignmentSchema:zi},methods:{},watch:{},computed:{policies:function(){return this.$store.state.policies},managedSchemata:function(){var e=this;return this.$store.state.managedSchemata.filter(function(e){return e.schemaTables.length>0}).map(function(t){return Object(_e["a"])({},t,{schemaTables:t.schemaTables.map(function(t){var n=e.policies.find(function(e){return e.id===t.policyDefinitionId});return Object(_e["a"])({},t,{policyDefinition:n})}).sort(function(e,t){return e.name<t.name?-1:1})})}).sort(function(e,t){return e.schemaName<t.schemaName?-1:1})}},data:function(){return{mappedSchemata:[]}}},Ki=Qi,Wi=Object(y["a"])(Ki,gi,xi,!1,null,null,null),Hi=Wi.exports;x()(Wi,{VTab:ct["a"],VTabItem:st["a"],VTabs:ut["a"]});var Xi=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("default-rls-using")],1)},Yi=[],Ji=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("v-toolbar",[n("v-btn",{attrs:{disabled:e.disabled},on:{click:e.save}},[e._v("Save")]),n("h2",[e._v("Default RLS Using Clause")])],1),n("v-textarea",{attrs:{"auto-grow":"","hide-details":"","background-color":"black"},model:{value:e.defaultRlsUsing,callback:function(t){e.defaultRlsUsing=t},expression:"defaultRlsUsing"}}),n("hr")],1)},Zi=[],eo={name:"DefaultRlsUsingClause",computed:{defaultDefaultRlsUsing:function(){return this.$store.state.defaultRlsUsing},disabled:function(){return this.defaultRlsUsing===this.defaultDefaultRlsUsing}},methods:{save:function(){this.$store.commit("updateDefaultRlsUsing",{defaultRlsUsing:this.defaultRlsUsing})},load:function(){this.defaultRlsUsing=this.defaultDefaultRlsUsing}},data:function(){return{defaultRlsUsing:null}},mounted:function(){this.load()}},to=eo,no=Object(y["a"])(to,Ji,Zi,!1,null,null,null),ao=no.exports;x()(no,{VBtn:P["a"],VContainer:k["a"],VTextarea:fe["a"],VToolbar:O["a"]});var io={name:"SecurityPolicySettings",components:{DefaultRlsUsing:ao},computed:{},methods:{},data:function(){return{}}},oo=io,ro=Object(y["a"])(oo,Xi,Yi,!1,null,null,null),lo=ro.exports;x()(ro,{VContainer:k["a"]});var co=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("v-tabs",{attrs:{dark:"","slider-color":"yellow"}},[e._l(e.allPolicies,function(t){return n("v-tab",{key:t.name,attrs:{ripple:""}},[e._v("\n      "+e._s(t.name)+"\n    ")])}),e._l(e.allPolicies,function(t){return n("v-tab-item",{key:t.name,attrs:{lazy:""}},[n("script-viewer",{attrs:{scriptText:t.policy,skipFormat:""},on:{"readability-changed":e.policyReadabilityChanged}})],1)})],2)],1)},so=[],uo=n("ee5d"),mo=n("2f62"),fo={name:"SchemaSecurityScripts",mixins:[uo["a"]],components:{ScriptViewer:at["a"]},props:{},computed:Object(_e["a"])({},Object(mo["b"])(["policies","managedSchemata"])),watch:{policyReadability:function(){this.calculateAllPolicies()}},methods:{policyReadabilityChanged:function(e){this.policyReadability=e},handleCopyStatus:function(e){alert(e)},refresh:function(e){this.calculateAllPolicies()},expand:function(e){e.policy="".concat(e.policy," ")},calcOnePolicy:function(e){var t=this;return e.sort(function(e,t){return e.tablename<t.tablename?-1:1}).reduce(function(e,n){var a=t.policies.find(function(e){return e.id===t.$store.state.tablePolicyAssignments[n.id].policyDefinitionId}),i={schemaName:n.tableSchema,tableName:n.tablename},o=t.computePolicy(a,t.policyReadability,i,n);return e.concat(o)},"")},calculateAllPolicies:function(){var e=this,t="One Script To Rule Them All",n=this.managedSchemata.filter(function(e){return!e.parked}).reduce(function(t,n){var a=n.schemaTables,i={name:"".concat(n.schemaName),policy:e.calcOnePolicy(a)};return t.concat([i])},[]).sort(function(e,t){return e.name<t.name?-1:1}),a=n.reduce(function(e,t){return e.concat(t.policy)},"");this.allPolicies=[].concat(Object(Me["a"])(n),[{name:t,policy:a}])},policyText:function(e){return e.policy},onCopy:function(){alert("Copied!")},onError:function(e){alert("Failed to copy scripts to clipboard"),console.error(e)},executeSql:function(){alert("not implemented:  server config value will expose graphile extension to execute generated script")}},data:function(){return{allPolicies:[],schemaPolicy:"NOT CALCULATED",defaultRlsPolicies:"NOT CALCULATED",defaultNoRlsPolicies:"NOT CALCULATED",selectedTabName:"",policyReadability:"terse"}},mounted:function(){this.calculateAllPolicies()}},po=fo,bo=Object(y["a"])(po,co,so,!1,null,null,null),vo=bo.exports;x()(bo,{VContainer:k["a"],VTab:ct["a"],VTabItem:st["a"],VTabs:ut["a"]});var ho=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-toolbar",[n("v-dialog",{attrs:{persistent:"","max-width":"290"},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[n("v-btn",e._g({attrs:{color:"primary",dark:""}},a),[e._v("New Policy Template")])]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[n("v-card",[n("v-card-title",{staticClass:"headline"},[e._v("New Policy")]),n("v-text-field",{attrs:{label:"Name"},model:{value:e.newPolicyName,callback:function(t){e.newPolicyName=t},expression:"newPolicyName"}}),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"green darken-1",flat:""},on:{click:e.saveNewPolicy}},[e._v("Save")]),n("v-btn",{attrs:{color:"green darken-1",flat:""},on:{click:function(t){e.dialog=!1}}},[e._v("Cancel")])],1)],1)],1)],1),n("v-data-table",{attrs:{headers:e.headers,items:e.policies,"item-key":"id",dense:"","disable-pagination":"","disable-sort":"","hide-default-footer":"","show-expand":""},scopedSlots:e._u([{key:"expanded-item",fn:function(t){return[n("td",{attrs:{colspan:e.headers.length+1}},[n("policy-definition",{key:t.item.id,attrs:{policyId:t.item.id}})],1)]}}])})],1)},yo=[],go=n("95fb"),xo=go["a"],ko=n("8654"),_o=Object(y["a"])(xo,ho,yo,!1,null,null,null),Co=_o.exports;x()(_o,{VBtn:P["a"],VCard:Oe["a"],VCardActions:Ei["a"],VCardTitle:Ei["b"],VDataTable:qe["a"],VDialog:Oi["a"],VSpacer:W["a"],VTextField:ko["a"],VToolbar:O["a"]});var No=n("858e"),To={name:"TableSecurityView",components:{SecurityPolicySettings:lo,SchemaSecurityScripts:vo,PolicyManager:Co,PolicyAssignment:Hi,pdf:No["a"]},props:{},computed:{},data:function(){return{activeTab:null}}},So=To,Io=n("0e8f"),Do=n("a722"),Eo=Object(y["a"])(So,hi,yi,!1,null,null,null),Po=Eo.exports;x()(Eo,{VCard:Oe["a"],VContainer:k["a"],VFlex:Io["a"],VLayout:Do["a"],VRow:we["a"],VTab:ct["a"],VTabItem:st["a"],VTabs:ut["a"]});var Oo=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",{attrs:{"ma-0":"","pa-0":""}},[n("h1",[e._v("Function Security Manager")]),n("h2",[e._v("A tool to ensure that all "),n("a",{attrs:{href:"https://learn.graphile.org/docs/PostgreSQL_Row_Level_Security_Infosheet.pdf",target:"_blank"}},[e._v("function grants")]),e._v(" are properly configured to support postgraphile")]),n("hr"),n("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[n("v-tab",{key:"policy-manager",attrs:{ripple:""}},[e._v("\n      Policy Templates\n    ")]),n("v-tab-item",{key:"policy-manager",attrs:{lazy:""}},[n("v-card",[n("policy-manager")],1)],1),n("v-tab",{key:"policyAssignment",attrs:{ripple:""}},[e._v("\n      Policy Assignment\n    ")]),n("v-tab-item",{key:"policyAssignment",attrs:{lazy:""}},[n("v-card",[n("v-layout",{attrs:{row:"",wrap:""}},[n("v-flex",{attrs:{xs12:""}},[n("v-card",{key:"policyAssignment"},[n("policy-assignment")],1)],1)],1)],1)],1),n("v-tab",{key:"policies",attrs:{ripple:""}},[e._v("\n      Schema Security Scripts\n    ")]),n("v-tab-item",{key:"policies",attrs:{lazy:""}},[n("v-card",[n("schema-security-scripts")],1)],1)],1)],1)},jo=[],wo=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-toolbar",[n("v-dialog",{attrs:{persistent:"","max-width":"290"},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[n("v-btn",e._g({attrs:{color:"primary",dark:""}},a),[e._v("New Policy Template")])]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[n("v-card",[n("v-card-title",{staticClass:"headline"},[e._v("New Policy")]),n("v-text-field",{attrs:{label:"Name"},model:{value:e.newPolicyName,callback:function(t){e.newPolicyName=t},expression:"newPolicyName"}}),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"green darken-1",text:""},on:{click:e.saveNewPolicy}},[e._v("Save")]),n("v-btn",{attrs:{color:"green darken-1",text:""},on:{click:function(t){e.dialog=!1}}},[e._v("Cancel")])],1)],1)],1)],1),n("v-data-table",{attrs:{headers:e.headers,items:e.policies,"item-key":"id",dense:"","disable-pagination":"","disable-sort":"","hide-default-footer":"","show-expand":""},scopedSlots:e._u([{key:"expanded-item",fn:function(t){return[n("td",{attrs:{colspan:e.headers.length+1}},[n("policy-definition",{key:t.item.id,attrs:{policyId:t.item.id}})],1)]}}])})],1)},Ro=[],Vo=n("567d"),Fo=Vo["a"],Ao=Object(y["a"])(Fo,wo,Ro,!1,null,null,null),$o=Ao.exports;x()(Ao,{VBtn:P["a"],VCard:Oe["a"],VCardActions:Ei["a"],VCardTitle:Ei["b"],VDataTable:qe["a"],VDialog:Oi["a"],VSpacer:W["a"],VTextField:ko["a"],VToolbar:O["a"]});var qo=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-tabs",{attrs:{dark:"","slider-color":"yellow"}},[e._l(e.managedSchemata,function(t){return n("v-tab",{key:t.schemaName,attrs:{ripple:""}},[e._v("\n      "+e._s(t.schemaName)+"\n    ")])}),e._l(e.managedSchemata,function(e){return n("v-tab-item",{key:e.schemaName},[n("function-policy-assignment-schema",{attrs:{schema:e}})],1)})],2)],1)},Go=[],Uo=n("82cd"),Lo=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-dialog",{attrs:{persistent:"",width:"800"},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[n("v-btn",e._g({staticClass:"text-none",attrs:{dark:"",disabled:e.disabled}},a),[e._v("\n        "+e._s(e.displayValue)+"\n      ")])]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[n("v-card",[n("v-card-title",{staticClass:"headline"},[e._v("Assign Policy")]),n("v-combobox",{attrs:{items:e.allPolicyDefinitions,"item-text":"name","item-value":"id"},model:{value:e.currentSelection,callback:function(t){e.currentSelection=t},expression:"currentSelection"}}),n("v-card-actions",[n("v-spacer"),n("v-btn",{on:{click:function(t){e.dialog=!1}}},[e._v("Cancel")]),n("v-btn",{attrs:{disabled:e.updateDisabled},on:{click:e.updateTablePolicyDefinition}},[e._v("Update")]),n("v-spacer")],1)],1)],1)],1)},Bo=[],Mo={name:"FunctionAssignmentDialog",props:{currentPolicyDefinition:{type:Object,required:!0},functions:{type:Array,required:!0},bulkAssign:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},mounted:function(){this.currentSelection=this.currentPolicyDefinition},data:function(){return{dialog:!1,currentSelection:null}},computed:{displayValue:function(){return this.bulkAssign?"Bulk Assign":this.currentPolicyDefinition?this.currentPolicyDefinition.name:"n/a"},allPolicyDefinitions:function(){return this.$store.state.functionPolicies},updateDisabled:function(){return!this.bulkAssign&&(!this.currentPolicyDefinition||!this.currentSelection||this.currentPolicyDefinition.id===this.currentSelection.id)}},watch:{},methods:{updateTablePolicyDefinition:function(){this.dialog=!1;var e=this.functions.reduce(function(e,t){return e.concat([t.id])},[]);this.$store.commit("assignFunctionPolicy",{functionIds:e,policyDefinitionId:this.currentSelection.id})}}},zo=Mo,Qo=(n("a789"),Object(y["a"])(zo,Lo,Bo,!1,null,null,null)),Ko=Qo.exports;x()(Qo,{VBtn:P["a"],VCard:Oe["a"],VCardActions:Ei["a"],VCardTitle:Ei["b"],VCombobox:Pi["a"],VDialog:Oi["a"],VSpacer:W["a"]});var Wo=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-toolbar",[n("policy-assignment-dialog",{attrs:{currentPolicyDefinition:e.defaultPolicy,functions:e.selected,bulkAssign:!0,disabled:0===e.selected.length}})],1),n("v-data-table",{attrs:{headers:e.headers,items:e.functionsToShow,"item-key":"id",dense:"","disable-pagination":"","disable-sort":"","hide-default-footer":"","show-select":"","show-expand":""},scopedSlots:e._u([{key:"item.name",fn:function(t){var n=t.item;return[e._v("\n        "+e._s(n.functionName)+"\n      ")]}},{key:"item.assignedPolicy",fn:function(e){var t=e.item;return[n("policy-assignment-dialog",{attrs:{currentPolicyDefinition:t.policyDefinition,functions:[t]}})]}},{key:"expanded-item",fn:function(t){return[n("td",{attrs:{colspan:e.headers.length+2}},[n("policy-definition",{attrs:{policyId:t.item.policyDefinition.id,aFunction:t.item}})],1)]}}]),model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}})],1)},Ho=[],Xo={name:"FunctionAssignment",components:{PolicyDefinition:Uo["a"],PolicyAssignmentDialog:Ko},props:{schema:{type:Object,required:!0}},methods:{},watch:{},computed:{functionsToShow:function(){var e=this;return this.schema.schemaFunctions.map(function(t){var n=e.$store.state.functionPolicyAssignments[t.id].policyDefinitionId,a=e.$store.state.functionPolicies.find(function(e){return e.id===n});return Object(_e["a"])({},t,{policyDefinition:a,policyDefinitionId:n})})},selectAllValue:function(){return this.schema.schemaFunctions.length===this.selected.length},defaultPolicy:function(){return this.$store.state.defaultFunctionPolicy}},data:function(){return{selected:[],headers:[{text:"",sortable:!1},{text:"",sortable:!1},{text:"Function Name",sortable:!1,value:"functionName"},{text:"Policy Name",sortable:!1,value:"assignedPolicy"}]}}},Yo=Xo,Jo=Object(y["a"])(Yo,Wo,Ho,!1,null,null,null),Zo=Jo.exports;x()(Jo,{VDataTable:qe["a"],VToolbar:O["a"]});var er={name:"FunctionAssignment",components:{PolicyDefinition:Uo["a"],PolicyAssignmentDialog:Ko,FunctionPolicyAssignmentSchema:Zo},methods:{},watch:{},computed:{functionPolicies:function(){return this.$store.state.functionPolicies},managedSchemata:function(){var e=this;return this.$store.state.managedSchemata.map(function(t){return Object(_e["a"])({},t,{schemaFunctions:t.schemaFunctions.map(function(t){var n=e.functionPolicies.find(function(e){return e.id===t.functionPolicyDefinitionId});return Object(_e["a"])({},t,{policyDefinition:n})}).sort(function(e,t){return e.functionname<t.functionname?-1:1})})}).sort(function(e,t){return e.schemaName<t.schemaName?-1:1})}},data:function(){return{mappedSchemata:[],headers:[{text:"",sortable:!1},{text:"Function Name",sortable:!1},{text:"Policy Name",sortable:!1}]}}},tr=er,nr=Object(y["a"])(tr,qo,Go,!1,null,null,null),ar=nr.exports;x()(nr,{VTab:ct["a"],VTabItem:st["a"],VTabs:ut["a"]});var ir=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("v-tabs",{attrs:{dark:"","slider-color":"yellow"}},[e._l(e.allPolicies,function(t){return n("v-tab",{key:t.name,attrs:{ripple:""}},[e._v("\n      "+e._s(t.name)+"\n    ")])}),e._l(e.allPolicies,function(t){return n("v-tab-item",{key:t.name},[n("script-viewer",{attrs:{scriptText:t.policy,skipFormat:""},on:{"readability-changed":e.readabilityChanged}})],1)})],2)],1)},or=[],rr=n("77d3"),lr={name:"SchemaSecurityScripts",mixins:[rr["a"]],components:{ScriptViewer:at["a"]},props:{},computed:Object(_e["a"])({},Object(mo["b"])(["functionPolicies","managedSchemata"])),watch:{functionPolicies:function(){this.calculateAllPolicies()},policyReadability:function(){this.calculateAllPolicies()}},methods:{readabilityChanged:function(e){this.policyReadability=e},refresh:function(){this.doComputePolicy()},expand:function(){this.computedPolicy="".concat(this.computedPolicy," ")},calcOnePolicy:function(e){var t=this,n=e.sort(function(e,t){return e.functionname<t.functionname?-1:1}).reduce(function(e,n){var a=t.functionPolicies.find(function(e){return e.id===t.$store.state.functionPolicyAssignments[n.id].policyDefinitionId}),i={},o=t.computePolicy(a,t.policyReadability,i,n);return e.concat(o)},"");return n},calculateAllPolicies:function(){var e=this,t="One Script To Rule Them All",n=this.managedSchemata.filter(function(e){return!e.parked}).reduce(function(t,n){var a=n.schemaFunctions,i={name:"".concat(n.schemaName),policy:e.calcOnePolicy(a)};return t.concat([i])},[]).sort(function(e,t){return e.name<t.name?-1:1}),a=n.reduce(function(e,t){return e.concat(t.policy)},"");this.allPolicies=[].concat(Object(Me["a"])(n),[{name:t,policy:a}])},policyText:function(e){return e.policy},onCopy:function(){alert("Copied!")},onError:function(e){alert("Failed to copy scripts to clipboard"),console.error(e)},executeSql:function(){alert("not implemented:  server config value will expose graphile extension to execute generated script")}},data:function(){return{allPolicies:[],schemaPolicy:"NOT CALCULATED",defaultRlsPolicies:"NOT CALCULATED",defaultNoRlsPolicies:"NOT CALCULATED",selectedTabName:"",policyReadability:"terse"}},mounted:function(){this.calculateAllPolicies()}},cr=lr,sr=Object(y["a"])(cr,ir,or,!1,null,null,null),ur=sr.exports;x()(sr,{VContainer:k["a"],VTab:ct["a"],VTabItem:st["a"],VTabs:ut["a"]});var dr={name:"FunctionSecurityView",components:{SchemaSecurityScripts:ur,PolicyManager:$o,PolicyAssignment:ar},props:{},computed:{},data:function(){return{activeTab:null}}},mr=dr,fr=Object(y["a"])(mr,Oo,jo,!1,null,null,null),pr=fr.exports;x()(fr,{VCard:Oe["a"],VContainer:k["a"],VFlex:Io["a"],VLayout:Do["a"],VTab:ct["a"],VTabItem:st["a"],VTabs:ut["a"]});var br=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",{attrs:{"ma-0":"","pa-0":""}},[n("h2",[e._v("Enter a search term to find functions of interest")]),n("v-text-field",{attrs:{label:"Search Term"},model:{value:e.searchTerm,callback:function(t){e.searchTerm=t},expression:"searchTerm"}}),n("hr"),n("function-list",{attrs:{functions:e.functions}})],1)},vr=[],hr=(n("ab3b"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-data-table",{attrs:{headers:e.headers,items:e.functions,"item-key":"id",dense:"","disable-pagination":"","disable-sort":"","hide-default-footer":"","show-expand":""},scopedSlots:e._u([{key:"item.blankLink",fn:function(t){var a=t.item;return[n("router-link",{attrs:{to:{name:"function",params:{id:a.id}},target:"_blank"}},[n("v-icon",[e._v("launch")])],1)]}},{key:"expanded-item",fn:function(t){return[n("td",{attrs:{colspan:e.headers.length+1}},[n("function",{attrs:{id:t.item.id}})],1)]}}])})}),yr=[],gr={name:"FunctionList",components:{Function:wn["a"]},props:{functions:{type:Array,required:!0}},computed:{},data:function(){return{headers:[{text:"",sortable:!1},{text:"schema",sortable:!1,value:"functionSchema"},{text:"function",sortable:!1,value:"functionName"},{text:"",sortable:!1,value:"blankLink"}]}},methods:{}},xr=gr,kr=Object(y["a"])(xr,hr,yr,!1,null,null,null),_r=kr.exports;x()(kr,{VDataTable:qe["a"],VIcon:Q["a"]});var Cr={name:"SearchView",components:{FunctionList:_r},props:{},computed:{disabled:function(){return void 0===this.searchTerm||null===this.searchTerm||""===this.searchTerm},allFunctions:function(){return this.$store.state.managedSchemata.reduce(function(e,t){return[].concat(Object(Me["a"])(e),Object(Me["a"])(t.schemaFunctions))},[])},functions:function(){var e=this;return console.log(this.allFunctions),this.allFunctions.filter(function(t){return-1!==t.functionSchema.toLowerCase().indexOf(e.searchTerm.toLowerCase())||-1!==t.functionName.toLowerCase().indexOf(e.searchTerm.toLowerCase())||-1!==t.definition.toLowerCase().indexOf(e.searchTerm.toLowerCase())})}},watch:{},data:function(){return{searchTerm:""}},methods:{}},Nr=Cr,Tr=Object(y["a"])(Nr,br,vr,!1,null,null,null),Sr=Tr.exports;x()(Tr,{VContainer:k["a"],VTextField:ko["a"]});var Ir=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("h1",[e._v("Settings")]),n("h2",{staticStyle:{color:"red"}},[e._v("Under Construction")]),n("hr"),n("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[n("v-tab",{key:"table-policy-template",attrs:{ripple:""}},[e._v("\n      Table Policy Template\n    ")]),n("v-tab-item",{key:"table-policy-template"},[n("security-policy-settings")],1)],1)],1)},Dr=[],Er={name:"Settings",components:{SecurityPolicySettings:lo},props:{},computed:{},data:function(){return{activeTab:null}}},Pr=Er,Or=Object(y["a"])(Pr,Ir,Dr,!1,null,null,null),jr=Or.exports;x()(Or,{VContainer:k["a"],VTab:ct["a"],VTabItem:st["a"],VTabs:ut["a"]});var wr=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",{attrs:{"ma-0":"","pa-0":""}},[n("constraints-and-indices-manager")],1)},Rr=[],Vr=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-card",[n("v-container",{attrs:{"bkeepground-color":"blkeep"}},[n("v-tabs",{attrs:{dark:"","slider-color":"yellow"}},[e._l(e.managedSchemata,function(t){return n("v-tab",{key:t.schemaName,attrs:{ripple:""}},[e._v("\n        "+e._s(t.schemaName)+"\n      ")])}),e._l(e.managedSchemata,function(e){return n("v-tab-item",{key:e.schemaName},[n("constraints-and-indices",{attrs:{tableSchema:e.schemaName}})],1)}),n("v-tab",{key:"allSchemata",attrs:{ripple:""}},[e._v("\n        All Schemata\n      ")]),n("v-tab-item",{key:"allSchemata"},[n("constraints-and-indices")],1)],2)],1)],1)},Fr=[],Ar="AS_EXPECTED",$r="NO_INDEX",qr="UNEXPECTED_NAME",Gr="EXTRA_INDEX",Ur="green",Lr="yellow",Br="blue",Mr="red",zr={name:"ConstraintsAndIndicesManager",components:{ConstraintsAndIndices:Ia},methods:{columnIndexStatusColor:function(e){switch(e){case Ar:return Ur;case $r:return Lr;case qr:return Br;case Gr:break}}},watch:{},computed:{policies:function(){return this.$store.state.policies},managedSchemata:function(){return this.$store.state.managedSchemata.sort(function(e,t){return e.schemaName<t.schemaName?-1:1})},headers:function(){return[{text:"",sortable:!1},{text:"Table Name",sortable:!1}].concat(Object(Me["a"])(this.statusMap.map(function(e){return{text:e.name,sortable:!1}})))}},data:function(){return{mappedSchemata:[],statusMap:[{name:Ar,columnIndexStatusColor:Ur,defaultActions:{}},{name:$r,columnIndexStatusColor:Lr,defaultActions:{ack:!1,create:!1}},{name:qr,columnIndexStatusColor:Br,defaultActions:{ack:!1,rename:!0}},{name:Gr,columnIndexStatusColor:Mr,defaultActions:{ack:!1,drop:!1}}]}}},Qr=zr,Kr=Object(y["a"])(Qr,Vr,Fr,!1,null,null,null),Wr=Kr.exports;x()(Kr,{VCard:Oe["a"],VContainer:k["a"],VTab:ct["a"],VTabItem:st["a"],VTabs:ut["a"]});var Hr={name:"ForeignKeyIndexView",components:{ConstraintsAndIndicesManager:Wr},props:{},computed:{},data:function(){return{activeTab:null}}},Xr=Hr,Yr=Object(y["a"])(Xr,wr,Rr,!1,null,null,null),Jr=Yr.exports;x()(Yr,{VContainer:k["a"]});var Zr=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},el=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("h1",[e._v("A tool to ensure that all "),n("a",{attrs:{href:"https://www.graphile.org/postgraphile/smart-comments/",target:"_blank"}},[e._v("smart comments")]),e._v(" are properly configured to support postgraphile")])])}],tl={name:"SmartCommentManager"},nl=tl,al=Object(y["a"])(nl,Zr,el,!1,null,null,null),il=al.exports,ol=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("h1",[e._v("Export Project")]),n("v-toolbar",[n("v-btn",{on:{click:e.exportProject}},[e._v("Save")])],1),n("v-textarea",{attrs:{value:e.projectJson,"auto-grow":"",readonly:""}})],1)},rl=[],ll={name:"ExportProject",components:{},props:{},computed:{projectName:function(){return this.project?this.project.name:"N/A"},projectJson:function(){return ue()(this.$store.state,0,2)}},methods:{exportProject:function(){var e=this.projectJson,t=new Blob([e],{type:"text/plain"}),n=document.createEvent("MouseEvents"),a=document.createElement("a");a.download="pgdbi.json",a.href=window.URL.createObjectURL(t),a.dataset.downloadurl=["text/json",a.download,a.href].join(":"),n.initEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),a.dispatchEvent(n)}}},cl=ll,sl=Object(y["a"])(cl,ol,rl,!1,null,null,null),ul=sl.exports;x()(sl,{VBtn:P["a"],VTextarea:fe["a"],VToolbar:O["a"]});var dl=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},ml=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("h1",[e._v("Sqitch")])])}],fl={},pl=Object(y["a"])(fl,dl,ml,!1,null,null,null),bl=pl.exports,vl=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},hl=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("h1",[e._v("Graphile Worker")])])}],yl={},gl=Object(y["a"])(yl,vl,hl,!1,null,null,null),xl=gl.exports,kl=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("h1",[e._v(e._s(e.id))]),n("hr"),n("script-viewer",{attrs:{scriptText:e.definition,showDeclarationVisibility:!1,showReadability:!1,skipFormat:""}})],1)},_l=[],Cl={name:"Enum",components:{ScriptViewer:at["a"]},props:{id:{type:String,required:!0}},computed:{definition:function(){return this.ENUM.enumDefinition}},data:function(){return{ENUM:{enumDefinition:"N/A"}}},methods:{onCopy:function(e){alert("Copied!")},onError:function(e){alert("Failed to copy texts")},setEnum:function(){var e=this,t=this.id.split(".")[0],n=this.$store.state.managedSchemata.find(function(e){return e.schemaName===t});this.ENUM=n.schemaEnums.find(function(t){return t.id===e.id})}},mounted:function(){this.setEnum()},beforeRouteUpdate:function(e,t,n){this.setEnum(),n()}},Nl=Cl,Tl=Object(y["a"])(Nl,kl,_l,!1,null,null,null),Sl=Tl.exports;x()(Tl,{VContainer:k["a"]});var Il=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("h1",[e._v(e._s(e.id))]),n("hr"),n("script-viewer",{attrs:{scriptText:e.definition,showDeclarationVisibility:!1,showReadability:!1,skipFormat:""}})],1)},Dl=[],El={name:"Udt",components:{ScriptViewer:at["a"]},props:{id:{type:String,required:!0}},computed:{definition:function(){return this.UDT.udtDefinition}},data:function(){return{UDT:{udtDefinition:"N/A"}}},methods:{onCopy:function(e){alert("Copied!")},onError:function(e){alert("Failed to copy texts")},setUdt:function(){var e=this,t=this.id.split(".")[0],n=this.$store.state.managedSchemata.find(function(e){return e.schemaName===t});this.UDT=n.schemaUdts.find(function(t){return t.id===e.id})}},mounted:function(){this.setUdt()},beforeRouteUpdate:function(e,t,n){this.setUdt(),n()}},Pl=El,Ol=Object(y["a"])(Pl,Il,Dl,!1,null,null,null),jl=Ol.exports;x()(Ol,{VContainer:k["a"]});var wl=n("0e44"),Rl=(n("ac6a"),{pgdbiOtions:{},initializing:!0,schemaFilterOn:!0,policies:[],tablePolicyAssignments:{},functionPolicies:[],functionPolicyAssignments:{},defaultPolicy:null,defaultFunctionPolicy:null,genericIndexEvaluations:{},fkIndexEvaluations:{singleColumn:{},multiColumn:{}},uqIndexEvaluations:{singleColumn:{},multiColumn:{}},indicesToDrop:{},managedSchemata:[],parkedSchemata:[],rawSchemata:[],schemaFilter:[],enabledRoles:[],projectRoles:[],ignoredRoles:[],selectedRoleFamilies:[],defaultRlsUsing:"( owner_id = viewer_id() )",defaultRlsWithCheck:"",defaultRlsQualifiers:{all:{policies:[]},select:{policies:[]},insert:{policies:[]},update:{policies:[]},delete:{policies:[]}},defaultRoleGrants:{select:"DENIED",insert:"DENIED",update:"DENIED",delete:"DENIED"},functionPolicyHeaderTemplate:"\n  ----------  BEGIN: {{schemaName}}.{{functionName}}\n  \n  ",functionPolicyFooterTemplate:"\n\n  ----------  END: {{schemaName}}.{{functionName}}",defaultFunctionRoleGrants:{execute:"DENIED"}});function Vl(e){nt()(Rl).forEach(function(t){e[t]=Rl[t]})}var Fl=Vl;function Al(e){e.schemaFilterOn=!0}var $l=Al;function ql(e,t){return{tableId:e,policyDefinitionId:t,evaluation:{status:"PASS",errors:[]}}}function Gl(e,t){var n=t.tableIds,a=t.policyDefinitionId;n.forEach(function(t){e.tablePolicyAssignments[t]=ql(t,a)})}var Ul=Gl;function Ll(e,t){return{functionId:e,policyDefinitionId:t,evaluation:{status:"PASS",errors:[]}}}function Bl(e,t){var n=t.functionIds,a=t.policyDefinitionId;n.forEach(function(t){e.functionPolicyAssignments[t]=Ll(t,a)})}var Ml=Bl,zl="NO_INDEX",Ql="MULTIPLE_INDICES";function Kl(e){var t=e.managedSchemata.reduce(function(t,n){return Object(_e["a"])({},t,n.schemaTables.reduce(function(t,n){var a=(n.tableColumns||[]).reduce(function(t,a){var i=(n.referentialConstraints||[]).filter(function(e){return 1===e.referencingColumnUsage.length}).filter(function(e){return void 0!==e.referencingColumnUsage.find(function(e){return e.tableSchema===a.tableSchema&&e.tableName===a.tableName&&e.columnName===a.columnName})}).map(function(t){var i=n.indices.filter(function(e){return e.tableSchema===a.tableSchema&&e.tableName===a.tableName&&1===e.indexColumns.length&&e.indexColumns[0].columnName===a.columnName}),o=0==i.length?zl:i.length>1?Ql:i[0].indexName,r=o===zl||o===Ql?"red--text":"green--text",l="".concat(a.tableSchema,"_").concat(a.tableName,"_").concat(a.columnName),c={create:"create index if not exists idx_".concat(l," on ").concat(a.tableSchema,".").concat(a.tableName," using btree(").concat(a.columnName,");")},s=i.reduce(function(t,n){var a=nt()(e.indicesToDrop).indexOf(n.id)>-1;return a?Object(_e["a"])({},t,{drop:(t.drop||"").concat("".concat(n.indexDrop,"\n\n"))}):Object(_e["a"])({},t,{create:(t.create||"").concat("".concat(n.indexDefinition,"\n\n"))})},{}),u=void 0===s.drop&&void 0===s.create?c:s,d=t.referencedColumnUsage[0];return{id:t.constraintName,constraintName:t.constraintName,tableSchema:n.tableSchema,tableName:n.tableName,fkTable:"".concat(d.tableSchema,".").concat(d.tableName),fkSource:[a.columnName],fkTarget:["".concat(d.columnName)],fkIndices:i,fkIndexEvaluation:o,fkTableLinkId:"".concat(d.tableSchema,".").concat(d.tableName),evaluation:o,idxColumns:[a.columnName],indices:i,indexDisplayClass:r,desiredRealization:u}});return i.length>0?Object(_e["a"])({},t,Object(Ba["a"])({},a.id,i)):t},{});return Object(_e["a"])({},t,a)},{}))},{});e.fkIndexEvaluations=Object(_e["a"])({},e.fkIndexEvaluations,{singleColumn:t})}function Wl(e){var t=e.managedSchemata.reduce(function(t,n){return Object(_e["a"])({},t,n.schemaTables.reduce(function(t,n){var a=(n.referentialConstraints||[]).filter(function(e){return e.referencingColumnUsage.length>1}).map(function(t){var a=t.referencingColumnUsage.map(function(e){return e.columnName}).join(", "),i=a.split(", ").join("_"),o=t.referencedColumnUsage.map(function(e){return e.columnName}).join(", "),r=n.indices.filter(function(e){return e.indexColumns.length===t.referencingColumnUsage.length}).filter(function(e){var t=e.indkey.map(function(t){return e.indexColumns.find(function(e){return e.indkey===t}).columnName}).join(", ");return t===a}),l=0==r.length?zl:r.length>1?Ql:r[0].indexName,c=l===zl||l===Ql?"red--text":"green--text",s={create:"create index if not exists idx_".concat(n.tableSchema,"_").concat(n.tableName,"_").concat(i," on ").concat(n.tableSchema,"_").concat(n.tableName," using btree(").concat(a,");")},u=r.reduce(function(t,n){var a=nt()(e.indicesToDrop).indexOf(n.id)>-1;return a?Object(_e["a"])({},t,{drop:(t.drop||"").concat("".concat(n.indexDrop,"\n\n"))}):Object(_e["a"])({},t,{create:(t.create||"").concat("".concat(n.indexDefinition,"\n\n"))})},{}),d=void 0===u.drop&&void 0===u.create?s:u,m=t.referencedColumnUsage[0];return{id:t.constraintName,constraintName:t.constraintName,tableSchema:n.tableSchema,tableName:n.tableName,fkTable:"".concat(m.tableSchema,".").concat(m.tableName),fkSource:a.split(", "),fkTarget:o.split(", "),fkIndices:r,fkIndexEvaluation:l,fkTableLinkId:"".concat(m.tableSchema,".").concat(m.tableName),evaluation:l,idxColumns:a.split(", "),indices:r,indexDisplayClass:c,desiredRealization:d}});return Object(_e["a"])({},t,Object(Ba["a"])({},n.id,a))},{}))},{});e.fkIndexEvaluations=Object(_e["a"])({},e.fkIndexEvaluations,{multiColumn:t})}function Hl(e){Kl(e),Wl(e)}var Xl=Hl,Yl="NO_INDEX",Jl="MULTIPLE_INDICES";function Zl(e){var t=e.managedSchemata.reduce(function(t,n){return Object(_e["a"])({},t,n.schemaTables.reduce(function(t,n){var a=(n.tableColumns||[]).reduce(function(t,a){var i=(n.uniqueConstraints||[]).filter(function(e){return 1===e.keyColumnUsage.length}).filter(function(e){return void 0!==e.keyColumnUsage.find(function(e){return e.tableSchema===a.tableSchema&&e.tableName===a.tableName&&e.columnName===a.columnName})}).map(function(t){var i=n.indices.filter(function(e){return 1===e.indexColumns.length}).filter(function(e){return e.indexColumns[0].columnName===a.columnName}),o=t.keyColumnUsage[0],r=t.keyColumnUsage[0].columnName,l=0==i.length?Yl:i.length>1?Jl:i[0].indexName,c=l===Yl||l===Jl?"red--text":"green--text",s="".concat(o.tableSchema,".").concat(o.tableName,".").concat(o.columnName),u={create:"create index if not exists idx_".concat(s," on ").concat(a.tableSchema,".").concat(a.tableName," using btree(").concat(a.columnName,");")},d=i.reduce(function(t,n){var a=nt()(e.indicesToDrop).indexOf(n.id)>-1;return a?Object(_e["a"])({},t,{drop:(t.drop||"").concat("".concat(n.indexDrop,"\n\n"))}):Object(_e["a"])({},t,{create:(t.create||"").concat("".concat(n.indexDefinition,"\n\n"))})},{}),m=void 0===d.drop&&void 0===d.create?u:d;return{id:t.constraintName,constraintName:t.constraintName,tableSchema:n.tableSchema,tableName:n.tableName,uqSource:r,uqPath:s,uqTableId:"".concat(o.tableSchema,".").concat(o.tableName),uqIndices:i,uqIndexEvaluation:l,evaluation:l,idxColumns:[a.columnName],indices:i,indexDisplayClass:c,desiredRealization:m}});return i.length>0?Object(_e["a"])({},t,Object(Ba["a"])({},a.id,i)):t},{});return Object(_e["a"])({},t,a)},{}))},{});e.uqIndexEvaluations=Object(_e["a"])({},e.uqIndexEvaluations,{singleColumn:t})}function ec(e){var t=e.managedSchemata.reduce(function(t,n){return Object(_e["a"])({},t,n.schemaTables.reduce(function(t,n){var a=(n.uniqueConstraints||[]).filter(function(e){return e.keyColumnUsage.length>1}).map(function(t){var a=t.keyColumnUsage.sort(function(e,t){return e.columnName<t.columnName?-1:1}).map(function(e){return e.columnName}).join(", "),i=a.split(", ").join("_"),o=n.indices.filter(function(e){return e.indexColumns.length===t.keyColumnUsage.length}).filter(function(e){var t=e.indkey.map(function(t){return e.indexColumns.find(function(e){return e.indkey===t}).columnName}).join(", ");return t===a}),r=0==o.length?Yl:o.length>1?Jl:o[0].indexName,l=r===Yl||r===Jl?"red--text":"green--text",c=t.keyColumnUsage[0],s={create:"create index if not exists idx_".concat(n.tableSchema,"_").concat(n.tableName,"_").concat(i," on ").concat(n.tableSchema,"_").concat(n.tableName," using btree(").concat(a,");")},u=o.reduce(function(t,n){var a=nt()(e.indicesToDrop).indexOf(n.id)>-1;return a?Object(_e["a"])({},t,{drop:(t.drop||"").concat("".concat(n.indexDrop,"\n\n"))}):Object(_e["a"])({},t,{create:(t.create||"").concat("".concat(n.indexDefinition,"\n\n"))})},{}),d=void 0===u.drop&&void 0===u.create?s:u;return{id:t.constraintName,constraintName:t.constraintName,tableSchema:n.tableSchema,tableName:n.tableName,uqPath:"".concat(c.tableSchema,".").concat(c.tableName,".").concat(c.columnName),uqTableId:"".concat(c.tableSchema,".").concat(c.tableName),uqSource:a,uqIndices:o,uqIndexEvaluation:r,evaluation:r,idxColumns:a.split(", "),indices:o,indexDisplayClass:l,desiredRealization:d}});return Object(_e["a"])({},t,Object(Ba["a"])({},n.id,a))},{}))},{});e.uqIndexEvaluations=Object(_e["a"])({},e.uqIndexEvaluations,{multiColumn:t})}function tc(e){Zl(e),ec(e)}var nc=tc,ac="MULTIPLE_INDICES";function ic(e){var t=e.managedSchemata.reduce(function(t,n){return Object(_e["a"])({},t,n.schemaTables.reduce(function(t,n){var a=n.indices.reduce(function(t,n){var a=n.indkey.map(function(e){return n.indexColumns.find(function(t){return t.indkey===e}).columnName}).join(", "),i="".concat(n.tableSchema,".").concat(n.tableName,".").concat(a),o=t[i],r=nt()(e.indicesToDrop).indexOf(n.id)>-1,l=r?{drop:"".concat(n.indexDrop,"\n\n"),create:""}:{drop:"",create:"".concat(n.indexDefinition,"\n\n")},c=l,s=o?Object(_e["a"])({},o,{indexDisplayClass:"red--text",evaluation:ac,indices:[].concat(Object(Me["a"])(o.indices),[n]),desiredRealization:{drop:o.desiredRealization.drop.concat(l.drop),create:o.desiredRealization.create.concat(l.create)}}):{id:i,idxKey:i,idxColumns:a,tableKey:"".concat(n.tableSchema,".").concat(n.tableName),tableSchema:"".concat(n.tableSchema),tableName:"".concat(n.tableName),indexDisplayClass:"green--text",evaluation:a,indices:[n],desiredRealization:c};return Object(_e["a"])({},t,Object(Ba["a"])({},i,s))},{});return Object(_e["a"])({},t,a)},{}))},{});e.genericIndexEvaluations=t}var oc=ic,rc=n("9dbb"),lc=n.n(rc),cc="\ncreate type {{enumSchema}}.{{enumName}} as (\n  {{#enumValues}}\n    '{{value}}'{{comma}}\n  {{/enumValues}}\n);\n";function sc(e){e.managedSchemata=e.managedSchemata.map(function(e){return Object(_e["a"])({},e,{schemaEnums:e.schemaEnums.map(function(e){var t=lc.a.render(cc,Object(_e["a"])({},e,{enumValues:e.enumValues.map(function(t,n){return{value:t,comma:n===e.enumValues.length-1?"":","}})}));return Object(_e["a"])({},e,{enumDefinition:t})})})})}var uc=sc,dc="\ncreate type {{udtSchema}}.{{udtName}} as (\n  {{#fields}}\n    {{fieldName}} {{dataType}}{{comma}}\n  {{/fields}}\n);\n";function mc(e){e.managedSchemata=e.managedSchemata.map(function(e){return Object(_e["a"])({},e,{schemaUdts:e.schemaUdts.map(function(e){var t=lc.a.render(dc,Object(_e["a"])({},e,{fields:e.fields.map(function(t,n){return Object(_e["a"])({},t,{comma:n===e.fields.length-1?"":","})})}));return Object(_e["a"])({},e,{udtDefinition:t})})})})}var fc=mc;function pc(e){Xl(e),nc(e),oc(e),uc(e),fc(e)}var bc=pc;function vc(e){if(!e.defaultPolicy){var t={id:1e4*(new Date).getTime()+621355968e9,name:"Default Table Policy - NO ACCESS",policyHeaderTemplate:e.policyHeaderTemplate,policyFooterTemplate:e.policyFooterTemplate,roleTableGrantTemplate:e.roleTableGrantTemplate,enableRls:!1,columnExclusionOverrides:{insert:[],update:[]},columnExclusions:{insert:{},update:{}},roleGrants:e.projectRoles.reduce(function(t,n){return Object(_e["a"])({},t,Object(Ba["a"])({},n.roleName,e.defaultRoleGrants))},{}),rlsQualifiers:e.projectRoles.reduce(function(t,n){return Object(_e["a"])({},t,Object(Ba["a"])({},n.roleName,e.defaultRlsQualifiers))},{})};e.defaultPolicy=t,e.policies=e.policies.concat([t])}}function hc(e){if(!e.defaultFunctionPolicy){var t={id:1e4*(new Date).getTime()+621355968e9,name:"Default Function Policy - NO ACCESS",functionPolicyHeaderTemplate:e.functionPolicyHeaderTemplate,functionPolicyFooterTemplate:e.functionPolicyFooterTemplate,roleFunctionGrants:e.projectRoles.reduce(function(t,n){return Object(_e["a"])({},t,Object(Ba["a"])({},n.roleName,e.defaultFunctionRoleGrants))},{})};e.defaultFunctionPolicy=t,e.functionPolicies=e.functionPolicies.concat([t])}}function yc(e,t){var n=t.reduce(function(t,n){return[].concat(Object(Me["a"])(t),Object(Me["a"])(n.schemaTables.filter(function(t){return void 0===e.tablePolicyAssignments[t.id]}).map(function(e){return e.id})))},[]);Ul(e,{tableIds:n,policyDefinitionId:e.defaultPolicy.id})}function gc(e,t){var n=t.reduce(function(t,n){return[].concat(Object(Me["a"])(t),Object(Me["a"])(n.schemaFunctions.filter(function(t){return void 0===e.functionPolicyAssignments[t.id]}).map(function(e){return e.id})))},[]);Ml(e,{functionIds:n,policyDefinitionId:e.defaultFunctionPolicy.id})}function xc(e,t){vc(e),hc(e),yc(e,t),gc(e,t),e.managedSchemata=t,bc(e),e.initializing=!1,e.schemaFilterOn=!1}var kc=xc;function _c(e,t){var n=e.projectRoles=t.projectRoles.map(function(e){return Object(_e["a"])({},e,{applicableRoles:e.applicableRoles||[]})});e.policies=e.policies.map(function(t){return Object(_e["a"])({},t,{roleGrants:n.reduce(function(n,a){return Object(_e["a"])({},n,Object(Ba["a"])({},a.roleName,t.roleGrants[a.name]||e.defaultRoleGrants))},{}),rlsQualifiers:n.reduce(function(n,a){return Object(_e["a"])({},n,Object(Ba["a"])({},a.roleName,t.rlsQualifiers[a.name]||e.defaultRlsQualifiers))},{})})}),e.functionPolicies=e.functionPolicies.map(function(t){return Object(_e["a"])({},t,{roleFunctionGrants:n.reduce(function(n,a){return Object(_e["a"])({},n,Object(Ba["a"])({},a.roleName,t.roleFunctionGrants[a.name]||e.defaultFunctionRoleGrants))},{})})});var a=n.map(function(e){return e.roleName});e.ignoredRoles=e.ignoredRoles.filter(function(e){return-1===a.indexOf(e.roleName)})}var Cc=_c;function Nc(e,t){e.selectedRoleFamilies=t.selectedRoleFamilies}var Tc=Nc;function Sc(e,t){e.defaultRlsUsing=t.defaultRlsUsing}var Ic=Sc;function Dc(e,t){e.defaultRlsWithCheck=t.defaultRlsWithCheck}var Ec=Dc;function Pc(e,t){var n=e.policies.find(function(e){return e.name===t.name});if(n)throw new Error("A policy with this name already exists");var a=t.name,i=e.projectRoles,o={id:1e4*(new Date).getTime()+621355968e9,name:a,policyHeaderTemplate:e.policyHeaderTemplate,policyFooterTemplate:e.policyFooterTemplate,roleTableGrantTemplate:e.roleTableGrantTemplate,enableRls:!1,columnExclusionOverrides:{insert:[],update:[]},columnExclusions:{insert:{},update:{}},roleGrants:i.reduce(function(t,n){return Object(_e["a"])({},t,Object(Ba["a"])({},n.roleName,e.defaultRoleGrants))},{}),rlsQualifiers:i.reduce(function(t,n){return Object(_e["a"])({},t,Object(Ba["a"])({},n.roleName,e.defaultRlsQualifiers))},{})};e.policies=[].concat(Object(Me["a"])(e.policies),[o]).sort(function(e,t){return e.id<t.id})}var Oc=Pc;function jc(e,t){var n=e.policies.filter(function(e){return e.name!==t.policy.name});e.policies=[].concat(Object(Me["a"])(n),[t.policy]).sort(function(e,t){return e.id-t.id})}var wc=jc;function Rc(e,t){var n=e.policies.find(function(e){return e.name===t.name});if(n)throw new Error("A policy with this name already exists");var a=t.name,i=e.projectRoles,o={id:1e4*(new Date).getTime()+621355968e9,name:a,functionPolicyHeaderTemplate:e.functionPolicyHeaderTemplate,functionPolicyFooterTemplate:e.functionPolicyFooterTemplate,roleFunctionGrants:i.reduce(function(t,n){return Object(_e["a"])({},t,Object(Ba["a"])({},n.roleName,e.defaultFunctionRoleGrants))},{})};e.functionPolicies=[].concat(Object(Me["a"])(e.functionPolicies),[o]).sort(function(e,t){return e.id<t.id})}var Vc=Rc;function Fc(e,t){var n=e.functionPolicies.filter(function(e){return e.id!==t.policy.id});e.functionPolicies=[].concat(Object(Me["a"])(n),[t.policy]).sort(function(e,t){return e.id-t.id})}var Ac=Fc;function $c(e,t){var n=e.policies.find(function(e){return e.id===t.policyId}),a=e.policies.filter(function(e){return e.id!==t.policyId}),i=t.roleName,o=t.action,r=1e4*(new Date).getTime()+621355968e9,l={id:r,name:t.name||"rls_".concat(r),using:t.using||e.defaultRlsUsing,withCheck:t.withCheck||e.defaultRlsWithCheck,passStrategy:t.passStrategy||"permissive"},c=Object(_e["a"])({},n,{rlsQualifiers:Object(_e["a"])({},n.rlsQualifiers,Object(Ba["a"])({},i,Object(_e["a"])({},n.rlsQualifiers[i],Object(Ba["a"])({},o,Object(_e["a"])({},n.rlsQualifiers[i][o],{policies:[].concat(Object(Me["a"])(n.rlsQualifiers[i][o].policies),[l])})))))});e.policies=[].concat(Object(Me["a"])(a),[c])}var qc=$c;function Gc(e,t){var n=e.policies.find(function(e){return e.id===t.policyId}),a=e.policies.filter(function(e){return e.id!==t.policyId}),i=t.roleName,o=t.action,r=t.rlsPolicyId,l=Object(_e["a"])({},n,{rlsQualifiers:Object(_e["a"])({},n.rlsQualifiers,Object(Ba["a"])({},i,Object(_e["a"])({},n.rlsQualifiers[i],Object(Ba["a"])({},o,Object(_e["a"])({},n.rlsQualifiers[i][o],{policies:n.rlsQualifiers[i][o].policies.filter(function(e){return e.id!==r})})))))});e.policies=[].concat(Object(Me["a"])(a),[l])}var Uc=Gc;function Lc(e,t){nt()(t.project).forEach(function(n){e[n]=t.project[n]})}var Bc=Lc;function Mc(e,t){var n=t.sourcePolicyDefinitionId,a=t.newFields,i=t.tableIds||[],o=e.policies.find(function(e){return e.id===n}),r=Object(_e["a"])({},o,{id:1e4*(new Date).getTime()+621355968e9,name:a.name,customIdentifier:1===i.length?i[0]:null});e.policies=[].concat(Object(Me["a"])(e.policies),[r]).sort(function(e,t){return e.id<t.id}),Ul(e,{tableIds:i,policyDefinitionId:r.id})}var zc=Mc;function Qc(e,t){var n=t.policyDefinitionId,a=t.newFields,i=e.policies.find(function(e){return e.name===a.name});if(i)throw new Error("A policy with this name already exists");var o=e.policies.find(function(e){return e.id===n}),r=e.policies.filter(function(e){return e.id!==o.id}),l=Object(_e["a"])({},o,{name:a.name,customIdentifier:null});e.policies=[].concat(Object(Me["a"])(r),[l]).sort(function(e,t){return e.id<t.id})}var Kc=Qc;function Wc(e,t){var n=t.policyDefinitionId,a=e.policies.filter(function(e){return e.id!==n});e.policies=Object(Me["a"])(a).sort(function(e,t){return e.id<t.id}),nt()(e.tablePolicyAssignments).forEach(function(t){e.tablePolicyAssignments[t]===n&&(e.tablePolicyAssignments[t]=e.defaultPolicy.id)})}var Hc=Wc;function Xc(e,t){e.tablePolicyTemplate=t.tablePolicyTemplate}var Yc=Xc,Jc=n("83cd"),Zc=n.n(Jc);function es(e,t){e.enabledRoles=t.enabledRoles}var ts=es;function ns(e,t){var n=e.ignoredRoles.find(function(e){return e.roleName===t.role.roleName});e.ignoredRoles=n?e.ignoredRoles.filter(function(e){return e.roleName!==t.role.roleName}):[].concat(Object(Me["a"])(e.ignoredRoles),[t.role])}var as=ns;function is(e,t){e.pgdbiOptions=t.pgdbiOptions}var os=is;function rs(e,t){if(!0!==t.value||e.indicesToDrop[t.item.id])!1===t.value&&(e.indicesToDrop=nt()(e.indicesToDrop).filter(function(e){return e!==t.item.id}).reduce(function(t,n){return Object(_e["a"])({},t,Object(Ba["a"])({},n,e.indicesToDrop[n]))},{}));else{var n=t.item.id;e.indicesToDrop=Object(_e["a"])({},e.indicesToDrop,Object(Ba["a"])({},n,t.item))}bc(e)}var ls=rs,cs={resetDefaultState:Fl,filterSchemata:$l,setManagedSchemata:kc,assignTablePolicy:Ul,projectRoles:Cc,selectedRoleFamilies:Tc,defaultRlsUsing:Ic,defaultRlsWithCheck:Ec,newPolicy:Oc,savePolicy:wc,createRlsPolicy:qc,deleteRlsPolicy:Uc,importProject:Bc,newFunctionPolicy:Vc,saveFunctionPolicy:Ac,assignFunctionPolicy:Ml,customizeTablePolicy:zc,makeGlobalTablePolicy:Kc,deleteTablePolicy:Hc,updateTablePolicyTemplate:Yc,updateDefaultRlsUsing:Zc.a,setEnabledRoles:ts,toggleIgnoreRole:as,setPgdbiOptions:os,toggleIndexForDrop:ls};a["a"].use(mo["a"]);var ss=new mo["a"].Store({plugins:[Object(wl["a"])()],state:Rl,mutations:cs,actions:{}});a["a"].use(J["a"]);var us=new J["a"]({scrollBehavior:function(e,t,n){return n||{x:0,y:0}},routes:[{path:"/",name:"home",component:ie},{path:"/initialize",name:"initialize",component:ge},{path:"/role-manager",name:"role-manager",component:vi},{path:"/table-security-manager",name:"table-security-manager",component:Po},{path:"/function-security-manager",name:"function-security-manager",component:pr},{path:"/search-view",name:"search-view",component:Sr},{path:"/fk-index-manager",name:"fk-index-manager",component:Jr},{path:"/smart-comment-manager",name:"smart-comment-manager",component:il},{path:"/settings",name:"settings",component:jr},{path:"/project-export",name:"project-export",component:ul},{path:"/project-import",name:"project-import",component:be},{path:"/sqitch",name:"sqitch",component:bl},{path:"/worker",name:"worker",component:xl},{path:"/table/:id",name:"table",component:$a,props:!0},{path:"/function/:id",name:"function",component:wn["a"],props:!0},{path:"/enum/:id",name:"enum",component:Sl,props:!0},{path:"/udt/:id",name:"udt",component:jl,props:!0},{path:"/about",name:"about",component:function(){return n.e("about").then(n.bind(null,"f820"))}}]});us.beforeEach(function(e,t,n){ss.state.initializing&&"initialize"!==e.name&&us.push("initialize"),n()});var ds=us,ms=(n("96cf"),n("3b8d"),n("522d")),fs=n("efe7");a["a"].use(ms["a"]);var ps="apollo-token",bs=Object({NODE_ENV:"production",BASE_URL:"/pgdbi/"}).VUE_APP_GRAPHQL_HTTP||"/pgdbi/graphql",vs={httpEndpoint:bs,tokenName:ps,persisting:!1,websocketsOnly:!1,ssr:!1};function hs(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(fs["createApolloClient"])(Object(_e["a"])({},vs,e)),n=t.apolloClient,a=new ms["a"]({defaultClient:n,defaultOptions:{$query:{}},errorHandler:function(e){console.log("%cError","background: red; color: white; padding: 2px 4px; border-radius: 3px; font-weight: bold;",e.message)}});return a}var ys=n("4eb5"),gs=n.n(ys),xs=n("ca55");a["a"].config.productionTip=!1,a["a"].use(gs.a),a["a"].use(xs["a"]),new a["a"]({vuetify:o,router:ds,store:ss,apolloProvider:hs(),render:function(e){return e(Y)}}).$mount("#app")},"58bb":function(e,t){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dbIntrospection"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"pgdbiOptions"},arguments:[],directives:[]}]}}],loc:{start:0,end:42}};n.loc.source={body:"query {\n  dbIntrospection\n  pgdbiOptions\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};function a(e,t){if("FragmentSpread"===e.kind)t.add(e.name.value);else if("VariableDefinition"===e.kind){var n=e.type;"NamedType"===n.kind&&t.add(n.name.value)}e.selectionSet&&e.selectionSet.selections.forEach(function(e){a(e,t)}),e.variableDefinitions&&e.variableDefinitions.forEach(function(e){a(e,t)}),e.definitions&&e.definitions.forEach(function(e){a(e,t)})}var i={};(function(){n.definitions.forEach(function(e){if(e.name){var t=new Set;a(e,t),i[e.name.value]=t}})})(),e.exports=n},6:function(e,t){},7:function(e,t){},"77d3":function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div")},i=[],o=(n("7f7f"),n("cebc")),r=(n("28a5"),n("a4bb")),l=n.n(r),c=n("9dbb"),s=n.n(c),u="terse";var d={name:"FunctionComputerMixin",methods:{computePolicy:function(e,t,n,a){var i=l()(e.roleFunctionGrants).map(function(e){return{roleName:e}}),r="".concat(i.map(function(e){return e.roleName}).join(", ")),c=l()(e.roleFunctionGrants).reduce(function(t,n){return"ALLOWED"===e.roleFunctionGrants[n].execute?t.concat([{roleName:n}]):t},[]),d=l()(e.roleFunctionGrants).reduce(function(t,n){return"IMPLIED"===e.roleFunctionGrants[n].execute?t.concat([{roleName:n}]):t},[]),f=l()(e.roleFunctionGrants).reduce(function(t,n){return"DENIED"===e.roleFunctionGrants[n].execute?t.concat([{roleName:n}]):t},[]),p={verbose:!0,deniedRoleGrants:f,impliedRoleGrants:d},b=a?a.argumentDataTypes.split(",").map(function(e){return e.trim().split(" ")[1]}).join(","):void 0,v=Object(o["a"])({},n,{policyName:e.name,allowedRoleGrants:c,revokeRolesList:r,functionSignature:a?"".concat(a.functionSchema,".").concat(a.functionName," (").concat(b,")"):"{{schemaName}}.{{functionName}} ({{signatureArgumentDataTypes}})"}),h=t===u?v:Object(o["a"])({},p,v);return s.a.render(m,h)}}},m="\n----------\n----------  BEGIN FUNCTION POLICY: {{functionSignature}}\n----------  POLICY NAME:  {{policyName}}\n----------\n\n----------  REMOVE EXISTING FUNCTION GRANTS\n\n  revoke all privileges \n  on function {{functionSignature}} \n  from public;\n\n  revoke all privileges \n  on function {{functionSignature}} \n  from {{revokeRolesList}};\n\n----------  CREATE NEW FUNCTION GRANTS\n{{#allowedRoleGrants}}\n\n----------  {{roleName}}\n  grant \n  execute\n  on function {{functionSignature}} \n  to {{roleName}};\n\n{{/allowedRoleGrants}}\n{{#verbose}}\n----------  IMPLIED FUNCTION GRANTS\n  {{#impliedRoleGrants}}\n  --IMPLIED:   grant execute on function {{functionSignature}} to {{roleName}};\n  {{/impliedRoleGrants}}\n\n  ----------  DENIED TABLE GRANTS\n  {{#deniedRoleGrants}}\n  --DENIED:   grant execute on function {{functionSignature}} to {{roleName}};\n  {{/deniedRoleGrants}}\n{{/verbose}}\n----------  END FUNCTION POLICY: {{functionSignature}}\n--==\n\n",f=d,p=n("2877"),b=Object(p["a"])(f,a,i,!1,null,null,null);t["a"]=b.exports},"7b59":function(e,t,n){"use strict";var a=n("8bda"),i=n.n(a);i.a},8:function(e,t){},"82cd":function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-card",{key:e.policyDefinition.id,attrs:{color:"black"}},[n("v-container",[n("v-toolbar",[n("h1",[e._v("Name: "+e._s(e.policyDefinition.name))])]),n("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[n("v-tab",{key:"grants",attrs:{ripple:""}},[e._v("\n        Execution Grants\n      ")]),n("v-tab-item",{key:"grants"},[n("v-card",{attrs:{flat:""}},[n("policy-definition-grant-grid",{attrs:{policy:e.policyDefinition,disabled:e.disabled}})],1)],1),n("v-tab",{key:"policy-template",attrs:{ripple:""}},[e._v("\n        "+e._s(e.aFunction?"Policy":"Policy Template")+"\n      ")]),n("v-tab-item",{key:"policy-template"},[n("v-card",{attrs:{flat:""}},[n("policy-realization",{attrs:{policyDefinition:e.policyDefinition,aFunction:e.aFunction}})],1)],1),e.aFunction?n("v-tab",{key:"function-definition",attrs:{ripple:""}},[e._v("\n        Function Definition\n      ")]):e._e(),e.aFunction?n("v-tab-item",{key:"function-definition"},[n("v-card",{attrs:{flat:""}},[n("function-definition",{attrs:{id:e.aFunction.id}})],1)],1):e._e()],1)],1)],1)},i=[],o=(n("7514"),n("c5f6"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-data-table",{staticClass:"text-sm-left",attrs:{headers:e.headers,items:e.grantMatrix,"hide-default-footer":"","item-key":"id"},scopedSlots:e._u([{key:"item.execute",fn:function(t){var a=t.item;return[n("v-checkbox",{attrs:{"input-value":e.roleGrantSelected(a,"execute"),disabled:e.roleGrantDisabled(a,"execute")},on:{click:function(t){return e.toggleRoleGrant(a.roleName,"execute")}}})]}}])})}),r=[],l=n("bd86"),c=n("a4bb"),s=n.n(c),u=n("cebc"),d="ALLOWED",m="DENIED",f="IMPLIED",p={name:"FunctionPolicyDefinitionGrantGrid",props:{policy:{type:Object,required:!0},disabled:{type:Boolean,default:!1}},data:function(){return{policyStructure:[],calculatedPolicy:"NOT CALCULATED",toggleCompleted:!1}},watch:{},methods:{roleGrantSelected:function(e,t){return[d,f].indexOf(e[t])>-1},roleGrantDisabled:function(e,t){return e[t]===f||this.disabled},toggleRoleGrant:function(e,t){var n=this;if(!0!==this.toggleCompleted){var a=this.policy.roleFunctionGrants[e][t],i=this.projectRoles.filter(function(t){return void 0!==t.applicableRoles.find(function(t){return t.roleName===e})}).reduce(function(e,t){return e.concat(t.roleName)},[]),o=Object(u["a"])({},this.policy,{roleFunctionGrants:s()(this.policy.roleFunctionGrants).reduce(function(o,r){var c=i.indexOf(r)>-1,p=r===e;return Object(u["a"])({},o,Object(l["a"])({},r,s()(n.policy.roleFunctionGrants[r]).reduce(function(e,i){var o;n.policy.roleFunctionGrants[r][i];return o=i===t?p?a===d?m:d:c?a===d?m:f:n.policy.roleFunctionGrants[r][i]:"all"==i&&(c||p)&&a===d?m:n.policy.roleFunctionGrants[r][i],Object(u["a"])({},e,Object(l["a"])({},i,o))},{})))},{})});this.$store.commit("saveFunctionPolicy",{policy:o}),this.toggleCompleted=!0}else this.toggleCompleted=!1}},computed:{projectRoles:function(){return this.$store.state.projectRoles},grantMatrix:function(){var e=this;return s()(this.policy.roleFunctionGrants).map(function(t){return Object(u["a"])({},e.policy.roleFunctionGrants[t],{roleName:t})})},headers:function(){return[{text:"Role Name",sortable:!1,value:"roleName"},{text:"EXECUTE",sortable:!1,value:"execute"}]}}},b=p,v=n("2877"),h=n("6544"),y=n.n(h),g=n("ac7c"),x=n("8fea"),k=Object(v["a"])(b,o,r,!1,null,null,null),_=k.exports;y()(k,{VCheckbox:g["a"],VDataTable:x["a"]});var C=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("script-viewer",{attrs:{scriptText:e.computedPolicy,skipFormat:""},on:{"readability-changed":e.policyReadabilityChanged}})],1)},N=[],T=n("77d3"),S=n("89d6"),I=n("4eb5"),D=n.n(I),E={name:"FunctionDefinition",mixins:[T["a"],D.a],components:{ScriptViewer:S["a"]},props:{policyDefinition:{type:Object,required:!0},aFunction:{type:Object,required:!1}},data:function(){return{policyStructure:[],policyReadability:"terse",computedPolicy:"N/A"}},mounted:function(){this.doComputePolicy()},watch:{policyDefinition:function(){this.doComputePolicy()},policyReadability:function(){this.doComputePolicy()}},methods:{policyReadabilityChanged:function(e){this.policyReadability=e},refresh:function(){this.doComputePolicy()},expand:function(){this.computedPolicy="".concat(this.computedPolicy," ")},doComputePolicy:function(){var e=this.aFunction?{}:null;this.computedPolicy=this.computePolicy(this.policyDefinition,this.policyReadability,e,this.aFunction)},onCopy:function(e){alert("Copied!")},onError:function(e){alert("Failed to copy texts")},executeSql:function(){alert("not implemented:  server config value will expose graphile extension to execute generated script")}},computed:{}},P=E,O=n("a523"),j=Object(v["a"])(P,C,N,!1,null,null,null),w=j.exports;y()(j,{VContainer:O["a"]});var R=n("243e"),V={name:"FunctionPolicyDefinition",components:{PolicyDefinitionGrantGrid:_,PolicyRealization:w,FunctionDefinition:R["a"]},props:{policyId:{type:Number,required:!0},aFunction:{type:Object,required:!1}},data:function(){return{calculatedPolicy:"NOT CALCULATED",toggleCompleted:!1,activeTab:0}},mounted:function(){},watch:{},methods:{},computed:{disabled:function(){return null!==this.aFunction&&void 0!==this.aFunction||this.policyDefinition.id===this.$store.state.defaultFunctionPolicy.id},policyDefinition:function(){var e=this,t=(this.$store.state.functionPolicies,this.$store.state.functionPolicies.find(function(t){return t.id===e.policyId}));return t}}},F=V,A=n("b0af"),$=n("71a3"),q=n("c671"),G=n("fe57"),U=n("71d9"),L=Object(v["a"])(F,a,i,!1,null,null,null);t["a"]=L.exports;y()(L,{VCard:A["a"],VContainer:O["a"],VTab:$["a"],VTabItem:q["a"],VTabs:G["a"],VToolbar:U["a"]})},"83cd":function(e,t){function n(e,t){e.defaultRlsUsing=t.defaultRlsUsing}e.exports=n},"861c":function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",{attrs:{fluid:"",cols:"12"}},[n("v-toolbar",{attrs:{dense:""}},[n("v-switch",{attrs:{label:"Enable RLS",disabled:e.disabled},model:{value:e.enableRls,callback:function(t){e.enableRls=t},expression:"enableRls"}}),n("v-spacer"),e.showMakeGlobalButton?n("table-policy-make-global-dialog",{attrs:{policyDefinition:e.policyDefinition}}):e._e(),n("v-spacer"),e.showDeleteButton?n("table-policy-delete-dialog",{attrs:{policyDefinition:e.policyDefinition}}):e._e(),n("v-spacer"),n("h4",{staticClass:"text-no-wrap"},[e._v(e._s(e.title))])],1),n("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[n("v-tab",{key:"grants",attrs:{ripple:""}},[e._v("\n        Table Grants\n      ")]),n("v-tab-item",{key:"grants",attrs:{lazy:""}},[n("v-card",{attrs:{flat:""}},[n("table-policy-definition-grants",{attrs:{policyDefinition:e.policyDefinition,disabled:e.disabled}})],1)],1),n("v-tab",{key:"rls",attrs:{ripple:"",disabled:!e.enableRls}},[e._v("\n        Row Level Security\n      ")]),n("v-tab-item",{key:"rls",attrs:{lazy:""}},[n("v-card",{attrs:{flat:""}},[n("policy-rls-qualifier-grid",{attrs:{policy:e.policyDefinition,disabled:e.disabled}})],1)],1),n("v-tab",{key:"policy-template",attrs:{ripple:""}},[e._v("\n        "+e._s(e.table?"Policy Script":"Policy Script Template")+"\n      ")]),n("v-tab-item",{key:"policy-template",attrs:{lazy:""}},[n("v-card",{attrs:{flat:""}},[n("policy-realization",{attrs:{policyDefinition:e.policyDefinition,table:e.table,enableRls:e.enableRls}})],1)],1),e.table?n("v-tab",{key:"policy-evaluation",attrs:{ripple:""}},[e._v("\n        Evaluation\n      ")]):e._e(),e.table?n("v-tab-item",{key:"policy-evaluation",attrs:{lazy:""}},[n("v-card",{attrs:{flat:""}},[n("table-policy-evaluator-detail",{attrs:{policyDefinition:e.policyDefinition,table:e.table}})],1)],1):e._e()],1)],1)},i=[],o=(n("7514"),n("7f7f"),n("cebc")),r=(n("c5f6"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[n("v-tab",{key:"grants",attrs:{ripple:""}},[e._v("\n    Role Grants\n  ")]),n("v-tab-item",{key:"grants",attrs:{lazy:""}},[n("v-card",{attrs:{flat:""}},[n("table-policy-definition-grant-grid",{attrs:{policyDefinition:e.policyDefinition,disabled:e.disabled}})],1)],1),n("v-tab",{key:"exclusions",attrs:{ripple:"",disabled:e.disabled}},[e._v("\n    Column Exclusions\n  ")]),n("v-tab-item",{key:"exclusions",attrs:{lazy:""}},[n("v-card",{attrs:{flat:""}},[n("table-policy-definition-column-exclusions",{attrs:{policyDefinition:e.policyDefinition,table:e.table,disabled:e.disabled}})],1)],1)],1)}),l=[],c=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-data-table",{staticClass:"text-sm-left",attrs:{headers:e.headers,items:e.grantMatrix,"hide-default-footer":"","item-key":"id"},scopedSlots:e._u([{key:"item.select",fn:function(t){var a=t.item;return[n("v-checkbox",{attrs:{"input-value":e.roleGrantSelected(a,"select"),disabled:e.roleGrantDisabled(a,"select")},on:{click:function(t){return e.toggleRoleGrant(a.roleName,"select")}}})]}},{key:"item.insert",fn:function(t){var a=t.item;return[n("v-checkbox",{attrs:{"input-value":e.roleGrantSelected(a,"insert"),disabled:e.roleGrantDisabled(a,"insert")},on:{click:function(t){return e.toggleRoleGrant(a.roleName,"insert")}}})]}},{key:"item.update",fn:function(t){var a=t.item;return[n("v-checkbox",{attrs:{"input-value":e.roleGrantSelected(a,"update"),disabled:e.roleGrantDisabled(a,"update")},on:{click:function(t){return e.toggleRoleGrant(a.roleName,"update")}}})]}},{key:"item.delete",fn:function(t){var a=t.item;return[n("v-checkbox",{attrs:{"input-value":e.roleGrantSelected(a,"delete"),disabled:e.roleGrantDisabled(a,"delete")},on:{click:function(t){return e.toggleRoleGrant(a.roleName,"delete")}}})]}}])})},s=[],u=n("bd86"),d=n("a4bb"),m=n.n(d),f="ALLOWED",p="DENIED",b="IMPLIED",v={name:"PolicyDefinitionGrantGrid",props:{policyDefinition:{type:Object,required:!0},disabled:{type:Boolean,default:!1}},data:function(){return{policyStructure:[],calculatedPolicy:"NOT CALCULATED",toggleCompleted:!1}},watch:{},methods:{roleGrantSelected:function(e,t){return[f,b].indexOf(e[t])>-1},roleGrantDisabled:function(e,t){return e[t]===b||this.disabled},toggleRoleGrant:function(e,t){var n=this;if(!0!==this.toggleCompleted){var a=this.policyDefinition.roleGrants[e][t],i=this.projectRoles.filter(function(t){return void 0!==(t.applicableRoles||[]).find(function(t){return t.roleName===e})}).reduce(function(e,t){return e.concat(t.roleName)},[]),r=Object(o["a"])({},this.policyDefinition,{roleGrants:m()(this.policyDefinition.roleGrants).reduce(function(r,l){var c=i.indexOf(l)>-1,s=l===e;return Object(o["a"])({},r,Object(u["a"])({},l,m()(n.policyDefinition.roleGrants[l]).reduce(function(e,i){var r;n.policyDefinition.roleGrants[l][i];return r=i===t?s?a===f?p:f:c?a===f?p:b:n.policyDefinition.roleGrants[l][i]:"all"==i&&(c||s)&&a===f?p:n.policyDefinition.roleGrants[l][i],Object(o["a"])({},e,Object(u["a"])({},i,r))},{})))},{})});this.$store.commit("savePolicy",{policy:r}),this.toggleCompleted=!0}else this.toggleCompleted=!1}},computed:{projectRoles:function(){return this.$store.state.projectRoles},grantMatrix:function(){var e=this;return m()(this.policyDefinition.roleGrants).map(function(t){return Object(o["a"])({},e.policyDefinition.roleGrants[t],{roleName:t})})},headers:function(){return[{text:"Role Name",sortable:!1,value:"roleName"},{text:"SELECT",sortable:!1,value:"select"},{text:"INSERT",sortable:!1,value:"insert"},{text:"UPDATE",sortable:!1,value:"update"},{text:"DELETE",sortable:!1,value:"delete"}]}}},h=v,y=n("2877"),g=n("6544"),x=n.n(g),k=n("ac7c"),_=n("8fea"),C=Object(y["a"])(h,c,s,!1,null,null,null),N=C.exports;x()(C,{VCheckbox:k["a"],VDataTable:_["a"]});var T=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",{attrs:{"justify-start":""}},[n("v-data-table",{attrs:{headers:e.headers,items:e.dataTableItems,"hide-default-footer":"",dense:""},scopedSlots:e._u([{key:"item.insertExclusions",fn:function(t){var a=t.item;return[n("column-exclusion-set",{attrs:{policyDefinition:e.policyDefinition,table:e.table,action:"insert",roleName:a.roleName}})]}},{key:"item.updateExclusions",fn:function(t){var a=t.item;return[n("column-exclusion-set",{attrs:{policyDefinition:e.policyDefinition,table:e.table,action:"update",roleName:a.roleName}})]}}])})],1)},S=[],I=n("75fc"),D=(n("2f62"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[e.overrideHidden?e._e():n("v-switch",{attrs:{label:"override implied exclusions"},model:{value:e.overrideActive,callback:function(t){e.overrideActive=t},expression:"overrideActive"}}),e.showDialogButton?n("table-policy-column-exclusion-dialog",{attrs:{policyDefinition:e.policyDefinition,table:e.table,action:e.action,roleName:e.roleName}}):e._e(),n("v-list",e._l(e.currentColumnExclusions,function(t){return n("v-list-item",{key:t},[n("v-btn",{on:{click:function(n){return e.removeColumnExclusion(t)}}},[n("v-icon",[e._v("clear")])],1),e._v(" "+e._s(t)+"\n      ")],1)}),1)],1)}),E=[],P=n("650f"),O=n.n(P),j=n("7618"),w=(n("6b54"),n("a8db")),R=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-dialog",{attrs:{persistent:"",width:"800"},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[n("v-btn",e._g({staticClass:"text-none",attrs:{small:"",dark:"",hidden:e.hidden,disabled:e.disabled}},a),[e._v("\n        "+e._s(e.displayValue)+"\n      ")])]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[n("v-card",[n("v-card-title",{staticClass:"headline"},[e._v("Exclude Column")]),n("v-text-field",{model:{value:e.columnName,callback:function(t){e.columnName=t},expression:"columnName"}}),n("v-card-actions",[n("v-spacer"),n("v-btn",{on:{click:function(t){e.dialog=!1}}},[e._v("Cancel")]),n("v-btn",{on:{click:e.addColumnExclusion}},[e._v("Exclude")]),n("v-spacer")],1)],1)],1)],1)},V=[],F={name:"TablePolicyColumnExclusionDialog",props:{policyDefinition:{type:Object,required:!0},table:{type:Object,required:!1},action:{type:String,required:!0},roleName:{type:String,required:!0},disabled:{type:Boolean,required:!1}},data:function(){return{dialog:!1,columnName:""}},computed:{displayValue:function(){return"New ".concat(this.action," exclusion")},hidden:function(){return"DENIED"===this.policyDefinition.roleGrants[this.roleName][this.action]}},watch:{},methods:{addColumnExclusion:function(){var e=this;this.dialog=!1;var t=(this.policyDefinition.columnExclusions[this.action][this.roleName]||[]).filter(function(t){return t!==e.columnName}).concat([this.columnName]);try{this.$store.commit("savePolicy",{policy:Object(o["a"])({},this.policyDefinition,{columnExclusions:Object(o["a"])({},this.policyDefinition.columnExclusions,Object(u["a"])({},this.action,Object(o["a"])({},this.policyDefinition.columnExclusions[this.action],Object(u["a"])({},this.roleName,t))))})})}catch(n){alert(n.toString()),console.error(n)}}}},A=F,$=(n("c2d7"),n("8336")),q=n("b0af"),G=n("99d9"),U=n("169a"),L=n("2fa4"),B=n("8654"),M=Object(y["a"])(A,R,V,!1,null,null,null),z=M.exports;function Q(e){var t=K(e,"string");return"symbol"===Object(j["a"])(t)?t:String(t)}function K(e,t){if("object"!==Object(j["a"])(e)||null===e)return e;var n=e[O.a];if(void 0!==n){var a=n.call(e,t||"default");if("object"!==Object(j["a"])(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}x()(M,{VBtn:$["a"],VCard:q["a"],VCardActions:G["a"],VCardTitle:G["b"],VDialog:U["a"],VSpacer:L["a"],VTextField:B["a"]});var W={name:"ColumnExclusionSet",components:{TablePolicyColumnExclusionDialog:z},props:{policyDefinition:{type:Object,required:!0},table:{type:Object,required:!1},action:{type:String,required:!0},roleName:{type:String,required:!0}},data:function(){return{toggleCompleted:!1,overrideActive:!1}},watch:{overrideActive:function(){var e,t=this,n=this.policyDefinition.columnExclusionOverrides[this.action].filter(function(e){return e!==t.roleName}),a=this.overrideActive?n.concat(this.roleName):n;if(this.overrideActive)e=this.policyDefinition.columnExclusions[this.action];else{var i=this.policyDefinition.columnExclusions[this.action];i[this.roleName],Object(w["a"])(i,[this.roleName].map(Q))}try{this.$store.commit("savePolicy",{policy:Object(o["a"])({},this.policyDefinition,{columnExclusionOverrides:Object(o["a"])({},this.policyDefinition.columnExclusionOverrides,Object(u["a"])({},this.action,a)),columnExclusions:Object(o["a"])({},this.policyDefinition.columnExclusions,Object(u["a"])({},this.action,e||{}))})})}catch(r){alert(r.toString()),console.error(r)}}},methods:{removeColumnExclusion:function(e){var t=this.policyDefinition.columnExclusions[this.action][this.roleName].filter(function(t){return t!==e});try{this.$store.commit("savePolicy",{policy:Object(o["a"])({},this.policyDefinition,{columnExclusions:Object(o["a"])({},this.policyDefinition.columnExclusions,Object(u["a"])({},this.action,Object(o["a"])({},this.policyDefinition.columnExclusions[this.action],Object(u["a"])({},this.roleName,t))))})})}catch(n){alert(n.toString()),console.error(n)}}},mounted:function(){this.overrideActive=this.policyDefinition.columnExclusionOverrides[this.action].indexOf(this.roleName)>-1},computed:{currentColumnExclusions:function(){return(this.policyDefinition.columnExclusions[this.action]||[])[this.roleName]},disabled:function(){return"DENIED"===this.policyDefinition.roleGrants[this.roleName][this.action]},overrideHidden:function(){var e=["DENIED","ALLOWED"].indexOf(this.policyDefinition.roleGrants[this.roleName][this.action])>-1;return e},showDialogButton:function(){return!0}}},H=W,X=n("a523"),Y=n("132d"),J=n("8860"),Z=n("da13"),ee=n("b73d"),te=Object(y["a"])(H,D,E,!1,null,null,null),ne=te.exports;x()(te,{VBtn:$["a"],VContainer:X["a"],VIcon:Y["a"],VList:J["a"],VListItem:Z["a"],VSwitch:ee["a"]});var ae={name:"PolicyDefinitionColumnExclusions",components:{ColumnExclusionSet:ne},props:{policyDefinition:{type:Object,required:!0},table:{type:Object,required:!1},disabled:{type:Boolean,default:!1}},data:function(){return{toggleComplete:!1,headers:[{text:"Role Name",sortable:!1,value:"roleName"},{text:"Insert Exclusions",sortable:!1,value:"insertExclusions"},{text:"Update Exclusions",sortable:!1,value:"updateExclusions"}]}},watch:{},methods:{removeInsertExclusion:function(e,t){console.log("columnExclusion",e,t)}},computed:{projectRoles:function(){return this.$store.state.projectRoles},dataTableItems:function(){var e=this;return m()(this.policyDefinition.roleGrants).reduce(function(t,n){var a=(e.policyDefinition.columnExclusions.insert||[])[n]||[],i=(e.policyDefinition.columnExclusions.update||[])[n]||[];return[].concat(Object(I["a"])(t),[{roleName:n,insertColumnExclusions:a,updateColumnExclusions:i}])},[])}}},ie=ae,oe=Object(y["a"])(ie,T,S,!1,null,null,null),re=oe.exports;x()(oe,{VContainer:X["a"],VDataTable:_["a"]});var le={name:"PolicyDefinitionGrants",components:{TablePolicyDefinitionGrantGrid:N,TablePolicyDefinitionColumnExclusions:re},props:{policyDefinition:{type:Object,required:!0},table:{type:Object,required:!1},disabled:{type:Boolean,default:!1}},data:function(){return{activeTab:null}},watch:{},methods:{},computed:{}},ce=le,se=n("71a3"),ue=n("c671"),de=n("fe57"),me=Object(y["a"])(ce,r,l,!1,null,null,null),fe=me.exports;x()(me,{VCard:q["a"],VTab:se["a"],VTabItem:ue["a"],VTabs:de["a"]});var pe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-data-table",{attrs:{headers:e.headers,items:e.rlsQualifierMatrix,"hide-default-footer":"","item-key":"id",dense:""},scopedSlots:e._u([{key:"item.roleName",fn:function(t){var a=t.item;return[n("div",{staticClass:"text-no-wrap"},[e._v(e._s(a.roleName))])]}},{key:"item.all",fn:function(t){var a=t.item;return[n("table-policy-rls-action",{attrs:{policy:e.policy,action:"all",item:a,disabled:e.disabled}})]}},{key:"item.select",fn:function(t){var a=t.item;return[n("table-policy-rls-action",{attrs:{policy:e.policy,action:"select",item:a,disabled:e.disabled}})]}},{key:"item.insert",fn:function(t){var a=t.item;return[n("table-policy-rls-action",{attrs:{policy:e.policy,action:"insert",item:a,disabled:e.disabled}})]}},{key:"item.update",fn:function(t){var a=t.item;return[n("table-policy-rls-action",{attrs:{policy:e.policy,action:"update",item:a,disabled:e.disabled}})]}},{key:"item.delete",fn:function(t){var a=t.item;return[n("table-policy-rls-action",{attrs:{policy:e.policy,action:"delete",item:a,disabled:e.disabled}})]}}])})},be=[],ve=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-dialog",{attrs:{persistent:"",width:"1400"},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[n("v-btn",e._g({staticClass:"text-none",attrs:{small:"",dark:"",disabled:e.btnDisabled,hidden:e.hidden},on:{click:e.activate}},a),[e._v("\n        "+e._s(e.displayValue)+"\n      ")])]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[n("v-card",[n("v-card-title",{staticClass:"headline"},[e._v("Rls Policy")]),n("v-text-field",{attrs:{label:"Name",disabled:e.disabled},model:{value:e.currentName,callback:function(t){e.currentName=t},expression:"currentName"}}),n("v-radio-group",{attrs:{column:!1,disabled:e.disabled},model:{value:e.currentPassStrategy,callback:function(t){e.currentPassStrategy=t},expression:"currentPassStrategy"}},[n("v-radio",{attrs:{label:"Permissive",value:"permissive"}}),n("v-radio",{attrs:{label:"Restrictive",value:"restrictive"}})],1),n("v-text-field",{attrs:{label:"Using",disabled:e.disabled},model:{value:e.currentUsing,callback:function(t){e.currentUsing=t},expression:"currentUsing"}}),n("v-text-field",{attrs:{label:"With Check",disabled:e.disabled},model:{value:e.currentWithCheck,callback:function(t){e.currentWithCheck=t},expression:"currentWithCheck"}}),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{hidden:e.disabled},on:{click:function(t){e.updateRlsPolicy(e.roleName,e.action,e.rlsPolicy.id,e.currentUsing,e.currentWithCheck,e.currentPassStrategy,e.currentName),e.dialog=!1}}},[e._v("Update")]),n("v-btn",{attrs:{hidden:e.disabled},on:{click:function(t){e.disableRlsPolicy(e.roleName,e.action,e.rlsPolicy.id),e.dialog=!1}}},[e._v("Disable")]),n("v-btn",{attrs:{hidden:e.disabled},on:{click:function(t){e.dialog=!1}}},[e._v("Cancel")]),n("v-btn",{attrs:{hidden:!e.disabled},on:{click:function(t){e.dialog=!1}}},[e._v("OK")]),n("v-spacer")],1)],1)],1)],1)},he=[],ye="DISABLED",ge="IMPLIED",xe={name:"RlsPolicyDialog",props:{disabled:{type:Boolean,default:!1},status:{type:String,required:!0},rlsPolicy:{type:Object,required:!0},action:{type:String,required:!0},roleName:{type:String,required:!0},disableRlsPolicy:{type:Function,required:!0},updateRlsPolicy:{type:Function,required:!0}},data:function(){return{toggleCompleted:!1,dialog:!1,currentName:"n/a",currentUsing:"n/a",currentWithCheck:"n/a",currentPassStrategy:!1}},computed:{displayValue:function(){return this.rlsPolicy.name},rlsQualifierDisplayValueDisabled:function(){return!1},hidden:function(){return!1},btnDisabled:function(){return[ye,ge].indexOf(this.status)>-1}},watch:{},methods:{activate:function(){this.currentName=this.rlsPolicy.name,this.currentUsing=this.rlsPolicy.using,this.currentWithCheck=this.rlsPolicy.withCheck,this.currentPassStrategy=this.rlsPolicy.passStrategy}}},ke=xe,_e=(n("dbdb9"),n("67b6")),Ce=n("43a6"),Ne=Object(y["a"])(ke,ve,he,!1,null,null,null),Te=Ne.exports;x()(Ne,{VBtn:$["a"],VCard:q["a"],VCardActions:G["a"],VCardTitle:G["b"],VDialog:U["a"],VRadio:_e["a"],VRadioGroup:Ce["a"],VSpacer:L["a"],VTextField:B["a"]});var Se=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("v-btn",{attrs:{small:"",hidden:e.disabled},on:{click:function(t){return e.addRlsPolicy(e.item.roleName,e.action)}}},[e._v("Add Policy")]),e._l(e.item[e.action].policies,function(t){return n("rls-policy-dialog",{key:t.roleName+"-"+t.id,attrs:{action:e.action,roleName:e.item.roleName,rlsPolicy:t,status:"ENABLED",disableRlsPolicy:e.disableRlsPolicy,updateRlsPolicy:e.updateRlsPolicy,disabled:e.disabled}})}),e._l(e.impliedPolicies(e.item.roleName,e.action),function(t){return n("rls-policy-dialog",{key:t.roleName+"-"+t.id,attrs:{action:e.action,roleName:e.item.roleName,rlsPolicy:t,status:"IMPLIED",disableRlsPolicy:e.disableRlsPolicy,updateRlsPolicy:e.updateRlsPolicy,disabled:e.disabled}})})],2)},Ie=[],De={name:"PolicyRlsAction",components:{RlsPolicyDialog:Te},props:{policy:{type:Object,required:!0},action:{type:String,required:!0},item:{type:Object,required:!0},disabled:{type:Boolean,default:!1}},data:function(){return{}},watch:{},methods:{impliedPolicies:function(e,t){var n=this,a=this.projectRoles.find(function(t){return t.roleName===e}).applicableRoles.reduce(function(e,t){return e.concat(t.roleName)},[]).concat([e]),i=a.reduce(function(a,i){return i!==e?"all"===t?a.concat(n.policy.rlsQualifiers[i][t].policies):a.concat(n.policy.rlsQualifiers[i][t].policies).concat(n.policy.rlsQualifiers[i].all.policies):"all"===t?a:a.concat(n.policy.rlsQualifiers[i].all.policies)},[]);return i},addRlsPolicy:function(e,t){this.$store.commit("createRlsPolicy",{policyId:this.policy.id,roleName:e,action:t})},disableRlsPolicy:function(e,t,n){this.$store.commit("deleteRlsPolicy",{policyId:this.policy.id,roleName:e,action:t,rlsPolicyId:n})},updateRlsPolicy:function(e,t,n,a,i,r,l){var c=this.policy.rlsQualifiers[e][t].policies.filter(function(e){return e.id!==n}).concat([{id:n,using:a,withCheck:i,passStrategy:r,name:l}]),s=Object(o["a"])({},this.policy,{rlsQualifiers:Object(o["a"])({},this.policy.rlsQualifiers,Object(u["a"])({},e,Object(o["a"])({},this.policy.rlsQualifiers[e],Object(u["a"])({},t,{status:this.policy.rlsQualifiers[e][t].status,policies:c,using:a,withCheck:i,passStrategy:r}))))});this.$store.commit("savePolicy",{policy:s})}},computed:{projectRoles:function(){return this.$store.state.projectRoles}}},Ee=De,Pe=(n("c496"),Object(y["a"])(Ee,Se,Ie,!1,null,null,null)),Oe=Pe.exports;x()(Pe,{VBtn:$["a"],VContainer:X["a"]});var je="ENABLED",we="DISABLED",Re="IMPLIED",Ve={name:"PolicyRlsQualifierGrid",components:{RlsPolicyDialog:Te,TablePolicyRlsAction:Oe},props:{policy:{type:Object,required:!0},disabled:{type:Boolean,default:!1}},data:function(){return{toggleCompleted:!1,dialog:!1,currentUsing:"n/a",currentWithCheck:"n/a"}},watch:{},methods:{impliedPolicies:function(e,t){var n=this,a=this.projectRoles.find(function(t){return t.roleName===e}).applicableRoles.reduce(function(e,t){return e.concat(t.roleName)},[]).concat([e]),i=a.reduce(function(a,i){return i!==e?"all"===t?a.concat(n.policy.rlsQualifiers[i][t].policies):a.concat(n.policy.rlsQualifiers[i][t].policies).concat(n.policy.rlsQualifiers[i].all.policies):"all"===t?a:a.concat(n.policy.rlsQualifiers[i].all.policies)},[]);return i},addRlsPolicy:function(e,t){this.$store.commit("createRlsPolicy",{policyId:this.policy.id,roleName:e,action:t})},disableRlsPolicy:function(e,t,n){this.$store.commit("deleteRlsPolicy",{policyId:this.policy.id,roleName:e,action:t,rlsPolicyId:n})},updateRlsPolicy:function(e,t,n,a,i,r,l){var c=this.policy.rlsQualifiers[e][t].policies.filter(function(e){return e.id!==n}).concat([{id:n,using:a,withCheck:i,passStrategy:r,name:l}]),s=Object(o["a"])({},this.policy,{rlsQualifiers:Object(o["a"])({},this.policy.rlsQualifiers,Object(u["a"])({},e,Object(o["a"])({},this.policy.rlsQualifiers[e],Object(u["a"])({},t,{status:this.policy.rlsQualifiers[e][t].status,policies:c,using:a,withCheck:i,passStrategy:r}))))});this.$store.commit("savePolicy",{policy:s})},rlsQualifierCheckLabel:function(e,t){switch(e[t].status){case je:return"Add Policy";case we:return"Enable";case Re:return"Add Policy"}}},computed:{projectRoles:function(){return this.$store.state.projectRoles},defaultRLSQual:function(){return this.$store.state.defaultRLSQual},rlsQualifierMatrix:function(){var e=this;return m()(this.policy.rlsQualifiers).map(function(t){return Object(o["a"])({},e.policy.rlsQualifiers[t],{roleName:t})})},headers:function(){return[{text:"Role Name",sortable:!1,value:"roleName"},{text:"ALL",sortable:!1,value:"all"},{text:"SELECT",sortable:!1,value:"select"},{text:"INSERT",sortable:!1,value:"insert"},{text:"UPDATE",sortable:!1,value:"update"},{text:"DELETE",sortable:!1,value:"delete"}]}}},Fe=Ve,Ae=(n("065f"),Object(y["a"])(Fe,pe,be,!1,null,null,null)),$e=Ae.exports;x()(Ae,{VDataTable:_["a"]});var qe=n("96b5"),Ge=n("bd5a"),Ue=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-dialog",{attrs:{persistent:"",width:"800"},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[n("v-btn",e._g({staticClass:"text-none",attrs:{small:"",dark:"",disabled:e.disabled}},a),[e._v("\n        "+e._s(e.displayValue)+"\n      ")])]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[n("v-card",[n("v-card-title",{staticClass:"headline"},[e._v("Make Custom Policy Available Globally")]),n("v-text-field",{model:{value:e.customName,callback:function(t){e.customName=t},expression:"customName"}}),n("v-card-actions",[n("v-spacer"),n("v-btn",{on:{click:function(t){e.dialog=!1}}},[e._v("Cancel")]),n("v-btn",{on:{click:e.makeGlobal}},[e._v("Make Global")]),n("v-spacer")],1)],1)],1)],1)},Le=[],Be={name:"TablePolicyMakeGlobalDialog",props:{policyDefinition:{type:Object,required:!0},disabled:{type:Boolean,default:!1}},data:function(){return{dialog:!1,customName:"New Table Policy"}},computed:{displayValue:function(){return"Make Global"}},watch:{},methods:{makeGlobal:function(){this.dialog=!1;try{this.$store.commit("makeGlobalTablePolicy",{policyDefinitionId:this.policyDefinition.id,newFields:{name:this.customName}})}catch(e){alert(e.toString()),console.error(e)}}}},Me=Be,ze=(n("cfbf"),Object(y["a"])(Me,Ue,Le,!1,null,null,null)),Qe=ze.exports;x()(ze,{VBtn:$["a"],VCard:q["a"],VCardActions:G["a"],VCardTitle:G["b"],VDialog:U["a"],VSpacer:L["a"],VTextField:B["a"]});var Ke=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-dialog",{attrs:{persistent:"",width:"800"},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[n("v-btn",e._g({staticClass:"text-none",attrs:{small:"",dark:"",disabled:e.disabled}},a),[e._v("\n        "+e._s(e.displayValue)+"\n      ")])]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[n("v-card",[n("v-card-title",{staticClass:"headline"},[e._v("Delete Policy")]),n("h1",[e._v("Are you sure you want to delete this policy?")]),n("h2",[e._v("Any tables currently assigned this policy will revert to:")]),n("h2",[e._v("Default Policy - NO ACCESS")]),n("v-card-actions",[n("v-spacer"),n("v-btn",{on:{click:function(t){e.dialog=!1}}},[e._v("Cancel")]),n("v-btn",{attrs:{disabled:e.deleteDisabled},on:{click:e.deleteTablePolicyDefinition}},[e._v("Delete")]),n("v-spacer")],1)],1)],1)],1)},We=[],He={name:"TablePolicyDeleteDialog",props:{policyDefinition:{type:Object,required:!0},disabled:{type:Boolean,default:!1}},mounted:function(){},data:function(){return{dialog:!1}},computed:{displayValue:function(){return"Delete"},allPolicyDefinitions:function(){return this.$store.state.policies.filter(function(e){return!e.customIdentifier})},deleteDisabled:function(){return!1}},watch:{},methods:{deleteTablePolicyDefinition:function(){this.dialog=!1,this.$store.commit("deleteTablePolicy",{policyDefinitionId:this.policyDefinition.id})}}},Xe=He,Ye=(n("fb68"),Object(y["a"])(Xe,Ke,We,!1,null,null,null)),Je=Ye.exports;x()(Ye,{VBtn:$["a"],VCard:q["a"],VCardActions:G["a"],VCardTitle:G["b"],VDialog:U["a"],VSpacer:L["a"]});var Ze=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("v-textarea",{attrs:{value:e.tablePolicyEval,"auto-grow":"","hide-details":"","background-color":"black",disabled:""}}),n("v-data-table",{attrs:{headers:e.headers,items:e.tablePolicyEvaluationItems,"hide-default-footer":"","item-key":"id"},scopedSlots:e._u([{key:"items",fn:function(t){return[n("tr",[n("td",[e._v("\n          "+e._s(t.item.roleName)+"\n        ")]),n("td",[e._v("\n          "+e._s(t.item.action)+"\n        ")]),n("td",[e._v("\n          "+e._s(t.item.status)+"\n        ")])])]}}])})],1)},et=[],tt=n("f499"),nt=n.n(tt),at=n("e002"),it={name:"TablePolicyEvaluatorDetail",mixins:[at["a"]],props:{},mounted:function(){},data:function(){return{headers:[{text:"roleName",sortable:!1},{text:"action",sortable:!1},{text:"status",sortable:!1}]}},computed:{tablePolicyEval:function(){return nt()(this.tablePolicyEvaluation,0,2)},tablePolicyEvaluationItems:function(){var e=this;return m()(this.tablePolicyEvaluation).reduce(function(t,n){return[].concat(Object(I["a"])(t),Object(I["a"])(e.tablePolicyEvaluation[n].map(function(e){return Object(o["a"])({},e,{id:"".concat(e.roleName,"-").concat(e.action),status:n})})))},[])}}},ot=it,rt=(n("7b59"),n("a844")),lt=Object(y["a"])(ot,Ze,et,!1,null,null,null),ct=lt.exports;x()(lt,{VContainer:X["a"],VDataTable:_["a"],VTextarea:rt["a"]});var st={name:"PolicyDefinition",components:{PolicyRlsQualifierGrid:$e,PolicyRealization:qe["a"],TablePolicyCustomizeDialog:Ge["a"],TablePolicyMakeGlobalDialog:Qe,TablePolicyDeleteDialog:Je,TablePolicyEvaluatorDetail:ct,TablePolicyDefinitionGrants:fe},props:{policyId:{type:Number,required:!0},table:{type:Object,required:!1}},data:function(){return{enableRls:!0,policyStructure:[],calculatedPolicy:"NOT CALCULATED",toggleCompleted:!1,activeTab:null}},mounted:function(){this.enableRls=this.policyDefinition.enableRls},watch:{policyDefinition:function(){this.enableRls=this.policyDefinition.enableRls},enableRls:function(){this.$store.commit("savePolicy",{policy:Object(o["a"])({},this.policyDefinition,{enableRls:this.enableRls})}),this.enableRls||1!==this.activeTab||(this.activeTab=0)}},methods:{customize:function(){"".concat(this.table.name," Custom Policy")}},computed:{showDeleteButton:function(){return this.policyDefinition.id!==this.$store.state.defaultPolicy.id},showMakeGlobalButton:function(){return void 0!==this.policyDefinition.customIdentifier&&null!==this.policyDefinition.customIdentifier},showCustomizeButton:function(){return!!this.table&&!this.policyDefinition.customIdentifier},disabled:function(){var e=this.policyDefinition.id===this.$store.state.defaultPolicy.id,t=null!==this.table&&void 0!==this.table,n=!!this.policyDefinition.customIdentifier;return!!e||!!t&&!n},policyDefinition:function(){var e=this,t=(this.$store.state.policies,this.$store.state.policies.find(function(t){return t.id===e.policyId}));return t},title:function(){return"Policy Name: ".concat(this.policyDefinition.name)}}},ut=st,dt=n("71d9"),mt=Object(y["a"])(ut,a,i,!1,null,null,null);t["a"]=mt.exports;x()(mt,{VCard:q["a"],VContainer:X["a"],VSpacer:L["a"],VSwitch:ee["a"],VTab:se["a"],VTabItem:ue["a"],VTabs:de["a"],VToolbar:dt["a"]})},"89d6":function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[e.showToolbar?n("v-toolbar",[n("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[n("v-btn",e._g({directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:e.scriptText,expression:"scriptText",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:e.onCopy,expression:"onCopy",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:e.onError,expression:"onError",arg:"error"}]},a),[n("v-icon",[e._v("file_copy")]),e._v("Copy\n      ")],1)]}}],null,!1,1252371525)},[n("span",[e._v("Copy")])]),n("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[n("v-btn",e._g({attrs:{disabled:""},on:{click:e.executeSql}},a),[n("v-icon",[e._v("arrow_forward")]),e._v("Execute")],1)]}}],null,!1,484692131)},[n("span",[e._v("Execute")])]),n("v-spacer"),n("v-container",{attrs:{fluid:""}},[n("v-row",[n("v-spacer"),n("v-spacer"),e.showReadability?n("v-layout",[n("label",{staticClass:"v-label theme--dark",attrs:{"mt-2":""}},[e._v("terseÂ ")]),n("v-switch",{attrs:{"true-value":"verbose","false-value":"terse",label:"verbose"},model:{value:e.readability,callback:function(t){e.readability=t},expression:"readability"}})],1):e._e(),e.showDeclarationVisibility?n("v-layout",[n("label",{staticClass:"v-label theme--dark",attrs:{"mt-2":""}},[e._v("show declaration:Â ")]),n("v-switch",{attrs:{"true-value":"hide","false-value":"show",label:"hide"},model:{value:e.declarationVisibility,callback:function(t){e.declarationVisibility=t},expression:"declarationVisibility"}})],1):e._e()],1)],1)],1):e._e(),n("v-textarea",{attrs:{disabled:!0,value:e.formatScript(e.scriptText),"auto-grow":"",spellcheck:"false","background-color":"black"}})],1)},i=[],o=(n("28a5"),{name:"ScriptViewer",components:{},props:{scriptText:{type:String,required:!1},showReadability:{type:Boolean,default:!0},showDeclarationVisibility:{type:Boolean,default:!1},showToolbar:{type:Boolean,default:!0},skipFormat:{type:Boolean,default:!1}},computed:{},watch:{readability:function(){this.$emit("readability-changed",this.readability)},declarationVisibility:function(){this.$emit("declaration-visibility-changed",this.declarationVisibility)}},methods:{formatScript:function(e){return this.skipFormat?e:(e||"").toLowerCase().split(" exists").join(" exists\n  ").split(" on").join("\non").split(" using").join("\nusing").split(" (").join(" (\n  ").split(",").join("\n  ,").split(");").join("\n);")},handleCopyStatus:function(e){alert(e)},onCopy:function(){alert("Copied!")},onError:function(e){alert("Failed to copy script to clipboard"),console.error(e)},executeSql:function(){alert("not implemented:  server config value will expose graphile extension to execute generated script")}},data:function(){return{allPolicies:[],schemaPolicy:"NOT CALCULATED",defaultRlsPolicies:"NOT CALCULATED",defaultNoRlsPolicies:"NOT CALCULATED",selectedTabName:"",readability:"terse",declarationVisibility:"show"}}}),r=o,l=n("2877"),c=n("6544"),s=n.n(c),u=n("8336"),d=n("a523"),m=n("132d"),f=n("a722"),p=n("0fd9"),b=n("2fa4"),v=n("b73d"),h=n("a844"),y=n("71d9"),g=n("3a2f"),x=Object(l["a"])(r,a,i,!1,null,null,null);t["a"]=x.exports;s()(x,{VBtn:u["a"],VContainer:d["a"],VIcon:m["a"],VLayout:f["a"],VRow:p["a"],VSpacer:b["a"],VSwitch:v["a"],VTextarea:h["a"],VToolbar:y["a"],VTooltip:g["a"]})},"8bda":function(e,t,n){},9:function(e,t){},"90d0":function(e,t,n){},9270:function(e,t,n){},9498:function(e,t,n){"use strict";var a=n("9270"),i=n.n(a);i.a},"95fb":function(e,t,n){"use strict";(function(e){n("55dd"),n("6b54");var a=n("861c");t["a"]={name:"PolicyManager",components:{PolicyDefinition:a["a"]},methods:{saveNewPolicy:function(){try{this.$store.commit("newPolicy",{name:this.newPolicyName})}catch(e){alert(e.toString()),console.error(e)}this.dialog=!1}},computed:{policies:function(){return this.$store.state.policies.sort(function(e,t){return e.id<t.id?-1:1})}},data:function(){return{dialog:!1,newPolicyName:"New Table Policy",headers:[{text:""},{text:"ID",sortable:!1,value:"id"},{text:"Name",sortable:!1,value:"name"}]}},mounted:function(){e.client&&window&&(window.history.scrollRestoration="auto")}}}).call(this,n("4362"))},"96b5":function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("script-viewer",{attrs:{scriptText:e.computedPolicy,skipFormat:""},on:{"readability-changed":e.policyReadabilityChanged}})],1)},i=[],o=n("ee5d"),r=n("89d6"),l=n("4eb5"),c=n.n(l),s={name:"TablePolicyRealization",mixins:[o["a"],c.a],components:{ScriptViewer:r["a"]},props:{policyDefinition:{type:Object,required:!0},table:{type:Object,required:!1},enableRls:{type:Boolean,required:!1}},data:function(){return{policyStructure:[],policyReadability:"terse",computedPolicy:"N/A"}},mounted:function(){this.doComputePolicy()},watch:{policyReadability:function(){this.doComputePolicy()},enableRls:function(){this.doComputePolicy()},policyDefinition:function(){this.doComputePolicy()}},methods:{policyReadabilityChanged:function(e){this.policyReadability=e},refresh:function(){this.doComputePolicy()},expand:function(){this.computedPolicy="".concat(this.computedPolicy," ")},doComputePolicy:function(){var e=null;this.table&&(e={schemaName:this.table.tableSchema,tableName:this.table.tableName}),this.computedPolicy=this.computePolicy(this.policyDefinition,this.policyReadability,e,this.table)},onCopy:function(e){alert("Copied!")},onError:function(e){alert("Failed to copy texts")},executeSql:function(){alert("not implemented:  server config value will expose graphile extension to execute generated script")}},computed:{}},u=s,d=n("2877"),m=n("6544"),f=n.n(m),p=n("a523"),b=Object(d["a"])(u,a,i,!1,null,null,null);t["a"]=b.exports;f()(b,{VContainer:p["a"]})},9849:function(e,t,n){"use strict";var a=n("b4ca"),i=n.n(a);i.a},"9e46":function(e,t,n){},a789:function(e,t,n){"use strict";var a=n("3b45"),i=n.n(a);i.a},ab3b:function(e,t){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"SearchFunctions"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"searchTerm"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"searchFunctions"},arguments:[{kind:"Argument",name:{kind:"Name",value:"searchTerm"},value:{kind:"Variable",name:{kind:"Name",value:"searchTerm"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"functionName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"functionSchema"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"resultDataType"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"argumentDataTypes"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"definition"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:201}};n.loc.source={body:"mutation SearchFunctions(\n  $searchTerm: String!\n){\n  searchFunctions(searchTerm: $searchTerm) {\n    id\n    functionName\n    functionSchema\n    resultDataType\n    argumentDataTypes\n    definition\n  }\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};function a(e,t){if("FragmentSpread"===e.kind)t.add(e.name.value);else if("VariableDefinition"===e.kind){var n=e.type;"NamedType"===n.kind&&t.add(n.name.value)}e.selectionSet&&e.selectionSet.selections.forEach(function(e){a(e,t)}),e.variableDefinitions&&e.variableDefinitions.forEach(function(e){a(e,t)}),e.definitions&&e.definitions.forEach(function(e){a(e,t)})}var i={};function o(e,t){for(var n=0;n<e.definitions.length;n++){var a=e.definitions[n];if(a.name&&a.name.value==t)return a}}function r(e,t){var n={kind:e.kind,definitions:[o(e,t)]};e.hasOwnProperty("loc")&&(n.loc=e.loc);var a=i[t]||new Set,r=new Set,l=new Set;a.forEach(function(e){l.add(e)});while(l.size>0){var c=l;l=new Set,c.forEach(function(e){if(!r.has(e)){r.add(e);var t=i[e]||new Set;t.forEach(function(e){l.add(e)})}})}return r.forEach(function(t){var a=o(e,t);a&&n.definitions.push(a)}),n}(function(){n.definitions.forEach(function(e){if(e.name){var t=new Set;a(e,t),i[e.name.value]=t}})})(),e.exports=n,e.exports["SearchFunctions"]=r(n,"SearchFunctions")},b450:function(e,t,n){},b4ca:function(e,t,n){},bd5a:function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-dialog",{attrs:{persistent:"",width:"800"},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[n("v-btn",e._g({staticClass:"text-none",attrs:{small:"",dark:"",disabled:e.disabled}},a),[e._v("\n        "+e._s(e.displayValue)+"\n      ")])]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[n("v-card",[n("v-card-title",{staticClass:"headline"},[e._v("Custom Policy")]),n("v-text-field",{model:{value:e.customName,callback:function(t){e.customName=t},expression:"customName"}}),n("v-card-actions",[n("v-spacer"),n("v-btn",{on:{click:function(t){e.dialog=!1}}},[e._v("Cancel")]),n("v-btn",{on:{click:e.customizeTablePolicyDefinition}},[e._v("Customize")]),n("v-spacer")],1)],1)],1)],1)},i=[],o={name:"PolicyCustomizeDialog",props:{currentPolicyDefinition:{type:Object,required:!0},tables:{type:Array,required:!0},bulkCustomize:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},mounted:function(){this.customName=this.defaultCustomName},data:function(){return{dialog:!1,customName:"n/a"}},computed:{displayValue:function(){return this.bulkCustomize?"Bulk Customize":"Customize"},defaultCustomName:function(){return 1===this.tables.length?"Custom Policy: ".concat(this.tables[0].tableSchema,".").concat(this.tables[0].tableName):this.tables.length>1?"New Bulk Policy":"n/a"}},watch:{},methods:{customizeTablePolicyDefinition:function(){this.dialog=!1;var e=this.tables.reduce(function(e,t){return e.concat([t.id])},[]);this.$store.commit("customizeTablePolicy",{sourcePolicyDefinitionId:this.currentPolicyDefinition.id,tableIds:e,newFields:{name:this.customName}})}}},r=o,l=(n("0134"),n("2877")),c=n("6544"),s=n.n(c),u=n("8336"),d=n("b0af"),m=n("99d9"),f=n("169a"),p=n("2fa4"),b=n("8654"),v=Object(l["a"])(r,a,i,!1,null,null,null);t["a"]=v.exports;s()(v,{VBtn:u["a"],VCard:d["a"],VCardActions:m["a"],VCardTitle:m["b"],VDialog:f["a"],VSpacer:p["a"],VTextField:b["a"]})},bd75:function(e,t,n){},c2d7:function(e,t,n){"use strict";var a=n("fe5d"),i=n.n(a);i.a},c496:function(e,t,n){"use strict";var a=n("bd75"),i=n.n(a);i.a},cb8a:function(e,t,n){"use strict";var a=n("3754"),i=n.n(a);i.a},cfbf:function(e,t,n){"use strict";var a=n("015f"),i=n.n(a);i.a},da37:function(e,t,n){},dbdb9:function(e,t,n){"use strict";var a=n("f010"),i=n.n(a);i.a},e002:function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div")},i=[],o=n("75fc"),r=n("cebc"),l=(n("7514"),n("a4bb")),c=n.n(l),s="ALLOWED",u="DENIED",d="IMPLIED",m={name:"TablePolicyEvaluatorCalculator",props:{policyDefinition:{type:Object,required:!0},table:{type:Object,required:!0}},mounted:function(){},data:function(){return{}},computed:{grantStatusColors:function(){return{expected:"green",missing:"yellow",unexpected:"red",extra:"blue"}},tablePolicyEvaluation:function(){var e=this,t=this.$store.state.ignoredRoles.map(function(e){return e.roleName}),n=c()(this.policyDefinition.roleGrants).reduce(function(n,a){return c()(e.policyDefinition.roleGrants[a]).filter(function(e){return-1===t.indexOf(e)}).reduce(function(t,n){var i=e.policyDefinition.roleGrants[a][n],l=e.table.roleTableGrants.find(function(e){return e.grantee===a&&e.privilegeType===n.toUpperCase()});switch(i){case s:return l?Object(r["a"])({},t,{expected:[].concat(Object(o["a"])(t.expected),[Object(r["a"])({},l,{statusColor:e.grantStatusColors.expected})])}):Object(r["a"])({},t,{missing:[].concat(Object(o["a"])(t.missing),[{roleName:a,expectedRoleAction:i,action:n,statusColor:e.grantStatusColors.missing}])});case u:return l?Object(r["a"])({},t,{unexpected:[].concat(Object(o["a"])(t.unexpected),[Object(r["a"])({},l,{statusColor:e.grantStatusColors.unexpected})])}):t;case d:return l?Object(r["a"])({},t,{extra:[].concat(Object(o["a"])(t.extra),[Object(r["a"])({},l,{statusColor:e.grantStatusColors.extra})])}):t}},n)},{expected:[],missing:[],extra:[],unexpected:[]});return n}},watch:{},methods:{}},f=m,p=(n("9498"),n("2877")),b=Object(p["a"])(f,a,i,!1,null,null,null);t["a"]=b.exports},ee5d:function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div")},i=[],o=(n("7f7f"),n("cebc")),r=n("75fc"),l=n("a4bb"),c=n.n(l),s=n("9dbb"),u=n.n(s),d="ALLOWED",m="DENIED",f="IMPLIED",p="terse",b={name:"PolicyComputerMixin",computed:{projectRoles:function(){return this.$store.state.projectRoles}},methods:{computePolicy:function(e,t,n,a){var i=c()(e.roleGrants).map(function(e){return{roleName:e}}),l="".concat(i.map(function(e){return e.roleName}).join(", ")),s=c()(e.roleGrants).reduce(function(t,n){var i=c()(e.roleGrants[n]).reduce(function(t,a){return e.roleGrants[n][a]===d?t+1:t},0),o=c()(e.roleGrants[n]).map(function(t,o,r){switch(t){case"insert":case"update":var l=e.columnExclusions[t][n]||[],c=l.length>0?"\n        -- excluded columns: ".concat(l.join(", ")):"\n        -- no excluded columns",s=a?"( ".concat(a.tableColumns.map(function(e){return e.columnName}).filter(function(e){return-1===l.indexOf(e)}).join(", ")," )"):"{{grantColumns}}",u=e.columnExclusionOverrides[t].indexOf(n)>-1,m=l.length>0||u?d:e.roleGrants[n][t];return{action:t,value:m,grantColumns:s,columnExclusionsText:c,comma:o<i-1?",":""};default:return{action:t,value:e.roleGrants[n][t],grantColumns:"",comma:o<i-1?",":""}}});return[].concat(Object(r["a"])(t),[{roleName:n,grants:o}])},[]),b=s.map(function(e,t,n){return Object(o["a"])({},e,{grants:e.grants.filter(function(e){return e.value===d})})}).filter(function(e){return e.grants.length>0}),h=s.map(function(e){return Object(o["a"])({},e,{grants:e.grants.filter(function(e){return e.value===m})})}).filter(function(e){return e.grants.length>0}),y=s.map(function(e){return Object(o["a"])({},e,{grants:e.grants.filter(function(e){return e.value===f})})}).filter(function(e){return e.grants.length>0}),g=c()(e.rlsQualifiers).reduce(function(t,n){return t.concat(c()(e.rlsQualifiers[n]).reduce(function(t,a){return[].concat(Object(r["a"])(t),Object(r["a"])(e.rlsQualifiers[n][a].policies.map(function(e){return Object(o["a"])({},e,{action:a,roleName:n})})))},[]))},[]),x={verbose:!0,deniedRoleGrants:h,impliedRoleGrants:y},k=Object(o["a"])({},n,{policyName:e.name,enableRls:e.enableRls,allowedRoleGrants:b,rlsPolicies:g,revokeRolesList:l,tableName:(a||{}).tableName}),_=t===p?k:Object(o["a"])({},x,k);return u.a.render(v,_)}}},v="\n----------\n----------  BEGIN TABLE POLICY: {{schemaName}}{{^schemaName}}{{=<% %>=}}{{schemaName}}<%={{ }}=%>{{/schemaName}}.{{tableName}}{{^tableName}}{{=<% %>=}}{{tableName}}<%={{ }}=%>{{/tableName}}\n----------  POLICY NAME:  {{policyName}}\n----------\n\n----------  REMOVE EXISTING TABLE GRANTS\n\n  revoke all privileges \n  on table {{schemaName}}{{^schemaName}}{{=<% %>=}}{{schemaName}}<%={{ }}=%>{{/schemaName}}.{{tableName}}{{^tableName}}{{=<% %>=}}{{tableName}}<%={{ }}=%>{{/tableName}} \n  from public;\n\n  revoke all privileges \n  on table {{schemaName}}{{^schemaName}}{{=<% %>=}}{{schemaName}}<%={{ }}=%>{{/schemaName}}.{{tableName}}{{^tableName}}{{=<% %>=}}{{tableName}}<%={{ }}=%>{{/tableName}} \n  from {{revokeRolesList}};\n\n{{#enableRls}}\n----------  ENABLE ROW LEVEL SECURITY\n\n  alter table {{schemaName}}{{^schemaName}}{{=<% %>=}}{{schemaName}}<%={{ }}=%>{{/schemaName}}.{{tableName}}{{^tableName}}{{=<% %>=}}{{tableName}}<%={{ }}=%>{{/tableName}} enable row level security;\n\n{{#rlsPolicies}}\n  create policy {{name}}_{{schemaName}}{{^schemaName}}{{=<% %>=}}{{schemaName}}<%={{ }}=%>{{/schemaName}}_{{tableName}}{{^tableName}}{{=<% %>=}}{{tableName}}<%={{ }}=%>{{/tableName}} \n    on {{schemaName}}{{^schemaName}}{{=<% %>=}}{{schemaName}}<%={{ }}=%>{{/schemaName}}.{{tableName}}{{^tableName}}{{=<% %>=}}{{tableName}}<%={{ }}=%>{{/tableName}}\n    as {{passStrategy}}\n    for {{action}}\n    to {{roleName}}\n    using {{{using}}}\n    {{#withCheck}}\n    with check {{withCheck}}\n    {{/withCheck}}\n    ;\n{{/rlsPolicies}}\n\n{{/enableRls}}\n{{^enableRls}}\n----------  DISABLE ROW LEVEL SECURITY\n\n  alter table {{schemaName}}{{^schemaName}}{{=<% %>=}}{{schemaName}}<%={{ }}=%>{{/schemaName}}.{{tableName}}{{^tableName}}{{=<% %>=}}{{tableName}}<%={{ }}=%>{{/tableName}} disable row level security;\n{{/enableRls}}\n\n----------  CREATE NEW TABLE GRANTS\n{{#allowedRoleGrants}}\n\n----------  {{roleName}}\n  grant \n  {{#grants}}\n    {{action}} {{grantColumns}}{{comma}} {{columnExclusionsText}}\n  {{/grants}}\n  on table {{schemaName}}{{^schemaName}}{{=<% %>=}}{{schemaName}}<%={{ }}=%>{{/schemaName}}.{{tableName}}{{^tableName}}{{=<% %>=}}{{tableName}}<%={{ }}=%>{{/tableName}} \n  to {{roleName}};\n\n{{/allowedRoleGrants}}\n\n{{#verbose}}\n----------  IMPLIED TABLE GRANTS\n  {{#impliedRoleGrants}}\n\n  ----------  {{roleName}}\n  {{#grants}}\n  --IMPLIED:   grant {{action}} on table {{schemaName}}{{^schemaName}}{{=<% %>=}}{{schemaName}}<%={{ }}=%>{{/schemaName}}.{{tableName}}{{^tableName}}{{=<% %>=}}{{tableName}}<%={{ }}=%>{{/tableName}} to {{roleName}};\n  {{/grants}}\n  {{/impliedRoleGrants}}\n\n  ----------  DENIED TABLE GRANTS\n  {{#deniedRoleGrants}}\n\n  ----------  {{roleName}}\n  {{#grants}}\n  --DENIED:   grant {{action}} on table {{schemaName}}{{^schemaName}}{{=<% %>=}}{{schemaName}}<%={{ }}=%>{{/schemaName}}.{{tableName}}{{^tableName}}{{=<% %>=}}{{tableName}}<%={{ }}=%>{{/tableName}} to {{roleName}};\n  {{/grants}}\n  {{/deniedRoleGrants}}\n{{/verbose}}\n\n----------  END TABLE POLICY: {{schemaName}}{{^schemaName}}{{=<% %>=}}{{schemaName}}<%={{ }}=%>{{/schemaName}}.{{tableName}}{{^tableName}}{{=<% %>=}}{{tableName}}<%={{ }}=%>{{/tableName}}\n--==",h=b,y=n("2877"),g=Object(y["a"])(h,a,i,!1,null,null,null);t["a"]=g.exports},f010:function(e,t,n){},fb68:function(e,t,n){"use strict";var a=n("90d0"),i=n.n(a);i.a},fe5d:function(e,t,n){}});
//# sourceMappingURL=app.fbba8978.js.map