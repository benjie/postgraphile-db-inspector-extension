(function(e){function t(t){for(var i,o,s=t[0],r=t[1],c=t[2],d=0,m=[];d<s.length;d++)o=s[d],Object.prototype.hasOwnProperty.call(n,o)&&n[o]&&m.push(n[o][0]),n[o]=0;for(i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i]);u&&u(t);while(m.length)m.shift()();return l.push.apply(l,c||[]),a()}function a(){for(var e,t=0;t<l.length;t++){for(var a=l[t],i=!0,o=1;o<a.length;o++){var r=a[o];0!==n[r]&&(i=!1)}i&&(l.splice(t--,1),e=s(s.s=a[0]))}return e}var i={},n={app:0},l=[];function o(e){return s.p+"js/"+({about:"about",pdfjsWorker:"pdfjsWorker"}[e]||e)+"."+{about:"5bee4903",pdfjsWorker:"157d1873"}[e]+".js"}function s(t){if(i[t])return i[t].exports;var a=i[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.e=function(e){var t=[],a=n[e];if(0!==a)if(a)t.push(a[2]);else{var i=new Promise((function(t,i){a=n[e]=[t,i]}));t.push(a[2]=i);var l,r=document.createElement("script");r.charset="utf-8",r.timeout=120,s.nc&&r.setAttribute("nonce",s.nc),r.src=o(e);var c=new Error;l=function(t){r.onerror=r.onload=null,clearTimeout(d);var a=n[e];if(0!==a){if(a){var i=t&&("load"===t.type?"missing":t.type),l=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+i+": "+l+")",c.name="ChunkLoadError",c.type=i,c.request=l,a[1](c)}n[e]=void 0}};var d=setTimeout((function(){l({type:"timeout",target:r})}),12e4);r.onerror=r.onload=l,document.head.appendChild(r)}return Promise.all(t)},s.m=e,s.c=i,s.d=function(e,t,a){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)s.d(a,i,function(t){return e[t]}.bind(null,i));return a},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/pgdbi/",s.oe=function(e){throw console.error(e),e};var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=t,r=r.slice();for(var d=0;d<r.length;d++)t(r[d]);var u=c;l.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"0100":function(e,t,a){"use strict";var i=a("9dbb"),n=a.n(i);const l="terse";function o(e,t,a,i){const o=Object.keys(e.roleFunctionGrants).map(e=>({roleName:e})),r=""+o.map(e=>e.roleName).join(", "),c=Object.keys(e.roleFunctionGrants).reduce((t,a)=>"ALLOWED"===e.roleFunctionGrants[a].execute?t.concat([{roleName:a}]):t,[]),d=Object.keys(e.roleFunctionGrants).reduce((t,a)=>"IMPLIED"===e.roleFunctionGrants[a].execute?t.concat([{roleName:a}]):t,[]),u=Object.keys(e.roleFunctionGrants).reduce((t,a)=>"DENIED"===e.roleFunctionGrants[a].execute?t.concat([{roleName:a}]):t,[]),m={verbose:!0,deniedRoleGrants:u,impliedRoleGrants:d},p=i?i.argumentDataTypes.split(",").map(e=>e.replace("timestamp with time zone","timestamptz")).map(e=>e.trim().split(" ")[1]).join(","):void 0,h={...a,policyName:e.name,allowedRoleGrants:c,revokeRolesList:r,functionSignature:i?`${i.functionSchema}.${i.functionName} (${p})`:"{{schemaName}}.{{functionName}} ({{signatureArgumentDataTypes}})"},f=t===l?h:{...m,...h};return n.a.render(s,f)}t["a"]=o;const s="\n----------\n----------  BEGIN FUNCTION POLICY: {{functionSignature}}\n----------  POLICY NAME:  {{policyName}}\n----------\n\n----------  REMOVE EXISTING FUNCTION GRANTS\n\n  revoke all privileges \n  on function {{functionSignature}} \n  from public;\n\n  revoke all privileges \n  on function {{functionSignature}} \n  from {{revokeRolesList}};\n\n----------  CREATE NEW FUNCTION GRANTS\n{{#allowedRoleGrants}}\n\n----------  {{roleName}}\n  grant \n  execute\n  on function {{functionSignature}} \n  to {{roleName}};\n\n{{/allowedRoleGrants}}\n{{#verbose}}\n----------  IMPLIED FUNCTION GRANTS\n  {{#impliedRoleGrants}}\n  --IMPLIED:   grant execute on function {{functionSignature}} to {{roleName}};\n  {{/impliedRoleGrants}}\n\n  ----------  DENIED TABLE GRANTS\n  {{#deniedRoleGrants}}\n  --DENIED:   grant execute on function {{functionSignature}} to {{roleName}};\n  {{/deniedRoleGrants}}\n{{/verbose}}\n----------  END FUNCTION POLICY: {{functionSignature}}\n--==\n\n"},"0134":function(e,t,a){"use strict";var i=a("1375"),n=a.n(i);n.a},"059b":function(e,t,a){},"0646":function(e,t,a){},"065f":function(e,t,a){"use strict";var i=a("b5bc"),n=a.n(i);n.a},"0a03":function(e,t,a){},"0cf9":function(e,t,a){},1:function(e,t){},"115f":function(e,t,a){"use strict";var i=a("270b"),n=a.n(i);n.a},1365:function(e,t,a){"use strict";(function(e){var i=a("861c");t["a"]={name:"PolicyManager",components:{PolicyDefinition:i["a"]},methods:{saveNewPolicy(){try{this.$store.commit("newPolicy",{name:this.newPolicyName})}catch(e){alert(e.toString()),console.error(e)}this.dialog=!1}},computed:{policies(){return this.$store.state.policies.sort((function(e,t){return e.id<t.id?-1:1}))}},data(){return{dialog:!1,newPolicyName:"New Table Policy",headers:[{text:""},{text:"ID",sortable:!1,value:"id"},{text:"Name",sortable:!1,value:"name"}]}},mounted(){e.client&&window&&(window.history.scrollRestoration="auto")}}}).call(this,a("f28c"))},1375:function(e,t,a){},2:function(e,t){},"243e":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("h1",[e._v(e._s(e.id))]),a("hr"),a("script-viewer",{attrs:{scriptText:e.definition,showDeclarationVisibility:!1,showReadability:!1,skipFormat:""},on:{"declaration-visibility-changed":e.declarationVisibilityChanged}})],1)},n=[],l=a("89d6"),o={name:"Function",components:{ScriptViewer:l["a"]},props:{id:{type:String,required:!0},context:{type:String,default:"default"}},computed:{definition(){const e={default:this.rawFunction,trigger:this.triggerFunction};return e[this.context]},rawFunction(){return this.fn.definition},modifiedFunction(){const e=this.fn.definition.split("$function$")[0],t=this.fn.definition.split("$function$")[1],a=e.split("\n").map(e=>"-- "+e).join("\n");return`${a} $function$${t} -- $function$\n`},triggerFunction(){const e=this.fn.definition.split("$function$")[1];return e},functionName(){return this.fn.functionName},functionSchema(){return this.fn.functionSchema}},data:()=>({fn:{definition:""},declarationVisibility:"show"}),methods:{declarationVisibilityChanged(e){this.declarationVisibility=e},onCopy:function(e){alert("Copied!")},onError:function(e){alert("Failed to copy texts")},setFn(){const e=this.id.split(".")[0],t=(this.id.split(".")[1].split("--")[0],this.$store.state.managedSchemata.find(t=>t.schemaName===e));this.fn=t.schemaFunctions.find(e=>e.id===this.id)}},mounted(){this.setFn()},beforeRouteUpdate(e,t,a){this.setFn(),a()}},s=o,r=a("2877"),c=a("6544"),d=a.n(c),u=a("a523"),m=Object(r["a"])(s,i,n,!1,null,null,null);t["a"]=m.exports;d()(m,{VContainer:u["a"]})},"270b":function(e,t,a){},3:function(e,t){},"35d9":function(e,t,a){"use strict";var i=a("b194"),n=a.n(i);n.a},"3c04":function(e,t){var a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"ExecSql"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"sql"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"ExecSql"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"sql"},value:{kind:"Variable",name:{kind:"Name",value:"sql"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"result"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:93}};a.loc.source={body:"mutation ExecSql(\n  $sql: String!\n){\n  ExecSql(input: {\n    sql: $sql\n  }) {\n    result\n  }\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};function i(e,t){if("FragmentSpread"===e.kind)t.add(e.name.value);else if("VariableDefinition"===e.kind){var a=e.type;"NamedType"===a.kind&&t.add(a.name.value)}e.selectionSet&&e.selectionSet.selections.forEach((function(e){i(e,t)})),e.variableDefinitions&&e.variableDefinitions.forEach((function(e){i(e,t)})),e.definitions&&e.definitions.forEach((function(e){i(e,t)}))}var n={};function l(e,t){for(var a=0;a<e.definitions.length;a++){var i=e.definitions[a];if(i.name&&i.name.value==t)return i}}function o(e,t){var a={kind:e.kind,definitions:[l(e,t)]};e.hasOwnProperty("loc")&&(a.loc=e.loc);var i=n[t]||new Set,o=new Set,s=new Set;i.forEach((function(e){s.add(e)}));while(s.size>0){var r=s;s=new Set,r.forEach((function(e){if(!o.has(e)){o.add(e);var t=n[e]||new Set;t.forEach((function(e){s.add(e)}))}}))}return o.forEach((function(t){var i=l(e,t);i&&a.definitions.push(i)})),a}(function(){a.definitions.forEach((function(e){if(e.name){var t=new Set;i(e,t),n[e.name.value]=t}}))})(),e.exports=a,e.exports["ExecSql"]=o(a,"ExecSql")},4:function(e,t){},"56d7":function(e,t,a){"use strict";a.r(t);var i=a("2b0e"),n=a("f309");i["a"].use(n["a"]);var l=new n["a"]({icons:{iconfont:"md"}}),o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-app",{attrs:{id:"inspire"}},[a("v-app-bar",{attrs:{app:"","clipped-left":""}},[a("v-btn",{class:e.refreshBtnClass,attrs:{color:e.refreshBtnColor,hidden:e.initializing},on:{click:e.refreshSchemata}},[e._v("Refresh Schemata")]),a("v-spacer"),a("v-toolbar-title",{attrs:{selectable:""},domProps:{textContent:e._s(e.title)},on:{click:e.home}}),a("v-spacer"),a("v-btn",{attrs:{color:e.btnColor("home")},on:{click:function(t){return e.navigate("home")}}},[e._v("Project")]),a("v-btn",{attrs:{color:e.btnColor("security-manager"),disabled:e.initializing},on:{click:function(t){return e.navigate("security-manager")}}},[e._v("Security Scripts")]),a("v-btn",{attrs:{color:e.btnColor("search-view"),disabled:e.initializing},on:{click:function(t){return e.navigate("search-view")}}},[e._v("Function Search")]),a("v-btn",{attrs:{color:e.btnColor("pg-lint"),disabled:e.initializing},on:{click:function(t){return e.navigate("pg-lint")}}},[e._v("PG-Lint")]),a("v-spacer"),a("v-spacer"),a("v-spacer"),a("v-spacer"),a("v-spacer"),a("v-spacer"),a("v-btn",{attrs:{color:e.btnColor("writeToDisk"),disabled:e.initializing},on:{click:e.writeToDisk}},[e._v("Write to Disk")]),a("v-spacer"),a("v-spacer"),a("v-app-bar-nav-icon",{on:{click:function(t){t.stopPropagation(),e.drawer=!e.drawer}}})],1),a("v-hover",{scopedSlots:e._u([{key:"default",fn:function(t){t.hover;return[a("v-navigation-drawer",{attrs:{app:"",right:"",width:400,"disable-route-watcher":""},model:{value:e.drawer,callback:function(t){e.drawer=t},expression:"drawer"}},[a("project-navigator")],1)]}}])}),a("v-content",[a("v-container",{attrs:{"justify-start":"","ma-0":"","pa-0":""}},[a("router-view")],1)],1),a("v-footer",{attrs:{app:""}},[a("span",[e._v("© 2019")])])],1)},s=[],r=a("58bb"),c=a.n(r),d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("schema-navigator")],1)},u=[],m=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{"ma-0":"","pa-0":"",fluid:""}},[a("h2",{attrs:{"text-right":""}},[e._v("schemata")]),a("schema-tree")],1)},p=[],h=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{"ma-0":"","pa-0":"",dense:""}},[a("v-treeview",{directives:[{name:"scroll",rawName:"v-scroll"}],attrs:{items:e.items,activatable:"",transition:"",active:e.active,hoverable:"",dense:""},on:{"update:active":function(t){e.active=t}},model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}})],1)},f=[];new i["a"];var b={name:"SchemaTree",data:()=>({active:[],schemata:[],selected:[]}),computed:{items(){return this.$store.state.managedSchemata.map(e=>({id:"schema:"+e.id,name:e.schemaName,children:this.filterMode?[]:[{id:"tables:"+e.schemaName,name:"tables",children:e.schemaTables.filter(e=>"BASE TABLE"===e.tableType).sort((e,t)=>e.tableName<t.tableName?-1:1).map(e=>({id:"table:"+e.id,name:e.tableName}))},{id:"views:"+e.schemaName,name:"views",children:e.schemaTables.filter(e=>"VIEW"===e.tableType).sort((e,t)=>e.tableName<t.tableName?-1:1).map(e=>({id:"view:"+e.id,name:e.tableName}))},{id:"functions:"+e.schemaName,name:"functions",children:(e.schemaFunctions||[]).sort((e,t)=>e.functionName<t.functionName?-1:1).map(e=>({id:"function:"+e.id,name:e.functionName}))},{id:"enums:"+e.schemaName,name:"enums",children:(e.schemaEnums||[]).sort((e,t)=>e.enumName<t.enumName?-1:1).map(e=>({id:"enum:"+e.id,name:e.enumName}))},{id:"udts:"+e.schemaName,name:"udts",children:(e.schemaUdts||[]).sort((e,t)=>e.udtName<t.udtName?-1:1).map(e=>({id:"udt:"+e.id,name:e.udtName}))}]})).sort((e,t)=>e.name<t.name?-1:1)}},watch:{active(){const e=this.active[0]||"",t=e.split(":")[0],a=e.split(":")[1];switch(t){case"table":this.$router.push({name:"table",params:{id:a}});break;case"tables":break;case"view":this.$router.push({name:"table",params:{id:a}});break;case"views":break;case"function":this.$router.push({name:"function",params:{id:a}});break;case"enum":this.$router.push({name:"enum",params:{id:a}});break;case"udt":this.$router.push({name:"udt",params:{id:a}});break;default:break}}}},v=b,y=a("2877"),g=a("6544"),k=a.n(g),x=a("a523"),N=a("eb2a"),C=a("269a"),T=a.n(C),S=a("f977"),_=Object(y["a"])(v,h,f,!1,null,null,null),E=_.exports;k()(_,{VContainer:x["a"],VTreeview:N["a"]}),T()(_,{Scroll:S["b"]});var P={name:"SchemaNavigator",components:{SchemaTree:E},props:{},data:()=>({}),computed:{},watch:{},methods:{}},D=P,I=(a("115f"),Object(y["a"])(D,m,p,!1,null,null,null)),w=I.exports;k()(I,{VContainer:x["a"]});var R={name:"ProjectNavigator",props:{},components:{SchemaNavigator:w}},O=R,V=Object(y["a"])(O,d,u,!1,null,null,null),$=V.exports;k()(V,{VContainer:x["a"]});var A=a("6514"),j=a.n(A),F={name:"App",props:{source:String},components:{ProjectNavigator:$},computed:{initializing(){return this.$store.state.initializing},currentRoute(){return this.$router.currentRoute},disableGraphileWorker(){return!0!==(this.$store.state.pgdbiOptions||{enableGraphileWorker:!1}).enableGraphileWorker},disableSqitch(){return!0!==(this.$store.state.pgdbiOptions||{enableSqitch:!1}).enableSqitch}},watch:{initializing(){this.setRefreshBtnClass()}},methods:{writeToDisk(){this.$store.dispatch("writeToDisk").then(e=>{alert(e)}).catch(e=>{alert("ERROR"),console.error(e)})},setRefreshBtnClass(){this.refreshBtnClass=this.initializing?"refreshBtnInitializing":"refreshBtn",this.refreshBtnColor=this.initializing?"yellow darken-3":"blue-grey"},refreshSchemata(){this.$loading(!0),this.$apollo.query({query:c.a,fetchPolicy:"network-only"}).then(e=>{this.$store.dispatch("setManagedSchemata",{schemaTree:e.data.dbIntrospection.schemaTree,pgdbiOptions:{pgdbiOptions:e.data.pgdbiOptions}}),this.$store.commit("setIsDirty",!1),this.$loading(!1)}).catch(e=>{this.$loading(!1),console.error(e),alert(e.toString())})},btnColor(e){return"writeToDisk"===e?this.$store.state.isDirty?"red":"blue-grey":this.$router.currentRoute.name===e?"blue":"blue-grey"},home(){this.$router.push({name:"home"}).catch(e=>{})},settings(){this.$router.push({name:"settings"}).catch(e=>{})},navigate(e){this.$router.push({name:e}).catch(e=>{})}},data(){return{expandNav:!1,clipped:!0,drawer:!1,fixed:!1,items:[],miniVariant:!1,right:!0,rightDrawer:!1,title:"pg-db-inspector",refreshBtnClass:"refreshBtn",refreshBtnColor:"blue-grey"}},mounted(){this.setRefreshBtnClass()},created(){this.$vuetify.theme.dark=!0}},L=F,q=a("7496"),G=a("40dc"),U=a("5bc1"),B=a("8336"),M=a("a75b"),z=a("553a"),H=a("ce87"),Q=a("f774"),W=a("2fa4"),K=a("2a7f"),J=Object(y["a"])(L,o,s,!1,null,null,null),X=J.exports;k()(J,{VApp:q["a"],VAppBar:G["a"],VAppBarNavIcon:U["a"],VBtn:B["a"],VContainer:x["a"],VContent:M["a"],VFooter:z["a"],VHover:H["a"],VNavigationDrawer:Q["a"],VSpacer:W["a"],VToolbarTitle:K["a"]});var Y=a("8c4f"),Z=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{"ma-0":"","pa-0":"",fluid:""}},[a("h1",[e._v("PGDBI")]),a("h2",[e._v("postgraphile-db-inspector")]),a("v-toolbar",[a("project-reset-dialog")],1),a("roles")],1)},ee=[],te=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("v-tab",{key:"choose-role-set",attrs:{ripple:""}},[e._v("\n      Choose Role Set\n    ")]),a("v-tab-item",{key:"choose-role-set"},[a("v-card",[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("v-card",{key:"choose-role-set"},[a("choose-role-set"),a("v-card-actions",[a("v-btn",{class:e.refreshBtnClass,attrs:{color:e.refreshBtnColor,hidden:e.refreshHidden},on:{click:e.refreshSchemata}},[e._v("Refresh Schemata")])],1)],1)],1)],1)],1)],1)],1)],1)},ae=[],ie=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-radio-group",{attrs:{value:e.roleSetId,row:"",disabled:!e.initializing},on:{change:e.changeRoleSet}},e._l(e.allRoleSets,(function(e){return a("v-radio",{key:e.name,attrs:{label:e.name,value:e.name}})})),1),a("v-data-table",{attrs:{items:e.mappedDbUsers,headers:e.userHeaders,"hide-default-footer":"","disable-sort":""}})],1)},ne=[];const le="---",oe="+++";var se={name:"Roles",mixins:[],components:{},watch:{},computed:{allRoleSets(){return this.$store.state.allRoleSets},roleSetId(){return this.$store.state.roleSet.name},initializing(){return this.$store.state.initializing},dbOwner(){return this.$store.state.roleSet.dbOwnerRole},dbAuthenticator(){return this.$store.state.roleSet.dbAuthenticatorRole},dbUsers(){const e=this.$store.state.roleSet.dbUserRoles;return[this.dbOwner,this.dbAuthenticator,...e.sort((e,t)=>t.applicableRoles.length-e.applicableRoles.length)]},userHeaders(){return[{text:"name",value:"name"},...this.dbUsers.map(e=>({text:e.roleName,value:e.roleName}))]},mappedDbUsers(){return this.dbUsers.map(e=>this.dbUsers.reduce((t,a)=>e.roleName===a.roleName?{...t,[a.roleName]:e.roleName}:e.applicableRoles.map(e=>e.roleName).indexOf(a.roleName)>-1?{...t,[a.roleName]:oe}:{...t,[a.roleName]:le},{name:e.roleName}))}},data(){return{}},methods:{changeRoleSet(e){this.$loading=!0,this.$store.dispatch("setProjectRoleSet",e).then(()=>{this.$loading=!1}).catch(e=>{console.error(e),this.$loading=!1})}},mounted(){}},re=se,ce=a("8fea"),de=a("67b6"),ue=a("43a6"),me=Object(y["a"])(re,ie,ne,!1,null,null,null),pe=me.exports;k()(me,{VContainer:x["a"],VDataTable:ce["a"],VRadio:de["a"],VRadioGroup:ue["a"]});var he={name:"Roles",mixins:[],components:{ChooseRoleSet:pe},watch:{},computed:{rolesSet(){return this.$store.state.roleSet,this.$store.state.roleSet},refreshHidden(){return!this.$store.state.initializing||!this.rolesSet.name}},data(){return{activeTab:null,refreshBtnClass:"refreshBtnInitializing",refreshBtnColor:"yellow darken-3"}},methods:{refreshSchemata(){this.$loading(!0),this.$apollo.query({query:c.a,fetchPolicy:"network-only"}).then(e=>{this.$store.dispatch("setManagedSchemata",{schemaTree:e.data.dbIntrospection.schemaTree,pgdbiOptions:{pgdbiOptions:e.data.pgdbiOptions}}),this.$loading(!1)}).catch(e=>{this.$loading(!1),console.error(e),alert(e.toString())})}},mounted(){}},fe=he,be=a("b0af"),ve=a("99d9"),ye=a("0e8f"),ge=a("a722"),ke=a("71a3"),xe=a("c671"),Ne=a("fe57"),Ce=Object(y["a"])(fe,te,ae,!1,null,null,null),Te=Ce.exports;k()(Ce,{VBtn:B["a"],VCard:be["a"],VCardActions:ve["a"],VContainer:x["a"],VFlex:ye["a"],VLayout:ge["a"],VTab:ke["a"],VTabItem:xe["a"],VTabs:Ne["a"]});var Se=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-dialog",{attrs:{persistent:"",width:"800"},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[a("v-btn",e._g({staticClass:"text-none",attrs:{dark:""}},i),[e._v("\n        RESET PGDBI\n      ")])]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[a("v-card-text",[e._v("Are you sure you want to reset PGDBI?")]),a("v-card-text",[e._v("This will discard all policy definitions and assignement")]),a("v-card-actions",[a("v-spacer"),a("v-btn",{on:{click:function(t){e.dialog=!1}}},[e._v("Cancel")]),a("v-btn",{staticClass:"red",attrs:{hidden:e.saveFirstHidden},on:{click:e.saveFirst}},[e._v("Save Project First")]),a("v-btn",{on:{click:e.resetPgdbi}},[e._v("Exterminate!")]),a("v-spacer")],1)],1)],1)],1)},_e=[],Ee={name:"ProjectResetDialog",props:{},mounted(){},data(){return{dialog:!1}},computed:{saveFirstHidden(){return!this.$store.state.isDirty}},watch:{},methods:{resetPgdbi(){this.$store.dispatch("resetDefaultState"),this.$router.push("initialize").catch(e=>{}),this.dialog=!1},saveFirst(){this.$store.dispatch("writeToDisk").then(e=>{this.resetPgdbi()}).catch(e=>{alert("ERROR"),console.error(e)})}},mounted(){}},Pe=Ee,De=(a("8c37"),a("169a")),Ie=Object(y["a"])(Pe,Se,_e,!1,null,null,null),we=Ie.exports;k()(Ie,{VBtn:B["a"],VCard:be["a"],VCardActions:ve["a"],VCardText:ve["b"],VDialog:De["a"],VSpacer:W["a"]});var Re={name:"Home",components:{Roles:Te,ProjectResetDialog:we},props:{},computed:{},data:()=>({activeTab:null}),methods:{}},Oe=Re,Ve=a("71d9"),$e=Object(y["a"])(Oe,Z,ee,!1,null,null,null),Ae=$e.exports;k()($e,{VContainer:x["a"],VToolbar:Ve["a"]});var je=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{"ma-5":"","pa-5":""}},[a("v-toolbar",[a("project-reset-dialog")],1),a("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("v-tab",{key:"initialize",attrs:{ripple:""}},[e._v("\n      Initialize Project\n    ")]),a("v-tab-item",{key:"initialize"},[a("v-card",[a("roles")],1)],1),a("v-tab",{key:"import",attrs:{ripple:""}},[e._v("\n      Load From Disk\n    ")]),a("v-tab-item",{key:"import"},[a("v-card",[a("v-btn",{on:{click:e.loadFromDisk}},[e._v("Load From Disk")])],1)],1)],1)],1)},Fe=[],Le={name:"Initialize",components:{Roles:Te,ProjectResetDialog:we},props:{},computed:{initializing(){return this.$store.state.initializing}},data:()=>({activeTab:null}),methods:{loadFromDisk(){this.$store.dispatch("loadFromDisk")}},watch:{initializing(){!0!==this.initializing&&this.$router.push({name:"security-manager"})}},beforeRouteLeave(e,t,a){this.initializing?a(!1):a()}},qe=Le,Ge=Object(y["a"])(qe,je,Fe,!1,null,null,null),Ue=Ge.exports;k()(Ge,{VBtn:B["a"],VCard:be["a"],VContainer:x["a"],VTab:ke["a"],VTabItem:xe["a"],VTabs:Ne["a"],VToolbar:Ve["a"]});var Be=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("h1",[e._v(e._s(e.id))]),a("hr"),a("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("v-tab",{key:"cols",attrs:{ripple:""}},[e._v("\n      Columns\n    ")]),a("v-tab-item",{key:"cols"},[a("v-card",{attrs:{flat:""}},[a("table-columns",{attrs:{tableInfo:e.tableInfo}})],1)],1),a("v-tab",{key:"constraints-and-indices",attrs:{ripple:""}},[e._v("\n      Constraints and Indices\n    ")]),a("v-tab-item",{key:"constraints-and-indices"},[a("v-card",{attrs:{flat:""}},[a("constraints-and-indices",{attrs:{tableSchema:e.tableSchema,tableName:e.tableName}})],1)],1),a("v-tab",{key:"tabletriggers",attrs:{ripple:""}},[e._v("\n      Triggers\n    ")]),a("v-tab-item",{key:"tabletriggers"},[a("v-card",{attrs:{flat:""}},[a("table-triggers",{attrs:{triggers:e.tableTriggers}})],1)],1),a("v-tab",{key:"tablePolicy",attrs:{ripple:""}},[e._v("\n      Assigned Policy\n    ")]),a("v-tab-item",{key:"tablePolicy"},[a("v-card",{attrs:{flat:""}},[a("table-policy-definition",{attrs:{policyId:e.tableInfo.policyDefinitionId,table:e.tableInfo}})],1)],1),a("v-tab",{key:"tableScripts",attrs:{ripple:""}},[e._v("\n      Generated Scripts\n    ")]),a("v-tab-item",{key:"tableScripts"},[a("v-card",{attrs:{flat:""}},[a("table-scripts",{attrs:{tableInfo:e.tableInfo}})],1)],1)],1)],1)},Me=[],ze=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.tableDetail,"hide-default-footer":"","show-expand":""},scopedSlots:e._u([{key:"item.fkInfo",fn:function(t){var a=t.item;return[e._v("\n    "+e._s(a.fkInfo)+"\n  ")]}},{key:"item.fkIndex",fn:function(t){var i=t.item;return[a("div",{class:e.fkIndexClass(i.fkIndex)},[i.fkIndexLinkId?a("router-link",{attrs:{to:{name:"table",params:{id:i.fkIndexLinkId}},target:"_blank"}},[e._v(e._s(i.fkIndex))]):e._e(),i.fkIndexLinkId?e._e():a("span",[e._v(e._s(i.fkIndex))])],1)]}},{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.headers.length+1}},[a("column-detail",{attrs:{columnInfo:t.item}})],1)]}}])})],1)},He=[],Qe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{fluid:""}},[a("v-row",[a("v-col",{attrs:{cols:"12"}},[a("v-row",{staticClass:"blue darken-4"},[a("v-col",{attrs:{cols:"4"}},[a("v-card",{staticClass:"ma-1 pa-1",attrs:{outlined:"",tile:""}},[a("h4",[e._v("Indices")]),a("hr"),e._l(e.columnInfo.columnIndices,(function(t){return a("v-card",{key:t.id,staticClass:"ma-1 pa-1 grey darken-4 text-no-wrap"},[e._v("\n              "+e._s(t.indexName)+"\n            ")])}))],2)],1),a("v-col",{attrs:{cols:"4"}},[a("v-card",{staticClass:"ma-1 pa-1",attrs:{dense:""}},[a("h4",[e._v("Foreign Keys")]),a("hr"),e._l(e.columnInfo.fkConstraintUsage,(function(t){return a("v-card",{key:t.id,staticClass:"ma-1 pa-1 grey darken-4 text-no-wrap"},[e._v("\n              "+e._s(t.constraintName)+"\n              "),a("hr"),e._v("\n              REF: "),t.fkTableLinkId?a("router-link",{attrs:{to:{name:"table",params:{id:t.fkTableLinkId}},target:"_blank"}},[e._v(e._s(t.fkPath))]):e._e(),a("hr"),e._v("\n              IDX: "),a("span",{class:e.fkIndexClass(t.fkIndexEvaluation)},[e._v(e._s(t.fkIndexEvaluation))])],1)}))],2)],1),a("v-col",{attrs:{cols:"4"}},[a("v-card",{staticClass:"ma-1 pa-1",attrs:{dense:""}},[a("h4",[e._v("Unique Constraints")]),a("hr"),e._l(e.columnInfo.uqConstraintUsage,(function(t){return a("v-card",{key:t.id,staticClass:"ma-1 pa-1 grey darken-4 text-no-wrap"},[e._v("\n              "+e._s(t.constraintName)+"\n              "),a("hr"),e._v("\n              IDX: "),a("span",{class:e.uqIndexClass(t.uqIndexEvaluation)},[e._v(e._s(t.uqIndexEvaluation))])])}))],2)],1)],1)],1)],1)],1)},We=[];const Ke="NO INDEX",Je="MULTIPLE_INDICES";var Xe={name:"ColumnDetail",props:{columnInfo:{type:Object,required:!0}},methods:{fkIndexClass(e){return e===Ke?"red--text":e===Je?"yellow--text":"green--text"},uqIndexClass(e){return e===Ke?"red--text":e===Je?"yellow--text":"green--text"}}},Ye=Xe,Ze=a("62ad"),et=a("0fd9"),tt=Object(y["a"])(Ye,Qe,We,!1,null,null,null),at=tt.exports;k()(tt,{VCard:be["a"],VCol:Ze["a"],VContainer:x["a"],VRow:et["a"]});const it="NO INDEX";var nt={name:"TableDetail",props:{tableInfo:{type:Object,required:!0}},components:{ColumnDetail:at},methods:{changeSort(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)},fkIndexClass(e){return e===it?"red--text":""}},computed:{tableDetail(){console.log("table",this.tableInfo);const e=(this.tableInfo.tableColumns||[]).map(e=>{const t=((this.tableInfo.referentialConstraints||[]).find(t=>void 0!==t.referencingColumnUsage.find(t=>t.tableSchema===e.tableSchema&&t.tableName===e.tableName&&t.columnName===e.columnName))||{referencedColumnUsage:[]}).referencedColumnUsage[0],a=t?`${t.tableSchema}.${t.tableName}.${t.columnName}`:"",i=this.tableInfo.indices.find(t=>t.tableSchema===e.tableSchema&&t.tableName===e.tableName&&t.columnName===e.columnName),n=t?i?""+i.indexName:it:"",l=t&&n!==it?`table:${t.tableSchema}.${t.tableName}`:"";return{...e,fkInfo:a,fkIndex:n,fkIndexLinkId:l}});return e}},data:()=>({headers:[{text:"Ordinal",sortable:!0,value:"ordinalPosition"},{text:"Column Name",sortable:!0,value:"columnName"},{text:"Data Type",sortable:!0,value:"dataType"},{text:"Identity",sortable:!0,value:"isIdentity"},{text:"Nullable",sortable:!0,value:"isNullable"},{text:"Default Value",sortable:!0,value:"columnDefault"},{text:"FK Reference",sortable:!0,value:"fkInfo"},{text:"FK Index",sortable:!0,value:"fkIndex"}],pagination:{sortBy:"ordinalPosition",rowsPerPage:-1}})},lt=nt,ot=Object(y["a"])(lt,ze,He,!1,null,null,null),st=ot.exports;k()(ot,{VContainer:x["a"],VDataTable:ce["a"]});var rt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{fluid:""}},[a("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{headers:e.headers,items:e.tableDetail,"hide-default-footer":"","calculate-widths":"",dense:"","items-per-page":100},scopedSlots:e._u([{key:"item.isPKColumn",fn:function(t){var i=t.item;return[i.isPKColumn?a("v-icon",[e._v("check")]):e._e()]}},{key:"item.isNullable",fn:function(t){var i=t.item;return["YES"===i.isNullable?a("v-icon",[e._v("check")]):e._e()]}}])})],1)},ct=[];const dt="NO INDEX",ut="MULTIPLE_INDICES";var mt={name:"TableColumns",props:{tableInfo:{type:Object,required:!0}},components:{ColumnDetail:at},methods:{changeSort(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)},fkIndexClass(e){const t=e.fkConstraintUsage.filter(e=>e.fkIndexEvaluation===dt).length,a=e.fkConstraintUsage.filter(e=>e.fkIndexEvaluation===ut).length;return t>0?"red":a>0?"yellow":"green"},uqIndexClass(e){const t=e.uqConstraintUsage.filter(e=>e.uqIndexEvaluation===dt).length,a=e.uqConstraintUsage.filter(e=>e.uqIndexEvaluation===ut).length;return t>0?"red":a>0?"yellow":"green"}},computed:{tableDetail(){const e=(this.tableInfo.primaryKeyConstraints||[]).reduce((e,t)=>{const a=t.keyColumnUsage.reduce((e,t)=>[...e,t.columnName],[]);return[...e,...a]},[]),t=(this.tableInfo.tableColumns||[]).map(t=>{const a=this.tableInfo.indices.filter(e=>e.tableSchema===t.tableSchema&&e.tableName===t.tableName&&e.columnName===t.columnName),i=e.indexOf(t.columnName)>-1,n=this.$store.state.fkIndexEvaluations.singleColumn[`${t.tableSchema}.${t.tableName}.${t.columnName}`],l=this.$store.state.uqIndexEvaluations[`${t.tableSchema}.${t.tableName}.${t.columnName}`];return{...t,fkConstraintUsage:n||[],uqConstraintUsage:l||[],isPKColumn:i,columnIndices:a}});return t}},data:()=>({headers:[{text:"Ordinal",sortable:!0,value:"ordinalPosition"},{text:"Column Name",sortable:!0,value:"columnName"},{text:"PK",sortable:!0,value:"isPKColumn"},{text:"Nullable",sortable:!0,value:"isNullable"},{text:"Data Type",sortable:!0,value:"dataType"},{text:"Default Value",sortable:!0,value:"columnDefault"}],pagination:{sortBy:"ordinalPosition",rowsPerPage:-1}})},pt=mt,ht=a("132d"),ft=Object(y["a"])(pt,rt,ct,!1,null,null,null),bt=ft.exports;k()(ft,{VContainer:x["a"],VDataTable:ce["a"],VIcon:ht["a"]});var vt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("v-tab",{key:"allIndices",attrs:{ripple:""}},[e._v("\n    All Indices\n  ")]),a("v-tab-item",{key:"allIndices"},[a("v-card",{attrs:{flat:""}},[a("table-generic-indices",{attrs:{tableInfo:e.tableInfo}})],1)],1),a("v-tab",{key:"fkIndices",attrs:{ripple:""}},[e._v("\n    Foreign Key Constraints\n  ")]),a("v-tab-item",{key:"fkIndices"},[a("v-card",{attrs:{flat:""}},[a("table-fk-indices",{attrs:{tableInfo:e.tableInfo}})],1)],1),a("v-tab",{key:"uqIndices",attrs:{ripple:""}},[e._v("\n    Unique Constraints\n  ")]),a("v-tab-item",{key:"uqIndices"},[a("v-card",{attrs:{flat:""}},[a("table-uq-indices",{attrs:{tableInfo:e.tableInfo}})],1)],1),a("v-tab",{key:"chk",attrs:{ripple:""}},[e._v("\n    Check Constraints\n  ")]),a("v-tab-item",{key:"chk"},[a("v-card",{attrs:{flat:""}},[a("table-check-constraints",{attrs:{checkConstraints:e.checkConstraints}})],1)],1)],1)},yt=[],gt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{fluid:""}},[a("v-card",{staticClass:"ma-3 pa-3 green darken-3",attrs:{dense:""}},[a("h2",[e._v("Indexed")]),a("hr"),a("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{items:e.goodIndices,headers:e.headers,"hide-default-footer":"","show-expand":"","calculate-widths":"",dense:""},scopedSlots:e._u([{key:"item.evaluation",fn:function(t){var i=t.item;return[a("span",{class:i.indexDisplayClass},[e._v(e._s(i.evaluation))])]}},{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.headers.length+1}},[a("table-generic-index-detail",{attrs:{evaluation:t.item}})],1)]}}])})],1),a("v-card",{staticClass:"ma-3 pa-3 red darken-3",attrs:{dense:""}},[a("h2",[e._v("Over-Indexed")]),a("hr"),a("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{items:e.badIndices,headers:e.headers,"hide-default-footer":"","show-expand":"","calculate-widths":"",dense:""},scopedSlots:e._u([{key:"item.columnDisplay",fn:function(t){var i=t.item;return e._l(i.columnDisplay,(function(t){return a("div",{key:t},[e._v(e._s(t))])}))}},{key:"item.evaluation",fn:function(t){var i=t.item;return[a("span",{class:i.indexDisplayClass},[e._v(e._s(i.evaluation))])]}},{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.headers.length+1}},[a("table-generic-index-detail",{attrs:{evaluation:t.item}})],1)]}}])})],1)],1)},kt=[],xt=a("89d6"),Nt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.evaluation.indices,"hide-default-footer":!0,"show-expand":""},scopedSlots:e._u([{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.headers.length+1}},[a("v-tabs",{attrs:{dark:"","slider-color":"yellow"}},[a("v-tab",{key:"create",attrs:{ripple:""}},[e._v("\n          Create\n          ")]),a("v-tab-item",{key:"create"},[a("script-viewer",{attrs:{scriptText:t.item.indexDefinition,showReadability:!1}})],1),a("v-tab",{key:"drop",attrs:{ripple:""}},[e._v("\n          Drop\n          ")]),a("v-tab-item",{key:"drop"},[a("script-viewer",{attrs:{scriptText:t.item.indexDrop,showReadability:!1}})],1)],1)],1)]}}])})],1)},Ct=[],Tt={name:"TableGenericIndexDetail",props:{evaluation:{type:Object,required:!0}},components:{ScriptViewer:xt["a"]},methods:{},computed:{},data:()=>({headers:[{text:"Index Name",value:"indexName"}]})},St=Tt,_t=Object(y["a"])(St,Nt,Ct,!1,null,null,null),Et=_t.exports;k()(_t,{VContainer:x["a"],VDataTable:ce["a"],VTab:ke["a"],VTabItem:xe["a"],VTabs:Ne["a"]});const Pt="MULTIPLE_INDICES";var Dt={name:"TableGenericIndices",props:{tableInfo:{type:Object,required:!0}},components:{TableGenericIndexDetail:Et},methods:{changeSort(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},computed:{items(){const e=this.$store.state.genericIndexEvaluations;return Object.keys(e).filter(t=>e[t].tableKey===`${this.tableInfo.tableSchema}.${this.tableInfo.tableName}`).map(t=>e[t])},goodIndices(){return this.items.filter(e=>e.evaluation!==Pt)},badIndices(){return this.items.filter(e=>e.evaluation===Pt).map(e=>({...e,columnDisplay:e.idxColumns}))},duplicateIndexSets(){return this.tableInfo.indices.reduce((e,t)=>{},[])}},data:()=>({selected:[],headers:[{text:"Index Columns",value:"columnDisplay"},{text:"Evaluation",value:"evaluation"}],pagination:{sortBy:"constraintName",rowsPerPage:-1}})},It=Dt,wt=Object(y["a"])(It,gt,kt,!1,null,null,null),Rt=wt.exports;k()(wt,{VCard:be["a"],VContainer:x["a"],VDataTable:ce["a"]});var Ot=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-card",{staticClass:"ma-3 pa-3 blue-grey",attrs:{dense:""}},[a("h2",[e._v("Single-Column Foreign Keys")]),a("hr"),a("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{headers:e.singleColumnHeaders,items:e.singleColumnItems,"hide-default-footer":"","show-expand":"","calculate-widths":"",dense:""},scopedSlots:e._u([{key:"item.fkIndexEvaluation",fn:function(t){var i=t.item;return[a("span",{class:i.indexDisplayClass},[e._v(e._s(i.fkIndexEvaluation))])]}},{key:"item.fkTable",fn:function(t){var i=t.item;return[i.fkTableLinkId?a("router-link",{attrs:{to:{name:"table",params:{id:i.fkTableLinkId}},target:"_blank"}},[e._v(e._s(i.fkTable))]):e._e()]}},{key:"item.fkSource",fn:function(t){var i=t.item;return e._l(i.fkSource,(function(t){return a("div",{key:t},[e._v(e._s(t))])}))}},{key:"item.fkTarget",fn:function(t){var i=t.item;return e._l(i.fkTarget,(function(t){return a("div",{key:t},[e._v(e._s(t))])}))}},{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.singleColumnHeaders.length+1}},[a("table-generic-index-detail",{attrs:{evaluation:t.item}})],1)]}}])})],1),a("v-card",{staticClass:"ma-3 pa-3 blue-grey darken-4",attrs:{dense:""}},[a("h2",[e._v("Multi-Column Foreign Keys")]),a("hr"),a("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{headers:e.multiColumnHeaders,items:e.multiColumnItems,"hide-default-footer":"","show-expand":"","calculate-widths":"",dense:""},scopedSlots:e._u([{key:"item.fkIndexEvaluation",fn:function(t){var i=t.item;return[a("span",{class:i.indexDisplayClass},[e._v(e._s(i.fkIndexEvaluation))])]}},{key:"item.fkTable",fn:function(t){var i=t.item;return[i.fkTableLinkId?a("router-link",{attrs:{to:{name:"table",params:{id:i.fkTableLinkId}},target:"_blank"}},[e._v(e._s(i.fkTable))]):e._e()]}},{key:"item.fkSource",fn:function(t){var i=t.item;return e._l(i.fkSource,(function(t){return a("div",{key:t},[e._v(e._s(t))])}))}},{key:"item.fkTarget",fn:function(t){var i=t.item;return e._l(i.fkTarget,(function(t){return a("div",{key:t},[e._v(e._s(t))])}))}},{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.multiColumnHeaders.length+1}},[a("table-generic-index-detail",{attrs:{evaluation:t.item}})],1)]}}])})],1)],1)},Vt=[],$t={name:"TableFKIndices",components:{TableGenericIndexDetail:Et},props:{tableInfo:{type:Object,required:!0}},methods:{changeSort(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},computed:{singleColumnItems(){return this.tableInfo.tableColumns.reduce((e,t)=>{const a=this.$store.state.fkIndexEvaluations.singleColumn[t.id];return a?[...e,...a]:e},[])},multiColumnItems(){return this.$store.state.fkIndexEvaluations.multiColumn[this.tableInfo.id]}},data:()=>({singleColumnHeaders:[{text:"Constraint Name",value:"constraintName"},{text:"Index",value:"fkIndexEvaluation"},{text:"FK Table",value:"fkTable"},{text:"FK Source",value:"fkSource"},{text:"FK Target",value:"fkTarget"}],multiColumnHeaders:[{text:"Constraint Name",value:"constraintName"},{text:"Index",value:"fkIndexEvaluation"},{text:"FK Table",value:"fkTable"},{text:"FK Source",value:"fkSource"},{text:"FK Target",value:"fkTarget"}]})},At=$t,jt=Object(y["a"])(At,Ot,Vt,!1,null,null,null),Ft=jt.exports;k()(jt,{VCard:be["a"],VContainer:x["a"],VDataTable:ce["a"]});var Lt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-card",{staticClass:"ma-3 pa-3 purple",attrs:{dense:""}},[a("h2",[e._v("Single-Column Unique Indices")]),a("hr"),a("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{headers:e.singleColumnHeaders,items:e.singleColumnItems,"hide-default-footer":"","show-expand":"","calculate-widths":"",dense:""},scopedSlots:e._u([{key:"item.uqIndexEvaluation",fn:function(t){var i=t.item;return[a("span",{class:i.indexDisplayClass},[e._v(e._s(i.uqIndexEvaluation))])]}},{key:"item.uqSource",fn:function(t){var i=t.item;return e._l(i.idxColumns,(function(t){return a("div",{key:t},[e._v(e._s(t))])}))}},{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.singleColumnHeaders.length+1}},[a("table-generic-index-detail",{attrs:{evaluation:t.item}})],1)]}}])})],1),a("v-card",{staticClass:"ma-3 pa-3 purple darken-4",attrs:{dense:""}},[a("h2",[e._v("Multi-Column Unique Indices")]),a("hr"),a("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{headers:e.multiColumnHeaders,items:e.multiColumnItems,"hide-default-footer":"","show-expand":"","calculate-widths":"",dense:""},scopedSlots:e._u([{key:"item.uqIndexEvaluation",fn:function(t){var i=t.item;return[a("span",{class:i.indexDisplayClass},[e._v(e._s(i.uqIndexEvaluation))])]}},{key:"item.uqSource",fn:function(t){var i=t.item;return e._l(i.idxColumns,(function(t){return a("div",{key:t},[e._v(e._s(t))])}))}},{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.singleColumnHeaders.length+1}},[a("table-generic-index-detail",{attrs:{evaluation:t.item}})],1)]}}])})],1)],1)},qt=[],Gt={name:"TableUqIndices",components:{TableGenericIndexDetail:Et},props:{tableInfo:{type:Object,required:!0}},methods:{changeSort(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},computed:{singleColumnItems(){return this.tableInfo.tableColumns.reduce((e,t)=>{const a=this.$store.state.uqIndexEvaluations.singleColumn[t.id];return a?[...e,...a]:e},[])},multiColumnItems(){return this.$store.state.uqIndexEvaluations.multiColumn[this.tableInfo.id]}},data:()=>({singleColumnHeaders:[{text:"Constraint Name",value:"constraintName"},{text:"Index",value:"uqIndexEvaluation"},{text:"Uq Column",value:"uqSource"}],multiColumnHeaders:[{text:"Constraint Name",value:"constraintName"},{text:"Index",value:"uqIndexEvaluation"},{text:"Uq Column(s)",value:"uqSource"}]})},Ut=Gt,Bt=Object(y["a"])(Ut,Lt,qt,!1,null,null,null),Mt=Bt.exports;k()(Bt,{VCard:be["a"],VContainer:x["a"],VDataTable:ce["a"]});var zt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-card",{staticClass:"ma-3 pa-3 blue darken-4",attrs:{dense:""}},[a("h2",[e._v("Check Constraints")]),a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.mappedConstraints,"hide-default-footer":!0}})],1)],1)},Ht=[],Qt={name:"TableCheckConstraints",props:{checkConstraints:{type:Array,required:!0}},computed:{mappedConstraints(){return this.checkConstraints.map(e=>({...e,expanded:!1,tableName:e.tableConstraints[0].tableName}))}},methods:{changeSort(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},data:()=>({headers:[{text:"Name",sortable:!0,value:"constraintName"},{text:"Check Clause",sortable:!0,value:"checkClause"}],pagination:{sortBy:"constraintName",rowsPerPage:-1}})},Wt=Qt,Kt=Object(y["a"])(Wt,zt,Ht,!1,null,null,null),Jt=Kt.exports;k()(Kt,{VCard:be["a"],VContainer:x["a"],VDataTable:ce["a"]});var Xt={name:"TableIndexAnalysis",components:{TableGenericIndices:Rt,TableFkIndices:Ft,TableUqIndices:Mt,TableCheckConstraints:Jt},props:{tableInfo:{type:Object,required:!0}},methods:{changeSort(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},computed:{allIndices(){return this.tableInfo.indices},uqIndices(){return this.tableInfo.indices},checkConstraints(){return this.tableInfo.checkConstraints||[]}},data:()=>({activeTab:0,headers:[{text:"Column",value:"columnName"},{text:"Index Name",value:"indexName"}],pagination:{sortBy:"constraintName",rowsPerPage:-1}})},Yt=Xt,Zt=Object(y["a"])(Yt,vt,yt,!1,null,null,null),ea=Zt.exports;k()(Zt,{VCard:be["a"],VTab:ke["a"],VTabItem:xe["a"],VTabs:Ne["a"]});var ta=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("v-tab",{key:"refcons",attrs:{ripple:""}},[e._v("\n        Referential Constraints\n      ")]),a("v-tab-item",{key:"refcons"},[a("v-card",{attrs:{flat:""}},[a("table-referential-constraints",{attrs:{referentialConstraints:e.referentialConstraints}})],1)],1),a("v-tab",{key:"chk",attrs:{ripple:""}},[e._v("\n        Check Constraints\n      ")]),a("v-tab-item",{key:"chk"},[a("v-card",{attrs:{flat:""}},[a("table-check-constraints",{attrs:{checkConstraints:e.checkConstraints}})],1)],1),a("v-tab",{key:"uq",attrs:{ripple:""}},[e._v("\n        Unique Constraints\n      ")]),a("v-tab-item",{key:"uq"},[a("v-card",{attrs:{flat:""}},[a("table-unique-constraints",{attrs:{uniqueConstraints:e.uniqueConstraints}})],1)],1)],1)],1)},aa=[],ia=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.mappedConstraints,"hide-default-footer":!0,"item-key":"constraintName"},scopedSlots:e._u([{key:"items",fn:function(t){return[a("tr",{on:{click:function(e){t.expanded=!t.expanded}}},[a("td",[e._v(e._s(t.item.constraintName)),a("hr"),e._v(e._s(t.item.source))]),a("td",[e._v(e._s(t.item.uniqueConstraintName)),a("hr"),e._v(e._s(t.item.target))]),a("td",[e._v(e._s(t.item.matchOption))]),a("td",[e._v(e._s(t.item.updateRule))]),a("td",[e._v(e._s(t.item.deleteRule))])])]}},{key:"expand",fn:function(t){return[a("v-card",{attrs:{flat:""}},[a("h2",[e._v("Source")]),a("table-key-column-usage",{attrs:{keyColumnUsage:t.item.referencingColumnUsage}})],1),a("v-card",{attrs:{flat:""}},[a("h2",[e._v("Target")]),a("table-key-column-usage",{attrs:{keyColumnUsage:t.item.referencedColumnUsage}})],1)]}}])})],1)},na=[],la=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.keyColumnUsage,"hide-default-footer":!0},scopedSlots:e._u([{key:"items",fn:function(t){return[a("td",[e._v(e._s(t.item.tableSchema))]),a("td",[e._v(e._s(t.item.tableName))]),a("td",[e._v(e._s(t.item.columnName))])]}}])})],1)},oa=[],sa={name:"TableKeyColumnUsage",props:{keyColumnUsage:{type:Array,required:!0}},methods:{},data:()=>({headers:[{text:"Schema",sortable:!1,value:"tableSchema"},{text:"Table",sortable:!1,value:"tableName"},{text:"Column",sortable:!1,value:"columnName"}]})},ra=sa,ca=Object(y["a"])(ra,la,oa,!1,null,null,null),da=ca.exports;k()(ca,{VContainer:x["a"],VDataTable:ce["a"]});var ua={name:"TableReferentialConstraints",components:{TableKeyColumnUsage:da},props:{referentialConstraints:{type:Array,required:!0}},computed:{mappedConstraints(){return this.referentialConstraints.map(e=>({...e,expanded:!1,source:`${e.referencingColumnUsage[0].tableSchema}.${e.referencingColumnUsage[0].tableName}.${e.referencingColumnUsage[0].columnName}`,target:`${e.referencedColumnUsage[0].tableSchema}.${e.referencedColumnUsage[0].tableName}.${e.referencedColumnUsage[0].columnName}`}))}},methods:{changeSort(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},data:()=>({headers:[{text:"Source Constraint",sortable:!0,value:"constraintName"},{text:"Target Constraint",sortable:!0,value:"uniqueConstraintName"},{text:"On Match",sortable:!0,value:"matchOption"},{text:"On Update",sortable:!0,value:"updateRule"},{text:"On Delete",sortable:!0,value:"deleteRule"}],pagination:{sortBy:"constraintName",rowsPerPage:-1}})},ma=ua,pa=Object(y["a"])(ma,ia,na,!1,null,null,null),ha=pa.exports;k()(pa,{VCard:be["a"],VContainer:x["a"],VDataTable:ce["a"]});var fa=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.uniqueConstraints,"hide-default-footer":!0},scopedSlots:e._u([{key:"items",fn:function(t){return[a("td",[e._v(e._s(t.item.constraintSchema))]),a("td",[e._v(e._s(t.item.constraintName))])]}}])})],1)},ba=[],va={name:"TableUniqueConstraints",props:{uniqueConstraints:{type:Array,required:!0}},methods:{changeSort(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},data:()=>({headers:[{text:"Schema",sortable:!0,value:"constraintSchema"},{text:"Name",sortable:!0,value:"constraintName"}],pagination:{sortBy:"constraintName",rowsPerPage:-1}})},ya=va,ga=Object(y["a"])(ya,fa,ba,!1,null,null,null),ka=ga.exports;k()(ga,{VContainer:x["a"],VDataTable:ce["a"]});var xa={name:"TableConstraints",components:{TableReferentialConstraints:ha,TableCheckConstraints:Jt,TableUniqueConstraints:ka},props:{tableInfo:{type:Object,required:!0}},computed:{referentialConstraints(){return this.tableInfo.referentialConstraints||[]},checkConstraints(){return this.tableInfo.checkConstraints||[]},uniqueConstraints(){return this.tableInfo.uniqueConstraints||[]}},methods:{},data:()=>({activeTab:null})},Na=xa,Ca=Object(y["a"])(Na,ta,aa,!1,null,null,null),Ta=Ca.exports;k()(Ca,{VCard:be["a"],VContainer:x["a"],VTab:ke["a"],VTabItem:xe["a"],VTabs:Ne["a"]});var Sa=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.grants,"hide-default-footer":!0},scopedSlots:e._u([{key:"items",fn:function(t){return[a("td",[e._v(e._s(t.item.grantee))]),a("td",[e._v(e._s(t.item.privilegeType))])]}}])})],1)},_a=[],Ea={name:"TableGrants",props:{grants:{type:Array,required:!0}},methods:{changeSort(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},data:()=>({headers:[{text:"Grantor",sortable:!0,value:"grantor"},{text:"Privilege Type",sortable:!0,value:"privilegeType"}],pagination:{sortBy:"constraintName",rowsPerPage:-1}})},Pa=Ea,Da=Object(y["a"])(Pa,Sa,_a,!1,null,null,null),Ia=Da.exports;k()(Da,{VContainer:x["a"],VDataTable:ce["a"]});var wa=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.grants,"hide-default-footer":!0},scopedSlots:e._u([{key:"items",fn:function(t){return[a("td",[e._v(e._s(t.item.tableSchema))]),a("td",[e._v(e._s(t.item.tableName))]),a("td",[e._v(e._s(t.item.columnName))]),a("td",[e._v(e._s(t.item.grantee))]),a("td",[e._v(e._s(t.item.grantor))]),a("td",[e._v(e._s(t.item.privilegeType))]),a("td",[e._v(e._s(t.item.isGrantable))])]}}])})],1)},Ra=[],Oa={name:"TableGrants",props:{grants:{type:Array,required:!0}},methods:{changeSort(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},data:()=>({headers:[{text:"Schema",sortable:!0,value:"tableSchema"},{text:"Table",sortable:!0,value:"tableName"},{text:"Column",sortable:!0,value:"columnName"},{text:"Grantee",sortable:!0,value:"grantee"},{text:"Grantor",sortable:!0,value:"grantor"},{text:"Privilege Type",sortable:!0,value:"privilegeType"},{text:"Is Grantable",sortable:!0,value:"isGrantable"}],pagination:{sortBy:"constraintName",rowsPerPage:-1}})},Va=Oa,$a=Object(y["a"])(Va,wa,Ra,!1,null,null,null),Aa=$a.exports;k()($a,{VContainer:x["a"],VDataTable:ce["a"]});var ja=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.policies,"hide-default-footer":!0},scopedSlots:e._u([{key:"items",fn:function(t){return[a("td",[e._v(e._s(t.item.policyName))]),a("td",[e._v(e._s(t.item.roles))]),a("td",[e._v(e._s(t.item.cmd))]),a("td",[e._v(e._s(t.item.qual))]),a("td",[e._v(e._s(t.item.withCheck))])]}}])})],1)},Fa=[],La={name:"TablePolicies",props:{policies:{type:Array,required:!0}},methods:{changeSort(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},data:()=>({headers:[{text:"Policy Name",sortable:!0,value:"policyName"},{text:"Roles",sortable:!0,value:"roles"},{text:"Cmd",sortable:!0,value:"cmd"},{text:"Qual",sortable:!0,value:"qual"},{text:"With Check",sortable:!0,value:"withCheck"}],pagination:{sortBy:"constraintName",rowsPerPage:-1}})},qa=La,Ga=Object(y["a"])(qa,ja,Fa,!1,null,null,null),Ua=Ga.exports;k()(Ga,{VContainer:x["a"],VDataTable:ce["a"]});var Ba=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("table-trigger-set",{staticClass:"pa-1 ma-1 green",attrs:{actionTiming:"BEFORE",eventManipulation:"INSERT",triggers:e.beforeInsert}}),a("table-trigger-set",{staticClass:"pa-1 ma-1 green darken-2",attrs:{actionTiming:"BEFORE",eventManipulation:"UPDATE",triggers:e.beforeUpdate}}),a("table-trigger-set",{staticClass:"pa-1 ma-1 green darken-4",attrs:{actionTiming:"BEFORE",eventManipulation:"DELETE",triggers:e.beforeDelete}}),a("table-trigger-set",{staticClass:"pa-1 ma-1 blue",attrs:{actionTiming:"AFTER",eventManipulation:"INSERT",triggers:e.afterInsert}}),a("table-trigger-set",{staticClass:"pa-1 ma-1 blue darken-2",attrs:{actionTiming:"AFTER",eventManipulation:"UPDATE",triggers:e.afterUpdate}}),a("table-trigger-set",{staticClass:"pa-1 ma-1 blue darken-4",attrs:{actionTiming:"AFTER",eventManipulation:"DELETE",triggers:e.afterDelete}})],1)},Ma=[],za=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("h4",[e._v(e._s(e.actionTiming)+" - "+e._s(e.eventManipulation))]),a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.mappedTriggers,"hide-default-footer":!0,"item-key":"id","show-expand":""},scopedSlots:e._u([{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.headers.length+1}},[a("function",{attrs:{id:t.item.functionId,context:"trigger"}})],1)]}}])})],1)},Ha=[],Qa=a("243e"),Wa={name:"TableTriggers",props:{actionTiming:{type:String,required:!0},eventManipulation:{type:String,required:!0},triggers:{type:Array,required:!0}},components:{Function:Qa["a"]},computed:{mappedTriggers(){return this.triggers.map(e=>{const t=""+e.actionStatement.split(" ")[2].split("(")[0];return{...e,functionId:t}}).sort((e,t)=>e.actionTiming<t.actionTiming)}},methods:{changeSort(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},data:()=>({headers:[{text:"Name",sortable:!0,value:"triggerName",width:"20%"},{text:"Timing",sortable:!0,value:"actionTiming",width:"10%"},{text:"Trigger On",sortable:!0,value:"eventManipulation",width:"10%"},{text:"Statement",sortable:!0,value:"actionStatement",width:"60%"}],pagination:{sortBy:"triggerName",rowsPerPage:-1}})},Ka=Wa,Ja=Object(y["a"])(Ka,za,Ha,!1,null,null,null),Xa=Ja.exports;k()(Ja,{VContainer:x["a"],VDataTable:ce["a"]});var Ya={name:"TableTriggers",props:{triggers:{type:Array,required:!0}},components:{TableTriggerSet:Xa},computed:{beforeInsert(){return this.triggers.filter(e=>"BEFORE"===e.actionTiming&&"INSERT"===e.eventManipulation)},beforeUpdate(){return this.triggers.filter(e=>"BEFORE"===e.actionTiming&&"UPDATE"===e.eventManipulation)},beforeDelete(){return this.triggers.filter(e=>"BEFORE"===e.actionTiming&&"DELETE"===e.eventManipulation)},afterInsert(){return this.triggers.filter(e=>"AFTER"===e.actionTiming&&"INSERT"===e.eventManipulation)},afterUpdate(){return this.triggers.filter(e=>"AFTER"===e.actionTiming&&"UPDATE"===e.eventManipulation)},afterDelete(){return this.triggers.filter(e=>"AFTER"===e.actionTiming&&"DELETE"===e.eventManipulation)}}},Za=Ya,ei=Object(y["a"])(Za,Ba,Ma,!1,null,null,null),ti=ei.exports;k()(ei,{VContainer:x["a"]});var ai=a("861c"),ii=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("v-tab",{key:"allIndices",attrs:{ripple:""}},[e._v("\n    All Indices\n  ")]),a("v-tab-item",{key:"allIndices"},[a("v-card",{attrs:{flat:""}},[a("generic-index-set",{attrs:{indexEvaluations:e.allIndexEvaluations}})],1)],1),a("v-tab",{key:"fkIndices",attrs:{ripple:""}},[e._v("\n    Foreign Key Constraints\n  ")]),a("v-tab-item",{key:"fkIndices"},[a("v-card",{attrs:{flat:""}},[a("fk-index-constraints",{attrs:{fkIndexEvaluations:e.fkIndexEvaluations}})],1)],1),a("v-tab",{key:"uqIndices",attrs:{ripple:""}},[e._v("\n    Unique Constraints\n  ")]),a("v-tab-item",{key:"uqIndices"},[a("v-card",{attrs:{flat:""}},[a("uq-index-set",{attrs:{uqIndexEvaluations:e.uqIndexEvaluations}})],1)],1),a("v-tab",{key:"chk",attrs:{ripple:"",hidden:e.hideCheckConstraints}},[e._v("\n    Check Constraints\n  ")]),a("v-tab-item",{key:"chk"},[a("v-card",{attrs:{flat:""}},[a("check-constraints",{attrs:{checkConstraints:e.checkConstraints}})],1)],1),a("v-tab",{key:"drop",attrs:{ripple:""}},[e._v("\n    Create Indices Script\n  ")]),a("v-tab-item",{key:"drop"},[a("v-card",{attrs:{flat:""}},[a("script-viewer",{attrs:{scriptText:e.createIndicesScript,skipFormat:""}})],1)],1),a("v-tab",{key:"create",attrs:{ripple:""}},[e._v("\n    Drop Indices Script\n  ")]),a("v-tab-item",{key:"create"},[a("v-card",{attrs:{flat:""}},[a("script-viewer",{attrs:{scriptText:e.dropIndicesScript}})],1)],1)],1)},ni=[],li=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{fluid:""}},[e.badIndices.length>0?a("v-card",{staticClass:"ma-3 pa-3 red darken-3",attrs:{dense:""}},[a("h2",[e._v("Over-Indexed")]),a("hr"),a("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{items:e.badIndices,headers:e.headers,"hide-default-footer":"","show-expand":"","calculate-widths":"",dense:"","items-per-page":e.badIndices.length},scopedSlots:e._u([{key:"item.tableSchema",fn:function(t){var a=t.item;return[e._v("\n        "+e._s(a.tableKey.split(".")[0])+"\n      ")]}},{key:"item.tableName",fn:function(t){var i=t.item;return[i.tableKey?a("router-link",{attrs:{to:{name:"table",params:{id:i.tableKey}},target:"_blank"}},[e._v(e._s(i.tableKey.split(".")[1]))]):e._e()]}},{key:"item.columnDisplay",fn:function(t){var i=t.item;return e._l(i.columnDisplay,(function(t){return a("div",{key:t},[e._v(e._s(t))])}))}},{key:"item.evaluation",fn:function(t){var i=t.item;return e._l(i.evaluation,(function(t){return a("div",{key:t,class:i.indexDisplayClass},[e._v(e._s(t))])}))}},{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.headers.length+1}},[a("generic-index-detail",{attrs:{evaluation:t.item}})],1)]}}],null,!1,589962001)})],1):e._e(),a("v-card",{staticClass:"ma-3 pa-3 green darken-3",attrs:{dense:""}},[a("h2",[e._v("Indexed")]),a("hr"),a("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{items:e.goodIndices,headers:e.headers,"hide-default-footer":"","show-expand":"","calculate-widths":"",dense:"","items-per-page":e.goodIndices.length},scopedSlots:e._u([{key:"item.tableSchema",fn:function(t){var a=t.item;return[e._v("\n        "+e._s(a.tableKey.split(".")[0])+"\n      ")]}},{key:"item.tableName",fn:function(t){var i=t.item;return[i.tableKey?a("router-link",{attrs:{to:{name:"table",params:{id:i.tableKey}},target:"_blank"}},[e._v(e._s(i.tableKey.split(".")[1]))]):e._e()]}},{key:"item.columnDisplay",fn:function(t){var i=t.item;return e._l(i.columnDisplay,(function(t){return a("div",{key:t},[e._v(e._s(t))])}))}},{key:"item.evaluation",fn:function(t){var i=t.item;return e._l(i.evaluation,(function(t){return a("div",{key:t,class:i.indexDisplayClass},[e._v(e._s(t))])}))}},{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.headers.length+1}},[a("generic-index-detail",{attrs:{evaluation:t.item}})],1)]}}])})],1)],1)},oi=[],si=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("h2",[e._v("Existing Indices")]),a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.evaluation.indices,"hide-default-footer":!0,"show-expand":"","show-select":""},on:{"item-selected":e.itemSelected},scopedSlots:e._u([{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.headers.length+2}},[a("h2",[e._v("Current Realization in Database Under Development")]),a("script-viewer",{attrs:{scriptText:t.item.indexDefinition,showReadability:!1,showToolbar:!1}})],1)]}}]),model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}},[a("template",{slot:"header.data-table-select"},[e._v("\n      Drop\n    ")])],2),a("h2",[e._v("Current Realization To Be Generated")]),a("script-viewer",{attrs:{scriptText:e.desiredRealization,showReadability:!1}})],1)},ri=[],ci={name:"GenericIndexDetail",props:{evaluation:{type:Object,required:!0}},components:{ScriptViewer:xt["a"]},methods:{itemSelected(e){this.$store.commit("toggleIndexForDrop",e)}},computed:{existingIndices(){return this.evaluation.indices||[]},desiredRealization(){const e=this.evaluation.desiredRealization.drop?"-- INDICES TO DROP\n\n "+this.evaluation.desiredRealization.drop:"",t=this.evaluation.desiredRealization.create?"-- INDICES TO CREATE\n\n "+this.evaluation.desiredRealization.create:"",a=e.concat("\n\n").concat(t);return a}},data:()=>({selected:[],headers:[{text:"",value:"drop",width:"5%"},{text:"Index Name",value:"indexName"}]}),mounted(){this.evaluation.indices.map(e=>e.indexName);this.selected=this.evaluation.indices.filter(e=>void 0!==this.$store.state.indicesToDrop[e.indexName])}},di=ci,ui=Object(y["a"])(di,si,ri,!1,null,null,null),mi=ui.exports;k()(ui,{VContainer:x["a"],VDataTable:ce["a"]});const pi="MULTIPLE_INDICES";var hi={name:"GenericIndexSet",props:{indexEvaluations:{type:Array,required:!0}},components:{GenericIndexDetail:mi},methods:{changeSort(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},computed:{goodIndices(){return this.indexEvaluations.filter(e=>e.evaluation!==pi).map(e=>({...e,columnDisplay:e.idxColumns,evaluation:e.evaluation.split(", ")}))},badIndices(){return this.indexEvaluations.filter(e=>e.evaluation===pi).map(e=>({...e,columnDisplay:e.idxColumns,evaluation:e.evaluation.split(", ")}))}},data:()=>({selected:[],headers:[{text:"Schema",value:"tableSchema",width:"10%"},{text:"Table",value:"tableName",width:"10%"},{text:"Index Columns",value:"columnDisplay",width:"40%"},{text:"Evaluation",value:"evaluation",width:"40%"}],pagination:{sortBy:"constraintName",rowsPerPage:-1}})},fi=hi,bi=Object(y["a"])(fi,li,oi,!1,null,null,null),vi=bi.exports;k()(bi,{VCard:be["a"],VContainer:x["a"],VDataTable:ce["a"]});var yi=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-card",{staticClass:"ma-3 pa-3 blue-grey",attrs:{dense:""}},[a("h2",[e._v("Single-Column Foreign Keys")]),a("hr"),a("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{headers:e.headers,items:e.singleColumnItems,"hide-default-footer":"","show-expand":"","calculate-widths":"",dense:"","items-per-page":e.singleColumnItems.length},scopedSlots:e._u([{key:"item.fkIndexEvaluation",fn:function(t){var i=t.item;return[a("span",{class:i.indexDisplayClass},[e._v(e._s(i.fkIndexEvaluation))])]}},{key:"item.fkTable",fn:function(t){var i=t.item;return[i.fkTableLinkId?a("router-link",{attrs:{to:{name:"table",params:{id:i.fkTableLinkId}},target:"_blank"}},[e._v(e._s(i.fkTable))]):e._e()]}},{key:"item.fkSource",fn:function(t){var i=t.item;return e._l(i.fkSource,(function(t){return a("div",{key:t},[e._v(e._s(t))])}))}},{key:"item.fkTarget",fn:function(t){var i=t.item;return e._l(i.fkTarget,(function(t){return a("div",{key:t},[e._v(e._s(t))])}))}},{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.headers.length+1}},[a("generic-index-detail",{attrs:{evaluation:t.item}})],1)]}}])})],1),a("v-card",{staticClass:"ma-3 pa-3 blue-grey darken-4",attrs:{dense:""}},[a("h2",[e._v("Multi-Column Foreign Keys")]),a("hr"),a("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{headers:e.headers,items:e.multiColumnItems,"hide-default-footer":"","show-expand":"","calculate-widths":"",dense:"","items-per-page":e.multiColumnItems.length},scopedSlots:e._u([{key:"item.fkIndexEvaluation",fn:function(t){var i=t.item;return[a("span",{class:i.indexDisplayClass},[e._v(e._s(i.fkIndexEvaluation))])]}},{key:"item.fkTable",fn:function(t){var i=t.item;return[i.fkTableLinkId?a("router-link",{attrs:{to:{name:"table",params:{id:i.fkTableLinkId}},target:"_blank"}},[e._v(e._s(i.fkTable))]):e._e()]}},{key:"item.fkSource",fn:function(t){var i=t.item;return e._l(i.fkSource,(function(t){return a("div",{key:t},[e._v(e._s(t))])}))}},{key:"item.fkTarget",fn:function(t){var i=t.item;return e._l(i.fkTarget,(function(t){return a("div",{key:t},[e._v(e._s(t))])}))}},{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.headers.length+1}},[a("generic-index-detail",{attrs:{evaluation:t.item}})],1)]}}])})],1)],1)},gi=[],ki={name:"FkIndexConstraints",components:{GenericIndexDetail:mi},props:{fkIndexEvaluations:{type:Object,required:!0}},methods:{changeSort(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},computed:{singleColumnItems(){return Object.values(this.fkIndexEvaluations.singleColumn).flat()},multiColumnItems(){return Object.values(this.fkIndexEvaluations.multiColumn).filter(e=>e.length>0).flat()}},data:()=>({headers:[{text:"Constraint Name",value:"constraintName",width:"15%"},{text:"FK Table",value:"fkTable",width:"15%"},{text:"FK Source",value:"fkSource",width:"25%"},{text:"FK Target",value:"fkTarget",width:"25%"},{text:"Index",value:"fkIndexEvaluation",width:"20%"}]})},xi=ki,Ni=Object(y["a"])(xi,yi,gi,!1,null,null,null),Ci=Ni.exports;k()(Ni,{VCard:be["a"],VContainer:x["a"],VDataTable:ce["a"]});var Ti=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-card",{staticClass:"ma-3 pa-3 purple",attrs:{dense:""}},[a("h2",[e._v("Single-Column Unique Indices")]),a("hr"),a("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{headers:e.headers,items:e.singleColumnItems,"hide-default-footer":"","show-expand":"","calculate-widths":"",dense:"","items-per-page":e.singleColumnItems.length},scopedSlots:e._u([{key:"item.uqTableId",fn:function(t){var i=t.item;return[i.uqTableId?a("router-link",{attrs:{to:{name:"table",params:{id:i.uqTableId}},target:"_blank"}},[e._v(e._s(i.uqTableId))]):e._e()]}},{key:"item.uqIndexEvaluation",fn:function(t){var i=t.item;return[a("span",{class:i.indexDisplayClass},[e._v(e._s(i.uqIndexEvaluation))])]}},{key:"item.uqSource",fn:function(t){var i=t.item;return e._l(i.idxColumns,(function(t){return a("div",{key:t},[e._v(e._s(t))])}))}},{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.headers.length+1}},[a("generic-index-detail",{attrs:{evaluation:t.item}})],1)]}}])})],1),a("v-card",{staticClass:"ma-3 pa-3 purple darken-4",attrs:{dense:""}},[a("h2",[e._v("Multi-Column Unique Indices")]),a("hr"),a("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{headers:e.headers,items:e.multiColumnItems,"hide-default-footer":"","show-expand":"","calculate-widths":"",dense:"","items-per-page":e.multiColumnItems.length},scopedSlots:e._u([{key:"item.uqTableId",fn:function(t){var i=t.item;return[i.uqTableId?a("router-link",{attrs:{to:{name:"table",params:{id:i.uqTableId}},target:"_blank"}},[e._v(e._s(i.uqTableId))]):e._e()]}},{key:"item.uqIndexEvaluation",fn:function(t){var i=t.item;return[a("span",{class:i.indexDisplayClass},[e._v(e._s(i.uqIndexEvaluation))])]}},{key:"item.uqSource",fn:function(t){var i=t.item;return e._l(i.idxColumns,(function(t){return a("div",{key:t},[e._v(e._s(t))])}))}},{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.headers.length+1}},[a("generic-index-detail",{attrs:{evaluation:t.item}})],1)]}}])})],1)],1)},Si=[],_i={name:"TableUqIndices",components:{GenericIndexDetail:mi},props:{uqIndexEvaluations:{type:Object,required:!0}},methods:{changeSort(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},computed:{singleColumnItems(){return Object.values(this.uqIndexEvaluations.singleColumn).flat()},multiColumnItems(){return Object.values(this.uqIndexEvaluations.multiColumn).flat()}},data:()=>({headers:[{text:"Constraint Name",value:"constraintName",width:"25%"},{text:"Table",value:"uqTableId",width:"20%"},{text:"Uq Column",value:"uqSource",width:"25%"},{text:"Index",value:"uqIndexEvaluation",width:"30%"}]})},Ei=_i,Pi=Object(y["a"])(Ei,Ti,Si,!1,null,null,null),Di=Pi.exports;k()(Pi,{VCard:be["a"],VContainer:x["a"],VDataTable:ce["a"]});var Ii=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-card",{staticClass:"ma-3 pa-3 blue darken-4",attrs:{dense:""}},[a("h2",[e._v("Check Constraints")]),a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.mappedConstraints,"hide-default-footer":!0}})],1)],1)},wi=[],Ri={name:"CheckConstraints",props:{checkConstraints:{type:Array,required:!0}},computed:{mappedConstraints(){return this.checkConstraints.map(e=>({...e,expanded:!1,tableName:e.tableConstraints[0].tableName}))}},methods:{changeSort(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},data:()=>({headers:[{text:"Name",sortable:!0,value:"constraintName"},{text:"Check Clause",sortable:!0,value:"checkClause"}],pagination:{sortBy:"constraintName",rowsPerPage:-1}})},Oi=Ri,Vi=Object(y["a"])(Oi,Ii,wi,!1,null,null,null),$i=Vi.exports;k()(Vi,{VCard:be["a"],VContainer:x["a"],VDataTable:ce["a"]});var Ai={name:"ConstraintsAndIndices",components:{GenericIndexSet:vi,FkIndexConstraints:Ci,UqIndexSet:Di,CheckConstraints:$i,ScriptViewer:xt["a"]},props:{tableSchema:{type:String,required:!1},tableName:{type:String,required:!1}},methods:{},computed:{allIndexEvaluations(){const e=Object.values(this.$store.state.genericIndexEvaluations),t=this.tableSchema?e.filter(e=>e.tableKey.split(".")[0]===this.tableSchema):e,a=this.tableName?e.filter(e=>e.tableKey.split(".")[0]===this.tableSchema&&e.tableKey.split(".")[1]===this.tableName):t;return a},fkIndexEvaluations(){const e=this.$store.state.fkIndexEvaluations,t=this.tableSchema?{singleColumn:Object.values(e.singleColumn).filter(e=>{const t=e[0]||{};return!this.tableSchema||t.tableSchema===this.tableSchema}),multiColumn:Object.values(e.multiColumn).filter(e=>{const t=e[0]||{};return!this.tableSchema||t.tableSchema===this.tableSchema})}:e,a=this.tableName?{singleColumn:Object.values(t.singleColumn).filter(e=>{const t=e[0]||{};return!this.tableName||t.tableName===this.tableName}),multiColumn:Object.values(t.multiColumn).filter(e=>{const t=e[0]||{};return!this.tableName||t.tableName===this.tableName})}:t;return a},uqIndexEvaluations(){const e=this.$store.state.uqIndexEvaluations,t=this.tableSchema?{singleColumn:Object.values(e.singleColumn).filter(e=>{const t=e[0]||{};return!this.tableSchema||t.tableSchema===this.tableSchema}),multiColumn:Object.values(e.multiColumn).filter(e=>{const t=e[0]||{};return!this.tableSchema||t.tableSchema===this.tableSchema})}:e,a=this.tableName?{singleColumn:Object.values(t.singleColumn).filter(e=>{const t=e[0]||{};return!this.tableName||t.tableName===this.tableName}),multiColumn:Object.values(t.multiColumn).filter(e=>{const t=e[0]||{};return!this.tableName||t.tableName===this.tableName})}:t;return a},hideCheckConstraints(){return null===this.tableName||void 0===this.tableName},checkConstraints(){return this.tableSchema&&this.tableName?this.$store.state.managedSchemata.find(e=>e.schemaName===this.tableSchema).schemaTables.find(e=>e.tableName===this.tableName).checkConstraints:[]},createIndicesScript(){const e=Object.values(this.$store.state.fkIndexEvaluations.singleColumn).filter(e=>e.length>0).filter(e=>!this.tableName||this.tableName===e[0].tableName).filter(e=>!this.tableSchema||this.tableSchema===e[0].tableSchema).map(e=>e[0]),t=Object.values(this.$store.state.fkIndexEvaluations.multiColumn).filter(e=>e.length>0).filter(e=>!this.tableName||this.tableName===e[0].tableName).filter(e=>!this.tableSchema||this.tableSchema===e[0].tableSchema),a=Object.values(this.$store.state.uqIndexEvaluations.singleColumn).filter(e=>e.length>0).filter(e=>!this.tableName||this.tableName===e[0].tableName).filter(e=>!this.tableSchema||this.tableSchema===e[0].tableSchema).map(e=>e[0]),i=Object.values(this.$store.state.uqIndexEvaluations.multiColumn).filter(e=>e.length>0).filter(e=>!this.tableName||this.tableName===e[0].tableName).filter(e=>!this.tableSchema||this.tableSchema===e[0].tableSchema),n=[...e,...t,...a,...i].flat(),l=(n.map(e=>e.idxKey),Object.values(this.$store.state.genericIndexEvaluations).filter(e=>1===e.idxColumns.length).filter(e=>0===n.filter(t=>t.id===e.id).length).filter(e=>!this.tableName||this.tableName===e.tableName).filter(e=>!this.tableSchema||this.tableSchema===e.tableSchema)),o=[...n,...l].flat().reduce((e,t)=>{const a=e.find(e=>e.idxKey===t.idxKey);if(a){const i=e.filter(e=>e.idxKey!==t.idxKey),n=a.indices.map(e=>e.id),l=t.indices.filter(e=>-1===n.indexOf(e.id));return[...i,{...a,indices:[...a.indices,...l]}]}return[...e,t]},[]);return o.reduce((e,t)=>t.desiredRealization.create?e.concat(t.desiredRealization.create+"\n"):e,"")},dropIndicesScript(){return Object.values(this.$store.state.indicesToDrop).reduce((e,t)=>this.tableName&&this.tableName!==t.tableName||this.schemaName&&this.tableSchema!==t.tableSchema?e:e.concat(`---- DROP INDEX: ${t.indexName}\n${t.indexDrop}\n----------\n\n`),"")}},data:()=>({activeTab:0})},ji=Ai,Fi=Object(y["a"])(ji,ii,ni,!1,null,null,null),Li=Fi.exports;k()(Fi,{VCard:be["a"],VTab:ke["a"],VTabItem:xe["a"],VTabs:Ne["a"]});var qi=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("v-tab",{key:"tableDefinition",attrs:{ripple:""}},[e._v("\n      Definition\n    ")]),a("v-tab-item",{key:"tableDefinition"},[a("v-card",{attrs:{flat:""}},[a("script-viewer",{attrs:{scriptText:e.tableDefinition,showReadability:!1}})],1)],1),a("v-tab",{key:"tableIndices",attrs:{ripple:""}},[e._v("\n      Indices\n    ")]),a("v-tab-item",{key:"tableIndices"},[a("v-card",{attrs:{flat:""}},[a("script-viewer",{attrs:{scriptText:e.tableIndicesRealization,showReadability:!1}})],1)],1),a("v-tab",{key:"tableSecurityPolicy",attrs:{ripple:""}},[e._v("\n      Security Policy Script\n    ")]),a("v-tab-item",{key:"tableSecurityPolicy"},[a("v-card",{attrs:{flat:""}},[a("table-policy-realization",{attrs:{policyDefinition:e.policyDefinition,table:e.tableInfo}})],1)],1)],1)],1)},Gi=[],Ui=a("96b5"),Bi={name:"TableScripts",components:{ScriptViewer:xt["a"],TablePolicyRealization:Ui["a"]},props:{tableInfo:{type:Object,required:!0}},computed:{tableDefinition(){return"TABLE DEFINITION NOT IMPLMENTED YET"},tableIndicesRealization(){const e=Object.values(this.$store.state.genericIndexEvaluations).filter(e=>e.tableKey===`${this.tableInfo.tableSchema}.${this.tableInfo.tableName}`),t=e.reduce((e,t)=>""!==t.desiredRealization.drop?[...e,t.desiredRealization.drop]:e,[]),a=e.reduce((e,t)=>""!==t.desiredRealization.create?[...e,t.desiredRealization.create]:e,[]),i=t.length>0?"-- INDICES TO DROP\n\n"+t.join(""):"",n=a.length>0?"-- INDICES TO CREATE\n\n"+a.join(""):"",l=i.concat("\n\n").concat(n);return l},policyDefinition(){const e=this.$store.state.tablePolicyAssignments[`${this.tableInfo.tableSchema}.${this.tableInfo.tableName}`].policyDefinitionId;return this.$store.state.policies.find(t=>t.id===e)}},methods:{},data:()=>({activeTab:null})},Mi=Bi,zi=Object(y["a"])(Mi,qi,Gi,!1,null,null,null),Hi=zi.exports;k()(zi,{VCard:be["a"],VContainer:x["a"],VTab:ke["a"],VTabItem:xe["a"],VTabs:Ne["a"]});var Qi={name:"Table",components:{TableDetail:st,TableColumns:bt,TableConstraints:Ta,TableIndices:ea,TableGrants:Ia,TableColumnGrants:Aa,TablePolicies:Ua,TableTriggers:ti,TablePolicyDefinition:ai["a"],ConstraintsAndIndices:Li,TableScripts:Hi},props:{id:{type:String,required:!0}},computed:{tableInfo(){const e=this.$store.state.managedSchemata.find(e=>e.schemaName===this.tableSchema),t=e.schemaTables.find(e=>e.tableName===this.tableName),a=this.$store.state.tablePolicyAssignments[this.id].policyDefinitionId;return{...t,policyDefinitionId:a}},tableName(){return this.id.split(".")[1]},tableSchema(){return this.id.split(".")[0]},tableColumns(){return this.tableInfo.tableColumns||[]},indices(){return this.tableInfo.indices||[]},tableGrants(){return this.tableInfo.roleTableGrants||[]},tableColumnGrants(){return this.tableInfo.roleColumnGrants||[]},tablePolicies(){return this.tableInfo.policies||[]},tableTriggers(){return this.tableInfo.triggers||[]}},methods:{},data:()=>({activeTab:null}),beforeRouteUpdate(e,t,a){a()}},Wi=Qi,Ki=Object(y["a"])(Wi,Be,Me,!1,null,null,null),Ji=Ki.exports;k()(Ki,{VCard:be["a"],VContainer:x["a"],VTab:ke["a"],VTabItem:xe["a"],VTabs:Ne["a"]});var Xi=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("h1",[e._v(e._s(e.id))]),a("hr"),a("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("v-tab",{key:"cols",attrs:{ripple:""}},[e._v("\n      Columns\n    ")]),a("v-tab-item",{key:"cols"},[a("v-card",{attrs:{flat:""}},[a("view-columns",{attrs:{viewInfo:e.tableInfo}})],1)],1)],1)],1)},Yi=[],Zi=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{fluid:""}},[a("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{headers:e.headers,items:e.tableDetail,"hide-default-footer":"","calculate-widths":"",dense:"","items-per-page":100}})],1)},en=[],tn={name:"ViewColumns",props:{viewInfo:{type:Object,required:!0}},components:{},methods:{},computed:{tableDetail(){const e=this.viewInfo.tableColumns||[];return e}},data:()=>({headers:[{text:"Ordinal",sortable:!0,value:"ordinalPosition"},{text:"Column Name",sortable:!0,value:"columnName"},{text:"Data Type",sortable:!0,value:"dataType"}],pagination:{sortBy:"ordinalPosition",rowsPerPage:-1}})},an=tn,nn=Object(y["a"])(an,Zi,en,!1,null,null,null),ln=nn.exports;k()(nn,{VContainer:x["a"],VDataTable:ce["a"]});var on={name:"DbView",components:{ViewColumns:ln},props:{id:{type:String,required:!0}},computed:{tableInfo(){const e=this.$store.state.managedSchemata.find(e=>e.schemaName===this.tableSchema),t=e.schemaTables.find(e=>e.tableName===this.tableName);return{...t}},tableName(){return this.id.split(".")[1]},tableSchema(){return this.id.split(".")[0]},tableColumns(){return this.tableInfo.tableColumns||[]}},methods:{},data:()=>({activeTab:null}),beforeRouteUpdate(e,t,a){a()}},sn=on,rn=Object(y["a"])(sn,Xi,Yi,!1,null,null,null),cn=rn.exports;k()(rn,{VCard:be["a"],VContainer:x["a"],VTab:ke["a"],VTabItem:xe["a"],VTabs:Ne["a"]});var dn=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{"ma-0":"","pa-0":""}},[a("h1",[e._v("Role Manager")]),a("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("v-tab",{key:"roles",attrs:{ripple:""}},[e._v("\n      Roles\n    ")]),a("v-tab-item",{key:"roles"},[a("v-card",[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("v-card",{key:"roles"},[a("roles")],1)],1)],1)],1)],1),a("v-tab",{key:"script",attrs:{ripple:""}},[e._v("\n      Create Roles Script\n    ")]),a("v-tab-item",{key:"script"},[a("v-card",[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("v-card",{key:"script"},[a("create-roles-realization")],1)],1)],1)],1)],1)],1)],1)},un=[],mn=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("script-viewer",{attrs:{scriptText:e.computedPolicy,skipFormat:"",canExecute:""},on:{"readability-changed":e.policyReadabilityChanged}})],1)},pn=[],hn=a("4eb5"),fn=a.n(hn);function bn(e){const t=e.roleSet.dbOwnerRole;return`\n------------  DB OWNER ROLE ------------\nDO\n$body$\nBEGIN\n  IF NOT EXISTS (\n    SELECT    *\n    FROM   pg_catalog.pg_roles\n    WHERE  rolname = '${t.roleName}')\n  THEN\n    CREATE ROLE ${t.roleName};\n  END IF;\n\n  ALTER ROLE ${t.roleName} with LOGIN;\n  ALTER ROLE ${t.roleName} with CREATEDB;\n\nEND\n$body$;\n--||--\n---------- END DB OWNER ROLE -----------\n  `}function vn(e){const t=e.roleSet.dbAuthenticatorRole,a=e.roleSet.dbUserRoles;return`\n------------  DB AUTHENTICATOR ROLE ------------\nDO\n$body$\nBEGIN\n  IF NOT EXISTS (\n    SELECT    *\n    FROM   pg_catalog.pg_roles\n    WHERE  rolname = '${t.roleName}')\n  THEN\n    CREATE ROLE ${t.roleName};\n  END IF;\n\nALTER ROLE ${t.roleName} with LOGIN;\nALTER ROLE ${t.roleName} with NOINHERIT;\n\n${a.map(e=>`GRANT ${e.roleName} TO ${t.roleName};`).join("\n")}\n\nEND\n$body$;\n--||--\n---------- END DB AUTHENTICATOR ROLE -----------\n  `}function yn(e){const t=e.roleSet.dbUserRoles.sort((e,t)=>e.applicableRoles.length-t.applicableRoles.length);return`\n---------- DB USER ROLES -----------\n${t.map(e=>`\n    ------------ ${e.roleName}\n      DO\n      $body$\n      BEGIN\n        IF NOT EXISTS (\n          SELECT    *\n          FROM   pg_catalog.pg_roles\n          WHERE  rolname = '${e.roleName}'\n        ) THEN\n          CREATE ROLE ${e.roleName};\n        END IF;\n\n        ALTER ROLE ${e.roleName} with NOLOGIN;\n        ${e.applicableRoles.map(t=>`\n        GRANT ${t.roleName} TO ${e.roleName};`).join("")}\n\n      END\n      $body$;\n      --||--\n    -------- END ${e.roleName}\n`).join("\n")}\n---------- END USER ROLES ----------\n\n`}function gn(e){return["\n----------\n----------  BEGIN POSTGRES ROLES SQL\n----------\n    ",bn(e),yn(e),vn(e),"\n----------\n----------  END POSTGRES ROLES SQL\n----------\n--==\n"].join("\n")}var kn=gn,xn={name:"CreateRolesRealization",mixins:[fn.a],components:{ScriptViewer:xt["a"]},props:{},data(){return{policyReadability:"terse",computedPolicy:"N/A"}},mounted(){this.doComputePolicy()},watch:{policyReadability(){this.doComputePolicy()},enableRls(){this.doComputePolicy()},policyDefinition(){this.doComputePolicy()}},methods:{policyReadabilityChanged(e){this.policyReadability=e},refresh(){this.doComputePolicy()},expand(){this.computedPolicy=this.computedPolicy+" "},doComputePolicy(){this.computedPolicy=kn(this.$store.state)},onCopy:function(){alert("Copied!")},onError:function(e){alert("Failed to copy texts")},executeSql(){alert("not implemented:  server config value will expose graphile extension to execute generated script")}},computed:{}},Nn=xn,Cn=Object(y["a"])(Nn,mn,pn,!1,null,null,null),Tn=Cn.exports;k()(Cn,{VContainer:x["a"]});var Sn={name:"RoleManagerView",components:{Roles:Te,CreateRolesRealization:Tn},props:{},computed:{},data:()=>({activeTab:0})},_n=Sn,En=Object(y["a"])(_n,dn,un,!1,null,null,null),Pn=En.exports;k()(En,{VCard:be["a"],VContainer:x["a"],VFlex:ye["a"],VLayout:ge["a"],VTab:ke["a"],VTabItem:xe["a"],VTabs:Ne["a"]});var Dn=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{"ma-0":"","pa-0":""}},[a("h1",[e._v("Security Management")]),a("hr"),a("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("v-tab",{key:"table-security",attrs:{ripple:"",disabled:e.initializing}},[e._v("\n      Table Security\n    ")]),a("v-tab-item",{key:"table-security"},[a("v-card",[a("table-security-view")],1)],1),a("v-tab",{key:"function-security",attrs:{ripple:"",disabled:e.initializing}},[e._v("\n      Function Security\n    ")]),a("v-tab-item",{key:"function-security"},[a("v-card",[a("function-security-view")],1)],1),a("v-tab",{key:"scripts-summary",attrs:{ripple:"",disabled:e.initializing}},[e._v("\n      Scripts Summary\n    ")]),a("v-tab-item",{key:"scripts-summary"},[a("v-card",[a("security-scripts-summary-view")],1)],1),a("v-tab",{key:"help",attrs:{ripple:""}},[e._v("\n      Help\n    ")]),a("v-tab-item",{key:"help"},[a("v-container",{attrs:{fluid:""}},[a("h2",[a("a",{attrs:{href:"https://learn.graphile.org/docs/PostgreSQL_Row_Level_Security_Infosheet.pdf",target:"_blank"}},[e._v("graphile.org rls infosheet")])]),a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{attrs:{"align-self":"stretch",cols:"12"}},[a("pdf",{attrs:{src:"https://learn.graphile.org/docs/PostgreSQL_Row_Level_Security_Infosheet.pdf"}})],1)],1)],1)],1)],1)],1)},In=[],wn=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{"ma-0":"","pa-0":""}},[a("hr"),a("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("v-tab",{key:"policyAssignment",attrs:{ripple:""}},[e._v("\n      Policy Assignment\n    ")]),a("v-tab-item",{key:"policyAssignment"},[a("v-card",[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("v-card",{key:"policyAssignment"},[a("policy-assignment")],1)],1)],1)],1)],1),a("v-tab",{key:"policies",attrs:{ripple:""}},[e._v("\n      Schema Security Scripts\n    ")]),a("v-tab-item",{key:"policies"},[a("v-card",[a("schema-security-scripts")],1)],1),a("v-tab",{key:"policy-manager",attrs:{ripple:""}},[e._v("\n      Policy Templates\n    ")]),a("v-tab-item",{key:"policy-manager"},[a("v-card",[a("policy-manager")],1)],1)],1)],1)},Rn=[],On=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-tabs",{attrs:{dark:"","slider-color":"yellow"}},[a("v-tab",{key:"by-schema",attrs:{ripple:""}},[e._v("\n      By Schema\n    ")]),a("v-tab-item",{key:"by-schema"},[a("table-policy-assignment-by-schema")],1),a("v-tab",{key:"by-policy",attrs:{ripple:""}},[e._v("\n      By Policy\n    ")]),a("v-tab-item",{key:"by-policy"},[a("table-policy-assignment-by-policy")],1)],1)],1)},Vn=[],$n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-tabs",{attrs:{dark:"","slider-color":"yellow"}},[e._l(e.managedSchemata,(function(t){return a("v-tab",{key:t.schemaName,attrs:{ripple:""}},[e._v("\n      "+e._s(t.schemaName)+"\n    ")])})),e._l(e.managedSchemata,(function(e){return a("v-tab-item",{key:e.schemaName},[a("policy-assignment-schema",{attrs:{schema:e}})],1)}))],2)],1)},An=[],jn=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-toolbar",[a("policy-assignment-dialog",{attrs:{currentPolicyDefinition:e.defaultPolicy,tables:e.selected,bulkAssign:!0,disabled:e.selected.length<1}})],1),a("v-data-table",{attrs:{headers:e.headers,items:e.tablesToShow,"item-key":"id",dense:"","disable-pagination":"","disable-sort":"","hide-default-footer":"","show-select":"","show-expand":"",expanded:e.expanded},on:{"update:expanded":function(t){e.expanded=t}},scopedSlots:e._u([{key:"item.name",fn:function(t){var a=t.item;return[e._v("\n        "+e._s(a.tableName)+"\n      ")]}},{key:"item.assignedPolicy",fn:function(t){var i=t.item;return[a("policy-assignment-dialog",{attrs:{currentPolicyDefinition:i.policyDefinition,tables:[i]},on:{policyAssigned:e.expandItems}}),e.showCustomizeButton(i)?a("table-policy-customize-dialog",{attrs:{currentPolicyDefinition:i.policyDefinition,tables:[i]},on:{policyAssigned:e.expandItems}}):e._e()]}},{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.headers.length+2}},[a("policy-definition",{key:t.item.id,attrs:{policyId:t.item.policyDefinition.id,table:t.item}})],1)]}}]),model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}})],1)},Fn=[],Ln=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-dialog",{attrs:{persistent:"",width:"800"},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[a("v-btn",e._g({staticClass:"text-none",attrs:{small:"",dark:"",disabled:e.disabled}},i),[e._v("\n        "+e._s(e.displayValue)+"\n      ")])]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[a("v-card-title",{staticClass:"headline"},[e._v("Assign Policy")]),a("v-combobox",{attrs:{items:e.allPolicyDefinitions,"item-text":"name","item-value":"id"},model:{value:e.currentSelection,callback:function(t){e.currentSelection=t},expression:"currentSelection"}}),a("v-card-actions",[a("v-spacer"),a("v-btn",{on:{click:function(t){e.dialog=!1}}},[e._v("Cancel")]),a("v-btn",{attrs:{disabled:e.updateDisabled},on:{click:e.updateTablePolicyDefinition}},[e._v("Update")]),a("v-spacer")],1)],1)],1)],1)},qn=[],Gn={name:"PolicyAssignmentDialog",props:{currentPolicyDefinition:{type:Object,required:!0},tables:{type:Array,required:!0},bulkAssign:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},mounted(){this.currentSelection=this.currentPolicyDefinition},data(){return{dialog:!1,currentSelection:null}},computed:{displayValue(){return this.bulkAssign?"Bulk Assign":this.currentPolicyDefinition?this.currentPolicyDefinition.name:"n/a"},allPolicyDefinitions(){return this.$store.state.policies.filter(e=>!e.customIdentifier)},updateDisabled(){return!this.bulkAssign&&(!this.currentPolicyDefinition||!this.currentSelection||this.currentPolicyDefinition.id===this.currentSelection.id)}},watch:{},methods:{updateTablePolicyDefinition(){this.dialog=!1;const e=this.tables.reduce((e,t)=>e.concat([t.id]),[]);this.$store.commit("assignTablePolicy",{tableIds:e,policyDefinitionId:this.currentSelection.id}),this.$emit("policyAssigned",this.tables)}}},Un=Gn,Bn=(a("35d9"),a("2b5d")),Mn=Object(y["a"])(Un,Ln,qn,!1,null,null,null),zn=Mn.exports;k()(Mn,{VBtn:B["a"],VCard:be["a"],VCardActions:ve["a"],VCardTitle:ve["c"],VCombobox:Bn["a"],VDialog:De["a"],VSpacer:W["a"]});var Hn=a("bd5a"),Qn={name:"PolicyAssignment",components:{PolicyDefinition:ai["a"],PolicyAssignmentDialog:zn,TablePolicyCustomizeDialog:Hn["a"]},props:{schema:{type:Object,required:!0}},methods:{showCustomizeButton(e){return!!e&&(!e.policyDefinition||!e.policyDefinition.customIdentifier)},expandItems(e){this.expanded=e}},watch:{},computed:{tablesToShow(){return this.schema.schemaTables.filter(e=>"BASE TABLE"===e.tableType).map(e=>{const t=this.$store.state.tablePolicyAssignments[e.id].policyDefinitionId,a=this.policies.find(e=>e.id===t)||this.defaultPolicy;return{...e,policyDefinition:a,policyDefinitionId:a.id}})},defaultPolicy(){return this.$store.state.defaultPolicy},policies(){return this.$store.state.policies}},data:()=>({loading:!1,selected:[],expanded:[],headers:[{text:"",sortable:!1},{text:"Table Name",sortable:!1,value:"name"},{text:"Assigned Policy",sortable:!1,value:"assignedPolicy"}]})},Wn=Qn,Kn=(a("cb8a"),Object(y["a"])(Wn,jn,Fn,!1,null,null,null)),Jn=Kn.exports;k()(Kn,{VDataTable:ce["a"],VToolbar:Ve["a"]});var Xn={name:"PolicyAssignment",components:{PolicyAssignmentSchema:Jn},methods:{},watch:{},computed:{policies(){return this.$store.state.policies},managedSchemata(){return this.$store.state.managedSchemata.filter(e=>e.schemaTables.length>0).map(e=>({...e,schemaTables:e.schemaTables.map(e=>{const t=this.policies.find(t=>t.id===e.policyDefinitionId);return{...e,policyDefinition:t}}).sort((e,t)=>e.name<t.name?-1:1)})).sort((e,t)=>e.schemaName<t.schemaName?-1:1)}},data:()=>({mappedSchemata:[]})},Yn=Xn,Zn=Object(y["a"])(Yn,$n,An,!1,null,null,null),el=Zn.exports;k()(Zn,{VContainer:x["a"],VTab:ke["a"],VTabItem:xe["a"],VTabs:Ne["a"]});var tl=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-expansion-panels",{attrs:{dark:"","slider-color":"yellow"}},e._l(e.mappedPolicies,(function(t){return a("v-expansion-panel",{key:t.id,attrs:{ripple:""}},[a("v-expansion-panel-header",[e._v("\n      ("+e._s(t.numberOfAssignments)+") - "+e._s(t.name)+"\n    ")]),t.numberOfAssignments>0?a("v-expansion-panel-content",[a("table-policy-assignment-policy",{attrs:{policyDefinitionId:t.id}})],1):a("v-expansion-panel-content",[a("h2",[e._v("No assignments for this policy")])])],1)})),1)],1)},al=[],il=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-toolbar",[a("policy-assignment-dialog",{attrs:{currentPolicyDefinition:e.defaultPolicy,tables:e.selected,bulkAssign:!0,disabled:e.selected.length<1}})],1),a("v-data-table",{attrs:{headers:e.headers,items:e.tablesToShow,"item-key":"id",dense:"","disable-pagination":"","disable-sort":"","hide-default-footer":"","show-select":"","show-expand":"",expanded:e.expanded},on:{"update:expanded":function(t){e.expanded=t}},scopedSlots:e._u([{key:"item.schemaName",fn:function(t){var a=t.item;return[e._v("\n        "+e._s(a.tableSchema)+"\n      ")]}},{key:"item.name",fn:function(t){var a=t.item;return[e._v("\n        "+e._s(a.tableName)+"\n      ")]}},{key:"item.assignedPolicy",fn:function(t){var i=t.item;return[a("policy-assignment-dialog",{attrs:{currentPolicyDefinition:i.policyDefinition,tables:[i]},on:{policyAssigned:e.expandItems}}),e.showCustomizeButton(i)?a("table-policy-customize-dialog",{attrs:{currentPolicyDefinition:i.policyDefinition,tables:[i]},on:{policyAssigned:e.expandItems}}):e._e()]}},{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.headers.length+2}},[a("policy-definition",{key:t.item.id,attrs:{policyId:t.item.policyDefinition.id,table:t.item}})],1)]}}]),model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}})],1)},nl=[],ll={name:"PolicyAssignment",components:{PolicyDefinition:ai["a"],PolicyAssignmentDialog:zn,TablePolicyCustomizeDialog:Hn["a"]},props:{policyDefinitionId:{type:Number,required:!0}},methods:{showCustomizeButton(e){return!!e&&(!e.policyDefinition||!e.policyDefinition.customIdentifier)},expandItems(e){this.expanded=e}},watch:{},computed:{tablesToShow(){const e=Object.keys(this.$store.state.tablePolicyAssignments).filter(e=>this.$store.state.tablePolicyAssignments[e].policyDefinitionId===this.policyDefinitionId);return this.managedSchemata.reduce((t,a)=>{const i=a.schemaTables.filter(t=>-1!==e.indexOf(t.id));return[...t,...i]},[]).map(e=>(console.log("t",e),{...e,policyDefinition:this.policyDefinition,policyDefinitionId:this.policyDefinition.id}))},policyDefinition(){return this.policies.find(e=>e.id===this.policyDefinitionId)||this.defaultPolicy},managedSchemata(){return this.$store.state.managedSchemata},defaultPolicy(){return this.$store.state.defaultPolicy},policies(){return this.$store.state.policies}},data:()=>({loading:!1,selected:[],expanded:[],headers:[{text:"",sortable:!1},{text:"Schema Name",sortable:!1,value:"tableSchema"},{text:"Table Name",sortable:!1,value:"name"},{text:"Assigned Policy",sortable:!1,value:"assignedPolicy"}]})},ol=ll,sl=(a("9969"),Object(y["a"])(ol,il,nl,!1,null,null,null)),rl=sl.exports;k()(sl,{VDataTable:ce["a"],VToolbar:Ve["a"]});var cl={name:"TablePolicyAssignmentByPolicy",components:{TablePolicyAssignmentPolicy:rl},methods:{},watch:{},computed:{mappedPolicies(){return this.policies.map(e=>{const t=Object.keys(this.tablePolicyAssignments).reduce((t,a)=>this.tablePolicyAssignments[a].policyDefinitionId===e.id?t+1:t,0);return{...e,numberOfAssignments:t}})},policies(){return this.$store.state.policies},tablePolicyAssignments(){return this.$store.state.tablePolicyAssignments}},data:()=>({mappedSchemata:[]})},dl=cl,ul=a("cd55"),ml=a("49e2"),pl=a("c865"),hl=a("0393"),fl=Object(y["a"])(dl,tl,al,!1,null,null,null),bl=fl.exports;k()(fl,{VContainer:x["a"],VExpansionPanel:ul["a"],VExpansionPanelContent:ml["a"],VExpansionPanelHeader:pl["a"],VExpansionPanels:hl["a"]});var vl={name:"TablePolicyAssignment",components:{TablePolicyAssignmentBySchema:el,TablePolicyAssignmentByPolicy:bl},methods:{},watch:{},computed:{},data:()=>({})},yl=vl,gl=Object(y["a"])(yl,On,Vn,!1,null,null,null),kl=gl.exports;k()(gl,{VContainer:x["a"],VTab:ke["a"],VTabItem:xe["a"],VTabs:Ne["a"]});var xl=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-tabs",{attrs:{dark:"","slider-color":"yellow"}},[e._l(e.allPolicies,(function(t){return a("v-tab",{key:t.name,attrs:{ripple:""}},[e._v("\n      "+e._s(t.name)+"\n    ")])})),e._l(e.allPolicies,(function(t){return a("v-tab-item",{key:t.name},[a("script-viewer",{attrs:{scriptText:t.policy,skipFormat:"",canExecute:""},on:{"readability-changed":e.policyReadabilityChanged}})],1)}))],2)],1)},Nl=[],Cl=a("2f62"),Tl=a("c92d");function Sl(e,t,a){return a.sort((e,t)=>e.tablename<t.tablename?-1:1).reduce((a,i)=>{const n=e.policies.find(t=>t.id===e.tablePolicyAssignments[i.id].policyDefinitionId),l={schemaName:i.tableSchema,tableName:i.tablename},o=Object(Tl["a"])(n,t,l,i);return a.concat(o)},"")}var _l=Sl;function El(e,t){return e.managedSchemata.filter(e=>!e.parked).filter(e=>e.schemaTables.length>0).reduce((a,i)=>{const n=i.schemaTables.filter(e=>"BASE TABLE"===e.tableType),l={name:""+i.schemaName,policy:_l(e,t,n)};return a.concat([l])},[]).sort((e,t)=>e.name<t.name?-1:1)}var Pl=El;function Dl(e,t){const a="All Schemata - Tables",i=Pl(e,t),n=i.reduce((e,t)=>e.concat(t.policy),"");return{name:a,policy:n}}var Il=Dl,wl={name:"SchemaSecurityScripts",mixins:[],components:{ScriptViewer:xt["a"]},props:{},computed:{...Object(Cl["b"])(["policies","managedSchemata"])},watch:{policyReadability(){this.computeAllPolicies()}},methods:{computeAllPolicies(){const e=Pl(this.$store.state,this.policyReadability),t=Il(this.$store.state,this.policyReadability);this.allPolicies=[...e,t]},policyReadabilityChanged(e){this.policyReadability=e},handleCopyStatus(e){alert(e)},refresh(e){this.computeAllPolicies()},expand(e){e.policy=e.policy+" "},policyText(e){return e.policy},onCopy:function(){alert("Copied!")},onError:function(e){alert("Failed to copy scripts to clipboard"),console.error(e)},executeSql(){alert("not implemented:  server config value will expose graphile extension to execute generated script")}},data:()=>({allPolicies:[],schemaPolicy:"NOT CALCULATED",defaultRlsPolicies:"NOT CALCULATED",defaultNoRlsPolicies:"NOT CALCULATED",selectedTabName:"",policyReadability:"terse"}),mounted(){this.computeAllPolicies()}},Rl=wl,Ol=Object(y["a"])(Rl,xl,Nl,!1,null,null,null),Vl=Ol.exports;k()(Ol,{VContainer:x["a"],VTab:ke["a"],VTabItem:xe["a"],VTabs:Ne["a"]});var $l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-toolbar",[a("v-dialog",{attrs:{persistent:"","max-width":"290"},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[a("v-btn",e._g({attrs:{color:"primary",dark:""}},i),[e._v("New Policy Template")])]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[a("v-card-title",{staticClass:"headline"},[e._v("New Policy")]),a("v-text-field",{attrs:{label:"Name"},model:{value:e.newPolicyName,callback:function(t){e.newPolicyName=t},expression:"newPolicyName"}}),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"green darken-1",flat:""},on:{click:e.saveNewPolicy}},[e._v("Save")]),a("v-btn",{attrs:{color:"green darken-1",flat:""},on:{click:function(t){e.dialog=!1}}},[e._v("Cancel")])],1)],1)],1)],1),a("v-data-table",{attrs:{headers:e.headers,items:e.policies,"item-key":"id",dense:"","disable-pagination":"","disable-sort":"","hide-default-footer":"","show-expand":""},scopedSlots:e._u([{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.headers.length+1}},[a("policy-definition",{key:t.item.id,attrs:{policyId:t.item.id}})],1)]}}])})],1)},Al=[],jl=a("1365"),Fl=jl["a"],Ll=a("8654"),ql=Object(y["a"])(Fl,$l,Al,!1,null,null,null),Gl=ql.exports;k()(ql,{VBtn:B["a"],VCard:be["a"],VCardActions:ve["a"],VCardTitle:ve["c"],VDataTable:ce["a"],VDialog:De["a"],VSpacer:W["a"],VTextField:Ll["a"],VToolbar:Ve["a"]});var Ul={name:"TableSecurityView",components:{SchemaSecurityScripts:Vl,PolicyManager:Gl,PolicyAssignment:kl},props:{},computed:{},data:()=>({activeTab:0})},Bl=Ul,Ml=Object(y["a"])(Bl,wn,Rn,!1,null,null,null),zl=Ml.exports;k()(Ml,{VCard:be["a"],VContainer:x["a"],VFlex:ye["a"],VLayout:ge["a"],VTab:ke["a"],VTabItem:xe["a"],VTabs:Ne["a"]});var Hl=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{"ma-0":"","pa-0":""}},[a("hr"),a("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("v-tab",{key:"policyAssignment",attrs:{ripple:""}},[e._v("\n      Policy Assignment\n    ")]),a("v-tab-item",{key:"policyAssignment"},[a("v-card",[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("v-card",{key:"policyAssignment"},[a("policy-assignment")],1)],1)],1)],1)],1),a("v-tab",{key:"policies",attrs:{ripple:""}},[e._v("\n      Schema Security Scripts\n    ")]),a("v-tab-item",{key:"policies"},[a("v-card",[a("schema-security-scripts")],1)],1),a("v-tab",{key:"policy-manager",attrs:{ripple:""}},[e._v("\n      Policy Templates\n    ")]),a("v-tab-item",{key:"policy-manager"},[a("v-card",[a("policy-manager")],1)],1)],1)],1)},Ql=[],Wl=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-toolbar",[a("v-dialog",{attrs:{persistent:"","max-width":"290"},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[a("v-btn",e._g({attrs:{color:"primary",dark:""}},i),[e._v("New Policy Template")])]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[a("v-card-title",{staticClass:"headline"},[e._v("New Policy")]),a("v-text-field",{attrs:{label:"Name"},model:{value:e.newPolicyName,callback:function(t){e.newPolicyName=t},expression:"newPolicyName"}}),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"green darken-1",text:""},on:{click:e.saveNewPolicy}},[e._v("Save")]),a("v-btn",{attrs:{color:"green darken-1",text:""},on:{click:function(t){e.dialog=!1}}},[e._v("Cancel")])],1)],1)],1)],1),a("v-data-table",{attrs:{headers:e.headers,items:e.policies,"item-key":"id",dense:"","disable-pagination":"","disable-sort":"","hide-default-footer":"","show-expand":""},scopedSlots:e._u([{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.headers.length+1}},[a("policy-definition",{key:t.item.id,attrs:{policyId:t.item.id}})],1)]}}])})],1)},Kl=[],Jl=a("6c2b"),Xl=Jl["a"],Yl=Object(y["a"])(Xl,Wl,Kl,!1,null,null,null),Zl=Yl.exports;k()(Yl,{VBtn:B["a"],VCard:be["a"],VCardActions:ve["a"],VCardTitle:ve["c"],VDataTable:ce["a"],VDialog:De["a"],VSpacer:W["a"],VTextField:Ll["a"],VToolbar:Ve["a"]});var eo=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-tabs",{attrs:{dark:"","slider-color":"yellow"}},[a("v-tab",{key:"by-schema",attrs:{ripple:""}},[e._v("\n      By Schema\n    ")]),a("v-tab-item",{key:"by-schema"},[a("function-policy-assignment-by-schema")],1),a("v-tab",{key:"by-policy",attrs:{ripple:""}},[e._v("\n      By Policy\n    ")]),a("v-tab-item",{key:"by-policy"},[a("function-policy-assignment-by-policy")],1)],1)],1)},to=[],ao=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-tabs",{attrs:{dark:"","slider-color":"yellow"}},[e._l(e.managedSchemata,(function(t){return a("v-tab",{key:t.schemaName,attrs:{ripple:""}},[e._v("\n      "+e._s(t.schemaName)+"\n    ")])})),e._l(e.managedSchemata,(function(e){return a("v-tab-item",{key:e.schemaName},[a("function-policy-assignment-schema",{attrs:{schema:e}})],1)}))],2)],1)},io=[],no=a("82cd"),lo=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-dialog",{attrs:{persistent:"",width:"800"},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[a("v-btn",e._g({staticClass:"text-none",attrs:{dark:"",disabled:e.disabled}},i),[e._v("\n        "+e._s(e.displayValue)+"\n      ")])]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[a("v-card-title",{staticClass:"headline"},[e._v("Assign Policy")]),a("v-combobox",{attrs:{items:e.allPolicyDefinitions,"item-text":"name","item-value":"id"},model:{value:e.currentSelection,callback:function(t){e.currentSelection=t},expression:"currentSelection"}}),a("v-card-actions",[a("v-spacer"),a("v-btn",{on:{click:function(t){e.dialog=!1}}},[e._v("Cancel")]),a("v-btn",{attrs:{disabled:e.updateDisabled},on:{click:e.updateTablePolicyDefinition}},[e._v("Update")]),a("v-spacer")],1)],1)],1)],1)},oo=[],so={name:"FunctionAssignmentDialog",props:{currentPolicyDefinition:{type:Object,required:!0},functions:{type:Array,required:!0},bulkAssign:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},mounted(){this.currentSelection=this.currentPolicyDefinition},data(){return{dialog:!1,expanded:[],currentSelection:null}},computed:{displayValue(){return this.bulkAssign?"Bulk Assign":this.currentPolicyDefinition?this.currentPolicyDefinition.name:"n/a"},allPolicyDefinitions(){return this.$store.state.functionPolicies},updateDisabled(){return!this.bulkAssign&&(!this.currentPolicyDefinition||!this.currentSelection||this.currentPolicyDefinition.id===this.currentSelection.id)}},watch:{},methods:{updateTablePolicyDefinition(){this.dialog=!1;const e=this.functions.reduce((e,t)=>e.concat([t.id]),[]);this.$store.commit("assignFunctionPolicy",{functionIds:e,policyDefinitionId:this.currentSelection.id}),this.$emit("policyAssigned",this.functions)}}},ro=so,co=(a("a789"),Object(y["a"])(ro,lo,oo,!1,null,null,null)),uo=co.exports;k()(co,{VBtn:B["a"],VCard:be["a"],VCardActions:ve["a"],VCardTitle:ve["c"],VCombobox:Bn["a"],VDialog:De["a"],VSpacer:W["a"]});var mo=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-toolbar",[a("policy-assignment-dialog",{attrs:{currentPolicyDefinition:e.defaultPolicy,functions:e.selected,bulkAssign:!0,disabled:0===e.selected.length}})],1),a("v-data-table",{attrs:{headers:e.headers,items:e.functionsToShow,"item-key":"id",dense:"","disable-pagination":"","disable-sort":"","hide-default-footer":"","show-select":"","show-expand":""},scopedSlots:e._u([{key:"item.name",fn:function(t){var a=t.item;return[e._v("\n        "+e._s(a.functionName)+"\n      ")]}},{key:"item.assignedPolicy",fn:function(t){var i=t.item;return[a("policy-assignment-dialog",{attrs:{currentPolicyDefinition:i.policyDefinition,functions:[i]},on:{policyAssigned:e.expandItems}})]}},{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.headers.length+2}},[a("policy-definition",{attrs:{policyId:t.item.policyDefinition.id,aFunction:t.item}})],1)]}}]),model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}})],1)},po=[],ho={name:"FunctionAssignment",components:{PolicyDefinition:no["a"],PolicyAssignmentDialog:uo},props:{schema:{type:Object,required:!0}},methods:{expandItems(e){this.expanded=e}},watch:{},computed:{functionsToShow(){return this.schema.schemaFunctions.map(e=>{const t=this.$store.state.functionPolicyAssignments[e.id].policyDefinitionId,a=this.$store.state.functionPolicies.find(e=>e.id===t);return{...e,policyDefinition:a,policyDefinitionId:t}})},selectAllValue(){return this.schema.schemaFunctions.length===this.selected.length},defaultPolicy(){return this.$store.state.defaultFunctionPolicy}},data:()=>({selected:[],headers:[{text:"",sortable:!1},{text:"",sortable:!1},{text:"Function Name",sortable:!1,value:"functionName"},{text:"Policy Name",sortable:!1,value:"assignedPolicy"}]})},fo=ho,bo=Object(y["a"])(fo,mo,po,!1,null,null,null),vo=bo.exports;k()(bo,{VDataTable:ce["a"],VToolbar:Ve["a"]});var yo={name:"FunctionPolicyAssignmentBySchema",components:{PolicyDefinition:no["a"],PolicyAssignmentDialog:uo,FunctionPolicyAssignmentSchema:vo},methods:{},watch:{},computed:{functionPolicies(){return this.$store.state.functionPolicies},managedSchemata(){return this.$store.state.managedSchemata.filter(e=>e.schemaFunctions.length>0).map(e=>({...e,schemaFunctions:e.schemaFunctions.map(e=>{const t=this.functionPolicies.find(t=>t.id===e.functionPolicyDefinitionId);return{...e,policyDefinition:t}}).sort((e,t)=>e.functionname<t.functionname?-1:1)})).sort((e,t)=>e.schemaName<t.schemaName?-1:1)}},data:()=>({mappedSchemata:[],headers:[{text:"",sortable:!1},{text:"Function Name",sortable:!1},{text:"Policy Name",sortable:!1}]})},go=yo,ko=Object(y["a"])(go,ao,io,!1,null,null,null),xo=ko.exports;k()(ko,{VTab:ke["a"],VTabItem:xe["a"],VTabs:Ne["a"]});var No=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-expansion-panels",{attrs:{dark:"","slider-color":"yellow"}},e._l(e.mappedPolicies,(function(t){return a("v-expansion-panel",{key:t.id,attrs:{ripple:""}},[a("v-expansion-panel-header",[e._v("\n      ("+e._s(t.numberOfAssignments)+") - "+e._s(t.name)+"\n    ")]),t.numberOfAssignments>0?a("v-expansion-panel-content",[a("function-policy-assignment-policy",{attrs:{policyDefinitionId:t.id}})],1):a("v-expansion-panel-content",[a("h2",[e._v("No assignments for this policy")])])],1)})),1)],1)},Co=[],To=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-toolbar",[a("policy-assignment-dialog",{attrs:{currentPolicyDefinition:e.defaultPolicy,functions:e.selected,bulkAssign:!0,disabled:0===e.selected.length}})],1),a("v-data-table",{attrs:{headers:e.headers,items:e.functionsToShow,"item-key":"id",dense:"","disable-pagination":"","disable-sort":"","hide-default-footer":"","show-select":"","show-expand":""},scopedSlots:e._u([{key:"item.name",fn:function(t){var a=t.item;return[e._v("\n        "+e._s(a.functionName)+"\n      ")]}},{key:"item.assignedPolicy",fn:function(t){var i=t.item;return[a("policy-assignment-dialog",{attrs:{currentPolicyDefinition:i.policyDefinition,functions:[i]},on:{policyAssigned:e.expandItems}})]}},{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.headers.length+2}},[a("policy-definition",{attrs:{policyId:t.item.policyDefinition.id,aFunction:t.item}})],1)]}}]),model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}})],1)},So=[],_o={name:"FunctionPolicyAssignmentPolicy",components:{PolicyDefinition:no["a"],PolicyAssignmentDialog:uo},props:{policyDefinitionId:{type:Number,required:!0}},methods:{expandItems(e){this.expanded=e}},watch:{},computed:{functionsToShow(){const e=Object.keys(this.$store.state.functionPolicyAssignments).filter(e=>this.$store.state.functionPolicyAssignments[e].policyDefinitionId===this.policyDefinitionId);return this.managedSchemata.reduce((t,a)=>{const i=a.schemaFunctions.filter(t=>-1!==e.indexOf(t.id));return[...t,...i]},[]).map(e=>({...e,policyDefinition:this.policyDefinition,policyDefinitionId:this.policyDefinition.id}))},policyDefinition(){return this.policies.find(e=>e.id===this.policyDefinitionId)||this.defaultPolicy},managedSchemata(){return this.$store.state.managedSchemata},defaultPolicy(){return this.$store.state.defaultFunctionPolicy},policies(){return this.$store.state.policies}},data:()=>({selected:[],headers:[{text:"",sortable:!1},{text:"",sortable:!1},{text:"Schema Name",sortable:!1,value:"tableSchema"},{text:"Function Name",sortable:!1,value:"functionName"},{text:"Policy Name",sortable:!1,value:"assignedPolicy"}]})},Eo=_o,Po=Object(y["a"])(Eo,To,So,!1,null,null,null),Do=Po.exports;k()(Po,{VDataTable:ce["a"],VToolbar:Ve["a"]});var Io={name:"FunctionPolicyAssignmentByPolicy",components:{FunctionPolicyAssignmentPolicy:Do},methods:{},watch:{},computed:{mappedPolicies(){return this.policies.map(e=>{const t=Object.keys(this.functionPolicyAssignments).reduce((t,a)=>this.functionPolicyAssignments[a].policyDefinitionId===e.id?t+1:t,0);return{...e,numberOfAssignments:t}})},policies(){return this.$store.state.functionPolicies},functionPolicyAssignments(){return this.$store.state.functionPolicyAssignments}},data:()=>({mappedSchemata:[]})},wo=Io,Ro=Object(y["a"])(wo,No,Co,!1,null,null,null),Oo=Ro.exports;k()(Ro,{VContainer:x["a"],VExpansionPanel:ul["a"],VExpansionPanelContent:ml["a"],VExpansionPanelHeader:pl["a"],VExpansionPanels:hl["a"]});var Vo={name:"FunctionPolicyAssignment",components:{FunctionPolicyAssignmentBySchema:xo,FunctionPolicyAssignmentByPolicy:Oo},methods:{},watch:{},computed:{},data:()=>({})},$o=Vo,Ao=Object(y["a"])($o,eo,to,!1,null,null,null),jo=Ao.exports;k()(Ao,{VContainer:x["a"],VTab:ke["a"],VTabItem:xe["a"],VTabs:Ne["a"]});var Fo=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-tabs",{attrs:{dark:"","slider-color":"yellow"}},[e._l(e.allPolicies,(function(t){return a("v-tab",{key:t.name,attrs:{ripple:""}},[e._v("\n      "+e._s(t.name)+"\n    ")])})),e._l(e.allPolicies,(function(t){return a("v-tab-item",{key:t.name},[a("script-viewer",{attrs:{scriptText:t.policy,skipFormat:"",canExecute:""},on:{"readability-changed":e.readabilityChanged}})],1)}))],2)],1)},Lo=[],qo=a("0100");function Go(e,t,a){const i=a.sort((e,t)=>e.functionname<t.functionname?-1:1).reduce((a,i)=>{const n=e.functionPolicies.find(t=>t.id===e.functionPolicyAssignments[i.id].policyDefinitionId),l={},o=Object(qo["a"])(n,t,l,i);return a.concat(o)},"");return i}var Uo=Go;function Bo(e,t){return e.managedSchemata.filter(e=>!e.parked).filter(e=>e.schemaFunctions.length>0).reduce((a,i)=>{const n=i.schemaFunctions,l={name:""+i.schemaName,policy:Uo(e,t,n)};return a.concat([l])},[]).sort((e,t)=>e.name<t.name?-1:1)}var Mo=Bo;function zo(e,t){const a="All Schemata - Functions",i=Mo(e,t),n=i.reduce((e,t)=>e.concat(t.policy),"");return{name:a,policy:n}}var Ho=zo,Qo={name:"SchemaSecurityScripts",mixins:[],components:{ScriptViewer:xt["a"]},props:{},computed:{...Object(Cl["b"])(["functionPolicies","managedSchemata"])},watch:{functionPolicies(){this.computeAllPolicies()},policyReadability(){this.computeAllPolicies()}},methods:{computeAllPolicies(){const e=Mo(this.$store.state,this.policyReadability),t=Ho(this.$store.state,this.policyReadability);this.allPolicies=[...e,t]},readabilityChanged(e){this.policyReadability=e},refresh(){this.doComputePolicy()},expand(){this.computedPolicy=this.computedPolicy+" "},policyText(e){return e.policy},onCopy:function(){alert("Copied!")},onError:function(e){alert("Failed to copy scripts to clipboard"),console.error(e)},executeSql(){alert("not implemented:  server config value will expose graphile extension to execute generated script")}},data:()=>({allPolicies:[],schemaPolicy:"NOT CALCULATED",defaultRlsPolicies:"NOT CALCULATED",defaultNoRlsPolicies:"NOT CALCULATED",selectedTabName:"",policyReadability:"terse"}),mounted(){this.computeAllPolicies()}},Wo=Qo,Ko=Object(y["a"])(Wo,Fo,Lo,!1,null,null,null),Jo=Ko.exports;k()(Ko,{VContainer:x["a"],VTab:ke["a"],VTabItem:xe["a"],VTabs:Ne["a"]});var Xo={name:"FunctionSecurityView",components:{SchemaSecurityScripts:Jo,PolicyManager:Zl,PolicyAssignment:jo},props:{},computed:{},data:()=>({activeTab:null})},Yo=Xo,Zo=Object(y["a"])(Yo,Hl,Ql,!1,null,null,null),es=Zo.exports;k()(Zo,{VCard:be["a"],VContainer:x["a"],VFlex:ye["a"],VLayout:ge["a"],VTab:ke["a"],VTabItem:xe["a"],VTabs:Ne["a"]});var ts=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{"ma-0":"","pa-0":""}},[a("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("v-tab",{key:"script",attrs:{ripple:""}},[e._v("\n      Create Roles Script\n    ")]),a("v-tab-item",{key:"script"},[a("v-card",[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("v-card",{key:"script"},[a("create-roles-realization")],1)],1)],1)],1)],1),a("v-tab",{key:"ownership-policy",attrs:{ripple:""}},[e._v("\n      Ownership Policy\n    ")]),a("v-tab-item",{key:"ownership-policy"},[a("v-card",[a("ownership-policy-realization")],1)],1),a("v-tab",{key:"schema-usage",attrs:{ripple:""}},[e._v("\n      Schema Usage Script\n    ")]),a("v-tab-item",{key:"schema-usage"},[a("v-card",[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("v-card",{key:"schema-usage"},[a("schema-usage-realization")],1)],1)],1)],1)],1),a("v-tab",{key:"table-security",attrs:{ripple:""}},[e._v("\n      Table Security\n    ")]),a("v-tab-item",{key:"table-security"},[a("v-card",[a("table-security-scripts")],1)],1),a("v-tab",{key:"function-security",attrs:{ripple:""}},[e._v("\n      Function Security\n    ")]),a("v-tab-item",{key:"function-security"},[a("v-card",[a("function-security-scripts")],1)],1),a("v-tab",{key:"master-security-policy",staticClass:"purple black--text",attrs:{ripple:"","active-class":"yellow red--text"}},[e._v("\n      Complete Security Policy\n    ")]),a("v-tab-item",{key:"master-security-policy"},[a("v-card",[a("master-security-policy-realization")],1)],1)],1)],1)},as=[],is=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("script-viewer",{attrs:{scriptText:e.computedPolicy,skipFormat:"",canExecute:""},on:{"readability-changed":e.policyReadabilityChanged}})],1)},ns=[],ls=a("9dbb"),os=a.n(ls);const ss="\n----------\n----------  BEGIN SCHEMA USAGE SQL\n----------\n\nREVOKE USAGE ON SCHEMA public FROM PUBLIC;\n\nGRANT USAGE ON SCHEMA public TO {{appAuthenticator}};\n\n{{#schemata}}\n------- {{schemaName}}\n  REVOKE USAGE ON SCHEMA {{schemaName}} FROM PUBLIC;\n  {{#rolesToRevoke}}\n  REVOKE USAGE ON SCHEMA {{schemaName}} FROM {{roleName}};\n  {{/rolesToRevoke}}\n\n  {{#rolesToGrant}}\n  GRANT USAGE ON SCHEMA {{schemaName}} TO {{.}};\n  {{/rolesToGrant}}\n{{/schemata}}\n----------\n----------  END SCHEMA USAGE SQL\n----------\n--==\n";function rs(...e){let t=[];e.forEach(e=>{t=[...t,...e]});const a=t.reduce((e,t)=>e.includes(t)?e:[...e,t],[]);return a}const cs=e=>{const t=e.managedSchemata.sort((e,t)=>e.schemaName<t.schemaName?-1:e.schemaName>t.schemaName?1:0).map(t=>{const a=Object.keys(e.tablePolicyAssignments).filter(e=>e.split(".")[0]===t.schemaName).reduce((t,a)=>{const i=e.tablePolicyAssignments[a],n=e.policies.find(e=>e.id===i.policyDefinitionId),l=Object.keys(n.roleGrants).filter(e=>Object.values(n.roleGrants[e]).indexOf("ALLOWED")>-1);return l.length>0?rs(t,l):t},[]),i=Object.keys(e.functionPolicyAssignments).filter(e=>e.split(".")[0]===t.schemaName).reduce((t,a)=>{const i=e.functionPolicyAssignments[a],n=e.functionPolicies.find(e=>e.id===i.policyDefinitionId),l=Object.keys(n.roleFunctionGrants).filter(e=>Object.values(n.roleFunctionGrants[e]).indexOf("ALLOWED")>-1);return l.length>0?rs(t,l):t},[]),n=[e.roleSet.dbAuthenticatorRole,...e.roleSet.dbUserRoles],l=rs(a,i).join(", ");return{...t,appAuthenticator:e.roleSet.dbAuthenticatorRole.roleName,rolesToRevoke:n,rolesToGrant:l}});return os.a.render(ss,{schemata:t,appAuthenticator:e.roleSet.dbAuthenticatorRole.roleName})};var ds=cs,us={name:"SchemaUsageRealization",mixins:[fn.a],components:{ScriptViewer:xt["a"]},props:{},data(){return{policyReadability:"terse",computedPolicy:"N/A"}},mounted(){this.doComputePolicy()},watch:{policyReadability(){this.doComputePolicy()},enableRls(){this.doComputePolicy()},policyDefinition(){this.doComputePolicy()}},methods:{policyReadabilityChanged(e){this.policyReadability=e},refresh(){this.doComputePolicy()},expand(){this.computedPolicy=this.computedPolicy+" "},doComputePolicy(){this.computedPolicy=ds(this.$store.state)},onCopy:function(e){alert("Copied!")},onError:function(e){alert("Failed to copy texts")},executeSql(){alert("not implemented:  server config value will expose graphile extension to execute generated script")}},computed:{}},ms=us,ps=Object(y["a"])(ms,is,ns,!1,null,null,null),hs=ps.exports;k()(ps,{VContainer:x["a"]});var fs=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("script-viewer",{attrs:{scriptText:e.masterPolicy,skipFormat:"",canExecute:""},on:{"readability-changed":e.readabilityChanged}})],1)},bs=[];const vs="\n----------\n----------  BEGIN OWNERSHIP SQL\n----------\n\n{{#schemata}}\n----------  SCHEMA: {{schemaName}}\n  ALTER SCHEMA {{schemaName}} OWNER TO {{dbOwnerRole}};\n  -- tables\n  {{#schemaTables}}\n    ALTER TABLE {{schemaName}}.{{tableName}} OWNER TO {{dbOwnerRole}};\n  {{/schemaTables}}\n  -- functions\n  {{#schemaFunctions}}\n    ALTER FUNCTION {{schemaName}}.{{functionName}}({{argumentDataTypes}}) OWNER TO {{dbOwnerRole}};\n  {{/schemaFunctions}}\n----------  END SCHEMA: {{schemaName}}\n{{/schemata}}\n----------\n----------  END OWNERSHIP SQL\n----------\n--==\n",ys=e=>{const t=e.managedSchemata.sort((e,t)=>e.schemaName<t.schemaName?-1:e.schemaName>t.schemaName?1:0).map(e=>({...e,schemaFunctions:e.schemaFunctions.map(e=>{const t=e.argumentDataTypes.split(",").map(e=>e.replace("timestamp with time zone","timestamptz")).map(e=>e.trim().split(" ")[1]).join(", ");return{...e,argumentDataTypes:t}})}));return os.a.render(vs,{schemata:t,dbOwnerRole:e.roleSet.dbOwnerRole.roleName}).split("&#39;").join("'")};var gs=ys;function ks(e,t){return["--=====  BEGIN COMPLETE SECURITY POLICY -========",kn(e),"\n\n--*****  BEGIN OWNERSHIP -********",gs(e,t),"--*****  END OWNERSHIP -**********","\n\n--*****  BEGIN SCHEMA USAGE -********",ds(e,t),"--*****  END SCHEMA USAGE -**********","\n\n--*****  BEGIN TABLE POLICIES -********",Il(e,t).policy,"--*****  END TABLE POLICIES -**********","\n\n--*****  BEGIN FUNCTION POLICIES -********",Ho(e,t).policy,"--*****  END FUNCTION POLICIES -**********","\n\n--=====  END COMPLETE SECURITY POLICY -=========="].join("\n")}var xs=ks,Ns={name:"MasterSecurityPolicyRealization",mixins:[],components:{ScriptViewer:xt["a"]},props:{},computed:{...Object(Cl["b"])(["functionPolicies","managedSchemata"])},watch:{functionPolicies(){this.computePolicy()},policyReadability(){this.computePolicy()}},methods:{computePolicy(){this.masterPolicy=xs(this.$store.state,this.policyReadability)},readabilityChanged(e){this.policyReadability=e},refresh(){this.computePolicy()},expand(){this.computedPolicy=this.computedPolicy+" "},policyText(e){return e.policy},onCopy:function(){alert("Copied!")},onError:function(e){alert("Failed to copy scripts to clipboard"),console.error(e)},executeSql(){alert("not implemented:  server config value will expose graphile extension to execute generated script")}},data:()=>({masterPolicy:"N/A",schemaPolicy:"NOT CALCULATED",defaultRlsPolicies:"NOT CALCULATED",defaultNoRlsPolicies:"NOT CALCULATED",selectedTabName:"",policyReadability:"terse"}),mounted(){this.computePolicy()}},Cs=Ns,Ts=Object(y["a"])(Cs,fs,bs,!1,null,null,null),Ss=Ts.exports;k()(Ts,{VContainer:x["a"]});var _s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("script-viewer",{attrs:{scriptText:e.computeOwnershipPolicy,skipFormat:"",canExecute:""},on:{"readability-changed":e.readabilityChanged}})],1)},Es=[],Ps={name:"OwnershipPolicyRealization",mixins:[],components:{ScriptViewer:xt["a"]},props:{},computed:{...Object(Cl["b"])(["functionPolicies","managedSchemata"])},watch:{functionPolicies(){this.computePolicy()},policyReadability(){this.computePolicy()}},methods:{computePolicy(){this.computeOwnershipPolicy=gs(this.$store.state,this.policyReadability)},readabilityChanged(e){this.policyReadability=e},refresh(){this.computePolicy()},expand(){this.computedPolicy=this.computedPolicy+" "},policyText(e){return e.policy},onCopy:function(){alert("Copied!")},onError:function(e){alert("Failed to copy scripts to clipboard"),console.error(e)}},data:()=>({computeOwnershipPolicy:"N/A",schemaPolicy:"NOT CALCULATED",defaultRlsPolicies:"NOT CALCULATED",defaultNoRlsPolicies:"NOT CALCULATED",selectedTabName:"",policyReadability:"terse"}),mounted(){this.computePolicy()}},Ds=Ps,Is=Object(y["a"])(Ds,_s,Es,!1,null,null,null),ws=Is.exports;k()(Is,{VContainer:x["a"]});var Rs={name:"SecurityScriptsSummaryView",components:{CreateRolesRealization:Tn,SchemaUsageRealization:hs,TableSecurityScripts:Vl,FunctionSecurityScripts:Jo,MasterSecurityPolicyRealization:Ss,OwnershipPolicyRealization:ws},props:{},computed:{},data:()=>({activeTab:0})},Os=Rs,Vs=Object(y["a"])(Os,ts,as,!1,null,null,null),$s=Vs.exports;k()(Vs,{VCard:be["a"],VContainer:x["a"],VFlex:ye["a"],VLayout:ge["a"],VTab:ke["a"],VTabItem:xe["a"],VTabs:Ne["a"]});var As=a("858e"),js={name:"SecurityView",components:{FunctionSecurityView:es,TableSecurityView:zl,SecurityScriptsSummaryView:$s,pdf:As["a"]},props:{},computed:{initializing(){return this.$store.state.initializing||0===this.$store.state.roleSet.dbUserRoles.length}},data:()=>({activeTab:0}),watch:{},methods:{},mounted(){this.activeTab=this.$store.state.roleSet.dbUserRoles.length>0?0:2}},Fs=js,Ls=Object(y["a"])(Fs,Dn,In,!1,null,null,null),qs=Ls.exports;k()(Ls,{VCard:be["a"],VCol:Ze["a"],VContainer:x["a"],VRow:et["a"],VTab:ke["a"],VTabItem:xe["a"],VTabs:Ne["a"]});var Gs=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{"ma-0":"","pa-0":""}},[a("h1",[e._v("PG LINT")])])},Us=[],Bs={name:"PgLintView",components:{},props:{},computed:{},watch:{},data:()=>({}),methods:{}},Ms=Bs,zs=Object(y["a"])(Ms,Gs,Us,!1,null,null,null),Hs=zs.exports;k()(zs,{VContainer:x["a"]});var Qs=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{"ma-0":"","pa-0":""}},[a("function-search")],1)},Ws=[],Ks=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{"ma-0":"","pa-0":""}},[a("h2",[e._v("Search Terms")]),a("v-row",[a("v-col",{attrs:{cols:"3"}},[a("v-text-field",{attrs:{label:"search term",placeholder:"enter a search term"},model:{value:e.searchTerm,callback:function(t){e.searchTerm=t},expression:"searchTerm"}})],1),a("v-col",{staticClass:"text-center",attrs:{cols:"1"}},[a("h3",[e._v("OR")])]),a("v-col",{attrs:{cols:"3"}},[a("v-text-field",{attrs:{label:"search term",placeholder:"enter a search term"},model:{value:e.searchTerm1,callback:function(t){e.searchTerm1=t},expression:"searchTerm1"}})],1),a("v-col",{staticClass:"text-center",attrs:{cols:"1"}},[a("h3",[e._v("OR")])]),a("v-col",{attrs:{cols:"3"}},[a("v-text-field",{attrs:{label:"search term",placeholder:"enter a search term"},model:{value:e.searchTerm2,callback:function(t){e.searchTerm2=t},expression:"searchTerm2"}})],1)],1),a("hr"),a("function-list",{attrs:{functions:e.functions}})],1)},Js=[],Xs=(a("ab3b"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-data-table",{attrs:{headers:e.headers,items:e.functions,"item-key":"id",dense:"","disable-pagination":"","disable-sort":"","hide-default-footer":"","show-expand":""},scopedSlots:e._u([{key:"item.blankLink",fn:function(t){var i=t.item;return[a("router-link",{attrs:{to:{name:"function",params:{id:i.id}},target:"_blank"}},[a("v-icon",[e._v("launch")])],1)]}},{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.headers.length+1}},[a("function",{attrs:{id:t.item.id}})],1)]}}])})}),Ys=[],Zs={name:"FunctionList",components:{Function:Qa["a"]},props:{functions:{type:Array,required:!0}},computed:{},data:()=>({headers:[{text:"",sortable:!1},{text:"schema",sortable:!1,value:"functionSchema"},{text:"function",sortable:!1,value:"functionName"},{text:"",sortable:!1,value:"blankLink"}]}),methods:{}},er=Zs,tr=Object(y["a"])(er,Xs,Ys,!1,null,null,null),ar=tr.exports;k()(tr,{VDataTable:ce["a"],VIcon:ht["a"]});var ir={name:"FunctionSearch",components:{FunctionList:ar},props:{},computed:{disabled(){return void 0===this.searchTerm||null===this.searchTerm||""===this.searchTerm},allFunctions(){return this.$store.state.managedSchemata.reduce((e,t)=>[...e,...t.schemaFunctions],[])},functions(){return this.allFunctions.filter(e=>{const t=e.functionSchema.toLowerCase(),a=e.functionName.toLowerCase(),i=e.definition.toLowerCase(),n=-1!==t.indexOf(this.searchTerm.toLowerCase())||-1!==a.indexOf(this.searchTerm.toLowerCase())||-1!==i.indexOf(this.searchTerm.toLowerCase()),l=-1!==t.indexOf(this.searchTerm1.toLowerCase())||-1!==a.indexOf(this.searchTerm1.toLowerCase())||-1!==i.indexOf(this.searchTerm1.toLowerCase()),o=-1!==t.indexOf(this.searchTerm2.toLowerCase())||-1!==a.indexOf(this.searchTerm2.toLowerCase())||-1!==i.indexOf(this.searchTerm2.toLowerCase());return n&&l&&o})}},watch:{},data:()=>({searchTerm:"",searchTerm1:"",searchTerm2:""}),methods:{}},nr=ir,lr=Object(y["a"])(nr,Ks,Js,!1,null,null,null),or=lr.exports;k()(lr,{VCol:Ze["a"],VContainer:x["a"],VRow:et["a"],VTextField:Ll["a"]});var sr={name:"SearchView",components:{FunctionSearch:or},props:{},computed:{},watch:{},data:()=>({searchTerm:""}),methods:{}},rr=sr,cr=Object(y["a"])(rr,Qs,Ws,!1,null,null,null),dr=cr.exports;k()(cr,{VContainer:x["a"]});var ur=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("h1",[e._v("Settings")]),a("h2",{staticStyle:{color:"red"}},[e._v("Under Construction")]),a("hr"),a("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("v-tab",{key:"table-policy-template",attrs:{ripple:""}},[e._v("\n      Table Policy Template\n    ")]),a("v-tab-item",{key:"table-policy-template"},[a("security-policy-settings")],1)],1)],1)},mr=[],pr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("default-rls-using")],1)},hr=[],fr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-toolbar",[a("v-btn",{attrs:{disabled:e.disabled},on:{click:e.save}},[e._v("Save")]),a("h2",[e._v("Default RLS Using Clause")])],1),a("v-textarea",{attrs:{"auto-grow":"","hide-details":"","background-color":"black"},model:{value:e.defaultRlsUsing,callback:function(t){e.defaultRlsUsing=t},expression:"defaultRlsUsing"}}),a("hr")],1)},br=[],vr={name:"DefaultRlsUsingClause",computed:{defaultDefaultRlsUsing(){return this.$store.state.defaultRlsUsing},disabled(){return this.defaultRlsUsing===this.defaultDefaultRlsUsing}},methods:{save(){this.$store.commit("updateDefaultRlsUsing",{defaultRlsUsing:this.defaultRlsUsing})},load(){this.defaultRlsUsing=this.defaultDefaultRlsUsing}},data(){return{defaultRlsUsing:null}},mounted(){this.load()}},yr=vr,gr=a("a844"),kr=Object(y["a"])(yr,fr,br,!1,null,null,null),xr=kr.exports;k()(kr,{VBtn:B["a"],VContainer:x["a"],VTextarea:gr["a"],VToolbar:Ve["a"]});var Nr={name:"SecurityPolicySettings",components:{DefaultRlsUsing:xr},computed:{},methods:{},data(){return{}}},Cr=Nr,Tr=Object(y["a"])(Cr,pr,hr,!1,null,null,null),Sr=Tr.exports;k()(Tr,{VContainer:x["a"]});var _r={name:"Settings",components:{SecurityPolicySettings:Sr},props:{},computed:{},data:()=>({activeTab:null})},Er=_r,Pr=Object(y["a"])(Er,ur,mr,!1,null,null,null),Dr=Pr.exports;k()(Pr,{VContainer:x["a"],VTab:ke["a"],VTabItem:xe["a"],VTabs:Ne["a"]});var Ir=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{"ma-0":"","pa-0":""}},[a("constraints-and-indices-manager")],1)},wr=[],Rr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-card",[a("v-container",{attrs:{"bkeepground-color":"blkeep"}},[a("v-tabs",{attrs:{dark:"","slider-color":"yellow"}},[e._l(e.managedSchemata,(function(t){return a("v-tab",{key:t.schemaName,attrs:{ripple:""}},[e._v("\n        "+e._s(t.schemaName)+"\n      ")])})),e._l(e.managedSchemata,(function(e){return a("v-tab-item",{key:e.schemaName},[a("constraints-and-indices",{attrs:{tableSchema:e.schemaName}})],1)})),a("v-tab",{key:"allSchemata",attrs:{ripple:""}},[e._v("\n        All Schemata\n      ")]),a("v-tab-item",{key:"allSchemata"},[a("constraints-and-indices")],1)],2)],1)],1)},Or=[];const Vr="AS_EXPECTED",$r="NO_INDEX",Ar="UNEXPECTED_NAME",jr="EXTRA_INDEX",Fr="green",Lr="yellow",qr="blue",Gr="red";var Ur={name:"ConstraintsAndIndicesManager",components:{ConstraintsAndIndices:Li},methods:{columnIndexStatusColor(e){switch(e){case Vr:return Fr;case $r:return Lr;case Ar:return qr;case jr:break}}},watch:{},computed:{policies(){return this.$store.state.policies},managedSchemata(){return this.$store.state.managedSchemata.sort((e,t)=>e.schemaName<t.schemaName?-1:1)},headers(){return[{text:"",sortable:!1},{text:"Table Name",sortable:!1},...this.statusMap.map(e=>({text:e.name,sortable:!1}))]}},data:()=>({mappedSchemata:[],statusMap:[{name:Vr,columnIndexStatusColor:Fr,defaultActions:{}},{name:$r,columnIndexStatusColor:Lr,defaultActions:{ack:!1,create:!1}},{name:Ar,columnIndexStatusColor:qr,defaultActions:{ack:!1,rename:!0}},{name:jr,columnIndexStatusColor:Gr,defaultActions:{ack:!1,drop:!1}}]})},Br=Ur,Mr=Object(y["a"])(Br,Rr,Or,!1,null,null,null),zr=Mr.exports;k()(Mr,{VCard:be["a"],VContainer:x["a"],VTab:ke["a"],VTabItem:xe["a"],VTabs:Ne["a"]});var Hr={name:"ForeignKeyIndexView",components:{ConstraintsAndIndicesManager:zr},props:{},computed:{},data:()=>({activeTab:null})},Qr=Hr,Wr=Object(y["a"])(Qr,Ir,wr,!1,null,null,null),Kr=Wr.exports;k()(Wr,{VContainer:x["a"]});var Jr=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},Xr=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("h1",[e._v("A tool to ensure that all "),a("a",{attrs:{href:"https://www.graphile.org/postgraphile/smart-comments/",target:"_blank"}},[e._v("smart comments")]),e._v(" are properly configured to support postgraphile")])])}],Yr={name:"SmartCommentManager"},Zr=Yr,ec=Object(y["a"])(Zr,Jr,Xr,!1,null,null,null),tc=ec.exports,ac=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("h1",[e._v("Export Project")]),a("v-toolbar",[a("v-btn",{on:{click:e.exportProject}},[e._v("Save")])],1),a("v-textarea",{attrs:{value:e.projectJson,"auto-grow":"",readonly:""}})],1)},ic=[],nc={name:"ExportProject",components:{},props:{},computed:{projectName(){return this.project?this.project.name:"N/A"},projectJson(){return JSON.stringify(this.$store.state,0,2)}},methods:{exportProject:function(){const e=this.projectJson,t=new Blob([e],{type:"text/plain"}),a=document.createEvent("MouseEvents"),i=document.createElement("a");i.download="pgdbi.json",i.href=window.URL.createObjectURL(t),i.dataset.downloadurl=["text/json",i.download,i.href].join(":"),a.initEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),i.dispatchEvent(a)}}},lc=nc,oc=Object(y["a"])(lc,ac,ic,!1,null,null,null),sc=oc.exports;k()(oc,{VBtn:B["a"],VTextarea:gr["a"],VToolbar:Ve["a"]});var rc=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"container"},[a("div",{staticClass:"large-12 medium-12 small-12 cell"},[a("label",[e._v("File\n        "),a("input",{ref:"file",attrs:{type:"file",id:"file"},on:{change:function(t){return e.handleFileUpload()}}})])])]),a("h1",[e._v("Import Project: "+e._s(e.projectName))]),a("v-toolbar",[a("v-btn",{on:{click:e.importProject}},[e._v("Import")])],1),a("v-textarea",{attrs:{value:e.projectJson,"auto-grow":"",readonly:""}})],1)},cc=[],dc={name:"ImportProject",components:{},props:{},computed:{projectName(){return this.project?this.project.name:"N/A"},projectJson(){return this.project?JSON.stringify(this.project,null,2):"N/A"}},methods:{importProject:function(){this.$store.commit("importProject",{project:this.project})},useResults(e){this.project=JSON.parse(e.currentTarget.result)},handleFileUpload(){this.file=this.$refs.file.files[0];const e=new FileReader;e.onload=this.useResults,e.readAsText(this.file)},submitFile(){}},data(){return{file:"",project:{releases:{nodes:[]}}}}},uc=dc,mc=Object(y["a"])(uc,rc,cc,!1,null,null,null),pc=mc.exports;k()(mc,{VBtn:B["a"],VTextarea:gr["a"],VToolbar:Ve["a"]});var hc=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},fc=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("h1",[e._v("Sqitch")])])}],bc={},vc=Object(y["a"])(bc,hc,fc,!1,null,null,null),yc=vc.exports,gc=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},kc=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("h1",[e._v("Graphile Worker")])])}],xc={},Nc=Object(y["a"])(xc,gc,kc,!1,null,null,null),Cc=Nc.exports,Tc=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("h1",[e._v(e._s(e.id))]),a("hr"),a("script-viewer",{attrs:{scriptText:e.definition,showDeclarationVisibility:!1,showReadability:!1,skipFormat:""}})],1)},Sc=[],_c={name:"Enum",components:{ScriptViewer:xt["a"]},props:{id:{type:String,required:!0}},computed:{definition(){return this.ENUM.enumDefinition}},data:()=>({ENUM:{enumDefinition:"N/A"}}),methods:{onCopy:function(e){alert("Copied!")},onError:function(e){alert("Failed to copy texts")},setEnum(){const e=this.id.split(".")[0],t=this.$store.state.managedSchemata.find(t=>t.schemaName===e);this.ENUM=t.schemaEnums.find(e=>e.id===this.id)}},mounted(){this.setEnum()},beforeRouteUpdate(e,t,a){this.setEnum(),a()}},Ec=_c,Pc=Object(y["a"])(Ec,Tc,Sc,!1,null,null,null),Dc=Pc.exports;k()(Pc,{VContainer:x["a"]});var Ic=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("h1",[e._v(e._s(e.id))]),a("hr"),a("script-viewer",{attrs:{scriptText:e.definition,showDeclarationVisibility:!1,showReadability:!1,skipFormat:""}})],1)},wc=[],Rc={name:"Udt",components:{ScriptViewer:xt["a"]},props:{id:{type:String,required:!0}},computed:{definition(){return this.UDT.udtDefinition}},data:()=>({UDT:{udtDefinition:"N/A"}}),methods:{onCopy:function(e){alert("Copied!")},onError:function(e){alert("Failed to copy texts")},setUdt(){const e=this.id.split(".")[0],t=this.$store.state.managedSchemata.find(t=>t.schemaName===e);this.UDT=t.schemaUdts.find(e=>e.id===this.id)}},mounted(){this.setUdt()},beforeRouteUpdate(e,t,a){this.setUdt(),a()}},Oc=Rc,Vc=Object(y["a"])(Oc,Ic,wc,!1,null,null,null),$c=Vc.exports;k()(Vc,{VContainer:x["a"]});var Ac=a("0e44"),jc={allRoleSets:[],pgdbiOptions:{},initializing:!0,schemaFilterOn:!0,policies:[],tablePolicyAssignments:{},functionPolicies:[],functionPolicyAssignments:{},defaultPolicy:null,defaultPolicyPermissive:null,defaultFunctionPolicy:null,defaultDbUserPolicies:[],genericIndexEvaluations:{},fkIndexEvaluations:{singleColumn:{},multiColumn:{}},uqIndexEvaluations:{singleColumn:{},multiColumn:{}},indicesToDrop:{},indexEvaluations:{},managedSchemata:[],parkedSchemata:[],rawSchemata:[],schemaFilter:[],roleSet:{dbOwnerRole:{},dbAuthenticatorRole:{},dbUserRoles:[]},defaultRlsUsing:"( owner_id = viewer_id() )",defaultRlsWithCheck:"",defaultRlsQualifiers:{all:{policies:[]},select:{policies:[]},insert:{policies:[]},update:{policies:[]},delete:{policies:[]}},defaultRoleGrants:{select:"DENIED",insert:"DENIED",update:"DENIED",delete:"DENIED"},defaultPermissiveRoleGrants:{select:"ALLOWED",insert:"ALLOWED",update:"ALLOWED",delete:"ALLOWED"},defaultImpliedRoleGrants:{select:"IMPLIED",insert:"IMPLIED",update:"IMPLIED",delete:"IMPLIED"},functionPolicyHeaderTemplate:"\n  ----------  BEGIN: {{schemaName}}.{{functionName}}\n  \n  ",functionPolicyFooterTemplate:"\n\n  ----------  END: {{schemaName}}.{{functionName}}",defaultFunctionRoleGrants:{execute:"DENIED"},defaultFunctionRoleGrantsPermissive:{execute:"ALLOWED"},defaultFunctionRoleGrantsImplied:{execute:"IMPLIED"}};function Fc(e,t){Object.keys(jc).forEach(a=>{e[a]=t[a]||jc[a]}),e.isDirty=!1}var Lc=Fc;function qc(e){e.isDirty=!0,e.schemaFilterOn=!0}var Gc=qc;function Uc(e,t){return{tableId:e,policyDefinitionId:t,evaluation:{status:"PASS",errors:[]}}}function Bc(e,t){e.isDirty=!0;const a=t.tableIds,i=t.policyDefinitionId;a.forEach(t=>{e.tablePolicyAssignments[t]=Uc(t,i)})}var Mc=Bc;function zc(e,t){return{functionId:e,policyDefinitionId:t,evaluation:{status:"PASS",errors:[]}}}function Hc(e,t){e.isDirty=!0;const a=t.functionIds,i=t.policyDefinitionId;a.forEach(t=>{e.functionPolicyAssignments[t]=zc(t,i)})}var Qc=Hc;let Wc=1;function Kc(){return Wc+=1,(new Date).getTime()*(1e4+Wc)+621355968e9}function Jc(e){if(!e.defaultPolicy){const t={id:Kc(),name:"Default Table Policy - NO ACCESS",policyHeaderTemplate:e.policyHeaderTemplate,policyFooterTemplate:e.policyFooterTemplate,enableRls:!1,columnExclusionOverrides:{insert:[],update:[]},columnExclusions:{insert:{},update:{}},roleGrants:e.roleSet.dbUserRoles.reduce((t,a)=>({...t,[a.roleName]:e.defaultRoleGrants}),{}),rlsQualifiers:e.roleSet.dbUserRoles.reduce((t,a)=>({...t,[a.roleName]:e.defaultRlsQualifiers}),{})};e.defaultPolicy=t,e.policies=e.policies.concat([t])}}function Xc(e){if(!e.defaultPolicyPermissive){const t={id:Kc(),name:"Default Table Policy - TOTAL EXPLICIT USER ACCESS",policyHeaderTemplate:e.policyHeaderTemplate,policyFooterTemplate:e.policyFooterTemplate,enableRls:!1,columnExclusionOverrides:{insert:[],update:[]},columnExclusions:{insert:{},update:{}},roleGrants:e.roleSet.dbUserRoles.reduce((t,a)=>a.isAnonymous?{...t,[a.roleName]:e.defaultRoleGrants}:{...t,[a.roleName]:e.defaultPermissiveRoleGrants},{}),rlsQualifiers:e.roleSet.dbUserRoles.reduce((t,a)=>({...t,[a.roleName]:e.defaultRlsQualifiers}),{})};e.defaultPolicyPermissive=t,e.policies=e.policies.concat([t])}}function Yc(e){if(0===e.defaultDbUserPolicies.length){const t=e.roleSet.dbUserRoles.map(t=>({id:Kc(),name:"Default Table Policy - "+t.roleName,policyHeaderTemplate:e.policyHeaderTemplate,policyFooterTemplate:e.policyFooterTemplate,enableRls:!1,columnExclusionOverrides:{insert:[],update:[]},columnExclusions:{insert:{},update:{}},roleGrants:e.roleSet.dbUserRoles.reduce((a,i)=>{let n;return n=i.roleName===t.roleName?e.defaultPermissiveRoleGrants:i.applicableRoles.map(e=>e.roleName).indexOf(t.roleName)>-1?e.defaultImpliedRoleGrants:e.defaultRoleGrants,{...a,[i.roleName]:n}},{}),rlsQualifiers:e.roleSet.dbUserRoles.reduce((t,a)=>({...t,[a.roleName]:e.defaultRlsQualifiers}),{})}));e.defaultDbUserTablePolicies=t,e.policies=e.policies.concat(t)}}function Zc(e){if(!e.defaultFunctionPolicy){const t={id:Kc(),name:"Default Function Policy - NO ACCESS",functionPolicyHeaderTemplate:e.functionPolicyHeaderTemplate,functionPolicyFooterTemplate:e.functionPolicyFooterTemplate,roleFunctionGrants:e.roleSet.dbUserRoles.reduce((t,a)=>({...t,[a.roleName]:e.defaultFunctionRoleGrants}),{})};e.defaultFunctionPolicy=t,e.functionPolicies=e.functionPolicies.concat([t])}}function ed(e){if(0===e.defaultDbUserPolicies.length){const t=e.roleSet.dbUserRoles.map(t=>({id:Kc(),name:"User Function Policy - "+t.roleName,functionPolicyHeaderTemplate:e.functionPolicyHeaderTemplate,functionPolicyFooterTemplate:e.functionPolicyFooterTemplate,roleFunctionGrants:e.roleSet.dbUserRoles.reduce((a,i)=>{let n;return n=i.roleName===t.roleName?e.defaultFunctionRoleGrantsPermissive:i.applicableRoles.map(e=>e.roleName).indexOf(t.roleName)>-1?e.defaultFunctionRoleGrantsImplied:e.defaultFunctionRoleGrants,{...a,[i.roleName]:n}},{})}));e.defaultDbUserFunctionsPolicies=t,e.functionPolicies=e.functionPolicies.concat(t)}}function td(e,t){const a=t.reduce((t,a)=>[...t,...a.schemaTables.filter(t=>void 0===e.tablePolicyAssignments[t.id]).map(e=>e.id)],[]);Mc(e,{tableIds:a,policyDefinitionId:e.defaultPolicy.id})}function ad(e,t){const a=t.reduce((t,a)=>[...t,...a.schemaFunctions.filter(t=>void 0===e.functionPolicyAssignments[t.id]).map(e=>e.id)],[]);Qc(e,{functionIds:a,policyDefinitionId:e.defaultFunctionPolicy.id})}function id(e,t){Jc(e),Xc(e),Yc(e),Zc(e),ed(e),td(e,t),ad(e,t),e.managedSchemata=t.sort((e,t)=>e.schemaName<t.schemaName?-1:e.schemaName>t.schemaName?1:0),e.isDirty=!0,e.initializing=!1,e.schemaFilterOn=!1}var nd=id;function ld(e,t){e.isDirty=!0,e.defaultRlsUsing=t.defaultRlsUsing}var od=ld;function sd(e,t){e.isDirty=!0,e.defaultRlsWithCheck=t.defaultRlsWithCheck}var rd=sd;function cd(e,t){const a=e.policies.find(e=>e.name===t.name);if(a)throw new Error("A policy with this name already exists");{e.isDirty=!0;const a=t.name,i=e.roleSet.dbUserRoles,n={id:1e4*(new Date).getTime()+621355968e9,name:a,policyHeaderTemplate:e.policyHeaderTemplate,policyFooterTemplate:e.policyFooterTemplate,enableRls:!1,columnExclusionOverrides:{insert:[],update:[]},columnExclusions:{insert:{},update:{}},roleGrants:i.reduce((t,a)=>({...t,[a.roleName]:e.defaultRoleGrants}),{}),rlsQualifiers:i.reduce((t,a)=>({...t,[a.roleName]:e.defaultRlsQualifiers}),{})};e.policies=[...e.policies,n].sort((function(e,t){return e.id<t.id}))}}var dd=cd;function ud(e,t){e.isDirty=!0;const a=e.policies.filter(e=>e.name!==t.policy.name);e.policies=[...a,t.policy].sort((e,t)=>e.id-t.id)}var md=ud;function pd(e,t){e.isDirty=!0;const a=e.policies.find(e=>e.name===t.name);if(a)throw new Error("A policy with this name already exists");{const a=t.name,i=e.roleSet.dbUserRoles,n={id:1e4*(new Date).getTime()+621355968e9,name:a,functionPolicyHeaderTemplate:e.functionPolicyHeaderTemplate,functionPolicyFooterTemplate:e.functionPolicyFooterTemplate,roleFunctionGrants:i.reduce((t,a)=>({...t,[a.roleName]:e.defaultFunctionRoleGrants}),{})};e.functionPolicies=[...e.functionPolicies,n].sort((function(e,t){return e.id<t.id}))}}var hd=pd;function fd(e,t){e.isDirty=!0;const a=e.functionPolicies.filter(e=>e.id!==t.policy.id);e.functionPolicies=[...a,t.policy].sort((e,t)=>e.id-t.id)}var bd=fd;function vd(e,t){const a=e.policies.find(e=>e.id===t.policyId),i=e.policies.filter(e=>e.id!==t.policyId),n=t.roleName,l=t.action,o=1e4*(new Date).getTime()+621355968e9,s={id:o,name:t.name||"rls_"+o,using:t.using||e.defaultRlsUsing,withCheck:t.withCheck||e.defaultRlsWithCheck,passStrategy:t.passStrategy||"permissive"},r={...a,rlsQualifiers:{...a.rlsQualifiers,[n]:{...a.rlsQualifiers[n],[l]:{...a.rlsQualifiers[n][l],policies:[...a.rlsQualifiers[n][l].policies,s]}}}};e.policies=[...i,r]}var yd=vd;function gd(e,t){e.isDirty=!0;const a=e.policies.find(e=>e.id===t.policyId),i=e.policies.filter(e=>e.id!==t.policyId),n=t.roleName,l=t.action,o=t.rlsPolicyId,s={...a,rlsQualifiers:{...a.rlsQualifiers,[n]:{...a.rlsQualifiers[n],[l]:{...a.rlsQualifiers[n][l],policies:a.rlsQualifiers[n][l].policies.filter(e=>e.id!==o)}}}};e.policies=[...i,s]}var kd=gd;function xd(e,t){Object.keys(t.project).forEach(a=>{e[a]=t.project[a]})}var Nd=xd;function Cd(e,t){e.isDirty=!0;const a=t.sourcePolicyDefinitionId,i=t.newFields,n=t.tableIds||[],l=e.policies.find(e=>e.id===a),o={...l,id:1e4*(new Date).getTime()+621355968e9,name:i.name,customIdentifier:1===n.length?n[0]:null};e.policies=[...e.policies,o].sort((function(e,t){return e.id<t.id})),Mc(e,{tableIds:n,policyDefinitionId:o.id})}var Td=Cd;function Sd(e,t){e.isDirty=!0;const a=t.policyDefinitionId,i=t.newFields,n=e.policies.find(e=>e.name===i.name);if(n)throw new Error("A policy with this name already exists");{const t=e.policies.find(e=>e.id===a),n=e.policies.filter(e=>e.id!==t.id),l={...t,name:i.name,customIdentifier:null};e.policies=[...n,l].sort((function(e,t){return e.id<t.id}))}}var _d=Sd;function Ed(e,t){e.isDirty=!0;const a=t.policyDefinitionId,i=e.policies.filter(e=>e.id!==a);e.policies=[...i].sort((function(e,t){return e.id<t.id})),Object.keys(e.tablePolicyAssignments).forEach(t=>{e.tablePolicyAssignments[t]===a&&(e.tablePolicyAssignments[t]=e.defaultPolicy.id)})}var Pd=Ed;function Dd(e,t){e.isDirty=!0,e.tablePolicyTemplate=t.tablePolicyTemplate}var Id=Dd,wd=a("83cd"),Rd=a.n(wd);function Od(e,t){e.isDirty=!0,e.pgdbiOptions=t.pgdbiOptions}var Vd=Od;function $d(e,t){e.isDirty=!0;const a=e.policies.find(e=>e.id===t.policyDefinitionId),i=e.policies.filter(e=>e.id!==t.policyDefinitionId);e.policies=[...i,{...a,name:t.name}]}var Ad=$d;function jd(e,t){e.isDirty=!0;const a=e.allRoleSets.find(e=>e.name===t);e.roleSet=a}var Fd=jd;function Ld(e,t){e.isDirty=!0,e.allRoleSets=t}var qd=Ld,Gd={resetDefaultState:Lc,filterSchemata:Gc,setManagedSchemata:nd,assignTablePolicy:Mc,defaultRlsUsing:od,defaultRlsWithCheck:rd,newPolicy:dd,savePolicy:md,createRlsPolicy:yd,deleteRlsPolicy:kd,importProject:Nd,newFunctionPolicy:hd,saveFunctionPolicy:bd,assignFunctionPolicy:Qc,customizeTablePolicy:Td,makeGlobalTablePolicy:_d,deleteTablePolicy:Pd,updateTablePolicyTemplate:Id,updateDefaultRlsUsing:Rd.a,setPgdbiOptions:Vd,renameTablePolicy:Ad,setProjectRoleSet:Fd,setAllRoleSets:qd};async function Ud({commit:e,dispatch:t},a){return await t("resetDefaultState"),await e("setProjectRoleSet",a),"role set set - "+a}var Bd=Ud;async function Md({commit:e},t){await e("setManagedSchemata",t.schemaTree),e("setPgdbiOptions",t.pgdbiOptions)}var zd=Md,Hd=a("522d"),Qd=a("efe7");i["a"].use(Hd["a"]);const Wd="apollo-token",Kd=Object({NODE_ENV:"production",BASE_URL:"/pgdbi/"}).VUE_APP_GRAPHQL_HTTP||"/pgdbi/graphql",Jd={httpEndpoint:Kd,tokenName:Wd,persisting:!1,websocketsOnly:!1,ssr:!1};let Xd;function Yd(){return Xd}function Zd(e={}){const{apolloClient:t}=Object(Qd["createApolloClient"])({...Jd,...e});Xd=t;const a=new Hd["a"]({defaultClient:t,defaultOptions:{$query:{}},errorHandler(e){console.log("%cError","background: red; color: white; padding: 2px 4px; border-radius: 3px; font-weight: bold;",e.message)}});return a}var eu=a("851a"),tu=a.n(eu);async function au(){const e=Yd(),t=await e.query({query:tu.a,fetchPolicy:"network-only"});return t.data.PGDBIRC.pgdbirc}var iu=au;async function nu(e){const t=await iu();await e.commit("resetDefaultState",t)}var lu=nu;async function ou({state:e}){const t=Yd(),a=xs(e),i=gs(e),n=ds(e),l=Il(e),o=Ho(e),s=Pl(e),r=Mo(e),c=await t.mutate({mutation:j.a,variables:{projectState:e,masterSecurityPolicy:a,ownershipPolicy:i,schemaUsageSql:n,masterTablePolicy:l.policy,masterFunctionPolicy:o.policy,allSchemaTablePolicies:s,allSchemaFunctionPolicies:r}});return e.isDirty=!1,c.data.WriteArtifacts.result}var su=ou,ru=a("bfc4"),cu=a.n(ru);async function du({commit:e}){const t=Yd(),a=await t.query({query:cu.a,fetchPolicy:"network-only"}),i=a.data.project.project;e("importProject",{project:i})}var uu=du,mu={setProjectRoleSet:Bd,setManagedSchemata:zd,resetDefaultState:lu,writeToDisk:su,loadFromDisk:uu};i["a"].use(Cl["a"]);var pu=new Cl["a"].Store({plugins:[Object(Ac["a"])()],state:jc,mutations:Gd,actions:mu});i["a"].use(Y["a"]);const hu=new Y["a"]({scrollBehavior(e,t,a){return a||{x:0,y:0}},routes:[{path:"/",name:"home",component:Ae},{path:"/initialize",name:"initialize",component:Ue},{path:"/role-manager",name:"role-manager",component:Pn},{path:"/security-manager",name:"security-manager",component:qs},{path:"/pg-lint",name:"pg-lint",component:Hs},{path:"/search-view",name:"search-view",component:dr},{path:"/fk-index-manager",name:"fk-index-manager",component:Kr},{path:"/smart-comment-manager",name:"smart-comment-manager",component:tc},{path:"/settings",name:"settings",component:Dr},{path:"/project-export",name:"project-export",component:sc},{path:"/project-import",name:"project-import",component:pc},{path:"/sqitch",name:"sqitch",component:yc},{path:"/worker",name:"worker",component:Cc},{path:"/table/:id",name:"table",component:Ji,props:!0},{path:"/view/:id",name:"view",component:cn,props:!0},{path:"/function/:id",name:"function",component:Qa["a"],props:!0},{path:"/enum/:id",name:"enum",component:Dc,props:!0},{path:"/udt/:id",name:"udt",component:$c,props:!0},{path:"/about",name:"about",component:()=>a.e("about").then(a.bind(null,"f820"))}]});hu.beforeEach((e,t,a)=>{pu.state.initializing&&"initialize"!==e.name&&hu.push("initialize"),a()});var fu=hu,bu=a("ca55");i["a"].config.productionTip=!1,i["a"].use(fn.a),i["a"].use(bu["a"]),new i["a"]({vuetify:l,router:fu,store:pu,apolloProvider:Zd(),render:e=>e(X)}).$mount("#app")},"58bb":function(e,t){var a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dbIntrospection"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"pgdbiOptions"},arguments:[],directives:[]}]}}],loc:{start:0,end:42}};a.loc.source={body:"query {\n  dbIntrospection\n  pgdbiOptions\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};function i(e,t){if("FragmentSpread"===e.kind)t.add(e.name.value);else if("VariableDefinition"===e.kind){var a=e.type;"NamedType"===a.kind&&t.add(a.name.value)}e.selectionSet&&e.selectionSet.selections.forEach((function(e){i(e,t)})),e.variableDefinitions&&e.variableDefinitions.forEach((function(e){i(e,t)})),e.definitions&&e.definitions.forEach((function(e){i(e,t)}))}var n={};(function(){a.definitions.forEach((function(e){if(e.name){var t=new Set;i(e,t),n[e.name.value]=t}}))})(),e.exports=a},6514:function(e,t){var a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"WriteArtifacts"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"projectState"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"JSON"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"masterSecurityPolicy"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"ownershipPolicy"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"schemaUsageSql"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"masterTablePolicy"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"masterFunctionPolicy"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"allSchemaTablePolicies"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"JSON"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"allSchemaFunctionPolicies"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"JSON"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"WriteArtifacts"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"projectState"},value:{kind:"Variable",name:{kind:"Name",value:"projectState"}}},{kind:"ObjectField",name:{kind:"Name",value:"masterSecurityPolicy"},value:{kind:"Variable",name:{kind:"Name",value:"masterSecurityPolicy"}}},{kind:"ObjectField",name:{kind:"Name",value:"ownershipPolicy"},value:{kind:"Variable",name:{kind:"Name",value:"ownershipPolicy"}}},{kind:"ObjectField",name:{kind:"Name",value:"schemaUsageSql"},value:{kind:"Variable",name:{kind:"Name",value:"schemaUsageSql"}}},{kind:"ObjectField",name:{kind:"Name",value:"masterTablePolicy"},value:{kind:"Variable",name:{kind:"Name",value:"masterTablePolicy"}}},{kind:"ObjectField",name:{kind:"Name",value:"masterFunctionPolicy"},value:{kind:"Variable",name:{kind:"Name",value:"masterFunctionPolicy"}}},{kind:"ObjectField",name:{kind:"Name",value:"allSchemaTablePolicies"},value:{kind:"Variable",name:{kind:"Name",value:"allSchemaTablePolicies"}}},{kind:"ObjectField",name:{kind:"Name",value:"allSchemaFunctionPolicies"},value:{kind:"Variable",name:{kind:"Name",value:"allSchemaFunctionPolicies"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"result"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:674}};a.loc.source={body:"mutation WriteArtifacts(\n  $projectState: JSON!\n  $masterSecurityPolicy: String!\n  $ownershipPolicy: String!\n  $schemaUsageSql: String!\n  $masterTablePolicy: String!\n  $masterFunctionPolicy: String!\n  $allSchemaTablePolicies: JSON!\n  $allSchemaFunctionPolicies: JSON!\n){\n  WriteArtifacts(input: {\n    projectState: $projectState\n    masterSecurityPolicy: $masterSecurityPolicy\n    ownershipPolicy: $ownershipPolicy\n    schemaUsageSql: $schemaUsageSql\n    masterTablePolicy: $masterTablePolicy\n    masterFunctionPolicy: $masterFunctionPolicy\n    allSchemaTablePolicies: $allSchemaTablePolicies\n    allSchemaFunctionPolicies: $allSchemaFunctionPolicies\n  }) {\n    result\n  }\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};function i(e,t){if("FragmentSpread"===e.kind)t.add(e.name.value);else if("VariableDefinition"===e.kind){var a=e.type;"NamedType"===a.kind&&t.add(a.name.value)}e.selectionSet&&e.selectionSet.selections.forEach((function(e){i(e,t)})),e.variableDefinitions&&e.variableDefinitions.forEach((function(e){i(e,t)})),e.definitions&&e.definitions.forEach((function(e){i(e,t)}))}var n={};function l(e,t){for(var a=0;a<e.definitions.length;a++){var i=e.definitions[a];if(i.name&&i.name.value==t)return i}}function o(e,t){var a={kind:e.kind,definitions:[l(e,t)]};e.hasOwnProperty("loc")&&(a.loc=e.loc);var i=n[t]||new Set,o=new Set,s=new Set;i.forEach((function(e){s.add(e)}));while(s.size>0){var r=s;s=new Set,r.forEach((function(e){if(!o.has(e)){o.add(e);var t=n[e]||new Set;t.forEach((function(e){s.add(e)}))}}))}return o.forEach((function(t){var i=l(e,t);i&&a.definitions.push(i)})),a}(function(){a.definitions.forEach((function(e){if(e.name){var t=new Set;i(e,t),n[e.name.value]=t}}))})(),e.exports=a,e.exports["WriteArtifacts"]=o(a,"WriteArtifacts")},"6c2b":function(e,t,a){"use strict";(function(e){var i=a("82cd");t["a"]={name:"FunctionPolicyManager",components:{PolicyDefinition:i["a"]},methods:{saveNewPolicy(){try{this.$store.commit("newFunctionPolicy",{name:this.newPolicyName})}catch(e){alert(e.toString()),console.error(e)}this.dialog=!1}},computed:{policies(){return this.$store.state.functionPolicies.sort((function(e,t){return e.id<t.id?-1:1}))}},data(){return{dialog:!1,newPolicyName:"New Function Policy",headers:[{text:"",sortable:!1},{text:"ID",sortable:!1,value:"id"},{text:"Name",sortable:!1,value:"name"}]}},mounted(){e.client&&window&&(window.history.scrollRestoration="auto")}}}).call(this,a("f28c"))},"6d7d":function(e,t,a){},"7b59":function(e,t,a){"use strict";var i=a("8e2c"),n=a.n(i);n.a},"82cd":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-card",{key:e.policyDefinition.id,attrs:{color:"black"}},[a("v-container",[a("v-toolbar",[a("h1",[e._v("Name: "+e._s(e.policyDefinition.name))])]),a("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("v-tab",{key:"grants",attrs:{ripple:""}},[e._v("\n        Execution Grants\n      ")]),a("v-tab-item",{key:"grants"},[a("v-card",{attrs:{flat:""}},[a("policy-definition-grant-grid",{attrs:{policy:e.policyDefinition,disabled:e.disabled}})],1)],1),a("v-tab",{key:"policy-template",attrs:{ripple:""}},[e._v("\n        "+e._s(e.aFunction?"Policy":"Policy Template")+"\n      ")]),a("v-tab-item",{key:"policy-template"},[a("v-card",{attrs:{flat:""}},[a("policy-realization",{attrs:{policyDefinition:e.policyDefinition,aFunction:e.aFunction}})],1)],1),e.aFunction?a("v-tab",{key:"function-definition",attrs:{ripple:""}},[e._v("\n        Function Definition\n      ")]):e._e(),e.aFunction?a("v-tab-item",{key:"function-definition"},[a("v-card",{attrs:{flat:""}},[a("function-definition",{attrs:{id:e.aFunction.id}})],1)],1):e._e()],1)],1)],1)},n=[],l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-data-table",{staticClass:"text-sm-left",attrs:{headers:e.headers,items:e.grantMatrix,"hide-default-footer":"","item-key":"id"},scopedSlots:e._u([{key:"item.execute",fn:function(t){var i=t.item;return[a("v-checkbox",{attrs:{"input-value":e.roleGrantSelected(i,"execute"),disabled:e.roleGrantDisabled(i,"execute")},on:{click:function(t){return e.toggleRoleGrant(i.roleName,"execute")}}})]}}])})},o=[];const s="ALLOWED",r="DENIED",c="IMPLIED";var d={name:"FunctionPolicyDefinitionGrantGrid",props:{policy:{type:Object,required:!0},disabled:{type:Boolean,default:!1}},data(){return{policyStructure:[],calculatedPolicy:"NOT CALCULATED",toggleCompleted:!1}},watch:{},methods:{roleGrantSelected(e,t){return[s,c].indexOf(e[t])>-1},roleGrantDisabled(e,t){return e[t]===c||this.disabled},toggleRoleGrant(e,t){if(!0===this.toggleCompleted)return void(this.toggleCompleted=!1);const a=this.policy.roleFunctionGrants[e][t],i=this.dbUserRoles.filter(t=>void 0!==t.applicableRoles.find(t=>t.roleName===e)).reduce((e,t)=>e.concat(t.roleName),[]),n={...this.policy,roleFunctionGrants:Object.keys(this.policy.roleFunctionGrants).reduce((n,l)=>{const o=i.indexOf(l)>-1,d=l===e;return{...n,[l]:Object.keys(this.policy.roleFunctionGrants[l]).reduce((e,i)=>{this.policy.roleFunctionGrants[l][i];let n;return n=i===t?d?a===s?r:s:o?a===s?r:c:this.policy.roleFunctionGrants[l][i]:"all"==i&&(o||d)&&a===s?r:this.policy.roleFunctionGrants[l][i],{...e,[i]:n}},{})}},{})};this.$store.commit("saveFunctionPolicy",{policy:n}),this.toggleCompleted=!0}},computed:{dbUserRoles(){return this.$store.state.roleSet.dbUserRoles},grantMatrix(){return Object.keys(this.policy.roleFunctionGrants).map(e=>({...this.policy.roleFunctionGrants[e],roleName:e}))},headers(){return[{text:"Role Name",sortable:!1,value:"roleName"},{text:"EXECUTE",sortable:!1,value:"execute"}]}}},u=d,m=a("2877"),p=a("6544"),h=a.n(p),f=a("ac7c"),b=a("8fea"),v=Object(m["a"])(u,l,o,!1,null,null,null),y=v.exports;h()(v,{VCheckbox:f["a"],VDataTable:b["a"]});var g=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("script-viewer",{attrs:{scriptText:e.computedPolicy,skipFormat:"",canExecute:""},on:{"readability-changed":e.policyReadabilityChanged}})],1)},k=[],x=a("89d6"),N=a("4eb5"),C=a.n(N),T=a("0100"),S={name:"FunctionDefinition",mixins:[C.a],components:{ScriptViewer:x["a"]},props:{policyDefinition:{type:Object,required:!0},aFunction:{type:Object,required:!1}},data(){return{policyStructure:[],policyReadability:"terse",computedPolicy:"N/A"}},mounted(){this.doComputePolicy()},watch:{policyDefinition(){this.doComputePolicy()},policyReadability(){this.doComputePolicy()}},methods:{policyReadabilityChanged(e){this.policyReadability=e},refresh(){this.doComputePolicy()},expand(){this.computedPolicy=this.computedPolicy+" "},doComputePolicy(){const e=this.aFunction?{}:null;this.computedPolicy=Object(T["a"])(this.policyDefinition,this.policyReadability,e,this.aFunction)},onCopy:function(e){alert("Copied!")},onError:function(e){alert("Failed to copy texts")},executeSql(){alert("not implemented:  server config value will expose graphile extension to execute generated script")}},computed:{}},_=S,E=a("a523"),P=Object(m["a"])(_,g,k,!1,null,null,null),D=P.exports;h()(P,{VContainer:E["a"]});var I=a("243e");var w={name:"FunctionPolicyDefinition",components:{PolicyDefinitionGrantGrid:y,PolicyRealization:D,FunctionDefinition:I["a"]},props:{policyId:{type:Number,required:!0},aFunction:{type:Object,required:!1}},data(){return{calculatedPolicy:"NOT CALCULATED",toggleCompleted:!1,activeTab:0}},mounted(){},watch:{},methods:{},computed:{disabled(){return null!==this.aFunction&&void 0!==this.aFunction||this.policyDefinition.id===this.$store.state.defaultFunctionPolicy.id},policyDefinition(){this.$store.state.functionPolicies;const e=this.$store.state.functionPolicies.find(e=>e.id===this.policyId);return e}}},R=w,O=a("b0af"),V=a("71a3"),$=a("c671"),A=a("fe57"),j=a("71d9"),F=Object(m["a"])(R,i,n,!1,null,null,null);t["a"]=F.exports;h()(F,{VCard:O["a"],VContainer:E["a"],VTab:V["a"],VTabItem:$["a"],VTabs:A["a"],VToolbar:j["a"]})},"83cd":function(e,t){function a(e,t){e.isDirty=!0,e.defaultRlsUsing=t.defaultRlsUsing}e.exports=a},"851a":function(e,t){var a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"PGDBIRC"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"PGDBIRC"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"pgdbirc"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:45}};a.loc.source={body:"query PGDBIRC {\n  PGDBIRC {\n    pgdbirc\n  }\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};function i(e,t){if("FragmentSpread"===e.kind)t.add(e.name.value);else if("VariableDefinition"===e.kind){var a=e.type;"NamedType"===a.kind&&t.add(a.name.value)}e.selectionSet&&e.selectionSet.selections.forEach((function(e){i(e,t)})),e.variableDefinitions&&e.variableDefinitions.forEach((function(e){i(e,t)})),e.definitions&&e.definitions.forEach((function(e){i(e,t)}))}var n={};function l(e,t){for(var a=0;a<e.definitions.length;a++){var i=e.definitions[a];if(i.name&&i.name.value==t)return i}}function o(e,t){var a={kind:e.kind,definitions:[l(e,t)]};e.hasOwnProperty("loc")&&(a.loc=e.loc);var i=n[t]||new Set,o=new Set,s=new Set;i.forEach((function(e){s.add(e)}));while(s.size>0){var r=s;s=new Set,r.forEach((function(e){if(!o.has(e)){o.add(e);var t=n[e]||new Set;t.forEach((function(e){s.add(e)}))}}))}return o.forEach((function(t){var i=l(e,t);i&&a.definitions.push(i)})),a}(function(){a.definitions.forEach((function(e){if(e.name){var t=new Set;i(e,t),n[e.name.value]=t}}))})(),e.exports=a,e.exports["PGDBIRC"]=o(a,"PGDBIRC")},"861c":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{fluid:"",cols:"12"}},[a("v-toolbar",{attrs:{dense:""}},[a("v-switch",{attrs:{label:"Enable RLS",disabled:e.disabled},model:{value:e.enableRls,callback:function(t){e.enableRls=t},expression:"enableRls"}}),a("v-spacer"),e.showMakeGlobalButton?a("table-policy-make-global-dialog",{attrs:{policyDefinition:e.policyDefinition}}):e._e(),a("v-spacer"),e.showDeleteButton?a("table-policy-delete-dialog",{attrs:{policyDefinition:e.policyDefinition}}):e._e(),a("v-spacer"),a("h4",{staticClass:"text-no-wrap"},[e._v(e._s(e.title))]),a("v-spacer"),a("table-policy-rename-dialog",{attrs:{policyDefinition:e.policyDefinition}})],1),a("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("v-tab",{key:"grants",attrs:{ripple:""}},[e._v("\n        Table Grants\n      ")]),a("v-tab-item",{key:"grants"},[a("v-card",{attrs:{flat:""}},[a("table-policy-definition-grants",{attrs:{policyDefinition:e.policyDefinition,disabled:e.disabled}})],1)],1),a("v-tab",{key:"rls",attrs:{ripple:"",disabled:!e.enableRls}},[e._v("\n        Row Level Security\n      ")]),a("v-tab-item",{key:"rls"},[a("v-card",{attrs:{flat:""}},[a("policy-rls-qualifier-grid",{attrs:{policy:e.policyDefinition,disabled:e.disabled}})],1)],1),a("v-tab",{key:"policy-template",attrs:{ripple:""}},[e._v("\n        "+e._s(e.table?"Policy Script":"Policy Script Template")+"\n      ")]),a("v-tab-item",{key:"policy-template"},[a("v-card",{attrs:{flat:""}},[a("policy-realization",{attrs:{policyDefinition:e.policyDefinition,table:e.table,enableRls:e.enableRls}})],1)],1),e.table?a("v-tab",{key:"policy-evaluation",attrs:{ripple:""}},[e._v("\n        Evaluation\n      ")]):e._e(),e.table?a("v-tab-item",{key:"policy-evaluation"},[a("v-card",{attrs:{flat:""}},[a("table-policy-evaluator-detail",{attrs:{policyDefinition:e.policyDefinition,table:e.table}})],1)],1):e._e()],1)],1)},n=[],l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("v-tab",{key:"grants",attrs:{ripple:""}},[e._v("\n    Role Grants\n  ")]),a("v-tab-item",{key:"grants"},[a("v-card",{attrs:{flat:""}},[a("table-policy-definition-grant-grid",{attrs:{policyDefinition:e.policyDefinition,disabled:e.disabled}})],1)],1),a("v-tab",{key:"exclusions",attrs:{ripple:"",disabled:e.disabled}},[e._v("\n    Column Exclusions\n  ")]),a("v-tab-item",{key:"exclusions"},[a("v-card",{attrs:{flat:""}},[a("table-policy-definition-column-exclusions",{attrs:{policyDefinition:e.policyDefinition,table:e.table,disabled:e.disabled}})],1)],1)],1)},o=[],s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-data-table",{staticClass:"text-sm-left",attrs:{headers:e.headers,items:e.grantMatrix,"hide-default-footer":"","item-key":"id"},scopedSlots:e._u([{key:"item.select",fn:function(t){var i=t.item;return[a("v-checkbox",{attrs:{"input-value":e.roleGrantSelected(i,"select"),disabled:e.roleGrantDisabled(i,"select")},on:{click:function(t){return e.toggleRoleGrant(i.roleName,"select")}}})]}},{key:"item.insert",fn:function(t){var i=t.item;return[a("v-checkbox",{attrs:{"input-value":e.roleGrantSelected(i,"insert"),disabled:e.roleGrantDisabled(i,"insert")},on:{click:function(t){return e.toggleRoleGrant(i.roleName,"insert")}}})]}},{key:"item.update",fn:function(t){var i=t.item;return[a("v-checkbox",{attrs:{"input-value":e.roleGrantSelected(i,"update"),disabled:e.roleGrantDisabled(i,"update")},on:{click:function(t){return e.toggleRoleGrant(i.roleName,"update")}}})]}},{key:"item.delete",fn:function(t){var i=t.item;return[a("v-checkbox",{attrs:{"input-value":e.roleGrantSelected(i,"delete"),disabled:e.roleGrantDisabled(i,"delete")},on:{click:function(t){return e.toggleRoleGrant(i.roleName,"delete")}}})]}}])})},r=[];const c="ALLOWED",d="DENIED",u="IMPLIED";var m={name:"PolicyDefinitionGrantGrid",props:{policyDefinition:{type:Object,required:!0},disabled:{type:Boolean,default:!1}},data(){return{policyStructure:[],calculatedPolicy:"NOT CALCULATED",toggleCompleted:!1}},watch:{},methods:{roleGrantSelected(e,t){return[c,u].indexOf(e[t])>-1},roleGrantDisabled(e,t){return e[t]===u||this.disabled},toggleRoleGrant(e,t){if(!0===this.toggleCompleted)return void(this.toggleCompleted=!1);const a=this.policyDefinition.roleGrants[e][t],i=this.dbUserRoles.filter(t=>void 0!==(t.applicableRoles||[]).find(t=>t.roleName===e)).reduce((e,t)=>e.concat(t.roleName),[]),n={...this.policyDefinition,roleGrants:Object.keys(this.policyDefinition.roleGrants).reduce((n,l)=>{const o=i.indexOf(l)>-1,s=l===e;return{...n,[l]:Object.keys(this.policyDefinition.roleGrants[l]).reduce((e,i)=>{let n;return n=i===t?s?a===c?d:c:o?a===c?d:u:this.policyDefinition.roleGrants[l][i]:"all"==i&&(o||s)&&a===c?d:this.policyDefinition.roleGrants[l][i],{...e,[i]:n}},{})}},{})};this.$store.commit("savePolicy",{policy:n}),this.toggleCompleted=!0}},computed:{dbUserRoles(){return this.$store.state.roleSet.dbUserRoles},grantMatrix(){return Object.keys(this.policyDefinition.roleGrants).map(e=>({...this.policyDefinition.roleGrants[e],roleName:e}))},headers(){return[{text:"Role Name",sortable:!1,value:"roleName"},{text:"SELECT",sortable:!1,value:"select"},{text:"INSERT",sortable:!1,value:"insert"},{text:"UPDATE",sortable:!1,value:"update"},{text:"DELETE",sortable:!1,value:"delete"}]}}},p=m,h=a("2877"),f=a("6544"),b=a.n(f),v=a("ac7c"),y=a("8fea"),g=Object(h["a"])(p,s,r,!1,null,null,null),k=g.exports;b()(g,{VCheckbox:v["a"],VDataTable:y["a"]});var x=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{"justify-start":""}},[a("v-data-table",{attrs:{headers:e.headers,items:e.dataTableItems,"hide-default-footer":"",dense:""},scopedSlots:e._u([{key:"item.insertExclusions",fn:function(t){var i=t.item;return[a("column-exclusion-set",{attrs:{policyDefinition:e.policyDefinition,table:e.table,action:"insert",roleName:i.roleName}})]}},{key:"item.updateExclusions",fn:function(t){var i=t.item;return[a("column-exclusion-set",{attrs:{policyDefinition:e.policyDefinition,table:e.table,action:"update",roleName:i.roleName}})]}}])})],1)},N=[],C=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[e.overrideHidden?e._e():a("v-switch",{attrs:{label:"override implied exclusions"},model:{value:e.overrideActive,callback:function(t){e.overrideActive=t},expression:"overrideActive"}}),e.showDialogButton?a("table-policy-column-exclusion-dialog",{attrs:{policyDefinition:e.policyDefinition,table:e.table,action:e.action,roleName:e.roleName}}):e._e(),a("v-list",e._l(e.currentColumnExclusions,(function(t){return a("v-list-item",{key:t},[a("v-btn",{on:{click:function(a){return e.removeColumnExclusion(t)}}},[a("v-icon",[e._v("clear")])],1),e._v(" "+e._s(t)+"\n      ")],1)})),1)],1)},T=[],S=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-dialog",{attrs:{persistent:"",width:"800"},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[a("v-btn",e._g({staticClass:"text-none",attrs:{small:"",dark:"",hidden:e.hidden,disabled:e.disabled}},i),[e._v("\n        "+e._s(e.displayValue)+"\n      ")])]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[a("v-card-title",{staticClass:"headline"},[e._v("Exclude Column")]),a("v-text-field",{model:{value:e.columnName,callback:function(t){e.columnName=t},expression:"columnName"}}),a("v-card-actions",[a("v-spacer"),a("v-btn",{on:{click:function(t){e.dialog=!1}}},[e._v("Cancel")]),a("v-btn",{on:{click:e.addColumnExclusion}},[e._v("Exclude")]),a("v-spacer")],1)],1)],1)],1)},_=[],E={name:"TablePolicyColumnExclusionDialog",props:{policyDefinition:{type:Object,required:!0},table:{type:Object,required:!1},action:{type:String,required:!0},roleName:{type:String,required:!0},disabled:{type:Boolean,required:!1}},data(){return{dialog:!1,columnName:""}},computed:{displayValue(){return`New ${this.action} exclusion`},hidden(){return"DENIED"===this.policyDefinition.roleGrants[this.roleName][this.action]}},watch:{},methods:{addColumnExclusion(){this.dialog=!1;const e=(this.policyDefinition.columnExclusions[this.action][this.roleName]||[]).filter(e=>e!==this.columnName).concat([this.columnName]);try{this.$store.commit("savePolicy",{policy:{...this.policyDefinition,columnExclusions:{...this.policyDefinition.columnExclusions,[this.action]:{...this.policyDefinition.columnExclusions[this.action],[this.roleName]:e}}}})}catch(t){alert(t.toString()),console.error(t)}}}},P=E,D=(a("c2d7"),a("8336")),I=a("b0af"),w=a("99d9"),R=a("169a"),O=a("2fa4"),V=a("8654"),$=Object(h["a"])(P,S,_,!1,null,null,null),A=$.exports;b()($,{VBtn:D["a"],VCard:I["a"],VCardActions:w["a"],VCardTitle:w["c"],VDialog:R["a"],VSpacer:O["a"],VTextField:V["a"]});var j={name:"ColumnExclusionSet",components:{TablePolicyColumnExclusionDialog:A},props:{policyDefinition:{type:Object,required:!0},table:{type:Object,required:!1},action:{type:String,required:!0},roleName:{type:String,required:!0}},data(){return{toggleCompleted:!1,overrideActive:!1}},watch:{overrideActive(){let e;const t=this.policyDefinition.columnExclusionOverrides[this.action].filter(e=>e!==this.roleName),a=this.overrideActive?t.concat(this.roleName):t;if(this.overrideActive)e=this.policyDefinition.columnExclusions[this.action];else{let{[this.roleName]:e,...t}=this.policyDefinition.columnExclusions[this.action]}try{this.$store.commit("savePolicy",{policy:{...this.policyDefinition,columnExclusionOverrides:{...this.policyDefinition.columnExclusionOverrides,[this.action]:a},columnExclusions:{...this.policyDefinition.columnExclusions,[this.action]:e||{}}}})}catch(i){alert(i.toString()),console.error(i)}}},methods:{removeColumnExclusion(e){const t=this.policyDefinition.columnExclusions[this.action][this.roleName].filter(t=>t!==e);try{this.$store.commit("savePolicy",{policy:{...this.policyDefinition,columnExclusions:{...this.policyDefinition.columnExclusions,[this.action]:{...this.policyDefinition.columnExclusions[this.action],[this.roleName]:t}}}})}catch(a){alert(a.toString()),console.error(a)}}},mounted(){this.overrideActive=this.policyDefinition.columnExclusionOverrides[this.action].indexOf(this.roleName)>-1},computed:{currentColumnExclusions(){return(this.policyDefinition.columnExclusions[this.action]||[])[this.roleName]},disabled(){return"DENIED"===this.policyDefinition.roleGrants[this.roleName][this.action]},overrideHidden(){const e=["DENIED","ALLOWED"].indexOf(this.policyDefinition.roleGrants[this.roleName][this.action])>-1;return e},showDialogButton(){return!0}}},F=j,L=a("a523"),q=a("132d"),G=a("8860"),U=a("da13"),B=a("b73d"),M=Object(h["a"])(F,C,T,!1,null,null,null),z=M.exports;b()(M,{VBtn:D["a"],VContainer:L["a"],VIcon:q["a"],VList:G["a"],VListItem:U["a"],VSwitch:B["a"]});var H={name:"PolicyDefinitionColumnExclusions",components:{ColumnExclusionSet:z},props:{policyDefinition:{type:Object,required:!0},table:{type:Object,required:!1},disabled:{type:Boolean,default:!1}},data(){return{toggleComplete:!1,headers:[{text:"Role Name",sortable:!1,value:"roleName"},{text:"Insert Exclusions",sortable:!1,value:"insertExclusions"},{text:"Update Exclusions",sortable:!1,value:"updateExclusions"}]}},watch:{},methods:{removeInsertExclusion(e,t){console.log("columnExclusion",e,t)}},computed:{dbUserRoles(){return this.$store.state.roleSet.dbUserRoles},dataTableItems(){return Object.keys(this.policyDefinition.roleGrants).reduce((e,t)=>{const a=(this.policyDefinition.columnExclusions.insert||[])[t]||[],i=(this.policyDefinition.columnExclusions.update||[])[t]||[];return[...e,{roleName:t,insertColumnExclusions:a,updateColumnExclusions:i}]},[])}}},Q=H,W=Object(h["a"])(Q,x,N,!1,null,null,null),K=W.exports;b()(W,{VContainer:L["a"],VDataTable:y["a"]});var J={name:"PolicyDefinitionGrants",components:{TablePolicyDefinitionGrantGrid:k,TablePolicyDefinitionColumnExclusions:K},props:{policyDefinition:{type:Object,required:!0},table:{type:Object,required:!1},disabled:{type:Boolean,default:!1}},data(){return{activeTab:null}},watch:{},methods:{},computed:{}},X=J,Y=a("71a3"),Z=a("c671"),ee=a("fe57"),te=Object(h["a"])(X,l,o,!1,null,null,null),ae=te.exports;b()(te,{VCard:I["a"],VTab:Y["a"],VTabItem:Z["a"],VTabs:ee["a"]});var ie=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-data-table",{attrs:{headers:e.headers,items:e.rlsQualifierMatrix,"hide-default-footer":"","item-key":"id",dense:""},scopedSlots:e._u([{key:"item.roleName",fn:function(t){var i=t.item;return[a("div",{staticClass:"text-no-wrap"},[e._v(e._s(i.roleName))])]}},{key:"item.all",fn:function(t){var i=t.item;return[a("table-policy-rls-action",{attrs:{policy:e.policy,action:"all",item:i,disabled:e.disabled}})]}},{key:"item.select",fn:function(t){var i=t.item;return[a("table-policy-rls-action",{attrs:{policy:e.policy,action:"select",item:i,disabled:e.disabled}})]}},{key:"item.insert",fn:function(t){var i=t.item;return[a("table-policy-rls-action",{attrs:{policy:e.policy,action:"insert",item:i,disabled:e.disabled}})]}},{key:"item.update",fn:function(t){var i=t.item;return[a("table-policy-rls-action",{attrs:{policy:e.policy,action:"update",item:i,disabled:e.disabled}})]}},{key:"item.delete",fn:function(t){var i=t.item;return[a("table-policy-rls-action",{attrs:{policy:e.policy,action:"delete",item:i,disabled:e.disabled}})]}}])})},ne=[],le=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-btn",{attrs:{small:"",hidden:e.disabled},on:{click:function(t){return e.addRlsPolicy(e.item.roleName,e.action)}}},[e._v("Add Policy")]),e._l(e.item[e.action].policies,(function(t){return a("rls-policy-dialog",{key:t.roleName+"-"+t.id,attrs:{action:e.action,roleName:e.item.roleName,rlsPolicy:t,status:"ENABLED",disableRlsPolicy:e.disableRlsPolicy,updateRlsPolicy:e.updateRlsPolicy,disabled:e.disabled}})})),e._l(e.impliedPolicies(e.item.roleName,e.action),(function(t){return a("rls-policy-dialog",{key:t.roleName+"-"+t.id,attrs:{action:e.action,roleName:e.item.roleName,rlsPolicy:t,status:"IMPLIED",disableRlsPolicy:e.disableRlsPolicy,updateRlsPolicy:e.updateRlsPolicy,disabled:e.disabled}})}))],2)},oe=[],se=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-dialog",{attrs:{persistent:"",width:"1400"},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[a("v-btn",e._g({staticClass:"text-none",attrs:{small:"",dark:"",disabled:e.btnDisabled,hidden:e.hidden},on:{click:e.activate}},i),[e._v("\n        "+e._s(e.displayValue)+"\n      ")])]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[a("v-card-title",{staticClass:"headline"},[e._v("Rls Policy")]),a("v-text-field",{attrs:{label:"Name",disabled:e.disabled},model:{value:e.currentName,callback:function(t){e.currentName=t},expression:"currentName"}}),a("v-radio-group",{attrs:{column:!1,disabled:e.disabled},model:{value:e.currentPassStrategy,callback:function(t){e.currentPassStrategy=t},expression:"currentPassStrategy"}},[a("v-radio",{attrs:{label:"Permissive",value:"permissive"}}),a("v-radio",{attrs:{label:"Restrictive",value:"restrictive"}})],1),a("v-text-field",{attrs:{label:"Using",disabled:e.disabled},model:{value:e.currentUsing,callback:function(t){e.currentUsing=t},expression:"currentUsing"}}),a("v-text-field",{attrs:{label:"With Check",disabled:e.disabled},model:{value:e.currentWithCheck,callback:function(t){e.currentWithCheck=t},expression:"currentWithCheck"}}),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{hidden:e.disabled},on:{click:function(t){e.updateRlsPolicy(e.roleName,e.action,e.rlsPolicy.id,e.currentUsing,e.currentWithCheck,e.currentPassStrategy,e.currentName),e.dialog=!1}}},[e._v("Update")]),a("v-btn",{attrs:{hidden:e.disabled},on:{click:function(t){e.disableRlsPolicy(e.roleName,e.action,e.rlsPolicy.id),e.dialog=!1}}},[e._v("Disable")]),a("v-btn",{attrs:{hidden:e.disabled},on:{click:function(t){e.dialog=!1}}},[e._v("Cancel")]),a("v-btn",{attrs:{hidden:!e.disabled},on:{click:function(t){e.dialog=!1}}},[e._v("OK")]),a("v-spacer")],1)],1)],1)],1)},re=[];const ce="DISABLED",de="IMPLIED";var ue={name:"RlsPolicyDialog",props:{disabled:{type:Boolean,default:!1},status:{type:String,required:!0},rlsPolicy:{type:Object,required:!0},action:{type:String,required:!0},roleName:{type:String,required:!0},disableRlsPolicy:{type:Function,required:!0},updateRlsPolicy:{type:Function,required:!0}},data(){return{toggleCompleted:!1,dialog:!1,currentName:"n/a",currentUsing:"n/a",currentWithCheck:"n/a",currentPassStrategy:!1}},computed:{displayValue(){return this.rlsPolicy.name},rlsQualifierDisplayValueDisabled(){return!1},hidden(){return!1},btnDisabled(){return[ce,de].indexOf(this.status)>-1}},watch:{},methods:{activate(){this.currentName=this.rlsPolicy.name,this.currentUsing=this.rlsPolicy.using,this.currentWithCheck=this.rlsPolicy.withCheck,this.currentPassStrategy=this.rlsPolicy.passStrategy}}},me=ue,pe=(a("dbdb"),a("67b6")),he=a("43a6"),fe=Object(h["a"])(me,se,re,!1,null,null,null),be=fe.exports;b()(fe,{VBtn:D["a"],VCard:I["a"],VCardActions:w["a"],VCardTitle:w["c"],VDialog:R["a"],VRadio:pe["a"],VRadioGroup:he["a"],VSpacer:O["a"],VTextField:V["a"]});var ve={name:"PolicyRlsAction",components:{RlsPolicyDialog:be},props:{policy:{type:Object,required:!0},action:{type:String,required:!0},item:{type:Object,required:!0},disabled:{type:Boolean,default:!1}},data(){return{}},watch:{},methods:{impliedPolicies(e,t){const a=this.dbUserRoles.find(t=>t.roleName===e).applicableRoles.reduce((e,t)=>e.concat(t.roleName),[]).concat([e]),i=a.reduce((a,i)=>i!==e?"all"===t?a.concat(this.policy.rlsQualifiers[i][t].policies):a.concat(this.policy.rlsQualifiers[i][t].policies).concat(this.policy.rlsQualifiers[i].all.policies):"all"===t?a:a.concat(this.policy.rlsQualifiers[i].all.policies),[]);return i},addRlsPolicy(e,t){this.$store.commit("createRlsPolicy",{policyId:this.policy.id,roleName:e,action:t})},disableRlsPolicy(e,t,a){this.$store.commit("deleteRlsPolicy",{policyId:this.policy.id,roleName:e,action:t,rlsPolicyId:a})},updateRlsPolicy(e,t,a,i,n,l,o){const s=this.policy.rlsQualifiers[e][t].policies.filter(e=>e.id!==a).concat([{id:a,using:i,withCheck:n,passStrategy:l,name:o}]),r={...this.policy,rlsQualifiers:{...this.policy.rlsQualifiers,[e]:{...this.policy.rlsQualifiers[e],[t]:{status:this.policy.rlsQualifiers[e][t].status,policies:s,using:i,withCheck:n,passStrategy:l}}}};this.$store.commit("savePolicy",{policy:r})}},computed:{dbUserRoles(){return this.$store.state.roleSet.dbUserRoles}}},ye=ve,ge=(a("c496"),Object(h["a"])(ye,le,oe,!1,null,null,null)),ke=ge.exports;b()(ge,{VBtn:D["a"],VContainer:L["a"]});const xe="ENABLED",Ne="DISABLED",Ce="IMPLIED";var Te={name:"PolicyRlsQualifierGrid",components:{TablePolicyRlsAction:ke},props:{policy:{type:Object,required:!0},disabled:{type:Boolean,default:!1}},data(){return{toggleCompleted:!1,dialog:!1,currentUsing:"n/a",currentWithCheck:"n/a"}},watch:{},methods:{impliedPolicies(e,t){const a=this.dbUserRoles.find(t=>t.roleName===e).applicableRoles.reduce((e,t)=>e.concat(t.roleName),[]).concat([e]),i=a.reduce((a,i)=>i!==e?"all"===t?a.concat(this.policy.rlsQualifiers[i][t].policies):a.concat(this.policy.rlsQualifiers[i][t].policies).concat(this.policy.rlsQualifiers[i].all.policies):"all"===t?a:a.concat(this.policy.rlsQualifiers[i].all.policies),[]);return i},addRlsPolicy(e,t){this.$store.commit("createRlsPolicy",{policyId:this.policy.id,roleName:e,action:t})},disableRlsPolicy(e,t,a){this.$store.commit("deleteRlsPolicy",{policyId:this.policy.id,roleName:e,action:t,rlsPolicyId:a})},updateRlsPolicy(e,t,a,i,n,l,o){const s=this.policy.rlsQualifiers[e][t].policies.filter(e=>e.id!==a).concat([{id:a,using:i,withCheck:n,passStrategy:l,name:o}]),r={...this.policy,rlsQualifiers:{...this.policy.rlsQualifiers,[e]:{...this.policy.rlsQualifiers[e],[t]:{status:this.policy.rlsQualifiers[e][t].status,policies:s,using:i,withCheck:n,passStrategy:l}}}};this.$store.commit("savePolicy",{policy:r})},rlsQualifierCheckLabel(e,t){switch(e[t].status){case xe:return"Add Policy";case Ne:return"Enable";case Ce:return"Add Policy"}}},computed:{dbUserRoles(){return this.$store.state.roleSet.dbUserRoles},defaultRLSQual(){return this.$store.state.defaultRLSQual},rlsQualifierMatrix(){return Object.keys(this.policy.rlsQualifiers).map(e=>({...this.policy.rlsQualifiers[e],roleName:e}))},headers(){return[{text:"Role Name",sortable:!1,value:"roleName"},{text:"ALL",sortable:!1,value:"all"},{text:"SELECT",sortable:!1,value:"select"},{text:"INSERT",sortable:!1,value:"insert"},{text:"UPDATE",sortable:!1,value:"update"},{text:"DELETE",sortable:!1,value:"delete"}]}}},Se=Te,_e=(a("065f"),Object(h["a"])(Se,ie,ne,!1,null,null,null)),Ee=_e.exports;b()(_e,{VDataTable:y["a"]});var Pe=a("96b5"),De=a("bd5a"),Ie=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-dialog",{attrs:{persistent:"",width:"800"},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[a("v-btn",e._g({staticClass:"text-none",attrs:{small:"",dark:"",disabled:e.disabled}},i),[e._v("\n        "+e._s(e.displayValue)+"\n      ")])]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[a("v-card-title",{staticClass:"headline"},[e._v("Make Custom Policy Available Globally")]),a("v-text-field",{model:{value:e.customName,callback:function(t){e.customName=t},expression:"customName"}}),a("v-card-actions",[a("v-spacer"),a("v-btn",{on:{click:function(t){e.dialog=!1}}},[e._v("Cancel")]),a("v-btn",{on:{click:e.makeGlobal}},[e._v("Make Global")]),a("v-spacer")],1)],1)],1)],1)},we=[],Re={name:"TablePolicyMakeGlobalDialog",props:{policyDefinition:{type:Object,required:!0},disabled:{type:Boolean,default:!1}},data(){return{dialog:!1,customName:"New Table Policy"}},computed:{displayValue(){return"Make Global"}},watch:{},methods:{makeGlobal(){this.dialog=!1;try{this.$store.commit("makeGlobalTablePolicy",{policyDefinitionId:this.policyDefinition.id,newFields:{name:this.customName}})}catch(e){alert(e.toString()),console.error(e)}}}},Oe=Re,Ve=(a("cfbf"),Object(h["a"])(Oe,Ie,we,!1,null,null,null)),$e=Ve.exports;b()(Ve,{VBtn:D["a"],VCard:I["a"],VCardActions:w["a"],VCardTitle:w["c"],VDialog:R["a"],VSpacer:O["a"],VTextField:V["a"]});var Ae=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-dialog",{attrs:{persistent:"",width:"800"},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[a("v-btn",e._g({staticClass:"text-none",attrs:{small:"",dark:"",disabled:e.disabled}},i),[e._v("\n        "+e._s(e.displayValue)+"\n      ")])]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[a("v-card-title",{staticClass:"headline"},[e._v("Delete Policy")]),a("h1",[e._v("Are you sure you want to delete this policy?")]),a("h2",[e._v("Any tables currently assigned this policy will revert to:")]),a("h2",[e._v("Default Policy - NO ACCESS")]),a("v-card-actions",[a("v-spacer"),a("v-btn",{on:{click:function(t){e.dialog=!1}}},[e._v("Cancel")]),a("v-btn",{attrs:{disabled:e.deleteDisabled},on:{click:e.deleteTablePolicyDefinition}},[e._v("Delete")]),a("v-spacer")],1)],1)],1)],1)},je=[],Fe={name:"TablePolicyDeleteDialog",props:{policyDefinition:{type:Object,required:!0},disabled:{type:Boolean,default:!1}},mounted(){},data(){return{dialog:!1}},computed:{displayValue(){return"Delete"},allPolicyDefinitions(){return this.$store.state.policies.filter(e=>!e.customIdentifier)},deleteDisabled(){return!1}},watch:{},methods:{deleteTablePolicyDefinition(){this.dialog=!1,this.$store.commit("deleteTablePolicy",{policyDefinitionId:this.policyDefinition.id})}}},Le=Fe,qe=(a("fb68"),Object(h["a"])(Le,Ae,je,!1,null,null,null)),Ge=qe.exports;b()(qe,{VBtn:D["a"],VCard:I["a"],VCardActions:w["a"],VCardTitle:w["c"],VDialog:R["a"],VSpacer:O["a"]});var Ue=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-dialog",{attrs:{persistent:"",width:"800"},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[a("v-btn",e._g({staticClass:"text-none",attrs:{small:"",dark:"",disabled:e.disabled}},i),[e._v("\n        "+e._s(e.displayValue)+"\n      ")])]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[a("v-card-title",{staticClass:"headline"},[e._v("Rename Policy")]),a("v-text-field",{model:{value:e.policyName,callback:function(t){e.policyName=t},expression:"policyName"}}),a("v-card-actions",[a("v-spacer"),a("v-btn",{on:{click:function(t){e.dialog=!1}}},[e._v("Cancel")]),a("v-btn",{attrs:{disabled:e.renameDisabled},on:{click:e.renameTablePolicyDefinition}},[e._v("Rename")]),a("v-spacer")],1)],1)],1)],1)},Be=[],Me={name:"TablePolicyRenameDialog",props:{policyDefinition:{type:Object,required:!0},disabled:{type:Boolean,default:!1}},mounted(){},data(){return{dialog:!1,policyName:""}},computed:{displayValue(){return"Rename"},allPolicyDefinitions(){return this.$store.state.policies.filter(e=>!e.customIdentifier)},renameDisabled(){return!1}},watch:{},methods:{renameTablePolicyDefinition(){this.dialog=!1,this.$store.commit("renameTablePolicy",{policyDefinitionId:this.policyDefinition.id,name:this.policyName})}},mounted(){this.policyName=this.policyDefinition.name}},ze=Me,He=(a("c5a9"),Object(h["a"])(ze,Ue,Be,!1,null,null,null)),Qe=He.exports;b()(He,{VBtn:D["a"],VCard:I["a"],VCardActions:w["a"],VCardTitle:w["c"],VDialog:R["a"],VSpacer:O["a"],VTextField:V["a"]});var We=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-textarea",{attrs:{value:e.tablePolicyEval,"auto-grow":"","hide-details":"","background-color":"black",disabled:""}}),a("v-data-table",{attrs:{headers:e.headers,items:e.tablePolicyEvaluationItems,"hide-default-footer":"","item-key":"id"},scopedSlots:e._u([{key:"items",fn:function(t){return[a("tr",[a("td",[e._v("\n          "+e._s(t.item.roleName)+"\n        ")]),a("td",[e._v("\n          "+e._s(t.item.action)+"\n        ")]),a("td",[e._v("\n          "+e._s(t.item.status)+"\n        ")])])]}}])})],1)},Ke=[],Je=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div")},Xe=[];const Ye="ALLOWED",Ze="DENIED",et="IMPLIED";var tt={name:"TablePolicyEvaluatorCalculator",props:{policyDefinition:{type:Object,required:!0},table:{type:Object,required:!0}},mounted(){},data(){return{}},computed:{grantStatusColors(){return{expected:"green",missing:"yellow",unexpected:"red",extra:"blue"}},tablePolicyEvaluation(){const e=this.$store.state.ignoredRoles.map(e=>e.roleName),t=Object.keys(this.policyDefinition.roleGrants).reduce((t,a)=>Object.keys(this.policyDefinition.roleGrants[a]).filter(t=>-1===e.indexOf(t)).reduce((e,t)=>{const i=this.policyDefinition.roleGrants[a][t],n=this.table.roleTableGrants.find(e=>e.grantee===a&&e.privilegeType===t.toUpperCase());switch(i){case Ye:return n?{...e,expected:[...e.expected,{...n,statusColor:this.grantStatusColors.expected}]}:{...e,missing:[...e.missing,{roleName:a,expectedRoleAction:i,action:t,statusColor:this.grantStatusColors.missing}]};case Ze:return n?{...e,unexpected:[...e.unexpected,{...n,statusColor:this.grantStatusColors.unexpected}]}:e;case et:return n?{...e,extra:[...e.extra,{...n,statusColor:this.grantStatusColors.extra}]}:e}},t),{expected:[],missing:[],extra:[],unexpected:[]});return t}},watch:{},methods:{}},at=tt,it=(a("9498"),Object(h["a"])(at,Je,Xe,!1,null,null,null)),nt=it.exports,lt={name:"TablePolicyEvaluatorDetail",mixins:[nt],props:{},mounted(){},data(){return{headers:[{text:"roleName",sortable:!1},{text:"action",sortable:!1},{text:"status",sortable:!1}]}},computed:{tablePolicyEval(){return JSON.stringify(this.tablePolicyEvaluation,0,2)},tablePolicyEvaluationItems(){return Object.keys(this.tablePolicyEvaluation).reduce((e,t)=>[...e,...this.tablePolicyEvaluation[t].map(e=>({...e,id:`${e.roleName}-${e.action}`,status:t}))],[])}}},ot=lt,st=(a("7b59"),a("a844")),rt=Object(h["a"])(ot,We,Ke,!1,null,null,null),ct=rt.exports;b()(rt,{VContainer:L["a"],VDataTable:y["a"],VTextarea:st["a"]});var dt={name:"PolicyDefinition",components:{PolicyRlsQualifierGrid:Ee,PolicyRealization:Pe["a"],TablePolicyCustomizeDialog:De["a"],TablePolicyMakeGlobalDialog:$e,TablePolicyDeleteDialog:Ge,TablePolicyEvaluatorDetail:ct,TablePolicyDefinitionGrants:ae,TablePolicyRenameDialog:Qe},props:{policyId:{type:Number,required:!0},table:{type:Object,required:!1}},data(){return{enableRls:!0,policyStructure:[],calculatedPolicy:"NOT CALCULATED",toggleCompleted:!1,activeTab:null}},mounted(){this.enableRls=this.policyDefinition.enableRls},watch:{policyDefinition(){this.enableRls=this.policyDefinition.enableRls},enableRls(){this.$store.commit("savePolicy",{policy:{...this.policyDefinition,enableRls:this.enableRls}}),this.enableRls||1!==this.activeTab||(this.activeTab=0)}},methods:{customize(){this.table.name}},computed:{showDeleteButton(){this.policyDefinition.id===this.$store.state.defaultPolicy.id||(this.policyDefinition.id,this.$store.state.defaultPolicyPermissive.id)},showMakeGlobalButton(){return void 0!==this.policyDefinition.customIdentifier&&null!==this.policyDefinition.customIdentifier},showCustomizeButton(){return!!this.table&&!this.policyDefinition.customIdentifier},disabled(){const e=this.policyDefinition.id===this.$store.state.defaultPolicy.id||this.policyDefinition.id===this.$store.state.defaultPolicyPermissive.id,t=null!==this.table&&void 0!==this.table,a=!!this.policyDefinition.customIdentifier;return!!e||!!t&&!a},policyDefinition(){this.$store.state.policies;const e=this.$store.state.policies.find(e=>e.id===this.policyId);return e},title(){return"Policy Name: "+this.policyDefinition.name}}},ut=dt,mt=a("71d9"),pt=Object(h["a"])(ut,i,n,!1,null,null,null);t["a"]=pt.exports;b()(pt,{VCard:I["a"],VContainer:L["a"],VSpacer:O["a"],VSwitch:B["a"],VTab:Y["a"],VTabItem:Z["a"],VTabs:ee["a"],VToolbar:mt["a"]})},"89d6":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[e.showToolbar?a("v-toolbar",[a("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[a("v-btn",e._g({directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:e.scriptText,expression:"scriptText",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:e.onCopy,expression:"onCopy",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:e.onError,expression:"onError",arg:"error"}]},i),[a("v-icon",[e._v("file_copy")]),e._v("Copy\n      ")],1)]}}],null,!1,1252371525)},[a("span",[e._v("Copy")])]),a("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[a("v-btn",e._g({attrs:{disabled:!e.canExecute},on:{click:e.executeSql}},i),[a("v-icon",[e._v("arrow_forward")]),e._v("Execute")],1)]}}],null,!1,1383927633)},[a("span",[e._v("Execute")])]),a("v-spacer"),a("v-container",{attrs:{fluid:""}},[a("v-row",[a("v-spacer"),a("v-spacer"),e.showReadability?a("v-layout",[a("label",{staticClass:"v-label theme--dark",attrs:{"mt-2":""}},[e._v("terse ")]),a("v-switch",{attrs:{"true-value":"verbose","false-value":"terse",label:"verbose"},model:{value:e.readability,callback:function(t){e.readability=t},expression:"readability"}})],1):e._e(),e.showDeclarationVisibility?a("v-layout",[a("label",{staticClass:"v-label theme--dark",attrs:{"mt-2":""}},[e._v("show declaration: ")]),a("v-switch",{attrs:{"true-value":"hide","false-value":"show",label:"hide"},model:{value:e.declarationVisibility,callback:function(t){e.declarationVisibility=t},expression:"declarationVisibility"}})],1):e._e()],1)],1)],1):e._e(),a("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("v-tab",{key:"the-script",attrs:{ripple:""}},[e._v("\n      Script\n    ")]),a("v-tab-item",{key:"the-script"},[a("v-textarea",{attrs:{disabled:!e.canEdit,value:e.formatScript(e.scriptText),"auto-grow":"",spellcheck:"false","background-color":"black"}})],1),e.results?a("v-tab",{key:"exec-result",attrs:{ripple:""}},[e._v("\n      Execute Result\n    ")]):e._e(),e.results?a("v-tab-item",{key:"exec-result"},[a("v-textarea",{attrs:{disabled:!e.canEdit,value:e.results,"auto-grow":"",spellcheck:"false","background-color":"black"}})],1):e._e()],1)],1)},n=[],l=a("3c04"),o=a.n(l),s={name:"ScriptViewer",components:{},props:{scriptText:{type:String,required:!1},showReadability:{type:Boolean,default:!0},showDeclarationVisibility:{type:Boolean,default:!1},showToolbar:{type:Boolean,default:!0},skipFormat:{type:Boolean,default:!1},canEdit:{type:Boolean,default:!1},canExecute:{type:Boolean,default:!1}},computed:{},watch:{readability(){this.$emit("readability-changed",this.readability)},declarationVisibility(){this.$emit("declaration-visibility-changed",this.declarationVisibility)}},methods:{formatScript(e){return this.skipFormat?e:(e||"").toLowerCase().split(" exists").join(" exists\n  ").split(" on").join("\non").split(" using").join("\nusing").split(" (").join(" (\n  ").split(",").join("\n  ,").split(");").join("\n);")},handleCopyStatus(e){alert(e)},onCopy(){alert("Copied!")},onError(e){alert("Failed to copy script to clipboard"),console.error(e)},executeSql(){this.$apollo.mutate({mutation:o.a,variables:{sql:this.scriptText}}).then(e=>{console.log("result",e),this.activeTab=1,this.results=JSON.stringify(e.data.ExecSql.result,null,2)}).catch(e=>{this.activeTab=1,this.results=e.toString()})}},data:()=>({activeTab:0,allPolicies:[],results:null,schemaPolicy:"NOT CALCULATED",defaultRlsPolicies:"NOT CALCULATED",defaultNoRlsPolicies:"NOT CALCULATED",selectedTabName:"",readability:"terse",declarationVisibility:"show"})},r=s,c=a("2877"),d=a("6544"),u=a.n(d),m=a("8336"),p=a("a523"),h=a("132d"),f=a("a722"),b=a("0fd9"),v=a("2fa4"),y=a("b73d"),g=a("71a3"),k=a("c671"),x=a("fe57"),N=a("a844"),C=a("71d9"),T=a("3a2f"),S=Object(c["a"])(r,i,n,!1,null,null,null);t["a"]=S.exports;u()(S,{VBtn:m["a"],VContainer:p["a"],VIcon:h["a"],VLayout:f["a"],VRow:b["a"],VSpacer:v["a"],VSwitch:y["a"],VTab:g["a"],VTabItem:k["a"],VTabs:x["a"],VTextarea:N["a"],VToolbar:C["a"],VTooltip:T["a"]})},"8c37":function(e,t,a){"use strict";var i=a("6d7d"),n=a.n(i);n.a},"8e2c":function(e,t,a){},"93e4":function(e,t,a){},9498:function(e,t,a){"use strict";var i=a("93e4"),n=a.n(i);n.a},"96b5":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("script-viewer",{attrs:{scriptText:e.computedPolicy,skipFormat:"",canExecute:""},on:{"readability-changed":e.policyReadabilityChanged}})],1)},n=[],l=a("89d6"),o=a("4eb5"),s=a.n(o),r=a("c92d"),c={name:"TablePolicyRealization",mixins:[s.a],components:{ScriptViewer:l["a"]},props:{policyDefinition:{type:Object,required:!0},table:{type:Object,required:!1},enableRls:{type:Boolean,required:!1}},data(){return{policyStructure:[],policyReadability:"terse",computedPolicy:"N/A"}},mounted(){this.doComputePolicy()},watch:{policyReadability(){this.doComputePolicy()},enableRls(){this.doComputePolicy()},policyDefinition(){this.doComputePolicy()}},methods:{policyReadabilityChanged(e){this.policyReadability=e},refresh(){this.doComputePolicy()},expand(){this.computedPolicy=this.computedPolicy+" "},doComputePolicy(){let e=null;this.table&&(e={schemaName:this.table.tableSchema,tableName:this.table.tableName}),this.computedPolicy=Object(r["a"])(this.policyDefinition,this.policyReadability,e,this.table)},onCopy:function(e){alert("Copied!")},onError:function(e){alert("Failed to copy texts")},executeSql(){alert("not implemented:  server config value will expose graphile extension to execute generated script")}},computed:{}},d=c,u=a("2877"),m=a("6544"),p=a.n(m),h=a("a523"),f=Object(u["a"])(d,i,n,!1,null,null,null);t["a"]=f.exports;p()(f,{VContainer:h["a"]})},9969:function(e,t,a){"use strict";var i=a("d367"),n=a.n(i);n.a},a789:function(e,t,a){"use strict";var i=a("059b"),n=a.n(i);n.a},ab3b:function(e,t){var a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"SearchFunctions"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"searchTerm"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"searchFunctions"},arguments:[{kind:"Argument",name:{kind:"Name",value:"searchTerm"},value:{kind:"Variable",name:{kind:"Name",value:"searchTerm"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"functionName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"functionSchema"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"resultDataType"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"argumentDataTypes"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"definition"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:201}};a.loc.source={body:"mutation SearchFunctions(\n  $searchTerm: String!\n){\n  searchFunctions(searchTerm: $searchTerm) {\n    id\n    functionName\n    functionSchema\n    resultDataType\n    argumentDataTypes\n    definition\n  }\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};function i(e,t){if("FragmentSpread"===e.kind)t.add(e.name.value);else if("VariableDefinition"===e.kind){var a=e.type;"NamedType"===a.kind&&t.add(a.name.value)}e.selectionSet&&e.selectionSet.selections.forEach((function(e){i(e,t)})),e.variableDefinitions&&e.variableDefinitions.forEach((function(e){i(e,t)})),e.definitions&&e.definitions.forEach((function(e){i(e,t)}))}var n={};function l(e,t){for(var a=0;a<e.definitions.length;a++){var i=e.definitions[a];if(i.name&&i.name.value==t)return i}}function o(e,t){var a={kind:e.kind,definitions:[l(e,t)]};e.hasOwnProperty("loc")&&(a.loc=e.loc);var i=n[t]||new Set,o=new Set,s=new Set;i.forEach((function(e){s.add(e)}));while(s.size>0){var r=s;s=new Set,r.forEach((function(e){if(!o.has(e)){o.add(e);var t=n[e]||new Set;t.forEach((function(e){s.add(e)}))}}))}return o.forEach((function(t){var i=l(e,t);i&&a.definitions.push(i)})),a}(function(){a.definitions.forEach((function(e){if(e.name){var t=new Set;i(e,t),n[e.name.value]=t}}))})(),e.exports=a,e.exports["SearchFunctions"]=o(a,"SearchFunctions")},ac54:function(e,t,a){},b194:function(e,t,a){},b1df:function(e,t,a){},b5bc:function(e,t,a){},bd5a:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-dialog",{attrs:{persistent:"",width:"800"},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[a("v-btn",e._g({staticClass:"text-none",attrs:{small:"",dark:"",disabled:e.disabled}},i),[e._v("\n        "+e._s(e.displayValue)+"\n      ")])]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[a("v-card-title",{staticClass:"headline"},[e._v("Custom Policy")]),a("v-text-field",{model:{value:e.customName,callback:function(t){e.customName=t},expression:"customName"}}),a("v-card-actions",[a("v-spacer"),a("v-btn",{on:{click:function(t){e.dialog=!1}}},[e._v("Cancel")]),a("v-btn",{on:{click:e.customizeTablePolicyDefinition}},[e._v("Customize")]),a("v-spacer")],1)],1)],1)],1)},n=[],l={name:"PolicyCustomizeDialog",props:{currentPolicyDefinition:{type:Object,required:!0},tables:{type:Array,required:!0},bulkCustomize:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},mounted(){this.customName=this.defaultCustomName},data(){return{dialog:!1,customName:"n/a"}},computed:{displayValue(){return this.bulkCustomize?"Bulk Customize":"Customize"},defaultCustomName(){return 1===this.tables.length?`Custom Policy: ${this.tables[0].tableSchema}.${this.tables[0].tableName}`:this.tables.length>1?"New Bulk Policy":"n/a"}},watch:{},methods:{customizeTablePolicyDefinition(){this.dialog=!1;const e=this.tables.reduce((e,t)=>e.concat([t.id]),[]);this.$store.commit("customizeTablePolicy",{sourcePolicyDefinitionId:this.currentPolicyDefinition.id,tableIds:e,newFields:{name:this.customName}}),this.$emit("policyAssigned",this.tables)}}},o=l,s=(a("0134"),a("2877")),r=a("6544"),c=a.n(r),d=a("8336"),u=a("b0af"),m=a("99d9"),p=a("169a"),h=a("2fa4"),f=a("8654"),b=Object(s["a"])(o,i,n,!1,null,null,null);t["a"]=b.exports;c()(b,{VBtn:d["a"],VCard:u["a"],VCardActions:m["a"],VCardTitle:m["c"],VDialog:p["a"],VSpacer:h["a"],VTextField:f["a"]})},bfc4:function(e,t){var a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"Project"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"project"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"project"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:45}};a.loc.source={body:"query Project {\n  project {\n    project\n  }\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};function i(e,t){if("FragmentSpread"===e.kind)t.add(e.name.value);else if("VariableDefinition"===e.kind){var a=e.type;"NamedType"===a.kind&&t.add(a.name.value)}e.selectionSet&&e.selectionSet.selections.forEach((function(e){i(e,t)})),e.variableDefinitions&&e.variableDefinitions.forEach((function(e){i(e,t)})),e.definitions&&e.definitions.forEach((function(e){i(e,t)}))}var n={};function l(e,t){for(var a=0;a<e.definitions.length;a++){var i=e.definitions[a];if(i.name&&i.name.value==t)return i}}function o(e,t){var a={kind:e.kind,definitions:[l(e,t)]};e.hasOwnProperty("loc")&&(a.loc=e.loc);var i=n[t]||new Set,o=new Set,s=new Set;i.forEach((function(e){s.add(e)}));while(s.size>0){var r=s;s=new Set,r.forEach((function(e){if(!o.has(e)){o.add(e);var t=n[e]||new Set;t.forEach((function(e){s.add(e)}))}}))}return o.forEach((function(t){var i=l(e,t);i&&a.definitions.push(i)})),a}(function(){a.definitions.forEach((function(e){if(e.name){var t=new Set;i(e,t),n[e.name.value]=t}}))})(),e.exports=a,e.exports["Project"]=o(a,"Project")},c271:function(e,t,a){},c2d7:function(e,t,a){"use strict";var i=a("0646"),n=a.n(i);n.a},c496:function(e,t,a){"use strict";var i=a("0cf9"),n=a.n(i);n.a},c5a9:function(e,t,a){"use strict";var i=a("c63d"),n=a.n(i);n.a},c63d:function(e,t,a){},c92d:function(e,t,a){"use strict";var i=a("9dbb"),n=a.n(i);const l="ALLOWED",o="DENIED",s="IMPLIED",r="terse";function c(e,t,a,i){const c=Object.keys(e.roleGrants).map(e=>({roleName:e})),u=""+c.map(e=>e.roleName).join(", "),m=Object.keys(e.roleGrants).reduce((t,a)=>{const n=Object.keys(e.roleGrants[a]).reduce((t,i)=>e.roleGrants[a][i]===l?t+1:t,0),o=Object.keys(e.roleGrants[a]).map((t,o,s)=>{switch(t){case"insert":case"update":let s=e.columnExclusions[t][a]||[],r=s.length>0?"\n        -- excluded columns: "+s.join(", "):"\n        -- no excluded columns",c=i?`( ${i.tableColumns.map(e=>e.columnName).filter(e=>-1===s.indexOf(e)).join(", ")} )`:"{{grantColumns}}";const d=e.columnExclusionOverrides[t].indexOf(a)>-1,u=s.length>0||d?l:e.roleGrants[a][t];return{action:t,value:u,grantColumns:c,columnExclusionsText:r,comma:o<n-1?",":""};default:return{action:t,value:e.roleGrants[a][t],grantColumns:"",comma:o<n-1?",":""}}});return[...t,{roleName:a,grants:o}]},[]),p=m.map((e,t,a)=>({...e,grants:e.grants.filter(e=>e.value===l)})).filter(e=>e.grants.length>0),h=m.map(e=>({...e,grants:e.grants.filter(e=>e.value===o)})).filter(e=>e.grants.length>0),f=m.map(e=>({...e,grants:e.grants.filter(e=>e.value===s)})).filter(e=>e.grants.length>0),b=Object.keys(e.rlsQualifiers).reduce((t,a)=>t.concat(Object.keys(e.rlsQualifiers[a]).reduce((t,i)=>[...t,...e.rlsQualifiers[a][i].policies.map(e=>({...e,action:i,roleName:a}))],[])),[]),v={verbose:!0,deniedRoleGrants:h,impliedRoleGrants:f},y={...a,policyName:e.name,enableRls:e.enableRls,allowedRoleGrants:p,rlsPolicies:b,revokeRolesList:u,tableName:(i||{}).tableName},g=t===r?y:{...v,...y};return n.a.render(d,g)}t["a"]=c;const d="\n----------\n----------  BEGIN TABLE POLICY: {{schemaName}}{{^schemaName}}{{=<% %>=}}{{schemaName}}<%={{ }}=%>{{/schemaName}}.{{tableName}}{{^tableName}}{{=<% %>=}}{{tableName}}<%={{ }}=%>{{/tableName}}\n----------  POLICY NAME:  {{policyName}}\n----------\n\n----------  REMOVE EXISTING TABLE GRANTS\n\n  revoke all privileges \n  on table {{schemaName}}{{^schemaName}}{{=<% %>=}}{{schemaName}}<%={{ }}=%>{{/schemaName}}.{{tableName}}{{^tableName}}{{=<% %>=}}{{tableName}}<%={{ }}=%>{{/tableName}} \n  from public;\n\n  revoke all privileges \n  on table {{schemaName}}{{^schemaName}}{{=<% %>=}}{{schemaName}}<%={{ }}=%>{{/schemaName}}.{{tableName}}{{^tableName}}{{=<% %>=}}{{tableName}}<%={{ }}=%>{{/tableName}} \n  from {{revokeRolesList}};\n\n{{#enableRls}}\n----------  ENABLE ROW LEVEL SECURITY\n\n  ----------\n  ----------  remove all rls policies for table\n  ----------\n  DO\n  $body$\n    DECLARE \n      _pol pg_policies;\n      _drop_sql text;\n    BEGIN\n\n      for _pol in\n        select \n          *\n        from pg_policies\n        where schemaname = '{{schemaName}}'\n        and tablename = '{{tableName}}'\n      loop\n        _drop_sql := 'drop policy if exists ' || quote_ident(_pol.policyname) || ' on ' || quote_ident(_pol.schemaname) || '.' || quote_ident(_pol.tablename) || ';';\n        execute _drop_sql;\n      end loop\n      ;\n    END\n  $body$;\n\n  alter table {{schemaName}}{{^schemaName}}{{=<% %>=}}{{schemaName}}<%={{ }}=%>{{/schemaName}}.{{tableName}}{{^tableName}}{{=<% %>=}}{{tableName}}<%={{ }}=%>{{/tableName}} enable row level security;\n\n{{#rlsPolicies}}\n  create policy {{name}}_{{schemaName}}{{^schemaName}}{{=<% %>=}}{{schemaName}}<%={{ }}=%>{{/schemaName}}_{{tableName}}{{^tableName}}{{=<% %>=}}{{tableName}}<%={{ }}=%>{{/tableName}} \n    on {{schemaName}}{{^schemaName}}{{=<% %>=}}{{schemaName}}<%={{ }}=%>{{/schemaName}}.{{tableName}}{{^tableName}}{{=<% %>=}}{{tableName}}<%={{ }}=%>{{/tableName}}\n    as {{passStrategy}}\n    for {{action}}\n    to {{roleName}}\n    using {{{using}}}\n    {{#withCheck}}\n    with check {{withCheck}}\n    {{/withCheck}}\n    ;\n{{/rlsPolicies}}\n\n{{/enableRls}}\n{{^enableRls}}\n----------  DISABLE ROW LEVEL SECURITY\n\n  alter table {{schemaName}}{{^schemaName}}{{=<% %>=}}{{schemaName}}<%={{ }}=%>{{/schemaName}}.{{tableName}}{{^tableName}}{{=<% %>=}}{{tableName}}<%={{ }}=%>{{/tableName}} disable row level security;\n{{/enableRls}}\n\n----------  CREATE NEW TABLE GRANTS\n{{#allowedRoleGrants}}\n\n----------  {{roleName}}\n  grant \n  {{#grants}}\n    {{action}} {{grantColumns}}{{comma}} {{columnExclusionsText}}\n  {{/grants}}\n  on table {{schemaName}}{{^schemaName}}{{=<% %>=}}{{schemaName}}<%={{ }}=%>{{/schemaName}}.{{tableName}}{{^tableName}}{{=<% %>=}}{{tableName}}<%={{ }}=%>{{/tableName}} \n  to {{roleName}};\n\n{{/allowedRoleGrants}}\n\n{{#verbose}}\n----------  IMPLIED TABLE GRANTS\n  {{#impliedRoleGrants}}\n\n  ----------  {{roleName}}\n  {{#grants}}\n  --IMPLIED:   grant {{action}} on table {{schemaName}}{{^schemaName}}{{=<% %>=}}{{schemaName}}<%={{ }}=%>{{/schemaName}}.{{tableName}}{{^tableName}}{{=<% %>=}}{{tableName}}<%={{ }}=%>{{/tableName}} to {{roleName}};\n  {{/grants}}\n  {{/impliedRoleGrants}}\n\n  ----------  DENIED TABLE GRANTS\n  {{#deniedRoleGrants}}\n\n  ----------  {{roleName}}\n  {{#grants}}\n  --DENIED:   grant {{action}} on table {{schemaName}}{{^schemaName}}{{=<% %>=}}{{schemaName}}<%={{ }}=%>{{/schemaName}}.{{tableName}}{{^tableName}}{{=<% %>=}}{{tableName}}<%={{ }}=%>{{/tableName}} to {{roleName}};\n  {{/grants}}\n  {{/deniedRoleGrants}}\n{{/verbose}}\n\n----------  END TABLE POLICY: {{schemaName}}{{^schemaName}}{{=<% %>=}}{{schemaName}}<%={{ }}=%>{{/schemaName}}.{{tableName}}{{^tableName}}{{=<% %>=}}{{tableName}}<%={{ }}=%>{{/tableName}}\n--=="},cb8a:function(e,t,a){"use strict";var i=a("c271"),n=a.n(i);n.a},cfbf:function(e,t,a){"use strict";var i=a("ac54"),n=a.n(i);n.a},d367:function(e,t,a){},dbdb:function(e,t,a){"use strict";var i=a("b1df"),n=a.n(i);n.a},fb68:function(e,t,a){"use strict";var i=a("0a03"),n=a.n(i);n.a}});
//# sourceMappingURL=app.7f85aad3.js.map