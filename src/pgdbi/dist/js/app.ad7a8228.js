(function(e){function t(t){for(var n,r,o=t[0],s=t[1],c=t[2],u=0,m=[];u<o.length;u++)r=o[u],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&m.push(i[r][0]),i[r]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n]);d&&d(t);while(m.length)m.shift()();return l.push.apply(l,c||[]),a()}function a(){for(var e,t=0;t<l.length;t++){for(var a=l[t],n=!0,r=1;r<a.length;r++){var s=a[r];0!==i[s]&&(n=!1)}n&&(l.splice(t--,1),e=o(o.s=a[0]))}return e}var n={},i={app:0},l=[];function r(e){return o.p+"js/"+({about:"about",pdfjsWorker:"pdfjsWorker"}[e]||e)+"."+{about:"be7c4293",pdfjsWorker:"484168c6"}[e]+".js"}function o(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.e=function(e){var t=[],a=i[e];if(0!==a)if(a)t.push(a[2]);else{var n=new Promise((function(t,n){a=i[e]=[t,n]}));t.push(a[2]=n);var l,s=document.createElement("script");s.charset="utf-8",s.timeout=120,o.nc&&s.setAttribute("nonce",o.nc),s.src=r(e);var c=new Error;l=function(t){s.onerror=s.onload=null,clearTimeout(u);var a=i[e];if(0!==a){if(a){var n=t&&("load"===t.type?"missing":t.type),l=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+n+": "+l+")",c.name="ChunkLoadError",c.type=n,c.request=l,a[1](c)}i[e]=void 0}};var u=setTimeout((function(){l({type:"timeout",target:s})}),12e4);s.onerror=s.onload=l,document.head.appendChild(s)}return Promise.all(t)},o.m=e,o.c=n,o.d=function(e,t,a){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(a,n,function(t){return e[t]}.bind(null,n));return a},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/pgdbi/",o.oe=function(e){throw console.error(e),e};var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var d=c;l.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"0134":function(e,t,a){"use strict";var n=a("da37"),i=a.n(n);i.a},"015f":function(e,t,a){},"03f5":function(e,t,a){"use strict";(function(e){var n=a("82cd");t["a"]={name:"FunctionPolicyManager",components:{PolicyDefinition:n["a"]},methods:{saveNewPolicy(){try{this.$store.commit("newFunctionPolicy",{name:this.newPolicyName})}catch(e){alert(e.toString()),console.error(e)}this.dialog=!1}},computed:{policies(){return this.$store.state.functionPolicies.sort((function(e,t){return e.id<t.id?-1:1}))}},data(){return{dialog:!1,newPolicyName:"New Function Policy",headers:[{text:"",sortable:!1},{text:"ID",sortable:!1,value:"id"},{text:"Name",sortable:!1,value:"name"}]}},mounted(){e.client&&window&&(window.history.scrollRestoration="auto")}}}).call(this,a("f28c"))},"065f":function(e,t,a){"use strict";var n=a("9e46"),i=a.n(n);i.a},1:function(e,t){},"115f":function(e,t,a){"use strict";var n=a("d806"),i=a.n(n);i.a},2:function(e,t){},"243e":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("h1",[e._v(e._s(e.id))]),a("hr"),a("script-viewer",{attrs:{scriptText:e.definition,showDeclarationVisibility:!1,showReadability:!1,skipFormat:""},on:{"declaration-visibility-changed":e.declarationVisibilityChanged}})],1)},i=[],l=a("89d6"),r={name:"Function",components:{ScriptViewer:l["a"]},props:{id:{type:String,required:!0},context:{type:String,default:"default"}},computed:{definition(){const e={default:this.rawFunction,trigger:this.triggerFunction};return e[this.context]},rawFunction(){return this.fn.definition},modifiedFunction(){const e=this.fn.definition.split("$function$")[0],t=this.fn.definition.split("$function$")[1],a=e.split("\n").map(e=>`-- ${e}`).join("\n");return`${a} $function$${t} -- $function$\n`},triggerFunction(){const e=this.fn.definition.split("$function$")[1];return e},functionName(){return this.fn.functionName},functionSchema(){return this.fn.functionSchema}},data:()=>({fn:{definition:""},declarationVisibility:"show"}),methods:{declarationVisibilityChanged(e){this.declarationVisibility=e},onCopy:function(e){alert("Copied!")},onError:function(e){alert("Failed to copy texts")},setFn(){const e=this.id.split(".")[0],t=(this.id.split(".")[1],this.$store.state.managedSchemata.find(t=>t.schemaName===e));this.fn=t.schemaFunctions.find(e=>e.id===this.id)}},mounted(){this.setFn()},beforeRouteUpdate(e,t,a){this.setFn(),a()}},o=r,s=a("2877"),c=a("6544"),u=a.n(c),d=a("a523"),m=Object(s["a"])(o,n,i,!1,null,null,null);t["a"]=m.exports;u()(m,{VContainer:d["a"]})},"2a83":function(e,t){var a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"allEnabledRoles"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"nodes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"roleName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"applicableRoles"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"grantee"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"roleName"},arguments:[],directives:[]}]}}]}}]}}]}}],loc:{start:0,end:131}};a.loc.source={body:"query {\n  allEnabledRoles {\n    nodes {\n      roleName\n      applicableRoles {\n        grantee\n        roleName\n      }\n    }\n  }\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};function n(e,t){if("FragmentSpread"===e.kind)t.add(e.name.value);else if("VariableDefinition"===e.kind){var a=e.type;"NamedType"===a.kind&&t.add(a.name.value)}e.selectionSet&&e.selectionSet.selections.forEach((function(e){n(e,t)})),e.variableDefinitions&&e.variableDefinitions.forEach((function(e){n(e,t)})),e.definitions&&e.definitions.forEach((function(e){n(e,t)}))}var i={};(function(){a.definitions.forEach((function(e){if(e.name){var t=new Set;n(e,t),i[e.name.value]=t}}))})(),e.exports=a},3:function(e,t){},"35d9":function(e,t,a){"use strict";var n=a("b450"),i=a.n(n);i.a},3754:function(e,t,a){},"3b45":function(e,t,a){},4:function(e,t){},5:function(e,t){},"56d7":function(e,t,a){"use strict";a.r(t);var n=a("2b0e"),i=a("f309");n["a"].use(i["a"]);var l=new i["a"]({icons:{iconfont:"md"}}),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-app",{attrs:{id:"inspire"}},[a("v-hover",{scopedSlots:e._u([{key:"default",fn:function(t){var n=t.hover;return[a("v-navigation-drawer",{attrs:{clipped:!0,app:"",width:n?500:200,"disable-route-watcher":""},model:{value:e.drawer,callback:function(t){e.drawer=t},expression:"drawer"}},[a("project-navigator")],1)]}}])}),a("v-app-bar",{attrs:{app:"","clipped-left":""}},[a("v-app-bar-nav-icon",{on:{click:function(t){t.stopPropagation(),e.drawer=!e.drawer}}}),a("v-btn",{class:e.refreshBtnClass,attrs:{color:e.refreshBtnColor},on:{click:e.refreshSchemata}},[e._v("Refresh Schemata")]),a("v-spacer"),a("v-toolbar-title",{attrs:{selectable:""},domProps:{textContent:e._s(e.title)},on:{click:e.home}}),a("v-spacer"),a("v-btn",{attrs:{color:e.btnColor("home")},on:{click:function(t){return e.navigate("home")}}},[e._v("Home")]),a("v-btn",{attrs:{color:e.btnColor("security-manager"),disabled:e.initializing},on:{click:function(t){return e.navigate("security-manager")}}},[e._v("Security Scripts")]),a("v-btn",{attrs:{color:e.btnColor("fk-index-manager"),disabled:e.initializing},on:{click:function(t){return e.navigate("fk-index-manager")}}},[e._v("Constraints And Indices")]),a("v-btn",{attrs:{color:e.btnColor("search-view"),disabled:e.initializing},on:{click:function(t){return e.navigate("search-view")}}},[e._v("Function Search")]),a("v-btn",{attrs:{color:e.btnColor("worker"),hidden:e.disableGraphileWorker},on:{click:function(t){return e.navigate("worker")}}},[e._v("Worker")]),a("v-btn",{attrs:{color:e.btnColor("sqitch"),hidden:e.disableSqitch},on:{click:function(t){return e.navigate("sqitch")}}},[e._v("Sqitch")]),a("v-spacer"),a("v-spacer"),a("v-spacer"),a("v-spacer"),a("v-spacer"),a("v-spacer"),a("v-spacer"),a("v-spacer"),a("v-btn",{attrs:{icon:""},on:{click:function(t){return t.stopPropagation(),e.settings(t)}}},[a("v-icon",[e._v("settings")])],1)],1),a("v-content",[a("v-container",{attrs:{"justify-start":"","ma-0":"","pa-0":""}},[a("router-view")],1)],1),a("v-footer",{attrs:{app:""}},[a("span",[e._v("Â© 2019")])])],1)},o=[],s=a("58bb"),c=a.n(s),u=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("schema-navigator")],1)},d=[],m=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{"ma-0":"","pa-0":"",fluid:""}},[a("h2",{attrs:{"text-right":""}},[e._v("schemata")]),a("schema-tree")],1)},p=[],h=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{"ma-0":"","pa-0":"",dense:""}},[a("v-treeview",{directives:[{name:"scroll",rawName:"v-scroll"}],attrs:{items:e.items,activatable:"",transition:"",active:e.active,hoverable:"",dense:""},on:{"update:active":function(t){e.active=t}},model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}})],1)},b=[];new n["a"];var f={name:"SchemaTree",data:()=>({active:[],schemata:[],selected:[]}),computed:{items(){return this.$store.state.managedSchemata.map(e=>{return{id:`schema:${e.id}`,name:e.schemaName,children:this.filterMode?[]:[{id:`tables:${e.schemaName}`,name:"tables",children:e.schemaTables.sort((e,t)=>{return e.tableName<t.tableName?-1:1}).map(e=>{return{id:`table:${e.id}`,name:e.tableName}})},{id:`functions:${e.schemaName}`,name:"functions",children:(e.schemaFunctions||[]).sort((e,t)=>{return e.functionName<t.functionName?-1:1}).map(e=>{return{id:`function:${e.id}`,name:e.functionName}})},{id:`enums:${e.schemaName}`,name:"enums",children:(e.schemaEnums||[]).sort((e,t)=>{return e.enumName<t.enumName?-1:1}).map(e=>{return{id:`enum:${e.id}`,name:e.enumName}})},{id:`udts:${e.schemaName}`,name:"udts",children:(e.schemaUdts||[]).sort((e,t)=>{return e.udtName<t.udtName?-1:1}).map(e=>{return{id:`udt:${e.id}`,name:e.udtName}})}]}}).sort((e,t)=>{return e.name<t.name?-1:1})}},watch:{active(){const e=this.active[0]||"",t=e.split(":")[0],a=e.split(":")[1];switch(t){case"table":this.$router.push({name:"table",params:{id:a}});break;case"tables":break;case"function":this.$router.push({name:"function",params:{id:a}});break;case"enum":this.$router.push({name:"enum",params:{id:a}});break;case"udt":this.$router.push({name:"udt",params:{id:a}});break;default:break}}}},v=f,y=a("2877"),g=a("6544"),x=a.n(g),k=a("a523"),N=a("eb2a"),C=a("269a"),_=a.n(C),T=a("f977"),S=Object(y["a"])(v,h,b,!1,null,null,null),I=S.exports;x()(S,{VContainer:k["a"],VTreeview:N["a"]}),_()(S,{Scroll:T["b"]});var D={name:"SchemaNavigator",components:{SchemaTree:I},props:{},data:()=>({}),computed:{},watch:{},methods:{}},E=D,P=(a("115f"),Object(y["a"])(E,m,p,!1,null,null,null)),w=P.exports;x()(P,{VContainer:k["a"]});var R={name:"ProjectNavigator",props:{},components:{SchemaNavigator:w}},O=R,$=Object(y["a"])(O,u,d,!1,null,null,null),V=$.exports;x()($,{VContainer:k["a"]});var j={name:"App",props:{source:String},components:{ProjectNavigator:V},computed:{initializing(){return this.$store.state.initializing},currentRoute(){return this.$router.currentRoute},disableGraphileWorker(){return!0!==(this.$store.state.pgdbiOptions||{enableGraphileWorker:!1}).enableGraphileWorker},disableSqitch(){return!0!==(this.$store.state.pgdbiOptions||{enableSqitch:!1}).enableSqitch}},watch:{initializing(){this.setRefreshBtnClass()}},methods:{setRefreshBtnClass(){this.refreshBtnClass=this.initializing?"refreshBtnInitializing":"refreshBtn",this.refreshBtnColor=this.initializing?"yellow darken-3":"blue-grey"},refreshSchemata(){this.$loading(!0),this.$apollo.query({query:c.a,fetchPolicy:"network-only"}).then(e=>{this.$store.commit("setManagedSchemata",e.data.dbIntrospection.schemaTree),this.$store.commit("setEnabledRoles",{enabledRoles:e.data.dbIntrospection.enabledRoles}),this.$store.commit("setPgdbiOptions",{pgdbiOptions:e.data.pgdbiOptions}),this.$loading(!1)}).catch(e=>{this.$loading(!1),console.error(e),alert(e.toString())})},btnColor(e){return this.$router.currentRoute.name===e?"blue":"blue-grey"},home(){this.$router.push({name:"home"})},settings(){this.$router.push({name:"settings"})},navigate(e){this.$router.push({name:e})}},data(){return{expandNav:!1,clipped:!0,drawer:!0,fixed:!1,items:[],miniVariant:!1,right:!0,rightDrawer:!1,title:"pg-db-inspector",refreshBtnClass:"refreshBtn",refreshBtnColor:"blue-grey"}},mounted(){this.setRefreshBtnClass()},created(){this.$vuetify.theme.dark=!0}},F=j,A=a("7496"),q=a("40dc"),G=a("5bc1"),U=a("8336"),L=a("a75b"),B=a("553a"),z=a("ce87"),M=a("132d"),Q=a("f774"),K=a("2fa4"),W=a("2a7f"),H=Object(y["a"])(F,r,o,!1,null,null,null),X=H.exports;x()(H,{VApp:A["a"],VAppBar:q["a"],VAppBarNavIcon:G["a"],VBtn:U["a"],VContainer:k["a"],VContent:L["a"],VFooter:B["a"],VHover:z["a"],VIcon:M["a"],VNavigationDrawer:Q["a"],VSpacer:K["a"],VToolbarTitle:W["a"]});var J=a("8c4f"),Y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("v-tab",{key:"home",attrs:{ripple:""}},[e._v("\n      Home\n    ")]),a("v-tab-item",{key:"home",attrs:{lazy:""}},[a("v-card",[a("new-home")],1)],1),a("v-tab",{key:"help",attrs:{ripple:""}},[e._v("\n      Help\n    ")]),a("v-tab-item",{key:"help",attrs:{lazy:""}},[a("v-card",[e._v("\n        TODO: Make help pages/videos\n      ")])],1)],1)],1)},Z=[],ee=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{"ma-0":"","pa-0":"",fluid:""}},[a("h1",[e._v("PGDBI")]),a("h2",[e._v("postgraphile-db-inspector")]),a("v-toolbar",[a("v-btn",{on:{click:e.resetStore}},[e._v("Reset PGDBI")]),a("v-btn",{on:{click:function(t){return e.$router.push("project-export")}}},[e._v("Export Project")]),a("v-btn",{on:{click:function(t){return e.$router.push("project-import")}}},[e._v("Import Project")])],1),a("hr"),a("p",[e._v("A collection of tools to ensure your postgres database is properly configured to support "),a("a",{attrs:{href:"https://www.graphile.org/postgraphile/",target:"_blank"}},[e._v("postgraphile")])]),a("hr"),a("h2",[e._v("use pgdbi to")]),a("ul",[a("li",[e._v("browse tables, functions, enums, udts and more in the schema tree")]),a("li",[e._v("manage table and function "),a("router-link",{attrs:{to:{name:"security-manager"}}},[e._v("security policies")])],1),a("li",[e._v("examine indices associated with "),a("router-link",{attrs:{to:{name:"fk-index-manager"}}},[e._v("foreign-keys and unique constraints")])],1),a("li",[a("router-link",{attrs:{to:{name:"search-view"}}},[e._v("text-search")]),e._v(" across all functions")],1),a("li",[e._v("...more to come")])]),a("hr"),a("h3",[e._v("links")]),a("ul",[a("li",[a("a",{attrs:{href:"https://www.graphile.org/postgraphile/"}},[e._v("postgraphile")])]),a("li",[a("a",{attrs:{href:"https://www.postgresql.org/docs/"}},[e._v("postgres")])]),a("li",[a("a",{attrs:{href:"https://graphql.org/"}},[e._v("graphql")])])])],1)},te=[],ae={name:"OldHome",components:{},props:{},computed:{},data:()=>({activeTab:null}),methods:{resetStore(){this.$store.commit("resetDefaultState"),this.$router.push("initialize")}}},ne=ae,ie=a("71d9"),le=Object(y["a"])(ne,ee,te,!1,null,null,null),re=le.exports;x()(le,{VBtn:U["a"],VContainer:k["a"],VToolbar:ie["a"]});var oe={name:"Home",components:{NewHome:re},props:{},computed:{},data:()=>({activeTab:null}),methods:{resetStore(){this.$store.commit("resetDefaultState"),this.$router.push("initialize")}}},se=oe,ce=a("b0af"),ue=a("71a3"),de=a("c671"),me=a("fe57"),pe=Object(y["a"])(se,Y,Z,!1,null,null,null),he=pe.exports;x()(pe,{VCard:ce["a"],VContainer:k["a"],VTab:ue["a"],VTabItem:de["a"],VTabs:me["a"]});var be=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{"ma-5":"","pa-5":""}},[a("v-btn",{class:e.refreshBtnClass,attrs:{color:e.refreshBtnColor},on:{click:e.refreshSchemata}},[e._v("Refresh Schemata")]),a("h2",[e._v("or...")]),a("project-import")],1)},fe=[],ve=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"container"},[a("div",{staticClass:"large-12 medium-12 small-12 cell"},[a("label",[e._v("File\n        "),a("input",{ref:"file",attrs:{type:"file",id:"file"},on:{change:function(t){return e.handleFileUpload()}}})])])]),a("h1",[e._v("Import Project: "+e._s(e.projectName))]),a("v-toolbar",[a("v-btn",{on:{click:e.importProject}},[e._v("Import")])],1),a("v-textarea",{attrs:{value:e.projectJson,"auto-grow":"",readonly:""}})],1)},ye=[],ge={name:"ImportProject",components:{},props:{},computed:{projectName(){return this.project?this.project.name:"N/A"},projectJson(){return this.project?JSON.stringify(this.project,null,2):"N/A"}},methods:{importProject:function(){this.$store.commit("importProject",{project:this.project})},useResults(e){this.project=JSON.parse(e.currentTarget.result)},handleFileUpload(){this.file=this.$refs.file.files[0];const e=new FileReader;e.onload=this.useResults,e.readAsText(this.file)},submitFile(){}},data(){return{file:"",project:{releases:{nodes:[]}}}}},xe=ge,ke=a("a844"),Ne=Object(y["a"])(xe,ve,ye,!1,null,null,null),Ce=Ne.exports;x()(Ne,{VBtn:U["a"],VTextarea:ke["a"],VToolbar:ie["a"]});var _e={name:"Initialize",components:{ProjectImport:Ce},props:{},computed:{initializing(){return this.$store.state.initializing}},data:()=>({activeTab:null,refreshBtnClass:"refreshBtnInitializing",refreshBtnColor:"yellow darken-3"}),methods:{refreshSchemata(){this.$loading(!0),this.$apollo.query({query:c.a,fetchPolicy:"network-only"}).then(e=>{this.$store.commit("setManagedSchemata",e.data.dbIntrospection.schemaTree),this.$store.commit("setEnabledRoles",{enabledRoles:e.data.dbIntrospection.enabledRoles}),this.$store.commit("setPgdbiOptions",{pgdbiOptions:e.data.pgdbiOptions}),this.$loading(!1)}).catch(e=>{this.$loading(!1),console.error(e),alert(e.toString())})}},watch:{initializing(){!0!==this.initializing&&this.$router.push({name:"security-manager"})}},beforeRouteLeave(e,t,a){this.initializing?a(!1):a()}},Te=_e,Se=Object(y["a"])(Te,be,fe,!1,null,null,null),Ie=Se.exports;x()(Se,{VBtn:U["a"],VContainer:k["a"]});var De=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("h1",[e._v(e._s(e.id))]),a("hr"),a("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("v-tab",{key:"cols",attrs:{ripple:""}},[e._v("\n      Columns\n    ")]),a("v-tab-item",{key:"cols"},[a("v-card",{attrs:{flat:""}},[a("table-columns",{attrs:{tableInfo:e.tableInfo}})],1)],1),a("v-tab",{key:"constraints-and-indices",attrs:{ripple:""}},[e._v("\n      Constraints and Indices\n    ")]),a("v-tab-item",{key:"constraints-and-indices"},[a("v-card",{attrs:{flat:""}},[a("constraints-and-indices",{attrs:{tableSchema:e.tableSchema,tableName:e.tableName}})],1)],1),a("v-tab",{key:"tabletriggers",attrs:{ripple:""}},[e._v("\n      Triggers\n    ")]),a("v-tab-item",{key:"tabletriggers"},[a("v-card",{attrs:{flat:""}},[a("table-triggers",{attrs:{triggers:e.tableTriggers}})],1)],1),a("v-tab",{key:"tablePolicy",attrs:{ripple:""}},[e._v("\n      Assigned Policy\n    ")]),a("v-tab-item",{key:"tablePolicy"},[a("v-card",{attrs:{flat:""}},[a("table-policy-definition",{attrs:{policyId:e.tableInfo.policyDefinitionId,table:e.tableInfo}})],1)],1),a("v-tab",{key:"tableScripts",attrs:{ripple:""}},[e._v("\n      Generated Scripts\n    ")]),a("v-tab-item",{key:"tableScripts"},[a("v-card",{attrs:{flat:""}},[a("table-scripts",{attrs:{tableInfo:e.tableInfo}})],1)],1)],1)],1)},Ee=[],Pe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.tableDetail,"hide-default-footer":"","show-expand":""},scopedSlots:e._u([{key:"item.fkInfo",fn:function(t){var a=t.item;return[e._v("\n    "+e._s(a.fkInfo)+"\n  ")]}},{key:"item.fkIndex",fn:function(t){var n=t.item;return[a("div",{class:e.fkIndexClass(n.fkIndex)},[n.fkIndexLinkId?a("router-link",{attrs:{to:{name:"table",params:{id:n.fkIndexLinkId}},target:"_blank"}},[e._v(e._s(n.fkIndex))]):e._e(),n.fkIndexLinkId?e._e():a("span",[e._v(e._s(n.fkIndex))])],1)]}},{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.headers.length+1}},[a("column-detail",{attrs:{columnInfo:t.item}})],1)]}}])})],1)},we=[],Re=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{fluid:""}},[a("v-row",[a("v-col",{attrs:{cols:"12"}},[a("v-row",{staticClass:"blue darken-4"},[a("v-col",{attrs:{cols:"4"}},[a("v-card",{staticClass:"ma-1 pa-1",attrs:{outlined:"",tile:""}},[a("h4",[e._v("Indices")]),a("hr"),e._l(e.columnInfo.columnIndices,(function(t){return a("v-card",{key:t.id,staticClass:"ma-1 pa-1 grey darken-4 text-no-wrap"},[e._v("\n              "+e._s(t.indexName)+"\n            ")])}))],2)],1),a("v-col",{attrs:{cols:"4"}},[a("v-card",{staticClass:"ma-1 pa-1",attrs:{dense:""}},[a("h4",[e._v("Foreign Keys")]),a("hr"),e._l(e.columnInfo.fkConstraintUsage,(function(t){return a("v-card",{key:t.id,staticClass:"ma-1 pa-1 grey darken-4 text-no-wrap"},[e._v("\n              "+e._s(t.constraintName)+"\n              "),a("hr"),e._v("\n              REF: "),t.fkTableLinkId?a("router-link",{attrs:{to:{name:"table",params:{id:t.fkTableLinkId}},target:"_blank"}},[e._v(e._s(t.fkPath))]):e._e(),a("hr"),e._v("\n              IDX: "),a("span",{class:e.fkIndexClass(t.fkIndexEvaluation)},[e._v(e._s(t.fkIndexEvaluation))])],1)}))],2)],1),a("v-col",{attrs:{cols:"4"}},[a("v-card",{staticClass:"ma-1 pa-1",attrs:{dense:""}},[a("h4",[e._v("Unique Constraints")]),a("hr"),e._l(e.columnInfo.uqConstraintUsage,(function(t){return a("v-card",{key:t.id,staticClass:"ma-1 pa-1 grey darken-4 text-no-wrap"},[e._v("\n              "+e._s(t.constraintName)+"\n              "),a("hr"),e._v("\n              IDX: "),a("span",{class:e.uqIndexClass(t.uqIndexEvaluation)},[e._v(e._s(t.uqIndexEvaluation))])])}))],2)],1)],1)],1)],1)],1)},Oe=[];const $e="NO INDEX",Ve="MULTIPLE_INDICES";var je={name:"ColumnDetail",props:{columnInfo:{type:Object,required:!0}},methods:{fkIndexClass(e){return e===$e?"red--text":e===Ve?"yellow--text":"green--text"},uqIndexClass(e){return e===$e?"red--text":e===Ve?"yellow--text":"green--text"}}},Fe=je,Ae=a("62ad"),qe=a("0fd9"),Ge=Object(y["a"])(Fe,Re,Oe,!1,null,null,null),Ue=Ge.exports;x()(Ge,{VCard:ce["a"],VCol:Ae["a"],VContainer:k["a"],VRow:qe["a"]});const Le="NO INDEX";var Be={name:"TableDetail",props:{tableInfo:{type:Object,required:!0}},components:{ColumnDetail:Ue},methods:{changeSort(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)},fkIndexClass(e){return e===Le?"red--text":""}},computed:{tableDetail(){console.log("table",this.tableInfo);const e=(this.tableInfo.tableColumns||[]).map(e=>{const t=((this.tableInfo.referentialConstraints||[]).find(t=>{return void 0!==t.referencingColumnUsage.find(t=>t.tableSchema===e.tableSchema&&t.tableName===e.tableName&&t.columnName===e.columnName)})||{referencedColumnUsage:[]}).referencedColumnUsage[0],a=t?`${t.tableSchema}.${t.tableName}.${t.columnName}`:"",n=this.tableInfo.indices.find(t=>t.tableSchema===e.tableSchema&&t.tableName===e.tableName&&t.columnName===e.columnName),i=t?n?`${n.indexName}`:Le:"",l=t&&i!==Le?`table:${t.tableSchema}.${t.tableName}`:"";return{...e,fkInfo:a,fkIndex:i,fkIndexLinkId:l}});return e}},data:()=>({headers:[{text:"Ordinal",sortable:!0,value:"ordinalPosition"},{text:"Column Name",sortable:!0,value:"columnName"},{text:"Data Type",sortable:!0,value:"dataType"},{text:"Identity",sortable:!0,value:"isIdentity"},{text:"Nullable",sortable:!0,value:"isNullable"},{text:"Default Value",sortable:!0,value:"columnDefault"},{text:"FK Reference",sortable:!0,value:"fkInfo"},{text:"FK Index",sortable:!0,value:"fkIndex"}],pagination:{sortBy:"ordinalPosition",rowsPerPage:-1}})},ze=Be,Me=a("8fea"),Qe=Object(y["a"])(ze,Pe,we,!1,null,null,null),Ke=Qe.exports;x()(Qe,{VContainer:k["a"],VDataTable:Me["a"]});var We=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{fluid:""}},[a("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{headers:e.headers,items:e.tableDetail,"hide-default-footer":"","calculate-widths":"",dense:"","items-per-page":100},scopedSlots:e._u([{key:"item.isPKColumn",fn:function(t){var n=t.item;return[n.isPKColumn?a("v-icon",[e._v("check")]):e._e()]}},{key:"item.isNullable",fn:function(t){var n=t.item;return["YES"===n.isNullable?a("v-icon",[e._v("check")]):e._e()]}}])})],1)},He=[];const Xe="NO INDEX",Je="MULTIPLE_INDICES";var Ye={name:"TableColumns",props:{tableInfo:{type:Object,required:!0}},components:{ColumnDetail:Ue},methods:{changeSort(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)},fkIndexClass(e){const t=e.fkConstraintUsage.filter(e=>e.fkIndexEvaluation===Xe).length,a=e.fkConstraintUsage.filter(e=>e.fkIndexEvaluation===Je).length;return t>0?"red":a>0?"yellow":"green"},uqIndexClass(e){const t=e.uqConstraintUsage.filter(e=>e.uqIndexEvaluation===Xe).length,a=e.uqConstraintUsage.filter(e=>e.uqIndexEvaluation===Je).length;return t>0?"red":a>0?"yellow":"green"}},computed:{tableDetail(){const e=(this.tableInfo.primaryKeyConstraints||[]).reduce((e,t)=>{const a=t.keyColumnUsage.reduce((e,t)=>{return[...e,t.columnName]},[]);return[...e,...a]},[]),t=(this.tableInfo.tableColumns||[]).map(t=>{const a=this.tableInfo.indices.filter(e=>e.tableSchema===t.tableSchema&&e.tableName===t.tableName&&e.columnName===t.columnName),n=e.indexOf(t.columnName)>-1,i=this.$store.state.fkIndexEvaluations.singleColumn[`${t.tableSchema}.${t.tableName}.${t.columnName}`],l=this.$store.state.uqIndexEvaluations[`${t.tableSchema}.${t.tableName}.${t.columnName}`];return{...t,fkConstraintUsage:i||[],uqConstraintUsage:l||[],isPKColumn:n,columnIndices:a}});return t}},data:()=>({headers:[{text:"Ordinal",sortable:!0,value:"ordinalPosition"},{text:"Column Name",sortable:!0,value:"columnName"},{text:"PK",sortable:!0,value:"isPKColumn"},{text:"Nullable",sortable:!0,value:"isNullable"},{text:"Data Type",sortable:!0,value:"dataType"},{text:"Default Value",sortable:!0,value:"columnDefault"}],pagination:{sortBy:"ordinalPosition",rowsPerPage:-1}})},Ze=Ye,et=Object(y["a"])(Ze,We,He,!1,null,null,null),tt=et.exports;x()(et,{VContainer:k["a"],VDataTable:Me["a"],VIcon:M["a"]});var at=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("v-tab",{key:"allIndices",attrs:{ripple:""}},[e._v("\n    All Indices\n  ")]),a("v-tab-item",{key:"allIndices"},[a("v-card",{attrs:{flat:""}},[a("table-generic-indices",{attrs:{tableInfo:e.tableInfo}})],1)],1),a("v-tab",{key:"fkIndices",attrs:{ripple:""}},[e._v("\n    Foreign Key Constraints\n  ")]),a("v-tab-item",{key:"fkIndices"},[a("v-card",{attrs:{flat:""}},[a("table-fk-indices",{attrs:{tableInfo:e.tableInfo}})],1)],1),a("v-tab",{key:"uqIndices",attrs:{ripple:""}},[e._v("\n    Unique Constraints\n  ")]),a("v-tab-item",{key:"uqIndices"},[a("v-card",{attrs:{flat:""}},[a("table-uq-indices",{attrs:{tableInfo:e.tableInfo}})],1)],1),a("v-tab",{key:"chk",attrs:{ripple:""}},[e._v("\n    Check Constraints\n  ")]),a("v-tab-item",{key:"chk"},[a("v-card",{attrs:{flat:""}},[a("table-check-constraints",{attrs:{checkConstraints:e.checkConstraints}})],1)],1)],1)},nt=[],it=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{fluid:""}},[a("v-card",{staticClass:"ma-3 pa-3 green darken-3",attrs:{dense:""}},[a("h2",[e._v("Indexed")]),a("hr"),a("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{items:e.goodIndices,headers:e.headers,"hide-default-footer":"","show-expand":"","calculate-widths":"",dense:""},scopedSlots:e._u([{key:"item.evaluation",fn:function(t){var n=t.item;return[a("span",{class:n.indexDisplayClass},[e._v(e._s(n.evaluation))])]}},{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.headers.length+1}},[a("table-generic-index-detail",{attrs:{evaluation:t.item}})],1)]}}])})],1),a("v-card",{staticClass:"ma-3 pa-3 red darken-3",attrs:{dense:""}},[a("h2",[e._v("Over-Indexed")]),a("hr"),a("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{items:e.badIndices,headers:e.headers,"hide-default-footer":"","show-expand":"","calculate-widths":"",dense:""},scopedSlots:e._u([{key:"item.columnDisplay",fn:function(t){var n=t.item;return e._l(n.columnDisplay,(function(t){return a("div",{key:t},[e._v(e._s(t))])}))}},{key:"item.evaluation",fn:function(t){var n=t.item;return[a("span",{class:n.indexDisplayClass},[e._v(e._s(n.evaluation))])]}},{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.headers.length+1}},[a("table-generic-index-detail",{attrs:{evaluation:t.item}})],1)]}}])})],1)],1)},lt=[],rt=a("89d6"),ot=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.evaluation.indices,"hide-default-footer":!0,"show-expand":""},scopedSlots:e._u([{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.headers.length+1}},[a("v-tabs",{attrs:{dark:"","slider-color":"yellow"}},[a("v-tab",{key:"create",attrs:{ripple:""}},[e._v("\n          Create\n          ")]),a("v-tab-item",{key:"create",attrs:{lazy:""}},[a("script-viewer",{attrs:{scriptText:t.item.indexDefinition,showReadability:!1}})],1),a("v-tab",{key:"drop",attrs:{ripple:""}},[e._v("\n          Drop\n          ")]),a("v-tab-item",{key:"drop",attrs:{lazy:""}},[a("script-viewer",{attrs:{scriptText:t.item.indexDrop,showReadability:!1}})],1)],1)],1)]}}])})],1)},st=[],ct={name:"TableGenericIndexDetail",props:{evaluation:{type:Object,required:!0}},components:{ScriptViewer:rt["a"]},methods:{},computed:{},data:()=>({headers:[{text:"Index Name",value:"indexName"}]})},ut=ct,dt=Object(y["a"])(ut,ot,st,!1,null,null,null),mt=dt.exports;x()(dt,{VContainer:k["a"],VDataTable:Me["a"],VTab:ue["a"],VTabItem:de["a"],VTabs:me["a"]});const pt="MULTIPLE_INDICES";var ht={name:"TableGenericIndices",props:{tableInfo:{type:Object,required:!0}},components:{TableGenericIndexDetail:mt},methods:{changeSort(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},computed:{items(){const e=this.$store.state.genericIndexEvaluations;return Object.keys(e).filter(t=>e[t].tableKey===`${this.tableInfo.tableSchema}.${this.tableInfo.tableName}`).map(t=>e[t])},goodIndices(){return this.items.filter(e=>e.evaluation!==pt)},badIndices(){return this.items.filter(e=>e.evaluation===pt).map(e=>{return{...e,columnDisplay:e.idxColumns}})},duplicateIndexSets(){return this.tableInfo.indices.reduce((e,t)=>{},[])}},data:()=>({selected:[],headers:[{text:"Index Columns",value:"columnDisplay"},{text:"Evaluation",value:"evaluation"}],pagination:{sortBy:"constraintName",rowsPerPage:-1}})},bt=ht,ft=Object(y["a"])(bt,it,lt,!1,null,null,null),vt=ft.exports;x()(ft,{VCard:ce["a"],VContainer:k["a"],VDataTable:Me["a"]});var yt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-card",{staticClass:"ma-3 pa-3 blue-grey",attrs:{dense:""}},[a("h2",[e._v("Single-Column Foreign Keys")]),a("hr"),a("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{headers:e.singleColumnHeaders,items:e.singleColumnItems,"hide-default-footer":"","show-expand":"","calculate-widths":"",dense:""},scopedSlots:e._u([{key:"item.fkIndexEvaluation",fn:function(t){var n=t.item;return[a("span",{class:n.indexDisplayClass},[e._v(e._s(n.fkIndexEvaluation))])]}},{key:"item.fkTable",fn:function(t){var n=t.item;return[n.fkTableLinkId?a("router-link",{attrs:{to:{name:"table",params:{id:n.fkTableLinkId}},target:"_blank"}},[e._v(e._s(n.fkTable))]):e._e()]}},{key:"item.fkSource",fn:function(t){var n=t.item;return e._l(n.fkSource,(function(t){return a("div",{key:t},[e._v(e._s(t))])}))}},{key:"item.fkTarget",fn:function(t){var n=t.item;return e._l(n.fkTarget,(function(t){return a("div",{key:t},[e._v(e._s(t))])}))}},{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.singleColumnHeaders.length+1}},[a("table-generic-index-detail",{attrs:{evaluation:t.item}})],1)]}}])})],1),a("v-card",{staticClass:"ma-3 pa-3 blue-grey darken-4",attrs:{dense:""}},[a("h2",[e._v("Multi-Column Foreign Keys")]),a("hr"),a("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{headers:e.multiColumnHeaders,items:e.multiColumnItems,"hide-default-footer":"","show-expand":"","calculate-widths":"",dense:""},scopedSlots:e._u([{key:"item.fkIndexEvaluation",fn:function(t){var n=t.item;return[a("span",{class:n.indexDisplayClass},[e._v(e._s(n.fkIndexEvaluation))])]}},{key:"item.fkTable",fn:function(t){var n=t.item;return[n.fkTableLinkId?a("router-link",{attrs:{to:{name:"table",params:{id:n.fkTableLinkId}},target:"_blank"}},[e._v(e._s(n.fkTable))]):e._e()]}},{key:"item.fkSource",fn:function(t){var n=t.item;return e._l(n.fkSource,(function(t){return a("div",{key:t},[e._v(e._s(t))])}))}},{key:"item.fkTarget",fn:function(t){var n=t.item;return e._l(n.fkTarget,(function(t){return a("div",{key:t},[e._v(e._s(t))])}))}},{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.multiColumnHeaders.length+1}},[a("table-generic-index-detail",{attrs:{evaluation:t.item}})],1)]}}])})],1)],1)},gt=[],xt={name:"TableFKIndices",components:{TableGenericIndexDetail:mt},props:{tableInfo:{type:Object,required:!0}},methods:{changeSort(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},computed:{singleColumnItems(){return this.tableInfo.tableColumns.reduce((e,t)=>{const a=this.$store.state.fkIndexEvaluations.singleColumn[t.id];return a?[...e,...a]:e},[])},multiColumnItems(){return this.$store.state.fkIndexEvaluations.multiColumn[this.tableInfo.id]}},data:()=>({singleColumnHeaders:[{text:"Constraint Name",value:"constraintName"},{text:"Index",value:"fkIndexEvaluation"},{text:"FK Table",value:"fkTable"},{text:"FK Source",value:"fkSource"},{text:"FK Target",value:"fkTarget"}],multiColumnHeaders:[{text:"Constraint Name",value:"constraintName"},{text:"Index",value:"fkIndexEvaluation"},{text:"FK Table",value:"fkTable"},{text:"FK Source",value:"fkSource"},{text:"FK Target",value:"fkTarget"}]})},kt=xt,Nt=Object(y["a"])(kt,yt,gt,!1,null,null,null),Ct=Nt.exports;x()(Nt,{VCard:ce["a"],VContainer:k["a"],VDataTable:Me["a"]});var _t=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-card",{staticClass:"ma-3 pa-3 purple",attrs:{dense:""}},[a("h2",[e._v("Single-Column Unique Indices")]),a("hr"),a("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{headers:e.singleColumnHeaders,items:e.singleColumnItems,"hide-default-footer":"","show-expand":"","calculate-widths":"",dense:""},scopedSlots:e._u([{key:"item.uqIndexEvaluation",fn:function(t){var n=t.item;return[a("span",{class:n.indexDisplayClass},[e._v(e._s(n.uqIndexEvaluation))])]}},{key:"item.uqSource",fn:function(t){var n=t.item;return e._l(n.idxColumns,(function(t){return a("div",{key:t},[e._v(e._s(t))])}))}},{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.singleColumnHeaders.length+1}},[a("table-generic-index-detail",{attrs:{evaluation:t.item}})],1)]}}])})],1),a("v-card",{staticClass:"ma-3 pa-3 purple darken-4",attrs:{dense:""}},[a("h2",[e._v("Multi-Column Unique Indices")]),a("hr"),a("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{headers:e.multiColumnHeaders,items:e.multiColumnItems,"hide-default-footer":"","show-expand":"","calculate-widths":"",dense:""},scopedSlots:e._u([{key:"item.uqIndexEvaluation",fn:function(t){var n=t.item;return[a("span",{class:n.indexDisplayClass},[e._v(e._s(n.uqIndexEvaluation))])]}},{key:"item.uqSource",fn:function(t){var n=t.item;return e._l(n.idxColumns,(function(t){return a("div",{key:t},[e._v(e._s(t))])}))}},{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.singleColumnHeaders.length+1}},[a("table-generic-index-detail",{attrs:{evaluation:t.item}})],1)]}}])})],1)],1)},Tt=[],St={name:"TableUqIndices",components:{TableGenericIndexDetail:mt},props:{tableInfo:{type:Object,required:!0}},methods:{changeSort(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},computed:{singleColumnItems(){return this.tableInfo.tableColumns.reduce((e,t)=>{const a=this.$store.state.uqIndexEvaluations.singleColumn[t.id];return a?[...e,...a]:e},[])},multiColumnItems(){return this.$store.state.uqIndexEvaluations.multiColumn[this.tableInfo.id]}},data:()=>({singleColumnHeaders:[{text:"Constraint Name",value:"constraintName"},{text:"Index",value:"uqIndexEvaluation"},{text:"Uq Column",value:"uqSource"}],multiColumnHeaders:[{text:"Constraint Name",value:"constraintName"},{text:"Index",value:"uqIndexEvaluation"},{text:"Uq Column(s)",value:"uqSource"}]})},It=St,Dt=Object(y["a"])(It,_t,Tt,!1,null,null,null),Et=Dt.exports;x()(Dt,{VCard:ce["a"],VContainer:k["a"],VDataTable:Me["a"]});var Pt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-card",{staticClass:"ma-3 pa-3 blue darken-4",attrs:{dense:""}},[a("h2",[e._v("Check Constraints")]),a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.mappedConstraints,"hide-default-footer":!0}})],1)],1)},wt=[],Rt={name:"TableCheckConstraints",props:{checkConstraints:{type:Array,required:!0}},computed:{mappedConstraints(){return this.checkConstraints.map(e=>{return{...e,expanded:!1,tableName:e.tableConstraints[0].tableName}})}},methods:{changeSort(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},data:()=>({headers:[{text:"Name",sortable:!0,value:"constraintName"},{text:"Check Clause",sortable:!0,value:"checkClause"}],pagination:{sortBy:"constraintName",rowsPerPage:-1}})},Ot=Rt,$t=Object(y["a"])(Ot,Pt,wt,!1,null,null,null),Vt=$t.exports;x()($t,{VCard:ce["a"],VContainer:k["a"],VDataTable:Me["a"]});var jt={name:"TableIndexAnalysis",components:{TableGenericIndices:vt,TableFkIndices:Ct,TableUqIndices:Et,TableCheckConstraints:Vt},props:{tableInfo:{type:Object,required:!0}},methods:{changeSort(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},computed:{allIndices(){return this.tableInfo.indices},uqIndices(){return this.tableInfo.indices},checkConstraints(){return this.tableInfo.checkConstraints||[]}},data:()=>({activeTab:0,headers:[{text:"Column",value:"columnName"},{text:"Index Name",value:"indexName"}],pagination:{sortBy:"constraintName",rowsPerPage:-1}})},Ft=jt,At=Object(y["a"])(Ft,at,nt,!1,null,null,null),qt=At.exports;x()(At,{VCard:ce["a"],VTab:ue["a"],VTabItem:de["a"],VTabs:me["a"]});var Gt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("v-tab",{key:"refcons",attrs:{ripple:""}},[e._v("\n        Referential Constraints\n      ")]),a("v-tab-item",{key:"refcons"},[a("v-card",{attrs:{flat:""}},[a("table-referential-constraints",{attrs:{referentialConstraints:e.referentialConstraints}})],1)],1),a("v-tab",{key:"chk",attrs:{ripple:""}},[e._v("\n        Check Constraints\n      ")]),a("v-tab-item",{key:"chk"},[a("v-card",{attrs:{flat:""}},[a("table-check-constraints",{attrs:{checkConstraints:e.checkConstraints}})],1)],1),a("v-tab",{key:"uq",attrs:{ripple:""}},[e._v("\n        Unique Constraints\n      ")]),a("v-tab-item",{key:"uq"},[a("v-card",{attrs:{flat:""}},[a("table-unique-constraints",{attrs:{uniqueConstraints:e.uniqueConstraints}})],1)],1)],1)],1)},Ut=[],Lt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.mappedConstraints,"hide-default-footer":!0,"item-key":"constraintName"},scopedSlots:e._u([{key:"items",fn:function(t){return[a("tr",{on:{click:function(e){t.expanded=!t.expanded}}},[a("td",[e._v(e._s(t.item.constraintName)),a("hr"),e._v(e._s(t.item.source))]),a("td",[e._v(e._s(t.item.uniqueConstraintName)),a("hr"),e._v(e._s(t.item.target))]),a("td",[e._v(e._s(t.item.matchOption))]),a("td",[e._v(e._s(t.item.updateRule))]),a("td",[e._v(e._s(t.item.deleteRule))])])]}},{key:"expand",fn:function(t){return[a("v-card",{attrs:{flat:""}},[a("h2",[e._v("Source")]),a("table-key-column-usage",{attrs:{keyColumnUsage:t.item.referencingColumnUsage}})],1),a("v-card",{attrs:{flat:""}},[a("h2",[e._v("Target")]),a("table-key-column-usage",{attrs:{keyColumnUsage:t.item.referencedColumnUsage}})],1)]}}])})],1)},Bt=[],zt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.keyColumnUsage,"hide-default-footer":!0},scopedSlots:e._u([{key:"items",fn:function(t){return[a("td",[e._v(e._s(t.item.tableSchema))]),a("td",[e._v(e._s(t.item.tableName))]),a("td",[e._v(e._s(t.item.columnName))])]}}])})],1)},Mt=[],Qt={name:"TableKeyColumnUsage",props:{keyColumnUsage:{type:Array,required:!0}},methods:{},data:()=>({headers:[{text:"Schema",sortable:!1,value:"tableSchema"},{text:"Table",sortable:!1,value:"tableName"},{text:"Column",sortable:!1,value:"columnName"}]})},Kt=Qt,Wt=Object(y["a"])(Kt,zt,Mt,!1,null,null,null),Ht=Wt.exports;x()(Wt,{VContainer:k["a"],VDataTable:Me["a"]});var Xt={name:"TableReferentialConstraints",components:{TableKeyColumnUsage:Ht},props:{referentialConstraints:{type:Array,required:!0}},computed:{mappedConstraints(){return this.referentialConstraints.map(e=>{return{...e,expanded:!1,source:`${e.referencingColumnUsage[0].tableSchema}.${e.referencingColumnUsage[0].tableName}.${e.referencingColumnUsage[0].columnName}`,target:`${e.referencedColumnUsage[0].tableSchema}.${e.referencedColumnUsage[0].tableName}.${e.referencedColumnUsage[0].columnName}`}})}},methods:{changeSort(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},data:()=>({headers:[{text:"Source Constraint",sortable:!0,value:"constraintName"},{text:"Target Constraint",sortable:!0,value:"uniqueConstraintName"},{text:"On Match",sortable:!0,value:"matchOption"},{text:"On Update",sortable:!0,value:"updateRule"},{text:"On Delete",sortable:!0,value:"deleteRule"}],pagination:{sortBy:"constraintName",rowsPerPage:-1}})},Jt=Xt,Yt=Object(y["a"])(Jt,Lt,Bt,!1,null,null,null),Zt=Yt.exports;x()(Yt,{VCard:ce["a"],VContainer:k["a"],VDataTable:Me["a"]});var ea=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.uniqueConstraints,"hide-default-footer":!0},scopedSlots:e._u([{key:"items",fn:function(t){return[a("td",[e._v(e._s(t.item.constraintSchema))]),a("td",[e._v(e._s(t.item.constraintName))])]}}])})],1)},ta=[],aa={name:"TableUniqueConstraints",props:{uniqueConstraints:{type:Array,required:!0}},methods:{changeSort(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},data:()=>({headers:[{text:"Schema",sortable:!0,value:"constraintSchema"},{text:"Name",sortable:!0,value:"constraintName"}],pagination:{sortBy:"constraintName",rowsPerPage:-1}})},na=aa,ia=Object(y["a"])(na,ea,ta,!1,null,null,null),la=ia.exports;x()(ia,{VContainer:k["a"],VDataTable:Me["a"]});var ra={name:"TableConstraints",components:{TableReferentialConstraints:Zt,TableCheckConstraints:Vt,TableUniqueConstraints:la},props:{tableInfo:{type:Object,required:!0}},computed:{referentialConstraints(){return this.tableInfo.referentialConstraints||[]},checkConstraints(){return this.tableInfo.checkConstraints||[]},uniqueConstraints(){return this.tableInfo.uniqueConstraints||[]}},methods:{},data:()=>({activeTab:null})},oa=ra,sa=Object(y["a"])(oa,Gt,Ut,!1,null,null,null),ca=sa.exports;x()(sa,{VCard:ce["a"],VContainer:k["a"],VTab:ue["a"],VTabItem:de["a"],VTabs:me["a"]});var ua=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.grants,"hide-default-footer":!0},scopedSlots:e._u([{key:"items",fn:function(t){return[a("td",[e._v(e._s(t.item.grantee))]),a("td",[e._v(e._s(t.item.privilegeType))])]}}])})],1)},da=[],ma={name:"TableGrants",props:{grants:{type:Array,required:!0}},methods:{changeSort(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},data:()=>({headers:[{text:"Grantor",sortable:!0,value:"grantor"},{text:"Privilege Type",sortable:!0,value:"privilegeType"}],pagination:{sortBy:"constraintName",rowsPerPage:-1}})},pa=ma,ha=Object(y["a"])(pa,ua,da,!1,null,null,null),ba=ha.exports;x()(ha,{VContainer:k["a"],VDataTable:Me["a"]});var fa=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.grants,"hide-default-footer":!0},scopedSlots:e._u([{key:"items",fn:function(t){return[a("td",[e._v(e._s(t.item.tableSchema))]),a("td",[e._v(e._s(t.item.tableName))]),a("td",[e._v(e._s(t.item.columnName))]),a("td",[e._v(e._s(t.item.grantee))]),a("td",[e._v(e._s(t.item.grantor))]),a("td",[e._v(e._s(t.item.privilegeType))]),a("td",[e._v(e._s(t.item.isGrantable))])]}}])})],1)},va=[],ya={name:"TableGrants",props:{grants:{type:Array,required:!0}},methods:{changeSort(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},data:()=>({headers:[{text:"Schema",sortable:!0,value:"tableSchema"},{text:"Table",sortable:!0,value:"tableName"},{text:"Column",sortable:!0,value:"columnName"},{text:"Grantee",sortable:!0,value:"grantee"},{text:"Grantor",sortable:!0,value:"grantor"},{text:"Privilege Type",sortable:!0,value:"privilegeType"},{text:"Is Grantable",sortable:!0,value:"isGrantable"}],pagination:{sortBy:"constraintName",rowsPerPage:-1}})},ga=ya,xa=Object(y["a"])(ga,fa,va,!1,null,null,null),ka=xa.exports;x()(xa,{VContainer:k["a"],VDataTable:Me["a"]});var Na=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.policies,"hide-default-footer":!0},scopedSlots:e._u([{key:"items",fn:function(t){return[a("td",[e._v(e._s(t.item.policyName))]),a("td",[e._v(e._s(t.item.roles))]),a("td",[e._v(e._s(t.item.cmd))]),a("td",[e._v(e._s(t.item.qual))]),a("td",[e._v(e._s(t.item.withCheck))])]}}])})],1)},Ca=[],_a={name:"TablePolicies",props:{policies:{type:Array,required:!0}},methods:{changeSort(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},data:()=>({headers:[{text:"Policy Name",sortable:!0,value:"policyName"},{text:"Roles",sortable:!0,value:"roles"},{text:"Cmd",sortable:!0,value:"cmd"},{text:"Qual",sortable:!0,value:"qual"},{text:"With Check",sortable:!0,value:"withCheck"}],pagination:{sortBy:"constraintName",rowsPerPage:-1}})},Ta=_a,Sa=Object(y["a"])(Ta,Na,Ca,!1,null,null,null),Ia=Sa.exports;x()(Sa,{VContainer:k["a"],VDataTable:Me["a"]});var Da=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("table-trigger-set",{staticClass:"pa-1 ma-1 green",attrs:{actionTiming:"BEFORE",eventManipulation:"INSERT",triggers:e.beforeInsert}}),a("table-trigger-set",{staticClass:"pa-1 ma-1 green darken-2",attrs:{actionTiming:"BEFORE",eventManipulation:"UPDATE",triggers:e.beforeUpdate}}),a("table-trigger-set",{staticClass:"pa-1 ma-1 green darken-4",attrs:{actionTiming:"BEFORE",eventManipulation:"DELETE",triggers:e.beforeDelete}}),a("table-trigger-set",{staticClass:"pa-1 ma-1 blue",attrs:{actionTiming:"AFTER",eventManipulation:"INSERT",triggers:e.afterInsert}}),a("table-trigger-set",{staticClass:"pa-1 ma-1 blue darken-2",attrs:{actionTiming:"AFTER",eventManipulation:"UPDATE",triggers:e.afterUpdate}}),a("table-trigger-set",{staticClass:"pa-1 ma-1 blue darken-4",attrs:{actionTiming:"AFTER",eventManipulation:"DELETE",triggers:e.afterDelete}})],1)},Ea=[],Pa=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("h4",[e._v(e._s(e.actionTiming)+" - "+e._s(e.eventManipulation))]),a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.mappedTriggers,"hide-default-footer":!0,"item-key":"id","show-expand":""},scopedSlots:e._u([{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.headers.length+1}},[a("function",{attrs:{id:t.item.functionId,context:"trigger"}})],1)]}}])})],1)},wa=[],Ra=a("243e"),Oa={name:"TableTriggers",props:{actionTiming:{type:String,required:!0},eventManipulation:{type:String,required:!0},triggers:{type:Array,required:!0}},components:{Function:Ra["a"]},computed:{mappedTriggers(){return this.triggers.map(e=>{const t=`${e.actionStatement.split(" ")[2].split("(")[0]}`;return{...e,functionId:t}}).sort((e,t)=>{return e.actionTiming<t.actionTiming})}},methods:{changeSort(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},data:()=>({headers:[{text:"Name",sortable:!0,value:"triggerName",width:"20%"},{text:"Timing",sortable:!0,value:"actionTiming",width:"10%"},{text:"Trigger On",sortable:!0,value:"eventManipulation",width:"10%"},{text:"Statement",sortable:!0,value:"actionStatement",width:"60%"}],pagination:{sortBy:"triggerName",rowsPerPage:-1}})},$a=Oa,Va=Object(y["a"])($a,Pa,wa,!1,null,null,null),ja=Va.exports;x()(Va,{VContainer:k["a"],VDataTable:Me["a"]});var Fa={name:"TableTriggers",props:{triggers:{type:Array,required:!0}},components:{TableTriggerSet:ja},computed:{beforeInsert(){return this.triggers.filter(e=>"BEFORE"===e.actionTiming&&"INSERT"===e.eventManipulation)},beforeUpdate(){return this.triggers.filter(e=>"BEFORE"===e.actionTiming&&"UPDATE"===e.eventManipulation)},beforeDelete(){return this.triggers.filter(e=>"BEFORE"===e.actionTiming&&"DELETE"===e.eventManipulation)},afterInsert(){return this.triggers.filter(e=>"AFTER"===e.actionTiming&&"INSERT"===e.eventManipulation)},afterUpdate(){return this.triggers.filter(e=>"AFTER"===e.actionTiming&&"UPDATE"===e.eventManipulation)},afterDelete(){return this.triggers.filter(e=>"AFTER"===e.actionTiming&&"DELETE"===e.eventManipulation)}}},Aa=Fa,qa=Object(y["a"])(Aa,Da,Ea,!1,null,null,null),Ga=qa.exports;x()(qa,{VContainer:k["a"]});var Ua=a("861c"),La=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("v-tab",{key:"allIndices",attrs:{ripple:""}},[e._v("\n    All Indices\n  ")]),a("v-tab-item",{key:"allIndices"},[a("v-card",{attrs:{flat:""}},[a("generic-index-set",{attrs:{indexEvaluations:e.allIndexEvaluations}})],1)],1),a("v-tab",{key:"fkIndices",attrs:{ripple:""}},[e._v("\n    Foreign Key Constraints\n  ")]),a("v-tab-item",{key:"fkIndices"},[a("v-card",{attrs:{flat:""}},[a("fk-index-constraints",{attrs:{fkIndexEvaluations:e.fkIndexEvaluations}})],1)],1),a("v-tab",{key:"uqIndices",attrs:{ripple:""}},[e._v("\n    Unique Constraints\n  ")]),a("v-tab-item",{key:"uqIndices"},[a("v-card",{attrs:{flat:""}},[a("uq-index-set",{attrs:{uqIndexEvaluations:e.uqIndexEvaluations}})],1)],1),a("v-tab",{key:"chk",attrs:{ripple:"",hidden:e.hideCheckConstraints}},[e._v("\n    Check Constraints\n  ")]),a("v-tab-item",{key:"chk"},[a("v-card",{attrs:{flat:""}},[a("check-constraints",{attrs:{checkConstraints:e.checkConstraints}})],1)],1),a("v-tab",{key:"drop",attrs:{ripple:""}},[e._v("\n    Create Indices Script\n  ")]),a("v-tab-item",{key:"drop"},[a("v-card",{attrs:{flat:""}},[a("script-viewer",{attrs:{scriptText:e.createIndicesScript,skipFormat:""}})],1)],1),a("v-tab",{key:"create",attrs:{ripple:""}},[e._v("\n    Drop Indices Script\n  ")]),a("v-tab-item",{key:"create"},[a("v-card",{attrs:{flat:""}},[a("script-viewer",{attrs:{scriptText:e.dropIndicesScript}})],1)],1)],1)},Ba=[],za=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{fluid:""}},[e.badIndices.length>0?a("v-card",{staticClass:"ma-3 pa-3 red darken-3",attrs:{dense:""}},[a("h2",[e._v("Over-Indexed")]),a("hr"),a("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{items:e.badIndices,headers:e.headers,"hide-default-footer":"","show-expand":"","calculate-widths":"",dense:"","items-per-page":e.badIndices.length},scopedSlots:e._u([{key:"item.tableSchema",fn:function(t){var a=t.item;return[e._v("\n        "+e._s(a.tableKey.split(".")[0])+"\n      ")]}},{key:"item.tableName",fn:function(t){var n=t.item;return[n.tableKey?a("router-link",{attrs:{to:{name:"table",params:{id:n.tableKey}},target:"_blank"}},[e._v(e._s(n.tableKey.split(".")[1]))]):e._e()]}},{key:"item.columnDisplay",fn:function(t){var n=t.item;return e._l(n.columnDisplay,(function(t){return a("div",{key:t},[e._v(e._s(t))])}))}},{key:"item.evaluation",fn:function(t){var n=t.item;return e._l(n.evaluation,(function(t){return a("div",{key:t,class:n.indexDisplayClass},[e._v(e._s(t))])}))}},{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.headers.length+1}},[a("generic-index-detail",{attrs:{evaluation:t.item}})],1)]}}],null,!1,589962001)})],1):e._e(),a("v-card",{staticClass:"ma-3 pa-3 green darken-3",attrs:{dense:""}},[a("h2",[e._v("Indexed")]),a("hr"),a("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{items:e.goodIndices,headers:e.headers,"hide-default-footer":"","show-expand":"","calculate-widths":"",dense:"","items-per-page":e.goodIndices.length},scopedSlots:e._u([{key:"item.tableSchema",fn:function(t){var a=t.item;return[e._v("\n        "+e._s(a.tableKey.split(".")[0])+"\n      ")]}},{key:"item.tableName",fn:function(t){var n=t.item;return[n.tableKey?a("router-link",{attrs:{to:{name:"table",params:{id:n.tableKey}},target:"_blank"}},[e._v(e._s(n.tableKey.split(".")[1]))]):e._e()]}},{key:"item.columnDisplay",fn:function(t){var n=t.item;return e._l(n.columnDisplay,(function(t){return a("div",{key:t},[e._v(e._s(t))])}))}},{key:"item.evaluation",fn:function(t){var n=t.item;return e._l(n.evaluation,(function(t){return a("div",{key:t,class:n.indexDisplayClass},[e._v(e._s(t))])}))}},{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.headers.length+1}},[a("generic-index-detail",{attrs:{evaluation:t.item}})],1)]}}])})],1)],1)},Ma=[],Qa=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("h2",[e._v("Existing Indices")]),a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.evaluation.indices,"hide-default-footer":!0,"show-expand":"","show-select":""},on:{"item-selected":e.itemSelected},scopedSlots:e._u([{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.headers.length+2}},[a("h2",[e._v("Current Realization in Database Under Development")]),a("script-viewer",{attrs:{scriptText:t.item.indexDefinition,showReadability:!1,showToolbar:!1}})],1)]}}]),model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}},[a("template",{slot:"header.data-table-select"},[e._v("\n      Drop\n    ")])],2),a("h2",[e._v("Current Realization To Be Generated")]),a("script-viewer",{attrs:{scriptText:e.desiredRealization,showReadability:!1}})],1)},Ka=[],Wa={name:"GenericIndexDetail",props:{evaluation:{type:Object,required:!0}},components:{ScriptViewer:rt["a"]},methods:{itemSelected(e){this.$store.commit("toggleIndexForDrop",e)}},computed:{existingIndices(){return this.evaluation.indices||[]},desiredRealization(){const e=this.evaluation.desiredRealization.drop?`-- INDICES TO DROP\n\n ${this.evaluation.desiredRealization.drop}`:"",t=this.evaluation.desiredRealization.create?`-- INDICES TO CREATE\n\n ${this.evaluation.desiredRealization.create}`:"",a=e.concat("\n\n").concat(t);return a}},data:()=>({selected:[],headers:[{text:"",value:"drop",width:"5%"},{text:"Index Name",value:"indexName"}]}),mounted(){this.evaluation.indices.map(e=>e.indexName);this.selected=this.evaluation.indices.filter(e=>void 0!==this.$store.state.indicesToDrop[e.indexName])}},Ha=Wa,Xa=Object(y["a"])(Ha,Qa,Ka,!1,null,null,null),Ja=Xa.exports;x()(Xa,{VContainer:k["a"],VDataTable:Me["a"]});const Ya="MULTIPLE_INDICES";var Za={name:"GenericIndexSet",props:{indexEvaluations:{type:Array,required:!0}},components:{GenericIndexDetail:Ja},methods:{changeSort(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},computed:{goodIndices(){return this.indexEvaluations.filter(e=>e.evaluation!==Ya).map(e=>{return{...e,columnDisplay:e.idxColumns,evaluation:e.evaluation.split(", ")}})},badIndices(){return this.indexEvaluations.filter(e=>e.evaluation===Ya).map(e=>{return{...e,columnDisplay:e.idxColumns,evaluation:e.evaluation.split(", ")}})}},data:()=>({selected:[],headers:[{text:"Schema",value:"tableSchema",width:"10%"},{text:"Table",value:"tableName",width:"10%"},{text:"Index Columns",value:"columnDisplay",width:"40%"},{text:"Evaluation",value:"evaluation",width:"40%"}],pagination:{sortBy:"constraintName",rowsPerPage:-1}})},en=Za,tn=Object(y["a"])(en,za,Ma,!1,null,null,null),an=tn.exports;x()(tn,{VCard:ce["a"],VContainer:k["a"],VDataTable:Me["a"]});var nn=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-card",{staticClass:"ma-3 pa-3 blue-grey",attrs:{dense:""}},[a("h2",[e._v("Single-Column Foreign Keys")]),a("hr"),a("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{headers:e.headers,items:e.singleColumnItems,"hide-default-footer":"","show-expand":"","calculate-widths":"",dense:"","items-per-page":e.singleColumnItems.length},scopedSlots:e._u([{key:"item.fkIndexEvaluation",fn:function(t){var n=t.item;return[a("span",{class:n.indexDisplayClass},[e._v(e._s(n.fkIndexEvaluation))])]}},{key:"item.fkTable",fn:function(t){var n=t.item;return[n.fkTableLinkId?a("router-link",{attrs:{to:{name:"table",params:{id:n.fkTableLinkId}},target:"_blank"}},[e._v(e._s(n.fkTable))]):e._e()]}},{key:"item.fkSource",fn:function(t){var n=t.item;return e._l(n.fkSource,(function(t){return a("div",{key:t},[e._v(e._s(t))])}))}},{key:"item.fkTarget",fn:function(t){var n=t.item;return e._l(n.fkTarget,(function(t){return a("div",{key:t},[e._v(e._s(t))])}))}},{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.headers.length+1}},[a("generic-index-detail",{attrs:{evaluation:t.item}})],1)]}}])})],1),a("v-card",{staticClass:"ma-3 pa-3 blue-grey darken-4",attrs:{dense:""}},[a("h2",[e._v("Multi-Column Foreign Keys")]),a("hr"),a("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{headers:e.headers,items:e.multiColumnItems,"hide-default-footer":"","show-expand":"","calculate-widths":"",dense:"","items-per-page":e.multiColumnItems.length},scopedSlots:e._u([{key:"item.fkIndexEvaluation",fn:function(t){var n=t.item;return[a("span",{class:n.indexDisplayClass},[e._v(e._s(n.fkIndexEvaluation))])]}},{key:"item.fkTable",fn:function(t){var n=t.item;return[n.fkTableLinkId?a("router-link",{attrs:{to:{name:"table",params:{id:n.fkTableLinkId}},target:"_blank"}},[e._v(e._s(n.fkTable))]):e._e()]}},{key:"item.fkSource",fn:function(t){var n=t.item;return e._l(n.fkSource,(function(t){return a("div",{key:t},[e._v(e._s(t))])}))}},{key:"item.fkTarget",fn:function(t){var n=t.item;return e._l(n.fkTarget,(function(t){return a("div",{key:t},[e._v(e._s(t))])}))}},{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.headers.length+1}},[a("generic-index-detail",{attrs:{evaluation:t.item}})],1)]}}])})],1)],1)},ln=[],rn={name:"FkIndexConstraints",components:{GenericIndexDetail:Ja},props:{fkIndexEvaluations:{type:Object,required:!0}},methods:{changeSort(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},computed:{singleColumnItems(){return Object.values(this.fkIndexEvaluations.singleColumn).flat()},multiColumnItems(){return Object.values(this.fkIndexEvaluations.multiColumn).filter(e=>e.length>0).flat()}},data:()=>({headers:[{text:"Constraint Name",value:"constraintName",width:"15%"},{text:"FK Table",value:"fkTable",width:"15%"},{text:"FK Source",value:"fkSource",width:"25%"},{text:"FK Target",value:"fkTarget",width:"25%"},{text:"Index",value:"fkIndexEvaluation",width:"20%"}]})},on=rn,sn=Object(y["a"])(on,nn,ln,!1,null,null,null),cn=sn.exports;x()(sn,{VCard:ce["a"],VContainer:k["a"],VDataTable:Me["a"]});var un=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-card",{staticClass:"ma-3 pa-3 purple",attrs:{dense:""}},[a("h2",[e._v("Single-Column Unique Indices")]),a("hr"),a("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{headers:e.headers,items:e.singleColumnItems,"hide-default-footer":"","show-expand":"","calculate-widths":"",dense:"","items-per-page":e.singleColumnItems.length},scopedSlots:e._u([{key:"item.uqTableId",fn:function(t){var n=t.item;return[n.uqTableId?a("router-link",{attrs:{to:{name:"table",params:{id:n.uqTableId}},target:"_blank"}},[e._v(e._s(n.uqTableId))]):e._e()]}},{key:"item.uqIndexEvaluation",fn:function(t){var n=t.item;return[a("span",{class:n.indexDisplayClass},[e._v(e._s(n.uqIndexEvaluation))])]}},{key:"item.uqSource",fn:function(t){var n=t.item;return e._l(n.idxColumns,(function(t){return a("div",{key:t},[e._v(e._s(t))])}))}},{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.headers.length+1}},[a("generic-index-detail",{attrs:{evaluation:t.item}})],1)]}}])})],1),a("v-card",{staticClass:"ma-3 pa-3 purple darken-4",attrs:{dense:""}},[a("h2",[e._v("Multi-Column Unique Indices")]),a("hr"),a("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{headers:e.headers,items:e.multiColumnItems,"hide-default-footer":"","show-expand":"","calculate-widths":"",dense:"","items-per-page":e.multiColumnItems.length},scopedSlots:e._u([{key:"item.uqTableId",fn:function(t){var n=t.item;return[n.uqTableId?a("router-link",{attrs:{to:{name:"table",params:{id:n.uqTableId}},target:"_blank"}},[e._v(e._s(n.uqTableId))]):e._e()]}},{key:"item.uqIndexEvaluation",fn:function(t){var n=t.item;return[a("span",{class:n.indexDisplayClass},[e._v(e._s(n.uqIndexEvaluation))])]}},{key:"item.uqSource",fn:function(t){var n=t.item;return e._l(n.idxColumns,(function(t){return a("div",{key:t},[e._v(e._s(t))])}))}},{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.headers.length+1}},[a("generic-index-detail",{attrs:{evaluation:t.item}})],1)]}}])})],1)],1)},dn=[],mn={name:"TableUqIndices",components:{GenericIndexDetail:Ja},props:{uqIndexEvaluations:{type:Object,required:!0}},methods:{changeSort(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},computed:{singleColumnItems(){return Object.values(this.uqIndexEvaluations.singleColumn).flat()},multiColumnItems(){return Object.values(this.uqIndexEvaluations.multiColumn).flat()}},data:()=>({headers:[{text:"Constraint Name",value:"constraintName",width:"25%"},{text:"Table",value:"uqTableId",width:"20%"},{text:"Uq Column",value:"uqSource",width:"25%"},{text:"Index",value:"uqIndexEvaluation",width:"30%"}]})},pn=mn,hn=Object(y["a"])(pn,un,dn,!1,null,null,null),bn=hn.exports;x()(hn,{VCard:ce["a"],VContainer:k["a"],VDataTable:Me["a"]});var fn=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-card",{staticClass:"ma-3 pa-3 blue darken-4",attrs:{dense:""}},[a("h2",[e._v("Check Constraints")]),a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.mappedConstraints,"hide-default-footer":!0}})],1)],1)},vn=[],yn={name:"CheckConstraints",props:{checkConstraints:{type:Array,required:!0}},computed:{mappedConstraints(){return this.checkConstraints.map(e=>{return{...e,expanded:!1,tableName:e.tableConstraints[0].tableName}})}},methods:{changeSort(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},data:()=>({headers:[{text:"Name",sortable:!0,value:"constraintName"},{text:"Check Clause",sortable:!0,value:"checkClause"}],pagination:{sortBy:"constraintName",rowsPerPage:-1}})},gn=yn,xn=Object(y["a"])(gn,fn,vn,!1,null,null,null),kn=xn.exports;x()(xn,{VCard:ce["a"],VContainer:k["a"],VDataTable:Me["a"]});var Nn={name:"ConstraintsAndIndices",components:{GenericIndexSet:an,FkIndexConstraints:cn,UqIndexSet:bn,CheckConstraints:kn,ScriptViewer:rt["a"]},props:{tableSchema:{type:String,required:!1},tableName:{type:String,required:!1}},methods:{},computed:{allIndexEvaluations(){const e=Object.values(this.$store.state.genericIndexEvaluations),t=this.tableSchema?e.filter(e=>e.tableKey.split(".")[0]===this.tableSchema):e,a=this.tableName?e.filter(e=>e.tableKey.split(".")[0]===this.tableSchema&&e.tableKey.split(".")[1]===this.tableName):t;return a},fkIndexEvaluations(){const e=this.$store.state.fkIndexEvaluations,t=this.tableSchema?{singleColumn:Object.values(e.singleColumn).filter(e=>{const t=e[0]||{};return!this.tableSchema||t.tableSchema===this.tableSchema}),multiColumn:Object.values(e.multiColumn).filter(e=>{const t=e[0]||{};return!this.tableSchema||t.tableSchema===this.tableSchema})}:e,a=this.tableName?{singleColumn:Object.values(t.singleColumn).filter(e=>{const t=e[0]||{};return!this.tableName||t.tableName===this.tableName}),multiColumn:Object.values(t.multiColumn).filter(e=>{const t=e[0]||{};return!this.tableName||t.tableName===this.tableName})}:t;return a},uqIndexEvaluations(){const e=this.$store.state.uqIndexEvaluations,t=this.tableSchema?{singleColumn:Object.values(e.singleColumn).filter(e=>{const t=e[0]||{};return!this.tableSchema||t.tableSchema===this.tableSchema}),multiColumn:Object.values(e.multiColumn).filter(e=>{const t=e[0]||{};return!this.tableSchema||t.tableSchema===this.tableSchema})}:e,a=this.tableName?{singleColumn:Object.values(t.singleColumn).filter(e=>{const t=e[0]||{};return!this.tableName||t.tableName===this.tableName}),multiColumn:Object.values(t.multiColumn).filter(e=>{const t=e[0]||{};return!this.tableName||t.tableName===this.tableName})}:t;return a},hideCheckConstraints(){return null===this.tableName||void 0===this.tableName},checkConstraints(){return this.tableSchema&&this.tableName?this.$store.state.managedSchemata.find(e=>e.schemaName===this.tableSchema).schemaTables.find(e=>e.tableName===this.tableName).checkConstraints:[]},createIndicesScript(){const e=Object.values(this.$store.state.fkIndexEvaluations.singleColumn).filter(e=>e.length>0).filter(e=>!this.tableName||this.tableName===e[0].tableName).filter(e=>!this.tableSchema||this.tableSchema===e[0].tableSchema).map(e=>e[0]),t=Object.values(this.$store.state.fkIndexEvaluations.multiColumn).filter(e=>e.length>0).filter(e=>!this.tableName||this.tableName===e[0].tableName).filter(e=>!this.tableSchema||this.tableSchema===e[0].tableSchema),a=Object.values(this.$store.state.uqIndexEvaluations.singleColumn).filter(e=>e.length>0).filter(e=>!this.tableName||this.tableName===e[0].tableName).filter(e=>!this.tableSchema||this.tableSchema===e[0].tableSchema).map(e=>e[0]),n=Object.values(this.$store.state.uqIndexEvaluations.multiColumn).filter(e=>e.length>0).filter(e=>!this.tableName||this.tableName===e[0].tableName).filter(e=>!this.tableSchema||this.tableSchema===e[0].tableSchema),i=[...e,...t,...a,...n].flat(),l=(i.map(e=>e.idxKey),Object.values(this.$store.state.genericIndexEvaluations).filter(e=>1===e.idxColumns.length).filter(e=>0===i.filter(t=>t.id===e.id).length).filter(e=>!this.tableName||this.tableName===e.tableName).filter(e=>!this.tableSchema||this.tableSchema===e.tableSchema)),r=[...i,...l].flat().reduce((e,t)=>{const a=e.find(e=>e.idxKey===t.idxKey);if(a){const n=e.filter(e=>e.idxKey!==t.idxKey),i=a.indices.map(e=>e.id),l=t.indices.filter(e=>-1===i.indexOf(e.id));return[...n,{...a,indices:[...a.indices,...l]}]}return[...e,t]},[]);return r.reduce((e,t)=>{return t.desiredRealization.create?e.concat(`${t.desiredRealization.create}\n`):e},"")},dropIndicesScript(){return Object.values(this.$store.state.indicesToDrop).reduce((e,t)=>{return this.tableName&&this.tableName!==t.tableName?e:this.schemaName&&this.tableSchema!==t.tableSchema?e:e.concat(`---- DROP INDEX: ${t.indexName}\n${t.indexDrop}\n----------\n\n`)},"")}},data:()=>({activeTab:0})},Cn=Nn,_n=Object(y["a"])(Cn,La,Ba,!1,null,null,null),Tn=_n.exports;x()(_n,{VCard:ce["a"],VTab:ue["a"],VTabItem:de["a"],VTabs:me["a"]});var Sn=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("v-tab",{key:"tableDefinition",attrs:{ripple:""}},[e._v("\n      Definition\n    ")]),a("v-tab-item",{key:"tableDefinition"},[a("v-card",{attrs:{flat:""}},[a("script-viewer",{attrs:{scriptText:e.tableDefinition,showReadability:!1}})],1)],1),a("v-tab",{key:"tableIndices",attrs:{ripple:""}},[e._v("\n      Indices\n    ")]),a("v-tab-item",{key:"tableIndices"},[a("v-card",{attrs:{flat:""}},[a("script-viewer",{attrs:{scriptText:e.tableIndicesRealization,showReadability:!1}})],1)],1),a("v-tab",{key:"tableSecurityPolicy",attrs:{ripple:""}},[e._v("\n      Security Policy Script\n    ")]),a("v-tab-item",{key:"tableSecurityPolicy"},[a("v-card",{attrs:{flat:""}},[a("table-policy-realization",{attrs:{policyDefinition:e.policyDefinition,table:e.tableInfo}})],1)],1)],1)],1)},In=[],Dn=a("96b5"),En={name:"TableScripts",components:{ScriptViewer:rt["a"],TablePolicyRealization:Dn["a"]},props:{tableInfo:{type:Object,required:!0}},computed:{tableDefinition(){return"TABLE DEFINITION NOT IMPLMENTED YET"},tableIndicesRealization(){const e=Object.values(this.$store.state.genericIndexEvaluations).filter(e=>e.tableKey===`${this.tableInfo.tableSchema}.${this.tableInfo.tableName}`),t=e.reduce((e,t)=>{return""!==t.desiredRealization.drop?[...e,t.desiredRealization.drop]:e},[]),a=e.reduce((e,t)=>{return""!==t.desiredRealization.create?[...e,t.desiredRealization.create]:e},[]),n=t.length>0?`-- INDICES TO DROP\n\n${t.join("")}`:"",i=a.length>0?`-- INDICES TO CREATE\n\n${a.join("")}`:"",l=n.concat("\n\n").concat(i);return l},policyDefinition(){const e=this.$store.state.tablePolicyAssignments[`${this.tableInfo.tableSchema}.${this.tableInfo.tableName}`].policyDefinitionId;return this.$store.state.policies.find(t=>t.id===e)}},methods:{},data:()=>({activeTab:null})},Pn=En,wn=Object(y["a"])(Pn,Sn,In,!1,null,null,null),Rn=wn.exports;x()(wn,{VCard:ce["a"],VContainer:k["a"],VTab:ue["a"],VTabItem:de["a"],VTabs:me["a"]});var On={name:"Table",components:{TableDetail:Ke,TableColumns:tt,TableConstraints:ca,TableIndices:qt,TableGrants:ba,TableColumnGrants:ka,TablePolicies:Ia,TableTriggers:Ga,TablePolicyDefinition:Ua["a"],ConstraintsAndIndices:Tn,TableScripts:Rn},props:{id:{type:String,required:!0}},computed:{tableInfo(){const e=this.$store.state.managedSchemata.find(e=>e.schemaName===this.tableSchema),t=e.schemaTables.find(e=>e.tableName===this.tableName),a=this.$store.state.tablePolicyAssignments[this.id].policyDefinitionId;return{...t,policyDefinitionId:a}},tableName(){return this.id.split(".")[1]},tableSchema(){return this.id.split(".")[0]},tableColumns(){return this.tableInfo.tableColumns||[]},indices(){return this.tableInfo.indices||[]},tableGrants(){return this.tableInfo.roleTableGrants||[]},tableColumnGrants(){return this.tableInfo.roleColumnGrants||[]},tablePolicies(){return this.tableInfo.policies||[]},tableTriggers(){return this.tableInfo.triggers||[]}},methods:{},data:()=>({activeTab:null}),beforeRouteUpdate(e,t,a){a()}},$n=On,Vn=Object(y["a"])($n,De,Ee,!1,null,null,null),jn=Vn.exports;x()(Vn,{VCard:ce["a"],VContainer:k["a"],VTab:ue["a"],VTabItem:de["a"],VTabs:me["a"]});var Fn=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{"ma-0":"","pa-0":""}},[a("h1",[e._v("Security Manager")]),a("hr"),a("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("v-tab",{key:"table-security",attrs:{ripple:"",disabled:e.initializing}},[e._v("\n      Table Security\n    ")]),a("v-tab-item",{key:"table-security",attrs:{lazy:""}},[a("v-card",[a("table-security-view")],1)],1),a("v-tab",{key:"function-security",attrs:{ripple:"",disabled:e.initializing}},[e._v("\n      Function Security\n    ")]),a("v-tab-item",{key:"function-security",attrs:{lazy:""}},[a("v-card",[a("function-security-view")],1)],1),a("v-tab",{key:"roles",attrs:{ripple:""}},[e._v("\n      Roles\n    ")]),a("v-tab-item",{key:"roles",attrs:{lazy:""}},[a("v-card",[a("role-filter")],1)],1),a("v-tab",{key:"help",attrs:{ripple:""}},[e._v("\n      Help\n    ")]),a("v-tab-item",{key:"help",attrs:{lazy:""}},[a("v-container",{attrs:{fluid:""}},[a("h2",[a("a",{attrs:{href:"https://learn.graphile.org/docs/PostgreSQL_Row_Level_Security_Infosheet.pdf",target:"_blank"}},[e._v("graphile.org rls infosheet")])]),a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{attrs:{"align-self":"stretch",cols:"12"}},[a("pdf",{attrs:{src:"https://learn.graphile.org/docs/PostgreSQL_Row_Level_Security_Infosheet.pdf"}})],1)],1)],1)],1)],1)],1)},An=[],qn=(a("52b3"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("h2",[e._v("Select roles to use when defining security policies")]),e._l(e.roleFamilies,(function(t){return a("div",{key:t.name},[a("applicable-family",{attrs:{applicableFamily:t,maxFamilySize:e.maxFamilySize}})],1)}))],2)}),Gn=[],Un=(a("2a83"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("h1",[e._v(e._s(e.applicableFamily.name))]),a("v-data-table",{staticClass:"text-sm-left",attrs:{headers:e.familyHeaders,items:e.applicableFamily.dataRows,"item-key":"roleName","show-select":"",dense:"","disable-pagination":"","disable-sort":"","hide-default-footer":"",value:e.selected},on:{input:e.itemSelected},scopedSlots:e._u([{key:"item.ignore",fn:function(e){var t=e.item;return[a("ignore-role",{attrs:{role:t}})]}}])})],1)}),Ln=[],Bn=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-checkbox",{attrs:{"input-value":e.isIgnored,disabled:e.disabled},on:{click:function(t){return e.toggleIgnoreRole()}}})},zn=[],Mn={name:"IgnoreRole",mixins:[],props:{role:{type:Object,required:!0}},computed:{disabled(){const e=this.$store.state.projectRoles.map(e=>e.roleName),t=-1!==e.indexOf(this.role.roleName);return t},isIgnored(){const e=this.$store.state.ignoredRoles.map(e=>e.roleName),t=-1!==e.indexOf(this.role.roleName);return t}},watch:{},data:()=>({debounce:!1}),methods:{toggleIgnoreRole(){this.debounce?this.debounce=!1:(this.$store.commit("toggleIgnoreRole",{role:this.role}),this.debounce=!0)}},mounted(){}},Qn=Mn,Kn=a("ac7c"),Wn=Object(y["a"])(Qn,Bn,zn,!1,null,null,null),Hn=Wn.exports;x()(Wn,{VCheckbox:Kn["a"]});var Xn={name:"ApplicableFamily",mixins:[],components:{IgnoreRole:Hn},props:{applicableFamily:{type:Object,required:!0},maxFamilySize:{type:Number,required:!0}},computed:{familyHeaders(){const e=`${100/(this.maxFamilySize+2)}%`,t=this.applicableFamily.allMemberNames.map(t=>{return{text:t,value:t,sortable:!1,width:e}}),a=new Array(this.maxFamilySize-this.applicableFamily.members.length).fill({text:"",width:e}),n=[{text:"select family",name:"roleName",value:"roleName",sortable:!1,width:e},{text:"ignore",value:"ignore",width:e},,...t,...a];return n},projectRoles(){return this.$store.state.projectRoles},selected(){return this.projectRoles.filter(e=>-1!==this.applicableFamily.allMemberNames.indexOf(e.roleName))}},watch:{},data:()=>({debounce:!1}),methods:{itemSelected(e){const t=[...this.projectRoles.filter(e=>-1===this.applicableFamily.allMemberNames.indexOf(e.roleName)),...e.map(e=>this.applicableFamily.members.find(t=>t.roleName===e.roleName))];this.$store.commit("projectRoles",{projectRoles:t})}},mounted(){}},Jn=Xn,Yn=Object(y["a"])(Jn,Un,Ln,!1,null,null,null),Zn=Yn.exports;x()(Yn,{VContainer:k["a"],VDataTable:Me["a"]});const ei="---",ti="+++";var ai={name:"RoleFilter",mixins:[],components:{ApplicableFamily:Zn},computed:{maxFamilySize(){return this.roleFamilies.reduce((e,t)=>{return t.members.length>e?t.members.length:e},0)},initializing(){return this.$store.state.initializing},enabledRoles(){return this.$store.state.enabledRoles},projectRoles(){return this.$store.state.projectRoles},applyDisabled(){if(this.roles.length>0){const e=this.projectRoles.reduce((e,t)=>{const a=this.roles.find(e=>e.roleName===t.roleName);return e?a.selected:e},!0),t=this.roles.filter(e=>e.selected);return e&&t.length===this.projectRoles.length}return!0},selectedRoleFamilies(){return this.$store.state.selectedRoleFamilies}},watch:{initializing(){this.computeItems()}},data:()=>({roleFamilies:[],roles:[],checkedFamilies:[],checkedRoles:{}}),methods:{computeItems(){this.roles.map(e=>{e.selected=void 0!==this.projectRoles.find(t=>t.name===e.name)});const e=this.roles.sort((e,t)=>{return e.applicableRoles.length>=t.applicableRoles.length?-1:1}).reduce((e,t)=>{const a=e.find(e=>new Set(e.allMemberNames).has(t.roleName));if(a)return e;{const a=t.applicableRoles.map(e=>{return e.roleName}).concat([t.roleName]).sort((e,t)=>{const a=this.roles.find(t=>t.roleName===e).applicableRoles.length,n=this.roles.find(e=>e.roleName===t).applicableRoles.length;return a>=n?-1:1});return e.concat([{name:t.roleName,selected:this.selectedRoleFamilies.find(e=>e.name===t.roleName),allMemberNames:a}])}},[]);this.roleFamilies=e.reduce((e,t)=>{const a=t.allMemberNames.reduce((e,a)=>{const n=this.roles.find(e=>e.roleName===a),i=t.allMemberNames.reduce((e,t)=>{const a=n.applicableRoles.find(e=>e.roleName===t);return void 0!==a?Object.assign(e,{[t]:ti}):n.roleName===t?Object.assign(e,{[t]:t}):Object.assign(e,{[t]:ei})},{});return e.concat([Object.assign({roleName:a},i)])},[]),n=this.roles.filter(e=>t.allMemberNames.indexOf(e.roleName)>-1);return e.concat([Object.assign(t,{dataRows:a,members:n})])},[])},familyItems(e){return e.items}},mounted(){this.roles=this.enabledRoles.map(e=>{this.projectRoles.find(t=>t.roleName===e.roleName);return{...e,selected:void 0!==this.projectRoles.find(t=>t.roleName===e.roleName)}}),this.computeItems()}},ni=ai,ii=Object(y["a"])(ni,qn,Gn,!1,null,null,null),li=ii.exports;x()(ii,{VContainer:k["a"]});var ri=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{"ma-0":"","pa-0":""}},[a("h1",[e._v("Table Security Manager")]),a("hr"),a("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("v-tab",{key:"policyAssignment",attrs:{ripple:""}},[e._v("\n      Policy Assignment\n    ")]),a("v-tab-item",{key:"policyAssignment",attrs:{lazy:""}},[a("v-card",[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("v-card",{key:"olicyAssignment"},[a("policy-assignment")],1)],1)],1)],1)],1),a("v-tab",{key:"policies",attrs:{ripple:""}},[e._v("\n      Schema Security Scripts\n    ")]),a("v-tab-item",{key:"policies",attrs:{lazy:""}},[a("v-card",[a("schema-security-scripts")],1)],1),a("v-tab",{key:"policy-manager",attrs:{ripple:""}},[e._v("\n      Policy Templates\n    ")]),a("v-tab-item",{key:"policy-manager",attrs:{lazy:""}},[a("v-card",[a("policy-manager")],1)],1)],1)],1)},oi=[],si=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-tabs",{attrs:{dark:"","slider-color":"yellow"}},[e._l(e.managedSchemata,(function(t){return a("v-tab",{key:t.schemaName,attrs:{ripple:""}},[e._v("\n      "+e._s(t.schemaName)+"\n    ")])})),e._l(e.managedSchemata,(function(e){return a("v-tab-item",{key:e.schemaName,attrs:{lazy:""}},[a("policy-assignment-schema",{attrs:{schema:e}})],1)}))],2)],1)},ci=[],ui=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-toolbar",[a("policy-assignment-dialog",{attrs:{currentPolicyDefinition:e.defaultPolicy,tables:e.selected,bulkAssign:!0,disabled:e.selected.length<1}})],1),a("v-data-table",{attrs:{headers:e.headers,items:e.tablesToShow,"item-key":"id",dense:"","disable-pagination":"","disable-sort":"","hide-default-footer":"","show-select":"","show-expand":"",expanded:e.expanded},on:{"update:expanded":function(t){e.expanded=t}},scopedSlots:e._u([{key:"item.name",fn:function(t){var a=t.item;return[e._v("\n        "+e._s(a.tableName)+"\n      ")]}},{key:"item.assignedPolicy",fn:function(t){var n=t.item;return[a("policy-assignment-dialog",{attrs:{currentPolicyDefinition:n.policyDefinition,tables:[n]},on:{policyAssigned:e.expandItems}}),e.showCustomizeButton(n)?a("table-policy-customize-dialog",{attrs:{currentPolicyDefinition:n.policyDefinition,tables:[n]},on:{policyAssigned:e.expandItems}}):e._e()]}},{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.headers.length+2}},[a("policy-definition",{key:t.item.id,attrs:{policyId:t.item.policyDefinition.id,table:t.item}})],1)]}}]),model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}})],1)},di=[],mi=a("996c"),pi=a.n(mi),hi=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-dialog",{attrs:{persistent:"",width:"800"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[a("v-btn",e._g({staticClass:"text-none",attrs:{small:"",dark:"",disabled:e.disabled}},n),[e._v("\n        "+e._s(e.displayValue)+"\n      ")])]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[a("v-card-title",{staticClass:"headline"},[e._v("Assign Policy")]),a("v-combobox",{attrs:{items:e.allPolicyDefinitions,"item-text":"name","item-value":"id"},model:{value:e.currentSelection,callback:function(t){e.currentSelection=t},expression:"currentSelection"}}),a("v-card-actions",[a("v-spacer"),a("v-btn",{on:{click:function(t){e.dialog=!1}}},[e._v("Cancel")]),a("v-btn",{attrs:{disabled:e.updateDisabled},on:{click:e.updateTablePolicyDefinition}},[e._v("Update")]),a("v-spacer")],1)],1)],1)],1)},bi=[],fi={name:"PolicyAssignmentDialog",props:{currentPolicyDefinition:{type:Object,required:!0},tables:{type:Array,required:!0},bulkAssign:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},mounted(){this.currentSelection=this.currentPolicyDefinition},data(){return{dialog:!1,currentSelection:null}},computed:{displayValue(){return this.bulkAssign?"Bulk Assign":this.currentPolicyDefinition?this.currentPolicyDefinition.name:"n/a"},allPolicyDefinitions(){return this.$store.state.policies.filter(e=>!e.customIdentifier)},updateDisabled(){return!this.bulkAssign&&(!this.currentPolicyDefinition||!this.currentSelection||this.currentPolicyDefinition.id===this.currentSelection.id)}},watch:{},methods:{updateTablePolicyDefinition(){this.dialog=!1;const e=this.tables.reduce((e,t)=>{return e.concat([t.id])},[]);this.$store.commit("assignTablePolicy",{tableIds:e,policyDefinitionId:this.currentSelection.id}),this.$emit("policyAssigned",this.tables)}}},vi=fi,yi=(a("35d9"),a("99d9")),gi=a("2b5d"),xi=a("169a"),ki=Object(y["a"])(vi,hi,bi,!1,null,null,null),Ni=ki.exports;x()(ki,{VBtn:U["a"],VCard:ce["a"],VCardActions:yi["a"],VCardTitle:yi["b"],VCombobox:gi["a"],VDialog:xi["a"],VSpacer:K["a"]});var Ci=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-data-table",{attrs:{items:e.items,"hide-default-footer":!0,"hide-headers":!1,headers:e.headers},scopedSlots:e._u([{key:"items",fn:function(t){return[a("td",{attrs:{align:"right"}},[a("v-icon",{attrs:{color:t.item.expectedColor}},[e._v("fiber_manual_record")])],1),a("td",{attrs:{align:"left"}},[e._v(e._s(t.item.expectedCount))]),a("td",{attrs:{align:"right"}},[a("v-icon",{attrs:{color:t.item.extraColor}},[e._v("fiber_manual_record")])],1),a("td",{attrs:{align:"left"}},[e._v(e._s(t.item.extraCount))]),a("td",{attrs:{align:"right"}},[a("v-icon",{attrs:{color:t.item.missingColor}},[e._v("fiber_manual_record")])],1),a("td",{attrs:{align:"left"}},[e._v(e._s(t.item.missingCount))]),a("td",{attrs:{align:"right"}},[a("v-icon",{attrs:{color:t.item.unexpectedColor}},[e._v("fiber_manual_record")])],1),a("td",{attrs:{align:"left"}},[e._v(e._s(t.item.unexpectedCount))])]}}])})},_i=[],Ti=a("e002");var Si={name:"TablePolicyEvaluatorSummary",mixins:[Ti["a"]],props:{},mounted(){},data(){return{headers:[{text:"",sortable:!1},{text:"expected",sortable:!1},{text:"",sortable:!1},{text:"extra",sortable:!1},{text:"",sortable:!1},{text:"missing",sortable:!1},{text:"",sortable:!1},{text:"unexpected",sortable:!1}]}},computed:{items(){const e=this.tablePolicyEvaluation||{expected:[],missing:[],unexpected:[],extra:[]};return[{expectedCount:e.expected.length,expectedColor:e.expected.length>0?this.grantStatusColors.expected:"grey",missingCount:e.missing.length,missingColor:e.missing.length>0?this.grantStatusColors.missing:"grey",unexpectedCount:e.unexpected.length,unexpectedColor:e.unexpected.length>0?this.grantStatusColors.unexpected:"grey",extraCount:e.extra.length,extraColor:e.extra.length>0?this.grantStatusColors.extra:"grey"}]}},watch:{},methods:{}},Ii=Si,Di=(a("9849"),Object(y["a"])(Ii,Ci,_i,!1,null,null,null)),Ei=Di.exports;x()(Di,{VDataTable:Me["a"],VIcon:M["a"]});var Pi=a("bd5a"),wi={name:"PolicyAssignment",components:{PolicyDefinition:Ua["a"],PolicyAssignmentDialog:Ni,TablePolicyEvaluatorSummary:Ei,TablePolicyCustomizeDialog:Pi["a"],MugenScroll:pi.a},props:{schema:{type:Object,required:!0}},methods:{showCustomizeButton(e){return!!e&&(!e.policyDefinition||!e.policyDefinition.customIdentifier)},expandItems(e){this.expanded=e}},watch:{},computed:{tablesToShow(){return this.schema.schemaTables.map(e=>{const t=this.$store.state.tablePolicyAssignments[e.id].policyDefinitionId,a=this.policies.find(e=>e.id===t);return{...e,policyDefinition:a,policyDefinitionId:t}})},defaultPolicy(){return this.$store.state.defaultPolicy},policies(){return this.$store.state.policies}},data:()=>({loading:!1,selected:[],expanded:[],headers:[{text:"",sortable:!1},{text:"Table Name",sortable:!1,value:"name"},{text:"Assigned Policy",sortable:!1,value:"assignedPolicy"}]})},Ri=wi,Oi=(a("cb8a"),Object(y["a"])(Ri,ui,di,!1,null,null,null)),$i=Oi.exports;x()(Oi,{VDataTable:Me["a"],VToolbar:ie["a"]});var Vi={name:"PolicyAssignment",components:{PolicyAssignmentSchema:$i},methods:{},watch:{},computed:{policies(){return this.$store.state.policies},managedSchemata(){return this.$store.state.managedSchemata.filter(e=>e.schemaTables.length>0).map(e=>{return{...e,schemaTables:e.schemaTables.map(e=>{const t=this.policies.find(t=>t.id===e.policyDefinitionId);return{...e,policyDefinition:t}}).sort((e,t)=>{return e.name<t.name?-1:1})}}).sort((e,t)=>{return e.schemaName<t.schemaName?-1:1})}},data:()=>({mappedSchemata:[]})},ji=Vi,Fi=Object(y["a"])(ji,si,ci,!1,null,null,null),Ai=Fi.exports;x()(Fi,{VContainer:k["a"],VTab:ue["a"],VTabItem:de["a"],VTabs:me["a"]});var qi=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("default-rls-using")],1)},Gi=[],Ui=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-toolbar",[a("v-btn",{attrs:{disabled:e.disabled},on:{click:e.save}},[e._v("Save")]),a("h2",[e._v("Default RLS Using Clause")])],1),a("v-textarea",{attrs:{"auto-grow":"","hide-details":"","background-color":"black"},model:{value:e.defaultRlsUsing,callback:function(t){e.defaultRlsUsing=t},expression:"defaultRlsUsing"}}),a("hr")],1)},Li=[],Bi={name:"DefaultRlsUsingClause",computed:{defaultDefaultRlsUsing(){return this.$store.state.defaultRlsUsing},disabled(){return this.defaultRlsUsing===this.defaultDefaultRlsUsing}},methods:{save(){this.$store.commit("updateDefaultRlsUsing",{defaultRlsUsing:this.defaultRlsUsing})},load(){this.defaultRlsUsing=this.defaultDefaultRlsUsing}},data(){return{defaultRlsUsing:null}},mounted(){this.load()}},zi=Bi,Mi=Object(y["a"])(zi,Ui,Li,!1,null,null,null),Qi=Mi.exports;x()(Mi,{VBtn:U["a"],VContainer:k["a"],VTextarea:ke["a"],VToolbar:ie["a"]});var Ki={name:"SecurityPolicySettings",components:{DefaultRlsUsing:Qi},computed:{},methods:{},data(){return{}}},Wi=Ki,Hi=Object(y["a"])(Wi,qi,Gi,!1,null,null,null),Xi=Hi.exports;x()(Hi,{VContainer:k["a"]});var Ji=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-tabs",{attrs:{dark:"","slider-color":"yellow"}},[e._l(e.allPolicies,(function(t){return a("v-tab",{key:t.name,attrs:{ripple:""}},[e._v("\n      "+e._s(t.name)+"\n    ")])})),e._l(e.allPolicies,(function(t){return a("v-tab-item",{key:t.name,attrs:{lazy:""}},[a("script-viewer",{attrs:{scriptText:t.policy,skipFormat:""},on:{"readability-changed":e.policyReadabilityChanged}})],1)}))],2)],1)},Yi=[],Zi=a("ee5d"),el=a("2f62"),tl={name:"SchemaSecurityScripts",mixins:[Zi["a"]],components:{ScriptViewer:rt["a"]},props:{},computed:{...Object(el["b"])(["policies","managedSchemata"])},watch:{policyReadability(){this.calculateAllPolicies()}},methods:{policyReadabilityChanged(e){this.policyReadability=e},handleCopyStatus(e){alert(e)},refresh(e){this.calculateAllPolicies()},expand(e){e.policy=`${e.policy} `},calcOnePolicy(e){return e.sort((e,t)=>{return e.tablename<t.tablename?-1:1}).reduce((e,t)=>{const a=this.policies.find(e=>e.id===this.$store.state.tablePolicyAssignments[t.id].policyDefinitionId),n={schemaName:t.tableSchema,tableName:t.tablename},i=this.computePolicy(a,this.policyReadability,n,t);return e.concat(i)},"")},calculateAllPolicies(){const e="One Script To Rule Them All",t=this.managedSchemata.filter(e=>!e.parked).reduce((e,t)=>{const a=t.schemaTables,n={name:`${t.schemaName}`,policy:this.calcOnePolicy(a)};return e.concat([n])},[]).sort((e,t)=>{return e.name<t.name?-1:1}),a=t.reduce((e,t)=>{return e.concat(t.policy)},"");this.allPolicies=[...t,{name:e,policy:a}]},policyText(e){return e.policy},onCopy:function(){alert("Copied!")},onError:function(e){alert("Failed to copy scripts to clipboard"),console.error(e)},executeSql(){alert("not implemented:  server config value will expose graphile extension to execute generated script")}},data:()=>({allPolicies:[],schemaPolicy:"NOT CALCULATED",defaultRlsPolicies:"NOT CALCULATED",defaultNoRlsPolicies:"NOT CALCULATED",selectedTabName:"",policyReadability:"terse"}),mounted(){this.calculateAllPolicies()}},al=tl,nl=Object(y["a"])(al,Ji,Yi,!1,null,null,null),il=nl.exports;x()(nl,{VContainer:k["a"],VTab:ue["a"],VTabItem:de["a"],VTabs:me["a"]});var ll=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-toolbar",[a("v-dialog",{attrs:{persistent:"","max-width":"290"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[a("v-btn",e._g({attrs:{color:"primary",dark:""}},n),[e._v("New Policy Template")])]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[a("v-card-title",{staticClass:"headline"},[e._v("New Policy")]),a("v-text-field",{attrs:{label:"Name"},model:{value:e.newPolicyName,callback:function(t){e.newPolicyName=t},expression:"newPolicyName"}}),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"green darken-1",flat:""},on:{click:e.saveNewPolicy}},[e._v("Save")]),a("v-btn",{attrs:{color:"green darken-1",flat:""},on:{click:function(t){e.dialog=!1}}},[e._v("Cancel")])],1)],1)],1)],1),a("v-data-table",{attrs:{headers:e.headers,items:e.policies,"item-key":"id",dense:"","disable-pagination":"","disable-sort":"","hide-default-footer":"","show-expand":""},scopedSlots:e._u([{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.headers.length+1}},[a("policy-definition",{key:t.item.id,attrs:{policyId:t.item.id}})],1)]}}])})],1)},rl=[],ol=a("a985"),sl=ol["a"],cl=a("8654"),ul=Object(y["a"])(sl,ll,rl,!1,null,null,null),dl=ul.exports;x()(ul,{VBtn:U["a"],VCard:ce["a"],VCardActions:yi["a"],VCardTitle:yi["b"],VDataTable:Me["a"],VDialog:xi["a"],VSpacer:K["a"],VTextField:cl["a"],VToolbar:ie["a"]});var ml={name:"TableSecurityView",components:{SecurityPolicySettings:Xi,SchemaSecurityScripts:il,PolicyManager:dl,PolicyAssignment:Ai},props:{},computed:{},data:()=>({activeTab:0})},pl=ml,hl=a("0e8f"),bl=a("a722"),fl=Object(y["a"])(pl,ri,oi,!1,null,null,null),vl=fl.exports;x()(fl,{VCard:ce["a"],VContainer:k["a"],VFlex:hl["a"],VLayout:bl["a"],VTab:ue["a"],VTabItem:de["a"],VTabs:me["a"]});var yl=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{"ma-0":"","pa-0":""}},[a("h1",[e._v("Function Security Manager")]),a("hr"),a("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("v-tab",{key:"policyAssignment",attrs:{ripple:""}},[e._v("\n      Policy Assignment\n    ")]),a("v-tab-item",{key:"policyAssignment",attrs:{lazy:""}},[a("v-card",[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("v-card",{key:"policyAssignment"},[a("policy-assignment")],1)],1)],1)],1)],1),a("v-tab",{key:"policies",attrs:{ripple:""}},[e._v("\n      Schema Security Scripts\n    ")]),a("v-tab-item",{key:"policies",attrs:{lazy:""}},[a("v-card",[a("schema-security-scripts")],1)],1),a("v-tab",{key:"policy-manager",attrs:{ripple:""}},[e._v("\n      Policy Templates\n    ")]),a("v-tab-item",{key:"policy-manager",attrs:{lazy:""}},[a("v-card",[a("policy-manager")],1)],1)],1)],1)},gl=[],xl=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-toolbar",[a("v-dialog",{attrs:{persistent:"","max-width":"290"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[a("v-btn",e._g({attrs:{color:"primary",dark:""}},n),[e._v("New Policy Template")])]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[a("v-card-title",{staticClass:"headline"},[e._v("New Policy")]),a("v-text-field",{attrs:{label:"Name"},model:{value:e.newPolicyName,callback:function(t){e.newPolicyName=t},expression:"newPolicyName"}}),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"green darken-1",text:""},on:{click:e.saveNewPolicy}},[e._v("Save")]),a("v-btn",{attrs:{color:"green darken-1",text:""},on:{click:function(t){e.dialog=!1}}},[e._v("Cancel")])],1)],1)],1)],1),a("v-data-table",{attrs:{headers:e.headers,items:e.policies,"item-key":"id",dense:"","disable-pagination":"","disable-sort":"","hide-default-footer":"","show-expand":""},scopedSlots:e._u([{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.headers.length+1}},[a("policy-definition",{key:t.item.id,attrs:{policyId:t.item.id}})],1)]}}])})],1)},kl=[],Nl=a("03f5"),Cl=Nl["a"],_l=Object(y["a"])(Cl,xl,kl,!1,null,null,null),Tl=_l.exports;x()(_l,{VBtn:U["a"],VCard:ce["a"],VCardActions:yi["a"],VCardTitle:yi["b"],VDataTable:Me["a"],VDialog:xi["a"],VSpacer:K["a"],VTextField:cl["a"],VToolbar:ie["a"]});var Sl=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-tabs",{attrs:{dark:"","slider-color":"yellow"}},[e._l(e.managedSchemata,(function(t){return a("v-tab",{key:t.schemaName,attrs:{ripple:""}},[e._v("\n      "+e._s(t.schemaName)+"\n    ")])})),e._l(e.managedSchemata,(function(e){return a("v-tab-item",{key:e.schemaName},[a("function-policy-assignment-schema",{attrs:{schema:e}})],1)}))],2)],1)},Il=[],Dl=a("82cd"),El=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-dialog",{attrs:{persistent:"",width:"800"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[a("v-btn",e._g({staticClass:"text-none",attrs:{dark:"",disabled:e.disabled}},n),[e._v("\n        "+e._s(e.displayValue)+"\n      ")])]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[a("v-card-title",{staticClass:"headline"},[e._v("Assign Policy")]),a("v-combobox",{attrs:{items:e.allPolicyDefinitions,"item-text":"name","item-value":"id"},model:{value:e.currentSelection,callback:function(t){e.currentSelection=t},expression:"currentSelection"}}),a("v-card-actions",[a("v-spacer"),a("v-btn",{on:{click:function(t){e.dialog=!1}}},[e._v("Cancel")]),a("v-btn",{attrs:{disabled:e.updateDisabled},on:{click:e.updateTablePolicyDefinition}},[e._v("Update")]),a("v-spacer")],1)],1)],1)],1)},Pl=[],wl={name:"FunctionAssignmentDialog",props:{currentPolicyDefinition:{type:Object,required:!0},functions:{type:Array,required:!0},bulkAssign:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},mounted(){this.currentSelection=this.currentPolicyDefinition},data(){return{dialog:!1,expanded:[],currentSelection:null}},computed:{displayValue(){return this.bulkAssign?"Bulk Assign":this.currentPolicyDefinition?this.currentPolicyDefinition.name:"n/a"},allPolicyDefinitions(){return this.$store.state.functionPolicies},updateDisabled(){return!this.bulkAssign&&(!this.currentPolicyDefinition||!this.currentSelection||this.currentPolicyDefinition.id===this.currentSelection.id)}},watch:{},methods:{updateTablePolicyDefinition(){this.dialog=!1;const e=this.functions.reduce((e,t)=>{return e.concat([t.id])},[]);this.$store.commit("assignFunctionPolicy",{functionIds:e,policyDefinitionId:this.currentSelection.id}),this.$emit("policyAssigned",this.functions)}}},Rl=wl,Ol=(a("a789"),Object(y["a"])(Rl,El,Pl,!1,null,null,null)),$l=Ol.exports;x()(Ol,{VBtn:U["a"],VCard:ce["a"],VCardActions:yi["a"],VCardTitle:yi["b"],VCombobox:gi["a"],VDialog:xi["a"],VSpacer:K["a"]});var Vl=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-toolbar",[a("policy-assignment-dialog",{attrs:{currentPolicyDefinition:e.defaultPolicy,functions:e.selected,bulkAssign:!0,disabled:0===e.selected.length}})],1),a("v-data-table",{attrs:{headers:e.headers,items:e.functionsToShow,"item-key":"id",dense:"","disable-pagination":"","disable-sort":"","hide-default-footer":"","show-select":"","show-expand":""},scopedSlots:e._u([{key:"item.name",fn:function(t){var a=t.item;return[e._v("\n        "+e._s(a.functionName)+"\n      ")]}},{key:"item.assignedPolicy",fn:function(t){var n=t.item;return[a("policy-assignment-dialog",{attrs:{currentPolicyDefinition:n.policyDefinition,functions:[n]},on:{policyAssigned:e.expandItems}})]}},{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.headers.length+2}},[a("policy-definition",{attrs:{policyId:t.item.policyDefinition.id,aFunction:t.item}})],1)]}}]),model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}})],1)},jl=[],Fl={name:"FunctionAssignment",components:{PolicyDefinition:Dl["a"],PolicyAssignmentDialog:$l},props:{schema:{type:Object,required:!0}},methods:{expandItems(e){this.expanded=e}},watch:{},computed:{functionsToShow(){return this.schema.schemaFunctions.map(e=>{const t=this.$store.state.functionPolicyAssignments[e.id].policyDefinitionId,a=this.$store.state.functionPolicies.find(e=>e.id===t);return{...e,policyDefinition:a,policyDefinitionId:t}})},selectAllValue(){return this.schema.schemaFunctions.length===this.selected.length},defaultPolicy(){return this.$store.state.defaultFunctionPolicy}},data:()=>({selected:[],headers:[{text:"",sortable:!1},{text:"",sortable:!1},{text:"Function Name",sortable:!1,value:"functionName"},{text:"Policy Name",sortable:!1,value:"assignedPolicy"}]})},Al=Fl,ql=Object(y["a"])(Al,Vl,jl,!1,null,null,null),Gl=ql.exports;x()(ql,{VDataTable:Me["a"],VToolbar:ie["a"]});var Ul={name:"FunctionAssignment",components:{PolicyDefinition:Dl["a"],PolicyAssignmentDialog:$l,FunctionPolicyAssignmentSchema:Gl},methods:{},watch:{},computed:{functionPolicies(){return this.$store.state.functionPolicies},managedSchemata(){return this.$store.state.managedSchemata.map(e=>{return{...e,schemaFunctions:e.schemaFunctions.map(e=>{const t=this.functionPolicies.find(t=>t.id===e.functionPolicyDefinitionId);return{...e,policyDefinition:t}}).sort((e,t)=>{return e.functionname<t.functionname?-1:1})}}).sort((e,t)=>{return e.schemaName<t.schemaName?-1:1})}},data:()=>({mappedSchemata:[],headers:[{text:"",sortable:!1},{text:"Function Name",sortable:!1},{text:"Policy Name",sortable:!1}]})},Ll=Ul,Bl=Object(y["a"])(Ll,Sl,Il,!1,null,null,null),zl=Bl.exports;x()(Bl,{VTab:ue["a"],VTabItem:de["a"],VTabs:me["a"]});var Ml=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-tabs",{attrs:{dark:"","slider-color":"yellow"}},[e._l(e.allPolicies,(function(t){return a("v-tab",{key:t.name,attrs:{ripple:""}},[e._v("\n      "+e._s(t.name)+"\n    ")])})),e._l(e.allPolicies,(function(t){return a("v-tab-item",{key:t.name},[a("script-viewer",{attrs:{scriptText:t.policy,skipFormat:""},on:{"readability-changed":e.readabilityChanged}})],1)}))],2)],1)},Ql=[],Kl=a("77d3"),Wl={name:"SchemaSecurityScripts",mixins:[Kl["a"]],components:{ScriptViewer:rt["a"]},props:{},computed:{...Object(el["b"])(["functionPolicies","managedSchemata"])},watch:{functionPolicies(){this.calculateAllPolicies()},policyReadability(){this.calculateAllPolicies()}},methods:{readabilityChanged(e){this.policyReadability=e},refresh(){this.doComputePolicy()},expand(){this.computedPolicy=`${this.computedPolicy} `},calcOnePolicy(e){const t=e.sort((e,t)=>{return e.functionname<t.functionname?-1:1}).reduce((e,t)=>{const a=this.functionPolicies.find(e=>e.id===this.$store.state.functionPolicyAssignments[t.id].policyDefinitionId),n={},i=this.computePolicy(a,this.policyReadability,n,t);return e.concat(i)},"");return t},calculateAllPolicies(){const e="One Script To Rule Them All",t=this.managedSchemata.filter(e=>!e.parked).reduce((e,t)=>{const a=t.schemaFunctions,n={name:`${t.schemaName}`,policy:this.calcOnePolicy(a)};return e.concat([n])},[]).sort((e,t)=>{return e.name<t.name?-1:1}),a=t.reduce((e,t)=>{return e.concat(t.policy)},"");this.allPolicies=[...t,{name:e,policy:a}]},policyText(e){return e.policy},onCopy:function(){alert("Copied!")},onError:function(e){alert("Failed to copy scripts to clipboard"),console.error(e)},executeSql(){alert("not implemented:  server config value will expose graphile extension to execute generated script")}},data:()=>({allPolicies:[],schemaPolicy:"NOT CALCULATED",defaultRlsPolicies:"NOT CALCULATED",defaultNoRlsPolicies:"NOT CALCULATED",selectedTabName:"",policyReadability:"terse"}),mounted(){this.calculateAllPolicies()}},Hl=Wl,Xl=Object(y["a"])(Hl,Ml,Ql,!1,null,null,null),Jl=Xl.exports;x()(Xl,{VContainer:k["a"],VTab:ue["a"],VTabItem:de["a"],VTabs:me["a"]});var Yl={name:"FunctionSecurityView",components:{SchemaSecurityScripts:Jl,PolicyManager:Tl,PolicyAssignment:zl},props:{},computed:{},data:()=>({activeTab:null})},Zl=Yl,er=Object(y["a"])(Zl,yl,gl,!1,null,null,null),tr=er.exports;x()(er,{VCard:ce["a"],VContainer:k["a"],VFlex:hl["a"],VLayout:bl["a"],VTab:ue["a"],VTabItem:de["a"],VTabs:me["a"]});var ar=a("858e"),nr={name:"SecurityView",components:{FunctionSecurityView:tr,TableSecurityView:vl,RoleFilter:li,pdf:ar["a"]},props:{},computed:{initializing(){return this.$store.state.initializing||0===this.$store.state.projectRoles.length}},data:()=>({activeTab:0}),watch:{},methods:{},mounted(){this.activeTab=this.$store.state.projectRoles.length>0?0:2}},ir=nr,lr=Object(y["a"])(ir,Fn,An,!1,null,null,null),rr=lr.exports;x()(lr,{VCard:ce["a"],VCol:Ae["a"],VContainer:k["a"],VRow:qe["a"],VTab:ue["a"],VTabItem:de["a"],VTabs:me["a"]});var or=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{"ma-0":"","pa-0":""}},[a("h2",[e._v("Enter a search term to find functions of interest")]),a("v-text-field",{attrs:{label:"Search Term"},model:{value:e.searchTerm,callback:function(t){e.searchTerm=t},expression:"searchTerm"}}),a("hr"),a("function-list",{attrs:{functions:e.functions}})],1)},sr=[],cr=(a("ab3b"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-data-table",{attrs:{headers:e.headers,items:e.functions,"item-key":"id",dense:"","disable-pagination":"","disable-sort":"","hide-default-footer":"","show-expand":""},scopedSlots:e._u([{key:"item.blankLink",fn:function(t){var n=t.item;return[a("router-link",{attrs:{to:{name:"function",params:{id:n.id}},target:"_blank"}},[a("v-icon",[e._v("launch")])],1)]}},{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.headers.length+1}},[a("function",{attrs:{id:t.item.id}})],1)]}}])})}),ur=[],dr={name:"FunctionList",components:{Function:Ra["a"]},props:{functions:{type:Array,required:!0}},computed:{},data:()=>({headers:[{text:"",sortable:!1},{text:"schema",sortable:!1,value:"functionSchema"},{text:"function",sortable:!1,value:"functionName"},{text:"",sortable:!1,value:"blankLink"}]}),methods:{}},mr=dr,pr=Object(y["a"])(mr,cr,ur,!1,null,null,null),hr=pr.exports;x()(pr,{VDataTable:Me["a"],VIcon:M["a"]});var br={name:"SearchView",components:{FunctionList:hr},props:{},computed:{disabled(){return void 0===this.searchTerm||null===this.searchTerm||""===this.searchTerm},allFunctions(){return this.$store.state.managedSchemata.reduce((e,t)=>{return[...e,...t.schemaFunctions]},[])},functions(){return this.allFunctions.filter(e=>{return-1!==e.functionSchema.toLowerCase().indexOf(this.searchTerm.toLowerCase())||-1!==e.functionName.toLowerCase().indexOf(this.searchTerm.toLowerCase())||-1!==e.definition.toLowerCase().indexOf(this.searchTerm.toLowerCase())})}},watch:{},data:()=>({searchTerm:""}),methods:{}},fr=br,vr=Object(y["a"])(fr,or,sr,!1,null,null,null),yr=vr.exports;x()(vr,{VContainer:k["a"],VTextField:cl["a"]});var gr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("h1",[e._v("Settings")]),a("h2",{staticStyle:{color:"red"}},[e._v("Under Construction")]),a("hr"),a("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("v-tab",{key:"table-policy-template",attrs:{ripple:""}},[e._v("\n      Table Policy Template\n    ")]),a("v-tab-item",{key:"table-policy-template"},[a("security-policy-settings")],1)],1)],1)},xr=[],kr={name:"Settings",components:{SecurityPolicySettings:Xi},props:{},computed:{},data:()=>({activeTab:null})},Nr=kr,Cr=Object(y["a"])(Nr,gr,xr,!1,null,null,null),_r=Cr.exports;x()(Cr,{VContainer:k["a"],VTab:ue["a"],VTabItem:de["a"],VTabs:me["a"]});var Tr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{"ma-0":"","pa-0":""}},[a("constraints-and-indices-manager")],1)},Sr=[],Ir=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-card",[a("v-container",{attrs:{"bkeepground-color":"blkeep"}},[a("v-tabs",{attrs:{dark:"","slider-color":"yellow"}},[e._l(e.managedSchemata,(function(t){return a("v-tab",{key:t.schemaName,attrs:{ripple:""}},[e._v("\n        "+e._s(t.schemaName)+"\n      ")])})),e._l(e.managedSchemata,(function(e){return a("v-tab-item",{key:e.schemaName},[a("constraints-and-indices",{attrs:{tableSchema:e.schemaName}})],1)})),a("v-tab",{key:"allSchemata",attrs:{ripple:""}},[e._v("\n        All Schemata\n      ")]),a("v-tab-item",{key:"allSchemata"},[a("constraints-and-indices")],1)],2)],1)],1)},Dr=[];const Er="AS_EXPECTED",Pr="NO_INDEX",wr="UNEXPECTED_NAME",Rr="EXTRA_INDEX",Or="green",$r="yellow",Vr="blue",jr="red";var Fr={name:"ConstraintsAndIndicesManager",components:{ConstraintsAndIndices:Tn},methods:{columnIndexStatusColor(e){switch(e){case Er:return Or;case Pr:return $r;case wr:return Vr;case Rr:break}}},watch:{},computed:{policies(){return this.$store.state.policies},managedSchemata(){return this.$store.state.managedSchemata.sort((e,t)=>{return e.schemaName<t.schemaName?-1:1})},headers(){return[{text:"",sortable:!1},{text:"Table Name",sortable:!1},...this.statusMap.map(e=>{return{text:e.name,sortable:!1}})]}},data:()=>({mappedSchemata:[],statusMap:[{name:Er,columnIndexStatusColor:Or,defaultActions:{}},{name:Pr,columnIndexStatusColor:$r,defaultActions:{ack:!1,create:!1}},{name:wr,columnIndexStatusColor:Vr,defaultActions:{ack:!1,rename:!0}},{name:Rr,columnIndexStatusColor:jr,defaultActions:{ack:!1,drop:!1}}]})},Ar=Fr,qr=Object(y["a"])(Ar,Ir,Dr,!1,null,null,null),Gr=qr.exports;x()(qr,{VCard:ce["a"],VContainer:k["a"],VTab:ue["a"],VTabItem:de["a"],VTabs:me["a"]});var Ur={name:"ForeignKeyIndexView",components:{ConstraintsAndIndicesManager:Gr},props:{},computed:{},data:()=>({activeTab:null})},Lr=Ur,Br=Object(y["a"])(Lr,Tr,Sr,!1,null,null,null),zr=Br.exports;x()(Br,{VContainer:k["a"]});var Mr=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},Qr=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("h1",[e._v("A tool to ensure that all "),a("a",{attrs:{href:"https://www.graphile.org/postgraphile/smart-comments/",target:"_blank"}},[e._v("smart comments")]),e._v(" are properly configured to support postgraphile")])])}],Kr={name:"SmartCommentManager"},Wr=Kr,Hr=Object(y["a"])(Wr,Mr,Qr,!1,null,null,null),Xr=Hr.exports,Jr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("h1",[e._v("Export Project")]),a("v-toolbar",[a("v-btn",{on:{click:e.exportProject}},[e._v("Save")])],1),a("v-textarea",{attrs:{value:e.projectJson,"auto-grow":"",readonly:""}})],1)},Yr=[],Zr={name:"ExportProject",components:{},props:{},computed:{projectName(){return this.project?this.project.name:"N/A"},projectJson(){return JSON.stringify(this.$store.state,0,2)}},methods:{exportProject:function(){const e=this.projectJson,t=new Blob([e],{type:"text/plain"}),a=document.createEvent("MouseEvents"),n=document.createElement("a");n.download="pgdbi.json",n.href=window.URL.createObjectURL(t),n.dataset.downloadurl=["text/json",n.download,n.href].join(":"),a.initEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),n.dispatchEvent(a)}}},eo=Zr,to=Object(y["a"])(eo,Jr,Yr,!1,null,null,null),ao=to.exports;x()(to,{VBtn:U["a"],VTextarea:ke["a"],VToolbar:ie["a"]});var no=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},io=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("h1",[e._v("Sqitch")])])}],lo={},ro=Object(y["a"])(lo,no,io,!1,null,null,null),oo=ro.exports,so=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},co=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("h1",[e._v("Graphile Worker")])])}],uo={},mo=Object(y["a"])(uo,so,co,!1,null,null,null),po=mo.exports,ho=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("h1",[e._v(e._s(e.id))]),a("hr"),a("script-viewer",{attrs:{scriptText:e.definition,showDeclarationVisibility:!1,showReadability:!1,skipFormat:""}})],1)},bo=[],fo={name:"Enum",components:{ScriptViewer:rt["a"]},props:{id:{type:String,required:!0}},computed:{definition(){return this.ENUM.enumDefinition}},data:()=>({ENUM:{enumDefinition:"N/A"}}),methods:{onCopy:function(e){alert("Copied!")},onError:function(e){alert("Failed to copy texts")},setEnum(){const e=this.id.split(".")[0],t=this.$store.state.managedSchemata.find(t=>t.schemaName===e);this.ENUM=t.schemaEnums.find(e=>e.id===this.id)}},mounted(){this.setEnum()},beforeRouteUpdate(e,t,a){this.setEnum(),a()}},vo=fo,yo=Object(y["a"])(vo,ho,bo,!1,null,null,null),go=yo.exports;x()(yo,{VContainer:k["a"]});var xo=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("h1",[e._v(e._s(e.id))]),a("hr"),a("script-viewer",{attrs:{scriptText:e.definition,showDeclarationVisibility:!1,showReadability:!1,skipFormat:""}})],1)},ko=[],No={name:"Udt",components:{ScriptViewer:rt["a"]},props:{id:{type:String,required:!0}},computed:{definition(){return this.UDT.udtDefinition}},data:()=>({UDT:{udtDefinition:"N/A"}}),methods:{onCopy:function(e){alert("Copied!")},onError:function(e){alert("Failed to copy texts")},setUdt(){const e=this.id.split(".")[0],t=this.$store.state.managedSchemata.find(t=>t.schemaName===e);this.UDT=t.schemaUdts.find(e=>e.id===this.id)}},mounted(){this.setUdt()},beforeRouteUpdate(e,t,a){this.setUdt(),a()}},Co=No,_o=Object(y["a"])(Co,xo,ko,!1,null,null,null),To=_o.exports;x()(_o,{VContainer:k["a"]});var So=a("0e44"),Io={pgdbiOtions:{},initializing:!0,schemaFilterOn:!0,policies:[],tablePolicyAssignments:{},functionPolicies:[],functionPolicyAssignments:{},defaultPolicy:null,defaultFunctionPolicy:null,genericIndexEvaluations:{},fkIndexEvaluations:{singleColumn:{},multiColumn:{}},uqIndexEvaluations:{singleColumn:{},multiColumn:{}},indicesToDrop:{},indexEvaluations:{},managedSchemata:[],parkedSchemata:[],rawSchemata:[],schemaFilter:[],enabledRoles:[],projectRoles:[],ignoredRoles:[],selectedRoleFamilies:[],defaultRlsUsing:"( owner_id = viewer_id() )",defaultRlsWithCheck:"",defaultRlsQualifiers:{all:{policies:[]},select:{policies:[]},insert:{policies:[]},update:{policies:[]},delete:{policies:[]}},defaultRoleGrants:{select:"DENIED",insert:"DENIED",update:"DENIED",delete:"DENIED"},functionPolicyHeaderTemplate:"\n  ----------  BEGIN: {{schemaName}}.{{functionName}}\n  \n  ",functionPolicyFooterTemplate:"\n\n  ----------  END: {{schemaName}}.{{functionName}}",defaultFunctionRoleGrants:{execute:"DENIED"}};function Do(e){Object.keys(Io).forEach(t=>{e[t]=Io[t]})}var Eo=Do;function Po(e){e.schemaFilterOn=!0}var wo=Po;function Ro(e,t){return{tableId:e,policyDefinitionId:t,evaluation:{status:"PASS",errors:[]}}}function Oo(e,t){const a=t.tableIds,n=t.policyDefinitionId;a.forEach(t=>{e.tablePolicyAssignments[t]=Ro(t,n)})}var $o=Oo;function Vo(e,t){return{functionId:e,policyDefinitionId:t,evaluation:{status:"PASS",errors:[]}}}function jo(e,t){const a=t.functionIds,n=t.policyDefinitionId;a.forEach(t=>{e.functionPolicyAssignments[t]=Vo(t,n)})}var Fo=jo,Ao=a("9dbb"),qo=a.n(Ao);function Go(e,t){const a=Object.keys(t).reduce((a,n)=>{const i=e.indexEvaluations[n],l=i?[...i,...t[n]]:t[n];return 0===l.length?a:{...a,[l[0].idxKey]:l}},{});e.indexEvaluations={...e.indexEvaluations,...a}}var Uo=Go;const Lo="NO_INDEX",Bo="MULTIPLE_INDICES";function zo(e){return(e||"").toLowerCase().split(" exists").join(" exists\n    ").split(" on").join("\n  on\n    ").split(" using").join("\n  using").split(" (").join(" (\n    ").split(", ").join(",\n    ").split(");").join("\n);")}const Mo="create index if not exists \n    {{indexName}}\n  on \n    {{tableSchema}}.{{tableName}}\n  using btree(\n    {{indexColumns}}\n  );";function Qo(e){const t=e.managedSchemata.reduce((t,a)=>{return{...t,...a.schemaTables.reduce((t,a)=>{const n=(a.tableColumns||[]).reduce((t,n)=>{const i=(a.referentialConstraints||[]).filter(e=>1===e.referencingColumnUsage.length).filter(e=>{return void 0!==e.referencingColumnUsage.find(e=>e.tableSchema===n.tableSchema&&e.tableName===n.tableName&&e.columnName===n.columnName)}).map(t=>{const i=a.indices.filter(e=>{return e.tableSchema===n.tableSchema&&e.tableName===n.tableName&&1===e.indexColumns.length&&e.indexColumns[0].columnName===n.columnName}),l=0==i.length?Lo:i.length>1?Bo:i[0].indexName,r=l===Lo||l===Bo?"red--text":"green--text",o=`${n.tableSchema}_${n.tableName}_${n.columnName}`,s={create:`---- NEW SINGLE-COLUMN FK-INDEX FOR CONSTRAINT: ${t.constraintName}\n  ${qo.a.render(Mo,{indexName:`idx_${o}`,tableSchema:n.tableSchema,tableName:n.tableName,indexColumns:n.columnName})}\n-----------------------------\n`},c=i.reduce((a,n)=>{const i=Object.keys(e.indicesToDrop).indexOf(n.id)>-1;if(i)return{...a,drop:(a.drop||"").concat(`${n.indexDrop}`)};{const e=`---- EXISTING SINGLE-COLUMN FK-INDEX FOR CONSTRAINT: ${t.constraintName}\n  ${zo(n.indexDefinition)}\n-----------------------------\n`;return{...a,create:(a.create||"").concat(`${e}`)}}},{}),u=void 0===c.drop&&void 0===c.create?s:c,d=t.referencedColumnUsage[0];return{id:t.constraintName,idxKey:o,idxType:"foreign-key",constraintName:t.constraintName,tableSchema:a.tableSchema,tableName:a.tableName,fkTable:`${d.tableSchema}.${d.tableName}`,fkSource:[n.columnName],fkTarget:[`${d.columnName}`],fkIndices:i,fkIndexEvaluation:l,fkTableLinkId:`${d.tableSchema}.${d.tableName}`,evaluation:l,idxColumns:[n.columnName],indices:i,indexDisplayClass:r,desiredRealization:u}});return i.length>0?{...t,[n.id]:i}:t},{});return{...t,...n}},{})}},{});e.fkIndexEvaluations={...e.fkIndexEvaluations,singleColumn:t},Uo(e,t)}function Ko(e){const t=e.managedSchemata.reduce((t,a)=>{return{...t,...a.schemaTables.reduce((t,a)=>{const n=(a.referentialConstraints||[]).filter(e=>e.referencingColumnUsage.length>1).map(t=>{const n=t.referencingColumnUsage.map(e=>e.columnName).join(", "),i=n.split(", ").join("_"),l=t.referencedColumnUsage.map(e=>e.columnName).join(", "),r=a.indices.filter(e=>e.indexColumns.length===t.referencingColumnUsage.length).filter(e=>{const t=e.indkey.map(t=>e.indexColumns.find(e=>e.indkey===t).columnName).join(", ");return t===n}),o=0==r.length?Lo:r.length>1?Bo:r[0].indexName,s=o===Lo||o===Bo?"red--text":"green--text",c={create:`---- NEW MULTI-COLUMN FK-INDEX FOR CONSTRAINT: ${t.constraintName}\n  ${qo.a.render(Mo,{indexName:`idx_${i}`,tableSchema:a.tableSchema,tableName:a.tableName,indexColumns:n.split(", ").join(",\n    ")})}\n-----------------------------\n`},u=r.reduce((a,n)=>{const i=Object.keys(e.indicesToDrop).indexOf(n.id)>-1;if(i)return{...a,drop:(a.drop||"").concat(`${n.indexDrop}`)};{const e=`---- EXISTING MULTI-COLUMN FK-INDEX FOR CONSTRAINT: ${t.constraintName}\n  ${zo(n.indexDefinition)}\n-----------------------------\n`;return{...a,create:(a.create||"").concat(`${e}`)}}},{}),d=void 0===u.drop&&void 0===u.create?c:u,m=t.referencedColumnUsage[0];return{id:t.constraintName,idxKey:i,idxType:"foreign-key",constraintName:t.constraintName,tableSchema:a.tableSchema,tableName:a.tableName,fkTable:`${m.tableSchema}.${m.tableName}`,fkSource:n.split(", "),fkTarget:l.split(", "),fkIndices:r,fkIndexEvaluation:o,fkTableLinkId:`${m.tableSchema}.${m.tableName}`,evaluation:o,idxColumns:n.split(", "),indices:r,indexDisplayClass:s,desiredRealization:d}});return{...t,[a.id]:n}},{})}},{});e.fkIndexEvaluations={...e.fkIndexEvaluations,multiColumn:t},Uo(e,t)}function Wo(e){Qo(e),Ko(e)}var Ho=Wo;const Xo="\ncreate type {{enumSchema}}.{{enumName}} as (\n  {{#enumValues}}\n    '{{value}}'{{comma}}\n  {{/enumValues}}\n);\n";function Jo(e){e.managedSchemata=e.managedSchemata.map(e=>{return{...e,schemaEnums:e.schemaEnums.map(e=>{const t=qo.a.render(Xo,{...e,enumValues:e.enumValues.map((t,a)=>{return{value:t,comma:a===e.enumValues.length-1?"":","}})});return{...e,enumDefinition:t}})}})}var Yo=Jo;const Zo="NO_INDEX",es="MULTIPLE_INDICES";function ts(e){return(e||"").toLowerCase().split(" exists").join(" exists\n    ").split(" on").join("\n  on\n    ").split(" using").join("\n  using").split(" (").join(" (\n    ").split(", ").join(",\n    ").split(");").join("\n);")}const as="create index if not exists \n    {{indexName}}\n  on \n    {{tableSchema}}.{{tableName}}\n  using btree(\n    {{indexColumns}}\n  );";function ns(e){const t=e.managedSchemata.reduce((t,a)=>{return{...t,...a.schemaTables.reduce((t,a)=>{const n=(a.tableColumns||[]).reduce((t,n)=>{const i=(a.uniqueConstraints||[]).filter(e=>1===e.keyColumnUsage.length).filter(e=>{return void 0!==e.keyColumnUsage.find(e=>e.tableSchema===n.tableSchema&&e.tableName===n.tableName&&e.columnName===n.columnName)}).map(t=>{const i=a.indices.filter(e=>1===e.indexColumns.length).filter(e=>e.indexColumns[0].columnName===n.columnName),l=t.keyColumnUsage[0],r=t.keyColumnUsage[0].columnName,o=0==i.length?Zo:i.length>1?es:i[0].indexName,s=o===Zo||o===es?"red--text":"green--text",c=`${l.tableSchema}_${l.tableName}_${l.columnName}`,u={create:`---- NEW SINGLE-COLUMN UNIQUE-INDEX FOR CONSTRAINT: ${l.constraintName}\n  ${qo.a.render(as,{indexName:`idx_${c}`,tableSchema:n.tableSchema,tableName:n.tableName,indexColumns:n.columnName})}\n-----------------------------\n`},d=i.reduce((t,a)=>{const n=Object.keys(e.indicesToDrop).indexOf(a.id)>-1;if(n)return{...t,drop:(t.drop||"").concat(`${a.indexDrop}`)};{const e=`---- EXISTING SINGLE-COLUMN UNIQUE-INDEX FOR CONSTRAINT: ${l.constraintName}\n  ${ts(a.indexDefinition)}\n-----------------------------\n`;return{...t,create:(t.create||"").concat(`${e}`)}}},{}),m=void 0===d.drop&&void 0===d.create?u:d;return{id:t.constraintName,idxKey:c,idxType:"unique",constraintName:t.constraintName,tableSchema:a.tableSchema,tableName:a.tableName,uqSource:r,uqPath:c,uqTableId:`${l.tableSchema}.${l.tableName}`,uqIndices:i,uqIndexEvaluation:o,evaluation:o,idxColumns:[n.columnName],indices:i,indexDisplayClass:s,desiredRealization:m}});return i.length>0?{...t,[n.id]:i}:t},{});return{...t,...n}},{})}},{});e.uqIndexEvaluations={...e.uqIndexEvaluations,singleColumn:t},Uo(e,t)}function is(e){const t=e.managedSchemata.reduce((t,a)=>{return{...t,...a.schemaTables.reduce((t,a)=>{const n=(a.uniqueConstraints||[]).filter(e=>e.keyColumnUsage.length>1).map(t=>{const n=t.keyColumnUsage.sort((e,t)=>{return e.columnName<t.columnName?-1:1}).map(e=>e.columnName).join(", "),i=`${a.tableSchema}_${a.tableName}_${n.split(", ").join("_")}`,l=a.indices.filter(e=>e.indexColumns.length===t.keyColumnUsage.length).filter(e=>{const t=e.indkey.map(t=>e.indexColumns.find(e=>e.indkey===t).columnName).join(", ");return t===n}),r=0==l.length?Zo:l.length>1?es:l[0].indexName,o=r===Zo||r===es?"red--text":"green--text",s=t.keyColumnUsage[0],c={create:`---- NEW MULTI-COLUMN UNIQUE-INDEX FOR CONSTRAINT: ${s.constraintName}\n  ${qo.a.render(as,{indexName:`idx_${i}`,tableSchema:a.tableSchema,tableName:a.tableName,indexColumns:n.split(", ").join(",\n    ")})}\n-----------------------------\n`},u=l.reduce((t,a)=>{const n=Object.keys(e.indicesToDrop).indexOf(a.id)>-1;if(n)return{...t,drop:(t.drop||"").concat(`${a.indexDrop}`)};{const e=`---- EXISTING MULTI-COLUMN UNIQUE-INDEX FOR CONSTRAINT: ${s.constraintName}\n  ${ts(a.indexDefinition)}\n-----------------------------\n`;return{...t,create:(t.create||"").concat(`${e}`)}}},{}),d=void 0===u.drop&&void 0===u.create?c:u;return{id:t.constraintName,idxKey:i,idxType:"unique",constraintName:t.constraintName,tableSchema:a.tableSchema,tableName:a.tableName,uqPath:`${s.tableSchema}_${s.tableName}_${s.columnName}`,uqTableId:`${s.tableSchema}.${s.tableName}`,uqSource:n,uqIndices:l,uqIndexEvaluation:r,evaluation:r,idxColumns:n.split(", "),indices:l,indexDisplayClass:o,desiredRealization:d}});return{...t,[a.id]:n}},{})}},{});e.uqIndexEvaluations={...e.uqIndexEvaluations,multiColumn:t};const a=Object.values(t).reduce((e,t)=>{const a=t.reduce((e,t)=>{return{...e,[t.idxKey]:[t]}},{});return{...e,...a}},{});Uo(e,a)}function ls(e){ns(e),is(e)}var rs=ls;const os="MULTIPLE_INDICES";function ss(e){const t=e.managedSchemata.reduce((t,a)=>{return{...t,...a.schemaTables.reduce((t,a)=>{const n=(a.indices||[]).reduce((t,a)=>{const n=a.indkey.map(e=>a.indexColumns.find(t=>t.indkey===e).columnName).join(", "),i=`${a.tableSchema}_${a.tableName}_${n}`,l=t[i],r=Object.keys(e.indicesToDrop).indexOf(a.id)>-1,o=r?{drop:`---- DROP EXISTING GENERAL INDEX: \n${a.indexDrop}\n\n`,create:""}:{drop:"",create:`---- EXISTING GENERAL INDEX: \n${a.indexDefinition}\n\n`},s=o,c=l?{...l,indexDisplayClass:"red--text",evaluation:os,indices:[...l.indices,a],desiredRealization:{drop:l.desiredRealization.drop.concat(o.drop),create:l.desiredRealization.create.concat(o.create)}}:{id:i,idxKey:i,idxType:"generic",idxColumns:n.split(", "),tableKey:`${a.tableSchema}.${a.tableName}`,tableSchema:`${a.tableSchema}`,tableName:`${a.tableName}`,indexDisplayClass:"green--text",evaluation:n,indices:[a],desiredRealization:s};return{...t,[i]:c}},{});return{...t,...n}},{})}},{});e.genericIndexEvaluations=t}var cs=ss;const us="\ncreate type {{udtSchema}}.{{udtName}} as (\n  {{#fields}}\n    {{fieldName}} {{dataType}}{{comma}}\n  {{/fields}}\n);\n";function ds(e){e.managedSchemata=e.managedSchemata.map(e=>{return{...e,schemaUdts:e.schemaUdts.map(e=>{const t=qo.a.render(us,{...e,fields:e.fields.map((t,a)=>{return{...t,comma:a===e.fields.length-1?"":","}})});return{...e,udtDefinition:t}})}})}var ms=ds;function ps(e){Ho(e),rs(e),cs(e),Yo(e),ms(e)}var hs=ps;function bs(e){if(!e.defaultPolicy){const t={id:1e4*(new Date).getTime()+621355968e9,name:"Default Table Policy - NO ACCESS",policyHeaderTemplate:e.policyHeaderTemplate,policyFooterTemplate:e.policyFooterTemplate,roleTableGrantTemplate:e.roleTableGrantTemplate,enableRls:!1,columnExclusionOverrides:{insert:[],update:[]},columnExclusions:{insert:{},update:{}},roleGrants:e.projectRoles.reduce((t,a)=>{return{...t,[a.roleName]:e.defaultRoleGrants}},{}),rlsQualifiers:e.projectRoles.reduce((t,a)=>{return{...t,[a.roleName]:e.defaultRlsQualifiers}},{})};e.defaultPolicy=t,e.policies=e.policies.concat([t])}}function fs(e){if(!e.defaultFunctionPolicy){const t={id:1e4*(new Date).getTime()+621355968e9,name:"Default Function Policy - NO ACCESS",functionPolicyHeaderTemplate:e.functionPolicyHeaderTemplate,functionPolicyFooterTemplate:e.functionPolicyFooterTemplate,roleFunctionGrants:e.projectRoles.reduce((t,a)=>{return{...t,[a.roleName]:e.defaultFunctionRoleGrants}},{})};e.defaultFunctionPolicy=t,e.functionPolicies=e.functionPolicies.concat([t])}}function vs(e,t){const a=t.reduce((t,a)=>{return[...t,...a.schemaTables.filter(t=>void 0===e.tablePolicyAssignments[t.id]).map(e=>e.id)]},[]);$o(e,{tableIds:a,policyDefinitionId:e.defaultPolicy.id})}function ys(e,t){const a=t.reduce((t,a)=>{return[...t,...a.schemaFunctions.filter(t=>void 0===e.functionPolicyAssignments[t.id]).map(e=>e.id)]},[]);Fo(e,{functionIds:a,policyDefinitionId:e.defaultFunctionPolicy.id})}function gs(e,t){bs(e),fs(e),vs(e,t),ys(e,t),e.managedSchemata=t,hs(e),e.initializing=!1,e.schemaFilterOn=!1}var xs=gs;function ks(e,t){const a=e.projectRoles=t.projectRoles.map(e=>{return{...e,applicableRoles:e.applicableRoles||[]}});e.policies=e.policies.map(t=>{return{...t,roleGrants:a.reduce((a,n)=>{return{...a,[n.roleName]:t.roleGrants[n.name]||e.defaultRoleGrants}},{}),rlsQualifiers:a.reduce((a,n)=>{return{...a,[n.roleName]:t.rlsQualifiers[n.name]||e.defaultRlsQualifiers}},{})}}),e.functionPolicies=e.functionPolicies.map(t=>{return{...t,roleFunctionGrants:a.reduce((a,n)=>{return{...a,[n.roleName]:t.roleFunctionGrants[n.name]||e.defaultFunctionRoleGrants}},{})}});const n=a.map(e=>e.roleName);e.ignoredRoles=e.ignoredRoles.filter(e=>-1===n.indexOf(e.roleName))}var Ns=ks;function Cs(e,t){e.selectedRoleFamilies=t.selectedRoleFamilies}var _s=Cs;function Ts(e,t){e.defaultRlsUsing=t.defaultRlsUsing}var Ss=Ts;function Is(e,t){e.defaultRlsWithCheck=t.defaultRlsWithCheck}var Ds=Is;function Es(e,t){const a=e.policies.find(e=>e.name===t.name);if(a)throw new Error("A policy with this name already exists");{const a=t.name,n=e.projectRoles,i={id:1e4*(new Date).getTime()+621355968e9,name:a,policyHeaderTemplate:e.policyHeaderTemplate,policyFooterTemplate:e.policyFooterTemplate,roleTableGrantTemplate:e.roleTableGrantTemplate,enableRls:!1,columnExclusionOverrides:{insert:[],update:[]},columnExclusions:{insert:{},update:{}},roleGrants:n.reduce((t,a)=>{return{...t,[a.roleName]:e.defaultRoleGrants}},{}),rlsQualifiers:n.reduce((t,a)=>{return{...t,[a.roleName]:e.defaultRlsQualifiers}},{})};e.policies=[...e.policies,i].sort((function(e,t){return e.id<t.id}))}}var Ps=Es;function ws(e,t){const a=e.policies.filter(e=>e.name!==t.policy.name);e.policies=[...a,t.policy].sort((e,t)=>{return e.id-t.id})}var Rs=ws;function Os(e,t){const a=e.policies.find(e=>e.name===t.name);if(a)throw new Error("A policy with this name already exists");{const a=t.name,n=e.projectRoles,i={id:1e4*(new Date).getTime()+621355968e9,name:a,functionPolicyHeaderTemplate:e.functionPolicyHeaderTemplate,functionPolicyFooterTemplate:e.functionPolicyFooterTemplate,roleFunctionGrants:n.reduce((t,a)=>{return{...t,[a.roleName]:e.defaultFunctionRoleGrants}},{})};e.functionPolicies=[...e.functionPolicies,i].sort((function(e,t){return e.id<t.id}))}}var $s=Os;function Vs(e,t){const a=e.functionPolicies.filter(e=>e.id!==t.policy.id);e.functionPolicies=[...a,t.policy].sort((e,t)=>{return e.id-t.id})}var js=Vs;function Fs(e,t){const a=e.policies.find(e=>e.id===t.policyId),n=e.policies.filter(e=>e.id!==t.policyId),i=t.roleName,l=t.action,r=1e4*(new Date).getTime()+621355968e9,o={id:r,name:t.name||`rls_${r}`,using:t.using||e.defaultRlsUsing,withCheck:t.withCheck||e.defaultRlsWithCheck,passStrategy:t.passStrategy||"permissive"},s={...a,rlsQualifiers:{...a.rlsQualifiers,[i]:{...a.rlsQualifiers[i],[l]:{...a.rlsQualifiers[i][l],policies:[...a.rlsQualifiers[i][l].policies,o]}}}};e.policies=[...n,s]}var As=Fs;function qs(e,t){const a=e.policies.find(e=>e.id===t.policyId),n=e.policies.filter(e=>e.id!==t.policyId),i=t.roleName,l=t.action,r=t.rlsPolicyId,o={...a,rlsQualifiers:{...a.rlsQualifiers,[i]:{...a.rlsQualifiers[i],[l]:{...a.rlsQualifiers[i][l],policies:a.rlsQualifiers[i][l].policies.filter(e=>e.id!==r)}}}};e.policies=[...n,o]}var Gs=qs;function Us(e,t){Object.keys(t.project).forEach(a=>{e[a]=t.project[a]})}var Ls=Us;function Bs(e,t){const a=t.sourcePolicyDefinitionId,n=t.newFields,i=t.tableIds||[],l=e.policies.find(e=>e.id===a),r={...l,id:1e4*(new Date).getTime()+621355968e9,name:n.name,customIdentifier:1===i.length?i[0]:null};e.policies=[...e.policies,r].sort((function(e,t){return e.id<t.id})),$o(e,{tableIds:i,policyDefinitionId:r.id})}var zs=Bs;function Ms(e,t){const a=t.policyDefinitionId,n=t.newFields,i=e.policies.find(e=>e.name===n.name);if(i)throw new Error("A policy with this name already exists");{const t=e.policies.find(e=>e.id===a),i=e.policies.filter(e=>e.id!==t.id),l={...t,name:n.name,customIdentifier:null};e.policies=[...i,l].sort((function(e,t){return e.id<t.id}))}}var Qs=Ms;function Ks(e,t){const a=t.policyDefinitionId,n=e.policies.filter(e=>e.id!==a);e.policies=[...n].sort((function(e,t){return e.id<t.id})),Object.keys(e.tablePolicyAssignments).forEach(t=>{e.tablePolicyAssignments[t]===a&&(e.tablePolicyAssignments[t]=e.defaultPolicy.id)})}var Ws=Ks;function Hs(e,t){e.tablePolicyTemplate=t.tablePolicyTemplate}var Xs=Hs,Js=a("83cd"),Ys=a.n(Js);function Zs(e,t){e.enabledRoles=t.enabledRoles}var ec=Zs;function tc(e,t){const a=e.ignoredRoles.find(e=>e.roleName===t.role.roleName);e.ignoredRoles=a?e.ignoredRoles.filter(e=>e.roleName!==t.role.roleName):[...e.ignoredRoles,t.role]}var ac=tc;function nc(e,t){e.pgdbiOptions=t.pgdbiOptions}var ic=nc;function lc(e,t){if(!0!==t.value||e.indicesToDrop[t.item.id])!1===t.value&&(e.indicesToDrop=Object.keys(e.indicesToDrop).filter(e=>e!==t.item.id).reduce((t,a)=>{return{...t,[a]:e.indicesToDrop[a]}},{}));else{const a=t.item.id;e.indicesToDrop={...e.indicesToDrop,[a]:t.item}}hs(e)}var rc=lc,oc={resetDefaultState:Eo,filterSchemata:wo,setManagedSchemata:xs,assignTablePolicy:$o,projectRoles:Ns,selectedRoleFamilies:_s,defaultRlsUsing:Ss,defaultRlsWithCheck:Ds,newPolicy:Ps,savePolicy:Rs,createRlsPolicy:As,deleteRlsPolicy:Gs,importProject:Ls,newFunctionPolicy:$s,saveFunctionPolicy:js,assignFunctionPolicy:Fo,customizeTablePolicy:zs,makeGlobalTablePolicy:Qs,deleteTablePolicy:Ws,updateTablePolicyTemplate:Xs,updateDefaultRlsUsing:Ys.a,setEnabledRoles:ec,toggleIgnoreRole:ac,setPgdbiOptions:ic,toggleIndexForDrop:rc};n["a"].use(el["a"]);var sc=new el["a"].Store({plugins:[Object(So["a"])()],state:Io,mutations:oc,actions:{}});n["a"].use(J["a"]);const cc=new J["a"]({scrollBehavior(e,t,a){return a||{x:0,y:0}},routes:[{path:"/",name:"home",component:he},{path:"/initialize",name:"initialize",component:Ie},{path:"/security-manager",name:"security-manager",component:rr},{path:"/search-view",name:"search-view",component:yr},{path:"/fk-index-manager",name:"fk-index-manager",component:zr},{path:"/smart-comment-manager",name:"smart-comment-manager",component:Xr},{path:"/settings",name:"settings",component:_r},{path:"/project-export",name:"project-export",component:ao},{path:"/project-import",name:"project-import",component:Ce},{path:"/sqitch",name:"sqitch",component:oo},{path:"/worker",name:"worker",component:po},{path:"/table/:id",name:"table",component:jn,props:!0},{path:"/function/:id",name:"function",component:Ra["a"],props:!0},{path:"/enum/:id",name:"enum",component:go,props:!0},{path:"/udt/:id",name:"udt",component:To,props:!0},{path:"/about",name:"about",component:()=>a.e("about").then(a.bind(null,"f820"))}]});cc.beforeEach((e,t,a)=>{sc.state.initializing&&"initialize"!==e.name&&cc.push("initialize"),a()});var uc=cc,dc=a("522d"),mc=a("efe7");n["a"].use(dc["a"]);const pc="apollo-token",hc=Object({NODE_ENV:"production",BASE_URL:"/pgdbi/"}).VUE_APP_GRAPHQL_HTTP||"/pgdbi/graphql",bc={httpEndpoint:hc,tokenName:pc,persisting:!1,websocketsOnly:!1,ssr:!1};function fc(e={}){const{apolloClient:t}=Object(mc["createApolloClient"])({...bc,...e}),a=new dc["a"]({defaultClient:t,defaultOptions:{$query:{}},errorHandler(e){console.log("%cError","background: red; color: white; padding: 2px 4px; border-radius: 3px; font-weight: bold;",e.message)}});return a}var vc=a("4eb5"),yc=a.n(vc),gc=a("ca55");n["a"].config.productionTip=!1,n["a"].use(yc.a),n["a"].use(gc["a"]),new n["a"]({vuetify:l,router:uc,store:sc,apolloProvider:fc(),render:e=>e(X)}).$mount("#app")},"58bb":function(e,t){var a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dbIntrospection"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"pgdbiOptions"},arguments:[],directives:[]}]}}],loc:{start:0,end:42}};a.loc.source={body:"query {\n  dbIntrospection\n  pgdbiOptions\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};function n(e,t){if("FragmentSpread"===e.kind)t.add(e.name.value);else if("VariableDefinition"===e.kind){var a=e.type;"NamedType"===a.kind&&t.add(a.name.value)}e.selectionSet&&e.selectionSet.selections.forEach((function(e){n(e,t)})),e.variableDefinitions&&e.variableDefinitions.forEach((function(e){n(e,t)})),e.definitions&&e.definitions.forEach((function(e){n(e,t)}))}var i={};(function(){a.definitions.forEach((function(e){if(e.name){var t=new Set;n(e,t),i[e.name.value]=t}}))})(),e.exports=a},6:function(e,t){},7:function(e,t){},"77d3":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div")},i=[],l=a("9dbb"),r=a.n(l);const o="terse";var s={name:"FunctionComputerMixin",methods:{computePolicy(e,t,a,n){const i=Object.keys(e.roleFunctionGrants).map(e=>{return{roleName:e}}),l=`${i.map(e=>e.roleName).join(", ")}`,s=Object.keys(e.roleFunctionGrants).reduce((t,a)=>{return"ALLOWED"===e.roleFunctionGrants[a].execute?t.concat([{roleName:a}]):t},[]),u=Object.keys(e.roleFunctionGrants).reduce((t,a)=>{return"IMPLIED"===e.roleFunctionGrants[a].execute?t.concat([{roleName:a}]):t},[]),d=Object.keys(e.roleFunctionGrants).reduce((t,a)=>{return"DENIED"===e.roleFunctionGrants[a].execute?t.concat([{roleName:a}]):t},[]),m={verbose:!0,deniedRoleGrants:d,impliedRoleGrants:u},p=n?n.argumentDataTypes.split(",").map(e=>{return e.trim().split(" ")[1]}).join(","):void 0,h={...a,policyName:e.name,allowedRoleGrants:s,revokeRolesList:l,functionSignature:n?`${n.functionSchema}.${n.functionName} (${p})`:"{{schemaName}}.{{functionName}} ({{signatureArgumentDataTypes}})"},b=t===o?h:{...m,...h};return r.a.render(c,b)}}};const c="\n----------\n----------  BEGIN FUNCTION POLICY: {{functionSignature}}\n----------  POLICY NAME:  {{policyName}}\n----------\n\n----------  REMOVE EXISTING FUNCTION GRANTS\n\n  revoke all privileges \n  on function {{functionSignature}} \n  from public;\n\n  revoke all privileges \n  on function {{functionSignature}} \n  from {{revokeRolesList}};\n\n----------  CREATE NEW FUNCTION GRANTS\n{{#allowedRoleGrants}}\n\n----------  {{roleName}}\n  grant \n  execute\n  on function {{functionSignature}} \n  to {{roleName}};\n\n{{/allowedRoleGrants}}\n{{#verbose}}\n----------  IMPLIED FUNCTION GRANTS\n  {{#impliedRoleGrants}}\n  --IMPLIED:   grant execute on function {{functionSignature}} to {{roleName}};\n  {{/impliedRoleGrants}}\n\n  ----------  DENIED TABLE GRANTS\n  {{#deniedRoleGrants}}\n  --DENIED:   grant execute on function {{functionSignature}} to {{roleName}};\n  {{/deniedRoleGrants}}\n{{/verbose}}\n----------  END FUNCTION POLICY: {{functionSignature}}\n--==\n\n";var u=s,d=a("2877"),m=Object(d["a"])(u,n,i,!1,null,null,null);t["a"]=m.exports},"7b59":function(e,t,a){"use strict";var n=a("8bda"),i=a.n(n);i.a},8:function(e,t){},"82cd":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-card",{key:e.policyDefinition.id,attrs:{color:"black"}},[a("v-container",[a("v-toolbar",[a("h1",[e._v("Name: "+e._s(e.policyDefinition.name))])]),a("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("v-tab",{key:"grants",attrs:{ripple:""}},[e._v("\n        Execution Grants\n      ")]),a("v-tab-item",{key:"grants"},[a("v-card",{attrs:{flat:""}},[a("policy-definition-grant-grid",{attrs:{policy:e.policyDefinition,disabled:e.disabled}})],1)],1),a("v-tab",{key:"policy-template",attrs:{ripple:""}},[e._v("\n        "+e._s(e.aFunction?"Policy":"Policy Template")+"\n      ")]),a("v-tab-item",{key:"policy-template"},[a("v-card",{attrs:{flat:""}},[a("policy-realization",{attrs:{policyDefinition:e.policyDefinition,aFunction:e.aFunction}})],1)],1),e.aFunction?a("v-tab",{key:"function-definition",attrs:{ripple:""}},[e._v("\n        Function Definition\n      ")]):e._e(),e.aFunction?a("v-tab-item",{key:"function-definition"},[a("v-card",{attrs:{flat:""}},[a("function-definition",{attrs:{id:e.aFunction.id}})],1)],1):e._e()],1)],1)],1)},i=[],l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-data-table",{staticClass:"text-sm-left",attrs:{headers:e.headers,items:e.grantMatrix,"hide-default-footer":"","item-key":"id"},scopedSlots:e._u([{key:"item.execute",fn:function(t){var n=t.item;return[a("v-checkbox",{attrs:{"input-value":e.roleGrantSelected(n,"execute"),disabled:e.roleGrantDisabled(n,"execute")},on:{click:function(t){return e.toggleRoleGrant(n.roleName,"execute")}}})]}}])})},r=[];const o="ALLOWED",s="DENIED",c="IMPLIED";var u={name:"FunctionPolicyDefinitionGrantGrid",props:{policy:{type:Object,required:!0},disabled:{type:Boolean,default:!1}},data(){return{policyStructure:[],calculatedPolicy:"NOT CALCULATED",toggleCompleted:!1}},watch:{},methods:{roleGrantSelected(e,t){return[o,c].indexOf(e[t])>-1},roleGrantDisabled(e,t){return e[t]===c||this.disabled},toggleRoleGrant(e,t){if(!0===this.toggleCompleted)return void(this.toggleCompleted=!1);const a=this.policy.roleFunctionGrants[e][t],n=this.projectRoles.filter(t=>{return void 0!==t.applicableRoles.find(t=>t.roleName===e)}).reduce((e,t)=>{return e.concat(t.roleName)},[]),i={...this.policy,roleFunctionGrants:Object.keys(this.policy.roleFunctionGrants).reduce((i,l)=>{const r=n.indexOf(l)>-1,u=l===e;return{...i,[l]:Object.keys(this.policy.roleFunctionGrants[l]).reduce((e,n)=>{this.policy.roleFunctionGrants[l][n];let i;return i=n===t?u?a===o?s:o:r?a===o?s:c:this.policy.roleFunctionGrants[l][n]:"all"==n&&(r||u)&&a===o?s:this.policy.roleFunctionGrants[l][n],{...e,[n]:i}},{})}},{})};this.$store.commit("saveFunctionPolicy",{policy:i}),this.toggleCompleted=!0}},computed:{projectRoles(){return this.$store.state.projectRoles},grantMatrix(){return Object.keys(this.policy.roleFunctionGrants).map(e=>{return{...this.policy.roleFunctionGrants[e],roleName:e}})},headers(){return[{text:"Role Name",sortable:!1,value:"roleName"},{text:"EXECUTE",sortable:!1,value:"execute"}]}}},d=u,m=a("2877"),p=a("6544"),h=a.n(p),b=a("ac7c"),f=a("8fea"),v=Object(m["a"])(d,l,r,!1,null,null,null),y=v.exports;h()(v,{VCheckbox:b["a"],VDataTable:f["a"]});var g=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("script-viewer",{attrs:{scriptText:e.computedPolicy,skipFormat:""},on:{"readability-changed":e.policyReadabilityChanged}})],1)},x=[],k=a("77d3"),N=a("89d6"),C=a("4eb5"),_=a.n(C),T={name:"FunctionDefinition",mixins:[k["a"],_.a],components:{ScriptViewer:N["a"]},props:{policyDefinition:{type:Object,required:!0},aFunction:{type:Object,required:!1}},data(){return{policyStructure:[],policyReadability:"terse",computedPolicy:"N/A"}},mounted(){this.doComputePolicy()},watch:{policyDefinition(){this.doComputePolicy()},policyReadability(){this.doComputePolicy()}},methods:{policyReadabilityChanged(e){this.policyReadability=e},refresh(){this.doComputePolicy()},expand(){this.computedPolicy=`${this.computedPolicy} `},doComputePolicy(){const e=this.aFunction?{}:null;this.computedPolicy=this.computePolicy(this.policyDefinition,this.policyReadability,e,this.aFunction)},onCopy:function(e){alert("Copied!")},onError:function(e){alert("Failed to copy texts")},executeSql(){alert("not implemented:  server config value will expose graphile extension to execute generated script")}},computed:{}},S=T,I=a("a523"),D=Object(m["a"])(S,g,x,!1,null,null,null),E=D.exports;h()(D,{VContainer:I["a"]});var P=a("243e");var w={name:"FunctionPolicyDefinition",components:{PolicyDefinitionGrantGrid:y,PolicyRealization:E,FunctionDefinition:P["a"]},props:{policyId:{type:Number,required:!0},aFunction:{type:Object,required:!1}},data(){return{calculatedPolicy:"NOT CALCULATED",toggleCompleted:!1,activeTab:0}},mounted(){},watch:{},methods:{},computed:{disabled(){return null!==this.aFunction&&void 0!==this.aFunction||this.policyDefinition.id===this.$store.state.defaultFunctionPolicy.id},policyDefinition(){this.$store.state.functionPolicies;const e=this.$store.state.functionPolicies.find(e=>e.id===this.policyId);return e}}},R=w,O=a("b0af"),$=a("71a3"),V=a("c671"),j=a("fe57"),F=a("71d9"),A=Object(m["a"])(R,n,i,!1,null,null,null);t["a"]=A.exports;h()(A,{VCard:O["a"],VContainer:I["a"],VTab:$["a"],VTabItem:V["a"],VTabs:j["a"],VToolbar:F["a"]})},"83cd":function(e,t){function a(e,t){e.defaultRlsUsing=t.defaultRlsUsing}e.exports=a},"861c":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{fluid:"",cols:"12"}},[a("v-toolbar",{attrs:{dense:""}},[a("v-switch",{attrs:{label:"Enable RLS",disabled:e.disabled},model:{value:e.enableRls,callback:function(t){e.enableRls=t},expression:"enableRls"}}),a("v-spacer"),e.showMakeGlobalButton?a("table-policy-make-global-dialog",{attrs:{policyDefinition:e.policyDefinition}}):e._e(),a("v-spacer"),e.showDeleteButton?a("table-policy-delete-dialog",{attrs:{policyDefinition:e.policyDefinition}}):e._e(),a("v-spacer"),a("h4",{staticClass:"text-no-wrap"},[e._v(e._s(e.title))])],1),a("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("v-tab",{key:"grants",attrs:{ripple:""}},[e._v("\n        Table Grants\n      ")]),a("v-tab-item",{key:"grants",attrs:{lazy:""}},[a("v-card",{attrs:{flat:""}},[a("table-policy-definition-grants",{attrs:{policyDefinition:e.policyDefinition,disabled:e.disabled}})],1)],1),a("v-tab",{key:"rls",attrs:{ripple:"",disabled:!e.enableRls}},[e._v("\n        Row Level Security\n      ")]),a("v-tab-item",{key:"rls",attrs:{lazy:""}},[a("v-card",{attrs:{flat:""}},[a("policy-rls-qualifier-grid",{attrs:{policy:e.policyDefinition,disabled:e.disabled}})],1)],1),a("v-tab",{key:"policy-template",attrs:{ripple:""}},[e._v("\n        "+e._s(e.table?"Policy Script":"Policy Script Template")+"\n      ")]),a("v-tab-item",{key:"policy-template",attrs:{lazy:""}},[a("v-card",{attrs:{flat:""}},[a("policy-realization",{attrs:{policyDefinition:e.policyDefinition,table:e.table,enableRls:e.enableRls}})],1)],1),e.table?a("v-tab",{key:"policy-evaluation",attrs:{ripple:""}},[e._v("\n        Evaluation\n      ")]):e._e(),e.table?a("v-tab-item",{key:"policy-evaluation",attrs:{lazy:""}},[a("v-card",{attrs:{flat:""}},[a("table-policy-evaluator-detail",{attrs:{policyDefinition:e.policyDefinition,table:e.table}})],1)],1):e._e()],1)],1)},i=[],l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("v-tab",{key:"grants",attrs:{ripple:""}},[e._v("\n    Role Grants\n  ")]),a("v-tab-item",{key:"grants",attrs:{lazy:""}},[a("v-card",{attrs:{flat:""}},[a("table-policy-definition-grant-grid",{attrs:{policyDefinition:e.policyDefinition,disabled:e.disabled}})],1)],1),a("v-tab",{key:"exclusions",attrs:{ripple:"",disabled:e.disabled}},[e._v("\n    Column Exclusions\n  ")]),a("v-tab-item",{key:"exclusions",attrs:{lazy:""}},[a("v-card",{attrs:{flat:""}},[a("table-policy-definition-column-exclusions",{attrs:{policyDefinition:e.policyDefinition,table:e.table,disabled:e.disabled}})],1)],1)],1)},r=[],o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-data-table",{staticClass:"text-sm-left",attrs:{headers:e.headers,items:e.grantMatrix,"hide-default-footer":"","item-key":"id"},scopedSlots:e._u([{key:"item.select",fn:function(t){var n=t.item;return[a("v-checkbox",{attrs:{"input-value":e.roleGrantSelected(n,"select"),disabled:e.roleGrantDisabled(n,"select")},on:{click:function(t){return e.toggleRoleGrant(n.roleName,"select")}}})]}},{key:"item.insert",fn:function(t){var n=t.item;return[a("v-checkbox",{attrs:{"input-value":e.roleGrantSelected(n,"insert"),disabled:e.roleGrantDisabled(n,"insert")},on:{click:function(t){return e.toggleRoleGrant(n.roleName,"insert")}}})]}},{key:"item.update",fn:function(t){var n=t.item;return[a("v-checkbox",{attrs:{"input-value":e.roleGrantSelected(n,"update"),disabled:e.roleGrantDisabled(n,"update")},on:{click:function(t){return e.toggleRoleGrant(n.roleName,"update")}}})]}},{key:"item.delete",fn:function(t){var n=t.item;return[a("v-checkbox",{attrs:{"input-value":e.roleGrantSelected(n,"delete"),disabled:e.roleGrantDisabled(n,"delete")},on:{click:function(t){return e.toggleRoleGrant(n.roleName,"delete")}}})]}}])})},s=[];const c="ALLOWED",u="DENIED",d="IMPLIED";var m={name:"PolicyDefinitionGrantGrid",props:{policyDefinition:{type:Object,required:!0},disabled:{type:Boolean,default:!1}},data(){return{policyStructure:[],calculatedPolicy:"NOT CALCULATED",toggleCompleted:!1}},watch:{},methods:{roleGrantSelected(e,t){return[c,d].indexOf(e[t])>-1},roleGrantDisabled(e,t){return e[t]===d||this.disabled},toggleRoleGrant(e,t){if(!0===this.toggleCompleted)return void(this.toggleCompleted=!1);const a=this.policyDefinition.roleGrants[e][t],n=this.projectRoles.filter(t=>{return void 0!==(t.applicableRoles||[]).find(t=>t.roleName===e)}).reduce((e,t)=>{return e.concat(t.roleName)},[]),i={...this.policyDefinition,roleGrants:Object.keys(this.policyDefinition.roleGrants).reduce((i,l)=>{const r=n.indexOf(l)>-1,o=l===e;return{...i,[l]:Object.keys(this.policyDefinition.roleGrants[l]).reduce((e,n)=>{this.policyDefinition.roleGrants[l][n];let i;return i=n===t?o?a===c?u:c:r?a===c?u:d:this.policyDefinition.roleGrants[l][n]:"all"==n&&(r||o)&&a===c?u:this.policyDefinition.roleGrants[l][n],{...e,[n]:i}},{})}},{})};this.$store.commit("savePolicy",{policy:i}),this.toggleCompleted=!0}},computed:{projectRoles(){return this.$store.state.projectRoles},grantMatrix(){return Object.keys(this.policyDefinition.roleGrants).map(e=>{return{...this.policyDefinition.roleGrants[e],roleName:e}})},headers(){return[{text:"Role Name",sortable:!1,value:"roleName"},{text:"SELECT",sortable:!1,value:"select"},{text:"INSERT",sortable:!1,value:"insert"},{text:"UPDATE",sortable:!1,value:"update"},{text:"DELETE",sortable:!1,value:"delete"}]}}},p=m,h=a("2877"),b=a("6544"),f=a.n(b),v=a("ac7c"),y=a("8fea"),g=Object(h["a"])(p,o,s,!1,null,null,null),x=g.exports;f()(g,{VCheckbox:v["a"],VDataTable:y["a"]});var k=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{"justify-start":""}},[a("v-data-table",{attrs:{headers:e.headers,items:e.dataTableItems,"hide-default-footer":"",dense:""},scopedSlots:e._u([{key:"item.insertExclusions",fn:function(t){var n=t.item;return[a("column-exclusion-set",{attrs:{policyDefinition:e.policyDefinition,table:e.table,action:"insert",roleName:n.roleName}})]}},{key:"item.updateExclusions",fn:function(t){var n=t.item;return[a("column-exclusion-set",{attrs:{policyDefinition:e.policyDefinition,table:e.table,action:"update",roleName:n.roleName}})]}}])})],1)},N=[],C=(a("2f62"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[e.overrideHidden?e._e():a("v-switch",{attrs:{label:"override implied exclusions"},model:{value:e.overrideActive,callback:function(t){e.overrideActive=t},expression:"overrideActive"}}),e.showDialogButton?a("table-policy-column-exclusion-dialog",{attrs:{policyDefinition:e.policyDefinition,table:e.table,action:e.action,roleName:e.roleName}}):e._e(),a("v-list",e._l(e.currentColumnExclusions,(function(t){return a("v-list-item",{key:t},[a("v-btn",{on:{click:function(a){return e.removeColumnExclusion(t)}}},[a("v-icon",[e._v("clear")])],1),e._v(" "+e._s(t)+"\n      ")],1)})),1)],1)}),_=[],T=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-dialog",{attrs:{persistent:"",width:"800"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[a("v-btn",e._g({staticClass:"text-none",attrs:{small:"",dark:"",hidden:e.hidden,disabled:e.disabled}},n),[e._v("\n        "+e._s(e.displayValue)+"\n      ")])]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[a("v-card-title",{staticClass:"headline"},[e._v("Exclude Column")]),a("v-text-field",{model:{value:e.columnName,callback:function(t){e.columnName=t},expression:"columnName"}}),a("v-card-actions",[a("v-spacer"),a("v-btn",{on:{click:function(t){e.dialog=!1}}},[e._v("Cancel")]),a("v-btn",{on:{click:e.addColumnExclusion}},[e._v("Exclude")]),a("v-spacer")],1)],1)],1)],1)},S=[],I={name:"TablePolicyColumnExclusionDialog",props:{policyDefinition:{type:Object,required:!0},table:{type:Object,required:!1},action:{type:String,required:!0},roleName:{type:String,required:!0},disabled:{type:Boolean,required:!1}},data(){return{dialog:!1,columnName:""}},computed:{displayValue(){return`New ${this.action} exclusion`},hidden(){return"DENIED"===this.policyDefinition.roleGrants[this.roleName][this.action]}},watch:{},methods:{addColumnExclusion(){this.dialog=!1;const e=(this.policyDefinition.columnExclusions[this.action][this.roleName]||[]).filter(e=>e!==this.columnName).concat([this.columnName]);try{this.$store.commit("savePolicy",{policy:{...this.policyDefinition,columnExclusions:{...this.policyDefinition.columnExclusions,[this.action]:{...this.policyDefinition.columnExclusions[this.action],[this.roleName]:e}}}})}catch(t){alert(t.toString()),console.error(t)}}}},D=I,E=(a("c2d7"),a("8336")),P=a("b0af"),w=a("99d9"),R=a("169a"),O=a("2fa4"),$=a("8654"),V=Object(h["a"])(D,T,S,!1,null,null,null),j=V.exports;f()(V,{VBtn:E["a"],VCard:P["a"],VCardActions:w["a"],VCardTitle:w["b"],VDialog:R["a"],VSpacer:O["a"],VTextField:$["a"]});var F={name:"ColumnExclusionSet",components:{TablePolicyColumnExclusionDialog:j},props:{policyDefinition:{type:Object,required:!0},table:{type:Object,required:!1},action:{type:String,required:!0},roleName:{type:String,required:!0}},data(){return{toggleCompleted:!1,overrideActive:!1}},watch:{overrideActive(){let e;const t=this.policyDefinition.columnExclusionOverrides[this.action].filter(e=>e!==this.roleName),a=this.overrideActive?t.concat(this.roleName):t;if(this.overrideActive)e=this.policyDefinition.columnExclusions[this.action];else{let{[this.roleName]:e,...t}=this.policyDefinition.columnExclusions[this.action]}try{this.$store.commit("savePolicy",{policy:{...this.policyDefinition,columnExclusionOverrides:{...this.policyDefinition.columnExclusionOverrides,[this.action]:a},columnExclusions:{...this.policyDefinition.columnExclusions,[this.action]:e||{}}}})}catch(n){alert(n.toString()),console.error(n)}}},methods:{removeColumnExclusion(e){const t=this.policyDefinition.columnExclusions[this.action][this.roleName].filter(t=>t!==e);try{this.$store.commit("savePolicy",{policy:{...this.policyDefinition,columnExclusions:{...this.policyDefinition.columnExclusions,[this.action]:{...this.policyDefinition.columnExclusions[this.action],[this.roleName]:t}}}})}catch(a){alert(a.toString()),console.error(a)}}},mounted(){this.overrideActive=this.policyDefinition.columnExclusionOverrides[this.action].indexOf(this.roleName)>-1},computed:{currentColumnExclusions(){return(this.policyDefinition.columnExclusions[this.action]||[])[this.roleName]},disabled(){return"DENIED"===this.policyDefinition.roleGrants[this.roleName][this.action]},overrideHidden(){const e=["DENIED","ALLOWED"].indexOf(this.policyDefinition.roleGrants[this.roleName][this.action])>-1;return e},showDialogButton(){return!0}}},A=F,q=a("a523"),G=a("132d"),U=a("8860"),L=a("da13"),B=a("b73d"),z=Object(h["a"])(A,C,_,!1,null,null,null),M=z.exports;f()(z,{VBtn:E["a"],VContainer:q["a"],VIcon:G["a"],VList:U["a"],VListItem:L["a"],VSwitch:B["a"]});var Q={name:"PolicyDefinitionColumnExclusions",components:{ColumnExclusionSet:M},props:{policyDefinition:{type:Object,required:!0},table:{type:Object,required:!1},disabled:{type:Boolean,default:!1}},data(){return{toggleComplete:!1,headers:[{text:"Role Name",sortable:!1,value:"roleName"},{text:"Insert Exclusions",sortable:!1,value:"insertExclusions"},{text:"Update Exclusions",sortable:!1,value:"updateExclusions"}]}},watch:{},methods:{removeInsertExclusion(e,t){console.log("columnExclusion",e,t)}},computed:{projectRoles(){return this.$store.state.projectRoles},dataTableItems(){return Object.keys(this.policyDefinition.roleGrants).reduce((e,t)=>{const a=(this.policyDefinition.columnExclusions.insert||[])[t]||[],n=(this.policyDefinition.columnExclusions.update||[])[t]||[];return[...e,{roleName:t,insertColumnExclusions:a,updateColumnExclusions:n}]},[])}}},K=Q,W=Object(h["a"])(K,k,N,!1,null,null,null),H=W.exports;f()(W,{VContainer:q["a"],VDataTable:y["a"]});var X={name:"PolicyDefinitionGrants",components:{TablePolicyDefinitionGrantGrid:x,TablePolicyDefinitionColumnExclusions:H},props:{policyDefinition:{type:Object,required:!0},table:{type:Object,required:!1},disabled:{type:Boolean,default:!1}},data(){return{activeTab:null}},watch:{},methods:{},computed:{}},J=X,Y=a("71a3"),Z=a("c671"),ee=a("fe57"),te=Object(h["a"])(J,l,r,!1,null,null,null),ae=te.exports;f()(te,{VCard:P["a"],VTab:Y["a"],VTabItem:Z["a"],VTabs:ee["a"]});var ne=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-data-table",{attrs:{headers:e.headers,items:e.rlsQualifierMatrix,"hide-default-footer":"","item-key":"id",dense:""},scopedSlots:e._u([{key:"item.roleName",fn:function(t){var n=t.item;return[a("div",{staticClass:"text-no-wrap"},[e._v(e._s(n.roleName))])]}},{key:"item.all",fn:function(t){var n=t.item;return[a("table-policy-rls-action",{attrs:{policy:e.policy,action:"all",item:n,disabled:e.disabled}})]}},{key:"item.select",fn:function(t){var n=t.item;return[a("table-policy-rls-action",{attrs:{policy:e.policy,action:"select",item:n,disabled:e.disabled}})]}},{key:"item.insert",fn:function(t){var n=t.item;return[a("table-policy-rls-action",{attrs:{policy:e.policy,action:"insert",item:n,disabled:e.disabled}})]}},{key:"item.update",fn:function(t){var n=t.item;return[a("table-policy-rls-action",{attrs:{policy:e.policy,action:"update",item:n,disabled:e.disabled}})]}},{key:"item.delete",fn:function(t){var n=t.item;return[a("table-policy-rls-action",{attrs:{policy:e.policy,action:"delete",item:n,disabled:e.disabled}})]}}])})},ie=[],le=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-dialog",{attrs:{persistent:"",width:"1400"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[a("v-btn",e._g({staticClass:"text-none",attrs:{small:"",dark:"",disabled:e.btnDisabled,hidden:e.hidden},on:{click:e.activate}},n),[e._v("\n        "+e._s(e.displayValue)+"\n      ")])]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[a("v-card-title",{staticClass:"headline"},[e._v("Rls Policy")]),a("v-text-field",{attrs:{label:"Name",disabled:e.disabled},model:{value:e.currentName,callback:function(t){e.currentName=t},expression:"currentName"}}),a("v-radio-group",{attrs:{column:!1,disabled:e.disabled},model:{value:e.currentPassStrategy,callback:function(t){e.currentPassStrategy=t},expression:"currentPassStrategy"}},[a("v-radio",{attrs:{label:"Permissive",value:"permissive"}}),a("v-radio",{attrs:{label:"Restrictive",value:"restrictive"}})],1),a("v-text-field",{attrs:{label:"Using",disabled:e.disabled},model:{value:e.currentUsing,callback:function(t){e.currentUsing=t},expression:"currentUsing"}}),a("v-text-field",{attrs:{label:"With Check",disabled:e.disabled},model:{value:e.currentWithCheck,callback:function(t){e.currentWithCheck=t},expression:"currentWithCheck"}}),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{hidden:e.disabled},on:{click:function(t){e.updateRlsPolicy(e.roleName,e.action,e.rlsPolicy.id,e.currentUsing,e.currentWithCheck,e.currentPassStrategy,e.currentName),e.dialog=!1}}},[e._v("Update")]),a("v-btn",{attrs:{hidden:e.disabled},on:{click:function(t){e.disableRlsPolicy(e.roleName,e.action,e.rlsPolicy.id),e.dialog=!1}}},[e._v("Disable")]),a("v-btn",{attrs:{hidden:e.disabled},on:{click:function(t){e.dialog=!1}}},[e._v("Cancel")]),a("v-btn",{attrs:{hidden:!e.disabled},on:{click:function(t){e.dialog=!1}}},[e._v("OK")]),a("v-spacer")],1)],1)],1)],1)},re=[];const oe="DISABLED",se="IMPLIED";var ce={name:"RlsPolicyDialog",props:{disabled:{type:Boolean,default:!1},status:{type:String,required:!0},rlsPolicy:{type:Object,required:!0},action:{type:String,required:!0},roleName:{type:String,required:!0},disableRlsPolicy:{type:Function,required:!0},updateRlsPolicy:{type:Function,required:!0}},data(){return{toggleCompleted:!1,dialog:!1,currentName:"n/a",currentUsing:"n/a",currentWithCheck:"n/a",currentPassStrategy:!1}},computed:{displayValue(){return this.rlsPolicy.name},rlsQualifierDisplayValueDisabled(){return!1},hidden(){return!1},btnDisabled(){return[oe,se].indexOf(this.status)>-1}},watch:{},methods:{activate(){this.currentName=this.rlsPolicy.name,this.currentUsing=this.rlsPolicy.using,this.currentWithCheck=this.rlsPolicy.withCheck,this.currentPassStrategy=this.rlsPolicy.passStrategy}}},ue=ce,de=(a("dbdb"),a("67b6")),me=a("43a6"),pe=Object(h["a"])(ue,le,re,!1,null,null,null),he=pe.exports;f()(pe,{VBtn:E["a"],VCard:P["a"],VCardActions:w["a"],VCardTitle:w["b"],VDialog:R["a"],VRadio:de["a"],VRadioGroup:me["a"],VSpacer:O["a"],VTextField:$["a"]});var be=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-btn",{attrs:{small:"",hidden:e.disabled},on:{click:function(t){return e.addRlsPolicy(e.item.roleName,e.action)}}},[e._v("Add Policy")]),e._l(e.item[e.action].policies,(function(t){return a("rls-policy-dialog",{key:t.roleName+"-"+t.id,attrs:{action:e.action,roleName:e.item.roleName,rlsPolicy:t,status:"ENABLED",disableRlsPolicy:e.disableRlsPolicy,updateRlsPolicy:e.updateRlsPolicy,disabled:e.disabled}})})),e._l(e.impliedPolicies(e.item.roleName,e.action),(function(t){return a("rls-policy-dialog",{key:t.roleName+"-"+t.id,attrs:{action:e.action,roleName:e.item.roleName,rlsPolicy:t,status:"IMPLIED",disableRlsPolicy:e.disableRlsPolicy,updateRlsPolicy:e.updateRlsPolicy,disabled:e.disabled}})}))],2)},fe=[];var ve={name:"PolicyRlsAction",components:{RlsPolicyDialog:he},props:{policy:{type:Object,required:!0},action:{type:String,required:!0},item:{type:Object,required:!0},disabled:{type:Boolean,default:!1}},data(){return{}},watch:{},methods:{impliedPolicies(e,t){const a=this.projectRoles.find(t=>t.roleName===e).applicableRoles.reduce((e,t)=>{return e.concat(t.roleName)},[]).concat([e]),n=a.reduce((a,n)=>{return n!==e?"all"===t?a.concat(this.policy.rlsQualifiers[n][t].policies):a.concat(this.policy.rlsQualifiers[n][t].policies).concat(this.policy.rlsQualifiers[n].all.policies):"all"===t?a:a.concat(this.policy.rlsQualifiers[n].all.policies)},[]);return n},addRlsPolicy(e,t){this.$store.commit("createRlsPolicy",{policyId:this.policy.id,roleName:e,action:t})},disableRlsPolicy(e,t,a){this.$store.commit("deleteRlsPolicy",{policyId:this.policy.id,roleName:e,action:t,rlsPolicyId:a})},updateRlsPolicy(e,t,a,n,i,l,r){const o=this.policy.rlsQualifiers[e][t].policies.filter(e=>e.id!==a).concat([{id:a,using:n,withCheck:i,passStrategy:l,name:r}]),s={...this.policy,rlsQualifiers:{...this.policy.rlsQualifiers,[e]:{...this.policy.rlsQualifiers[e],[t]:{status:this.policy.rlsQualifiers[e][t].status,policies:o,using:n,withCheck:i,passStrategy:l}}}};this.$store.commit("savePolicy",{policy:s})}},computed:{projectRoles(){return this.$store.state.projectRoles}}},ye=ve,ge=(a("c496"),Object(h["a"])(ye,be,fe,!1,null,null,null)),xe=ge.exports;f()(ge,{VBtn:E["a"],VContainer:q["a"]});const ke="ENABLED",Ne="DISABLED",Ce="IMPLIED";var _e={name:"PolicyRlsQualifierGrid",components:{RlsPolicyDialog:he,TablePolicyRlsAction:xe},props:{policy:{type:Object,required:!0},disabled:{type:Boolean,default:!1}},data(){return{toggleCompleted:!1,dialog:!1,currentUsing:"n/a",currentWithCheck:"n/a"}},watch:{},methods:{impliedPolicies(e,t){const a=this.projectRoles.find(t=>t.roleName===e).applicableRoles.reduce((e,t)=>{return e.concat(t.roleName)},[]).concat([e]),n=a.reduce((a,n)=>{return n!==e?"all"===t?a.concat(this.policy.rlsQualifiers[n][t].policies):a.concat(this.policy.rlsQualifiers[n][t].policies).concat(this.policy.rlsQualifiers[n].all.policies):"all"===t?a:a.concat(this.policy.rlsQualifiers[n].all.policies)},[]);return n},addRlsPolicy(e,t){this.$store.commit("createRlsPolicy",{policyId:this.policy.id,roleName:e,action:t})},disableRlsPolicy(e,t,a){this.$store.commit("deleteRlsPolicy",{policyId:this.policy.id,roleName:e,action:t,rlsPolicyId:a})},updateRlsPolicy(e,t,a,n,i,l,r){const o=this.policy.rlsQualifiers[e][t].policies.filter(e=>e.id!==a).concat([{id:a,using:n,withCheck:i,passStrategy:l,name:r}]),s={...this.policy,rlsQualifiers:{...this.policy.rlsQualifiers,[e]:{...this.policy.rlsQualifiers[e],[t]:{status:this.policy.rlsQualifiers[e][t].status,policies:o,using:n,withCheck:i,passStrategy:l}}}};this.$store.commit("savePolicy",{policy:s})},rlsQualifierCheckLabel(e,t){switch(e[t].status){case ke:return"Add Policy";case Ne:return"Enable";case Ce:return"Add Policy"}}},computed:{projectRoles(){return this.$store.state.projectRoles},defaultRLSQual(){return this.$store.state.defaultRLSQual},rlsQualifierMatrix(){return Object.keys(this.policy.rlsQualifiers).map(e=>{return{...this.policy.rlsQualifiers[e],roleName:e}})},headers(){return[{text:"Role Name",sortable:!1,value:"roleName"},{text:"ALL",sortable:!1,value:"all"},{text:"SELECT",sortable:!1,value:"select"},{text:"INSERT",sortable:!1,value:"insert"},{text:"UPDATE",sortable:!1,value:"update"},{text:"DELETE",sortable:!1,value:"delete"}]}}},Te=_e,Se=(a("065f"),Object(h["a"])(Te,ne,ie,!1,null,null,null)),Ie=Se.exports;f()(Se,{VDataTable:y["a"]});var De=a("96b5"),Ee=a("bd5a"),Pe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-dialog",{attrs:{persistent:"",width:"800"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[a("v-btn",e._g({staticClass:"text-none",attrs:{small:"",dark:"",disabled:e.disabled}},n),[e._v("\n        "+e._s(e.displayValue)+"\n      ")])]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[a("v-card-title",{staticClass:"headline"},[e._v("Make Custom Policy Available Globally")]),a("v-text-field",{model:{value:e.customName,callback:function(t){e.customName=t},expression:"customName"}}),a("v-card-actions",[a("v-spacer"),a("v-btn",{on:{click:function(t){e.dialog=!1}}},[e._v("Cancel")]),a("v-btn",{on:{click:e.makeGlobal}},[e._v("Make Global")]),a("v-spacer")],1)],1)],1)],1)},we=[],Re={name:"TablePolicyMakeGlobalDialog",props:{policyDefinition:{type:Object,required:!0},disabled:{type:Boolean,default:!1}},data(){return{dialog:!1,customName:"New Table Policy"}},computed:{displayValue(){return"Make Global"}},watch:{},methods:{makeGlobal(){this.dialog=!1;try{this.$store.commit("makeGlobalTablePolicy",{policyDefinitionId:this.policyDefinition.id,newFields:{name:this.customName}})}catch(e){alert(e.toString()),console.error(e)}}}},Oe=Re,$e=(a("cfbf"),Object(h["a"])(Oe,Pe,we,!1,null,null,null)),Ve=$e.exports;f()($e,{VBtn:E["a"],VCard:P["a"],VCardActions:w["a"],VCardTitle:w["b"],VDialog:R["a"],VSpacer:O["a"],VTextField:$["a"]});var je=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-dialog",{attrs:{persistent:"",width:"800"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[a("v-btn",e._g({staticClass:"text-none",attrs:{small:"",dark:"",disabled:e.disabled}},n),[e._v("\n        "+e._s(e.displayValue)+"\n      ")])]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[a("v-card-title",{staticClass:"headline"},[e._v("Delete Policy")]),a("h1",[e._v("Are you sure you want to delete this policy?")]),a("h2",[e._v("Any tables currently assigned this policy will revert to:")]),a("h2",[e._v("Default Policy - NO ACCESS")]),a("v-card-actions",[a("v-spacer"),a("v-btn",{on:{click:function(t){e.dialog=!1}}},[e._v("Cancel")]),a("v-btn",{attrs:{disabled:e.deleteDisabled},on:{click:e.deleteTablePolicyDefinition}},[e._v("Delete")]),a("v-spacer")],1)],1)],1)],1)},Fe=[],Ae={name:"TablePolicyDeleteDialog",props:{policyDefinition:{type:Object,required:!0},disabled:{type:Boolean,default:!1}},mounted(){},data(){return{dialog:!1}},computed:{displayValue(){return"Delete"},allPolicyDefinitions(){return this.$store.state.policies.filter(e=>!e.customIdentifier)},deleteDisabled(){return!1}},watch:{},methods:{deleteTablePolicyDefinition(){this.dialog=!1,this.$store.commit("deleteTablePolicy",{policyDefinitionId:this.policyDefinition.id})}}},qe=Ae,Ge=(a("fb68"),Object(h["a"])(qe,je,Fe,!1,null,null,null)),Ue=Ge.exports;f()(Ge,{VBtn:E["a"],VCard:P["a"],VCardActions:w["a"],VCardTitle:w["b"],VDialog:R["a"],VSpacer:O["a"]});var Le=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-textarea",{attrs:{value:e.tablePolicyEval,"auto-grow":"","hide-details":"","background-color":"black",disabled:""}}),a("v-data-table",{attrs:{headers:e.headers,items:e.tablePolicyEvaluationItems,"hide-default-footer":"","item-key":"id"},scopedSlots:e._u([{key:"items",fn:function(t){return[a("tr",[a("td",[e._v("\n          "+e._s(t.item.roleName)+"\n        ")]),a("td",[e._v("\n          "+e._s(t.item.action)+"\n        ")]),a("td",[e._v("\n          "+e._s(t.item.status)+"\n        ")])])]}}])})],1)},Be=[],ze=a("e002"),Me={name:"TablePolicyEvaluatorDetail",mixins:[ze["a"]],props:{},mounted(){},data(){return{headers:[{text:"roleName",sortable:!1},{text:"action",sortable:!1},{text:"status",sortable:!1}]}},computed:{tablePolicyEval(){return JSON.stringify(this.tablePolicyEvaluation,0,2)},tablePolicyEvaluationItems(){return Object.keys(this.tablePolicyEvaluation).reduce((e,t)=>{return[...e,...this.tablePolicyEvaluation[t].map(e=>{return{...e,id:`${e.roleName}-${e.action}`,status:t}})]},[])}}},Qe=Me,Ke=(a("7b59"),a("a844")),We=Object(h["a"])(Qe,Le,Be,!1,null,null,null),He=We.exports;f()(We,{VContainer:q["a"],VDataTable:y["a"],VTextarea:Ke["a"]});var Xe={name:"PolicyDefinition",components:{PolicyRlsQualifierGrid:Ie,PolicyRealization:De["a"],TablePolicyCustomizeDialog:Ee["a"],TablePolicyMakeGlobalDialog:Ve,TablePolicyDeleteDialog:Ue,TablePolicyEvaluatorDetail:He,TablePolicyDefinitionGrants:ae},props:{policyId:{type:Number,required:!0},table:{type:Object,required:!1}},data(){return{enableRls:!0,policyStructure:[],calculatedPolicy:"NOT CALCULATED",toggleCompleted:!1,activeTab:null}},mounted(){this.enableRls=this.policyDefinition.enableRls},watch:{policyDefinition(){this.enableRls=this.policyDefinition.enableRls},enableRls(){this.$store.commit("savePolicy",{policy:{...this.policyDefinition,enableRls:this.enableRls}}),this.enableRls||1!==this.activeTab||(this.activeTab=0)}},methods:{customize(){this.table.name}},computed:{showDeleteButton(){return this.policyDefinition.id!==this.$store.state.defaultPolicy.id},showMakeGlobalButton(){return void 0!==this.policyDefinition.customIdentifier&&null!==this.policyDefinition.customIdentifier},showCustomizeButton(){return!!this.table&&!this.policyDefinition.customIdentifier},disabled(){const e=this.policyDefinition.id===this.$store.state.defaultPolicy.id,t=null!==this.table&&void 0!==this.table,a=!!this.policyDefinition.customIdentifier;return!!e||!!t&&!a},policyDefinition(){this.$store.state.policies;const e=this.$store.state.policies.find(e=>e.id===this.policyId);return e},title(){return`Policy Name: ${this.policyDefinition.name}`}}},Je=Xe,Ye=a("71d9"),Ze=Object(h["a"])(Je,n,i,!1,null,null,null);t["a"]=Ze.exports;f()(Ze,{VCard:P["a"],VContainer:q["a"],VSpacer:O["a"],VSwitch:B["a"],VTab:Y["a"],VTabItem:Z["a"],VTabs:ee["a"],VToolbar:Ye["a"]})},"89d6":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[e.showToolbar?a("v-toolbar",[a("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[a("v-btn",e._g({directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:e.scriptText,expression:"scriptText",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:e.onCopy,expression:"onCopy",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:e.onError,expression:"onError",arg:"error"}]},n),[a("v-icon",[e._v("file_copy")]),e._v("Copy\n      ")],1)]}}],null,!1,1252371525)},[a("span",[e._v("Copy")])]),a("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[a("v-btn",e._g({attrs:{disabled:""},on:{click:e.executeSql}},n),[a("v-icon",[e._v("arrow_forward")]),e._v("Execute")],1)]}}],null,!1,484692131)},[a("span",[e._v("Execute")])]),a("v-spacer"),a("v-container",{attrs:{fluid:""}},[a("v-row",[a("v-spacer"),a("v-spacer"),e.showReadability?a("v-layout",[a("label",{staticClass:"v-label theme--dark",attrs:{"mt-2":""}},[e._v("terseÂ ")]),a("v-switch",{attrs:{"true-value":"verbose","false-value":"terse",label:"verbose"},model:{value:e.readability,callback:function(t){e.readability=t},expression:"readability"}})],1):e._e(),e.showDeclarationVisibility?a("v-layout",[a("label",{staticClass:"v-label theme--dark",attrs:{"mt-2":""}},[e._v("show declaration:Â ")]),a("v-switch",{attrs:{"true-value":"hide","false-value":"show",label:"hide"},model:{value:e.declarationVisibility,callback:function(t){e.declarationVisibility=t},expression:"declarationVisibility"}})],1):e._e()],1)],1)],1):e._e(),a("v-textarea",{attrs:{disabled:!0,value:e.formatScript(e.scriptText),"auto-grow":"",spellcheck:"false","background-color":"black"}})],1)},i=[],l={name:"ScriptViewer",components:{},props:{scriptText:{type:String,required:!1},showReadability:{type:Boolean,default:!0},showDeclarationVisibility:{type:Boolean,default:!1},showToolbar:{type:Boolean,default:!0},skipFormat:{type:Boolean,default:!1}},computed:{},watch:{readability(){this.$emit("readability-changed",this.readability)},declarationVisibility(){this.$emit("declaration-visibility-changed",this.declarationVisibility)}},methods:{formatScript(e){return this.skipFormat?e:(e||"").toLowerCase().split(" exists").join(" exists\n  ").split(" on").join("\non").split(" using").join("\nusing").split(" (").join(" (\n  ").split(",").join("\n  ,").split(");").join("\n);")},handleCopyStatus(e){alert(e)},onCopy(){alert("Copied!")},onError(e){alert("Failed to copy script to clipboard"),console.error(e)},executeSql(){alert("not implemented:  server config value will expose graphile extension to execute generated script")}},data:()=>({allPolicies:[],schemaPolicy:"NOT CALCULATED",defaultRlsPolicies:"NOT CALCULATED",defaultNoRlsPolicies:"NOT CALCULATED",selectedTabName:"",readability:"terse",declarationVisibility:"show"})},r=l,o=a("2877"),s=a("6544"),c=a.n(s),u=a("8336"),d=a("a523"),m=a("132d"),p=a("a722"),h=a("0fd9"),b=a("2fa4"),f=a("b73d"),v=a("a844"),y=a("71d9"),g=a("3a2f"),x=Object(o["a"])(r,n,i,!1,null,null,null);t["a"]=x.exports;c()(x,{VBtn:u["a"],VContainer:d["a"],VIcon:m["a"],VLayout:p["a"],VRow:h["a"],VSpacer:b["a"],VSwitch:f["a"],VTextarea:v["a"],VToolbar:y["a"],VTooltip:g["a"]})},"8bda":function(e,t,a){},9:function(e,t){},"90d0":function(e,t,a){},9270:function(e,t,a){},9498:function(e,t,a){"use strict";var n=a("9270"),i=a.n(n);i.a},"96b5":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("script-viewer",{attrs:{scriptText:e.computedPolicy,skipFormat:""},on:{"readability-changed":e.policyReadabilityChanged}})],1)},i=[],l=a("ee5d"),r=a("89d6"),o=a("4eb5"),s=a.n(o),c={name:"TablePolicyRealization",mixins:[l["a"],s.a],components:{ScriptViewer:r["a"]},props:{policyDefinition:{type:Object,required:!0},table:{type:Object,required:!1},enableRls:{type:Boolean,required:!1}},data(){return{policyStructure:[],policyReadability:"terse",computedPolicy:"N/A"}},mounted(){this.doComputePolicy()},watch:{policyReadability(){this.doComputePolicy()},enableRls(){this.doComputePolicy()},policyDefinition(){this.doComputePolicy()}},methods:{policyReadabilityChanged(e){this.policyReadability=e},refresh(){this.doComputePolicy()},expand(){this.computedPolicy=`${this.computedPolicy} `},doComputePolicy(){let e=null;this.table&&(e={schemaName:this.table.tableSchema,tableName:this.table.tableName}),this.computedPolicy=this.computePolicy(this.policyDefinition,this.policyReadability,e,this.table)},onCopy:function(e){alert("Copied!")},onError:function(e){alert("Failed to copy texts")},executeSql(){alert("not implemented:  server config value will expose graphile extension to execute generated script")}},computed:{}},u=c,d=a("2877"),m=a("6544"),p=a.n(m),h=a("a523"),b=Object(d["a"])(u,n,i,!1,null,null,null);t["a"]=b.exports;p()(b,{VContainer:h["a"]})},9849:function(e,t,a){"use strict";var n=a("b4ca"),i=a.n(n);i.a},"9e46":function(e,t,a){},a789:function(e,t,a){"use strict";var n=a("3b45"),i=a.n(n);i.a},a985:function(e,t,a){"use strict";(function(e){var n=a("861c");t["a"]={name:"PolicyManager",components:{PolicyDefinition:n["a"]},methods:{saveNewPolicy(){try{this.$store.commit("newPolicy",{name:this.newPolicyName})}catch(e){alert(e.toString()),console.error(e)}this.dialog=!1}},computed:{policies(){return this.$store.state.policies.sort((function(e,t){return e.id<t.id?-1:1}))}},data(){return{dialog:!1,newPolicyName:"New Table Policy",headers:[{text:""},{text:"ID",sortable:!1,value:"id"},{text:"Name",sortable:!1,value:"name"}]}},mounted(){e.client&&window&&(window.history.scrollRestoration="auto")}}}).call(this,a("f28c"))},ab3b:function(e,t){var a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"SearchFunctions"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"searchTerm"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"searchFunctions"},arguments:[{kind:"Argument",name:{kind:"Name",value:"searchTerm"},value:{kind:"Variable",name:{kind:"Name",value:"searchTerm"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"functionName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"functionSchema"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"resultDataType"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"argumentDataTypes"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"definition"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:201}};a.loc.source={body:"mutation SearchFunctions(\n  $searchTerm: String!\n){\n  searchFunctions(searchTerm: $searchTerm) {\n    id\n    functionName\n    functionSchema\n    resultDataType\n    argumentDataTypes\n    definition\n  }\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};function n(e,t){if("FragmentSpread"===e.kind)t.add(e.name.value);else if("VariableDefinition"===e.kind){var a=e.type;"NamedType"===a.kind&&t.add(a.name.value)}e.selectionSet&&e.selectionSet.selections.forEach((function(e){n(e,t)})),e.variableDefinitions&&e.variableDefinitions.forEach((function(e){n(e,t)})),e.definitions&&e.definitions.forEach((function(e){n(e,t)}))}var i={};function l(e,t){for(var a=0;a<e.definitions.length;a++){var n=e.definitions[a];if(n.name&&n.name.value==t)return n}}function r(e,t){var a={kind:e.kind,definitions:[l(e,t)]};e.hasOwnProperty("loc")&&(a.loc=e.loc);var n=i[t]||new Set,r=new Set,o=new Set;n.forEach((function(e){o.add(e)}));while(o.size>0){var s=o;o=new Set,s.forEach((function(e){if(!r.has(e)){r.add(e);var t=i[e]||new Set;t.forEach((function(e){o.add(e)}))}}))}return r.forEach((function(t){var n=l(e,t);n&&a.definitions.push(n)})),a}(function(){a.definitions.forEach((function(e){if(e.name){var t=new Set;n(e,t),i[e.name.value]=t}}))})(),e.exports=a,e.exports["SearchFunctions"]=r(a,"SearchFunctions")},b450:function(e,t,a){},b4ca:function(e,t,a){},bd5a:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-dialog",{attrs:{persistent:"",width:"800"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[a("v-btn",e._g({staticClass:"text-none",attrs:{small:"",dark:"",disabled:e.disabled}},n),[e._v("\n        "+e._s(e.displayValue)+"\n      ")])]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[a("v-card-title",{staticClass:"headline"},[e._v("Custom Policy")]),a("v-text-field",{model:{value:e.customName,callback:function(t){e.customName=t},expression:"customName"}}),a("v-card-actions",[a("v-spacer"),a("v-btn",{on:{click:function(t){e.dialog=!1}}},[e._v("Cancel")]),a("v-btn",{on:{click:e.customizeTablePolicyDefinition}},[e._v("Customize")]),a("v-spacer")],1)],1)],1)],1)},i=[],l={name:"PolicyCustomizeDialog",props:{currentPolicyDefinition:{type:Object,required:!0},tables:{type:Array,required:!0},bulkCustomize:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},mounted(){this.customName=this.defaultCustomName},data(){return{dialog:!1,customName:"n/a"}},computed:{displayValue(){return this.bulkCustomize?"Bulk Customize":"Customize"},defaultCustomName(){return 1===this.tables.length?`Custom Policy: ${this.tables[0].tableSchema}.${this.tables[0].tableName}`:this.tables.length>1?"New Bulk Policy":"n/a"}},watch:{},methods:{customizeTablePolicyDefinition(){this.dialog=!1;const e=this.tables.reduce((e,t)=>{return e.concat([t.id])},[]);this.$store.commit("customizeTablePolicy",{sourcePolicyDefinitionId:this.currentPolicyDefinition.id,tableIds:e,newFields:{name:this.customName}}),this.$emit("policyAssigned",this.tables)}}},r=l,o=(a("0134"),a("2877")),s=a("6544"),c=a.n(s),u=a("8336"),d=a("b0af"),m=a("99d9"),p=a("169a"),h=a("2fa4"),b=a("8654"),f=Object(o["a"])(r,n,i,!1,null,null,null);t["a"]=f.exports;c()(f,{VBtn:u["a"],VCard:d["a"],VCardActions:m["a"],VCardTitle:m["b"],VDialog:p["a"],VSpacer:h["a"],VTextField:b["a"]})},bd75:function(e,t,a){},c2d7:function(e,t,a){"use strict";var n=a("fe5d"),i=a.n(n);i.a},c496:function(e,t,a){"use strict";var n=a("bd75"),i=a.n(n);i.a},cb8a:function(e,t,a){"use strict";var n=a("3754"),i=a.n(n);i.a},cfbf:function(e,t,a){"use strict";var n=a("015f"),i=a.n(n);i.a},d806:function(e,t,a){},da37:function(e,t,a){},dbdb:function(e,t,a){"use strict";var n=a("f010"),i=a.n(n);i.a},e002:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div")},i=[];const l="ALLOWED",r="DENIED",o="IMPLIED";var s={name:"TablePolicyEvaluatorCalculator",props:{policyDefinition:{type:Object,required:!0},table:{type:Object,required:!0}},mounted(){},data(){return{}},computed:{grantStatusColors(){return{expected:"green",missing:"yellow",unexpected:"red",extra:"blue"}},tablePolicyEvaluation(){const e=this.$store.state.ignoredRoles.map(e=>e.roleName),t=Object.keys(this.policyDefinition.roleGrants).reduce((t,a)=>{return Object.keys(this.policyDefinition.roleGrants[a]).filter(t=>-1===e.indexOf(t)).reduce((e,t)=>{const n=this.policyDefinition.roleGrants[a][t],i=this.table.roleTableGrants.find(e=>e.grantee===a&&e.privilegeType===t.toUpperCase());switch(n){case l:return i?{...e,expected:[...e.expected,{...i,statusColor:this.grantStatusColors.expected}]}:{...e,missing:[...e.missing,{roleName:a,expectedRoleAction:n,action:t,statusColor:this.grantStatusColors.missing}]};case r:return i?{...e,unexpected:[...e.unexpected,{...i,statusColor:this.grantStatusColors.unexpected}]}:e;case o:return i?{...e,extra:[...e.extra,{...i,statusColor:this.grantStatusColors.extra}]}:e}},t)},{expected:[],missing:[],extra:[],unexpected:[]});return t}},watch:{},methods:{}},c=s,u=(a("9498"),a("2877")),d=Object(u["a"])(c,n,i,!1,null,null,null);t["a"]=d.exports},ee5d:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div")},i=[],l=a("9dbb"),r=a.n(l);const o="ALLOWED",s="DENIED",c="IMPLIED",u="terse";var d={name:"PolicyComputerMixin",computed:{projectRoles(){return this.$store.state.projectRoles}},methods:{computePolicy(e,t,a,n){const i=Object.keys(e.roleGrants).map(e=>{return{roleName:e}}),l=`${i.map(e=>e.roleName).join(", ")}`,d=Object.keys(e.roleGrants).reduce((t,a)=>{const i=Object.keys(e.roleGrants[a]).reduce((t,n)=>{return e.roleGrants[a][n]===o?t+1:t},0),l=Object.keys(e.roleGrants[a]).map((t,l,r)=>{switch(t){case"insert":case"update":let r=e.columnExclusions[t][a]||[],s=r.length>0?`\n        -- excluded columns: ${r.join(", ")}`:"\n        -- no excluded columns",c=n?`( ${n.tableColumns.map(e=>e.columnName).filter(e=>-1===r.indexOf(e)).join(", ")} )`:"{{grantColumns}}";const u=e.columnExclusionOverrides[t].indexOf(a)>-1,d=r.length>0||u?o:e.roleGrants[a][t];return{action:t,value:d,grantColumns:c,columnExclusionsText:s,comma:l<i-1?",":""};default:return{action:t,value:e.roleGrants[a][t],grantColumns:"",comma:l<i-1?",":""}}});return[...t,{roleName:a,grants:l}]},[]),p=d.map((e,t,a)=>{return{...e,grants:e.grants.filter(e=>e.value===o)}}).filter(e=>e.grants.length>0),h=d.map(e=>{return{...e,grants:e.grants.filter(e=>e.value===s)}}).filter(e=>e.grants.length>0),b=d.map(e=>{return{...e,grants:e.grants.filter(e=>e.value===c)}}).filter(e=>e.grants.length>0),f=Object.keys(e.rlsQualifiers).reduce((t,a)=>{return t.concat(Object.keys(e.rlsQualifiers[a]).reduce((t,n)=>{return[...t,...e.rlsQualifiers[a][n].policies.map(e=>{return{...e,action:n,roleName:a}})]},[]))},[]),v={verbose:!0,deniedRoleGrants:h,impliedRoleGrants:b},y={...a,policyName:e.name,enableRls:e.enableRls,allowedRoleGrants:p,rlsPolicies:f,revokeRolesList:l,tableName:(n||{}).tableName},g=t===u?y:{...v,...y};return r.a.render(m,g)}}};const m="\n----------\n----------  BEGIN TABLE POLICY: {{schemaName}}{{^schemaName}}{{=<% %>=}}{{schemaName}}<%={{ }}=%>{{/schemaName}}.{{tableName}}{{^tableName}}{{=<% %>=}}{{tableName}}<%={{ }}=%>{{/tableName}}\n----------  POLICY NAME:  {{policyName}}\n----------\n\n----------  REMOVE EXISTING TABLE GRANTS\n\n  revoke all privileges \n  on table {{schemaName}}{{^schemaName}}{{=<% %>=}}{{schemaName}}<%={{ }}=%>{{/schemaName}}.{{tableName}}{{^tableName}}{{=<% %>=}}{{tableName}}<%={{ }}=%>{{/tableName}} \n  from public;\n\n  revoke all privileges \n  on table {{schemaName}}{{^schemaName}}{{=<% %>=}}{{schemaName}}<%={{ }}=%>{{/schemaName}}.{{tableName}}{{^tableName}}{{=<% %>=}}{{tableName}}<%={{ }}=%>{{/tableName}} \n  from {{revokeRolesList}};\n\n{{#enableRls}}\n----------  ENABLE ROW LEVEL SECURITY\n\n  alter table {{schemaName}}{{^schemaName}}{{=<% %>=}}{{schemaName}}<%={{ }}=%>{{/schemaName}}.{{tableName}}{{^tableName}}{{=<% %>=}}{{tableName}}<%={{ }}=%>{{/tableName}} enable row level security;\n\n{{#rlsPolicies}}\n  create policy {{name}}_{{schemaName}}{{^schemaName}}{{=<% %>=}}{{schemaName}}<%={{ }}=%>{{/schemaName}}_{{tableName}}{{^tableName}}{{=<% %>=}}{{tableName}}<%={{ }}=%>{{/tableName}} \n    on {{schemaName}}{{^schemaName}}{{=<% %>=}}{{schemaName}}<%={{ }}=%>{{/schemaName}}.{{tableName}}{{^tableName}}{{=<% %>=}}{{tableName}}<%={{ }}=%>{{/tableName}}\n    as {{passStrategy}}\n    for {{action}}\n    to {{roleName}}\n    using {{{using}}}\n    {{#withCheck}}\n    with check {{withCheck}}\n    {{/withCheck}}\n    ;\n{{/rlsPolicies}}\n\n{{/enableRls}}\n{{^enableRls}}\n----------  DISABLE ROW LEVEL SECURITY\n\n  alter table {{schemaName}}{{^schemaName}}{{=<% %>=}}{{schemaName}}<%={{ }}=%>{{/schemaName}}.{{tableName}}{{^tableName}}{{=<% %>=}}{{tableName}}<%={{ }}=%>{{/tableName}} disable row level security;\n{{/enableRls}}\n\n----------  CREATE NEW TABLE GRANTS\n{{#allowedRoleGrants}}\n\n----------  {{roleName}}\n  grant \n  {{#grants}}\n    {{action}} {{grantColumns}}{{comma}} {{columnExclusionsText}}\n  {{/grants}}\n  on table {{schemaName}}{{^schemaName}}{{=<% %>=}}{{schemaName}}<%={{ }}=%>{{/schemaName}}.{{tableName}}{{^tableName}}{{=<% %>=}}{{tableName}}<%={{ }}=%>{{/tableName}} \n  to {{roleName}};\n\n{{/allowedRoleGrants}}\n\n{{#verbose}}\n----------  IMPLIED TABLE GRANTS\n  {{#impliedRoleGrants}}\n\n  ----------  {{roleName}}\n  {{#grants}}\n  --IMPLIED:   grant {{action}} on table {{schemaName}}{{^schemaName}}{{=<% %>=}}{{schemaName}}<%={{ }}=%>{{/schemaName}}.{{tableName}}{{^tableName}}{{=<% %>=}}{{tableName}}<%={{ }}=%>{{/tableName}} to {{roleName}};\n  {{/grants}}\n  {{/impliedRoleGrants}}\n\n  ----------  DENIED TABLE GRANTS\n  {{#deniedRoleGrants}}\n\n  ----------  {{roleName}}\n  {{#grants}}\n  --DENIED:   grant {{action}} on table {{schemaName}}{{^schemaName}}{{=<% %>=}}{{schemaName}}<%={{ }}=%>{{/schemaName}}.{{tableName}}{{^tableName}}{{=<% %>=}}{{tableName}}<%={{ }}=%>{{/tableName}} to {{roleName}};\n  {{/grants}}\n  {{/deniedRoleGrants}}\n{{/verbose}}\n\n----------  END TABLE POLICY: {{schemaName}}{{^schemaName}}{{=<% %>=}}{{schemaName}}<%={{ }}=%>{{/schemaName}}.{{tableName}}{{^tableName}}{{=<% %>=}}{{tableName}}<%={{ }}=%>{{/tableName}}\n--==";var p=d,h=a("2877"),b=Object(h["a"])(p,n,i,!1,null,null,null);t["a"]=b.exports},f010:function(e,t,a){},fb68:function(e,t,a){"use strict";var n=a("90d0"),i=a.n(n);i.a},fe5d:function(e,t,a){}});
//# sourceMappingURL=app.ad7a8228.js.map